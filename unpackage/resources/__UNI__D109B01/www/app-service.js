if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then(r=>t.resolve(e()).then(()=>r),r=>t.resolve(e()).then(()=>{throw r}))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function t(e,t,...r){uni.__log__?uni.__log__(e,t,...r):console[e].apply(console,[...r,t])}const r=t=>(r,n=e.getCurrentInstance())=>{!e.isInSSRComponentSetup&&e.injectHook(t,r,n)},n=r("onShow"),o=r("onHide"),i=r("onLaunch"),a=(e,t)=>{const r=e.__vccOpts||e;for(const[n,o]of t)r[n]=o;return r},s=a(e.defineComponent({__name:"index",setup(r){const n=e.ref(0),o=e.ref(0),i=e.ref(0),a=e.ref(0),s=e.ref([]);e.onMounted(()=>{c()});const c=()=>{try{const e=uni.getStorageSync("ptt_data");e&&(n.value=e.currentPTT||0,o.value=e.best10Avg||0,i.value=e.best30Avg||0,a.value=e.recent10Avg||0);const t=uni.getStorageSync("recent_scores");t&&Array.isArray(t)&&(s.value=t.slice(0,3))}catch(e){t("error","at pages/index/index.vue:174","åŠ è½½æ•°æ®å¤±è´¥",e)}},l=e=>({pst:"PAST",prs:"PRESENT",ftr:"FUTURE",byd:"BEYOND",etr:"ETERNAL"}[e]||e.toUpperCase()),u=e=>e>=1e7?"PM":e>=99e5?"EX+":e>=98e5?"EX":e>=95e5?"AA":e>=92e5?"A":e>=89e5?"B":e>=86e5?"C":"D",d=e=>e.toLocaleString(),f=e=>Math.min(e/15*100,100),p=()=>{uni.navigateTo({url:"/pages/calculator/score-ptt"})},h=()=>{uni.navigateTo({url:"/pages/calculator/tolerance"})},m=()=>{uni.navigateTo({url:"/pages/best30/best30"})},y=()=>{uni.navigateTo({url:"/pages/songs/songs"})},v=()=>{uni.navigateTo({url:"/pages/data/data"})};return(t,r)=>(e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("view",{class:"header-content"},[e.createElementVNode("text",{class:"title"},"Arcaea PTTè®¡ç®—å™¨"),e.createElementVNode("text",{class:"subtitle"},"ä¸“ä¸šã€å‡†ç¡®ã€ä¾¿æ·")]),e.createElementVNode("view",{class:"header-decoration"})]),e.createElementVNode("view",{class:"card overview-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"PTTæ¦‚è§ˆ"),e.createElementVNode("view",{class:"refresh-icon",onClick:c},[e.createElementVNode("text",{class:"icon"},"ğŸ”„")])]),e.createElementVNode("view",{class:"ptt-overview"},[e.createElementVNode("view",{class:"ptt-value"},[e.createElementVNode("text",{class:"value"},e.toDisplayString(n.value.toFixed(2)),1),e.createElementVNode("text",{class:"label"},"å½“å‰PTT"),e.createElementVNode("view",{class:"ptt-progress",style:e.normalizeStyle({width:Math.min(n.value/15*100,100)+"%"})},null,4)]),e.createElementVNode("view",{class:"ptt-divider"}),e.createElementVNode("view",{class:"ptt-stat"},[e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("view",{class:"stat-content"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(o.value.toFixed(2)),1),e.createElementVNode("text",{class:"stat-label"},"B10å¹³å‡")]),e.createElementVNode("view",{class:"stat-progress",style:e.normalizeStyle({width:f(o.value)+"%"})},null,4)]),e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("view",{class:"stat-content"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(i.value.toFixed(2)),1),e.createElementVNode("text",{class:"stat-label"},"B30å¹³å‡")]),e.createElementVNode("view",{class:"stat-progress",style:e.normalizeStyle({width:f(i.value)+"%"})},null,4)]),e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("view",{class:"stat-content"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(a.value.toFixed(2)),1),e.createElementVNode("text",{class:"stat-label"},"R10å¹³å‡")]),e.createElementVNode("view",{class:"stat-progress",style:e.normalizeStyle({width:f(a.value)+"%"})},null,4)])])])]),e.createElementVNode("view",{class:"card function-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"å¿«æ·åŠŸèƒ½"),e.createElementVNode("view",{class:"function-grid-icon"},"ğŸ¯")]),e.createElementVNode("view",{class:"functions"},[e.createElementVNode("view",{class:"function-item calculator",onClick:p},[e.createElementVNode("view",{class:"function-icon-container"},[e.createElementVNode("text",{class:"function-icon"},"ğŸ§®")]),e.createElementVNode("text",{class:"function-name"},"æˆç»©â†”PTT"),e.createElementVNode("text",{class:"function-desc"},"æˆç»©ä¸PTTåŒå‘è½¬æ¢"),e.createElementVNode("view",{class:"function-arrow"},"â†’")]),e.createElementVNode("view",{class:"function-item tolerance",onClick:h},[e.createElementVNode("view",{class:"function-icon-container"},[e.createElementVNode("text",{class:"function-icon"},"âš–ï¸")]),e.createElementVNode("text",{class:"function-name"},"å®¹é”™è®¡ç®—"),e.createElementVNode("text",{class:"function-desc"},"è®¡ç®—è¯„çº§å®¹é”™æ•°"),e.createElementVNode("view",{class:"function-arrow"},"â†’")]),e.createElementVNode("view",{class:"function-item best30",onClick:m},[e.createElementVNode("view",{class:"function-icon-container"},[e.createElementVNode("text",{class:"function-icon"},"ğŸ“‹")]),e.createElementVNode("text",{class:"function-name"},"B30ç®¡ç†"),e.createElementVNode("text",{class:"function-desc"},"ç®¡ç†æœ€ä½³30æ¬¡æˆç»©"),e.createElementVNode("view",{class:"function-arrow"},"â†’")]),e.createElementVNode("view",{class:"function-item songs",onClick:y},[e.createElementVNode("view",{class:"function-icon-container"},[e.createElementVNode("text",{class:"function-icon"},"ğŸµ")]),e.createElementVNode("text",{class:"function-name"},"æ­Œæ›²åˆ—è¡¨"),e.createElementVNode("text",{class:"function-desc"},"æµè§ˆæ­Œæ›²å’Œå®šæ•°"),e.createElementVNode("view",{class:"function-arrow"},"â†’")])])]),e.createElementVNode("view",{class:"card recent-score-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"æœ€è¿‘æˆç»©"),e.createElementVNode("text",{class:"card-action",onClick:v},"æŸ¥çœ‹å…¨éƒ¨ â†’")]),s.value.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"recent-scores"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.value,(t,r)=>{return e.openBlock(),e.createElementBlock("view",{class:"score-item",key:r,style:e.normalizeStyle({animationDelay:.1*r+"s"})},[e.createElementVNode("view",{class:"score-info"},[e.createElementVNode("text",{class:"song-name"},e.toDisplayString(t.songName),1),e.createElementVNode("view",{class:"song-meta"},[e.createElementVNode("text",{class:e.normalizeClass(["song-difficulty",(o=t.difficulty,{pst:"difficulty-pst",prs:"difficulty-prs",ftr:"difficulty-ftr",byd:"difficulty-byd",etr:"difficulty-etr"}[o]||"")])},e.toDisplayString(l(t.difficulty)),3),t.constant?(e.openBlock(),e.createElementBlock("text",{key:0,class:"song-constant"},e.toDisplayString(t.constant),1)):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"score-value"},[e.createElementVNode("text",{class:"score-text"},e.toDisplayString(d(t.score)),1),e.createElementVNode("text",{class:"score-ptt"},"PTT: "+e.toDisplayString(t.ptt.toFixed(2)),1),e.createElementVNode("text",{class:e.normalizeClass(["score-rating",(n=t.rating||u(t.score),{PM:"rating-pm","EX+":"rating-ex-plus",EX:"rating-ex",AA:"rating-aa",A:"rating-a",B:"rating-b",C:"rating-c",D:"rating-d"}[n]||"")])},e.toDisplayString(t.rating||u(t.score)),3)])],4);var n,o}),128))])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-scores"},[e.createElementVNode("view",{class:"empty-icon"},"ğŸ“Š"),e.createElementVNode("text",{class:"empty-title"},"æš‚æ— æˆç»©è®°å½•"),e.createElementVNode("text",{class:"empty-desc"},"ç‚¹å‡»æˆç»©â†”PTTå¼€å§‹è®°å½•æ‚¨çš„æˆç»©"),e.createElementVNode("button",{class:"empty-button",onClick:p},"ç«‹å³å¼€å§‹")]))]),e.createElementVNode("view",{class:"footer"},[e.createElementVNode("text",{class:"footer-text"},"ç‰ˆæœ¬ 1.2.5"),e.createElementVNode("view",{class:"footer-decoration"})])]))}}),[["__scopeId","data-v-75e16e28"]]),c=a(e.defineComponent({__name:"score-ptt",setup(r){const n=e.ref("scoreToPtt"),o=e.ref("song"),i=e.ref({}),a=e.ref(""),s=e.ref(""),c=e.ref(""),l=e.ref(""),u=e.ref(null),d=e.computed(()=>{let e=0;return e="song"===o.value?i.value.constant:parseFloat(s.value),!(!e||isNaN(e))&&("scoreToPtt"===n.value?""!==c.value&&parseInt(c.value)>=0&&parseInt(c.value)<=1e7:""!==l.value&&!isNaN(parseFloat(l.value)))}),f=e.computed(()=>!!u.value&&("song"===o.value?!!i.value.name:!!s.value&&!isNaN(parseFloat(s.value))));e.onMounted(()=>{const e=uni.getStorageSync("recent_song");e&&(i.value=e),uni.$on("songSelected",e=>{i.value=e,u.value=null,c.value="",l.value=""})});const p=e=>{n.value=e,u.value=null,c.value="",l.value=""},h=e=>{o.value=e,u.value=null,c.value="",l.value=""},m=()=>{const e=parseFloat(s.value);isNaN(e)||e<0?s.value="0":e>15&&(s.value="15")},y=()=>{uni.navigateTo({url:"/pages/songs/songs?from=calculator"})},v=()=>{const e=parseInt(c.value);isNaN(e)||e<0?c.value="0":e>1e7&&(c.value="10000000")},g=()=>{const e=parseFloat(l.value);(isNaN(e)||e<0)&&(l.value="0")},b=()=>{let e=0,t="";if("song"===o.value){if(e=i.value.constant,t=i.value.name||"",!e)return void uni.showToast({title:"è¯·å…ˆé€‰æ‹©æ­Œæ›²",icon:"none"})}else if(e=parseFloat(s.value),t=a.value||"æ‰‹åŠ¨è¾“å…¥",!e||isNaN(e))return void uni.showToast({title:"è¯·è¾“å…¥æœ‰æ•ˆçš„å®šæ•°",icon:"none"});if("scoreToPtt"===n.value){const r=parseInt(c.value),n=w(r,e),i=_(r);u.value={score:r,ptt:n,rating:i,songName:t,constant:e,inputMode:o.value}}else{const r=parseFloat(l.value),n=E(r,e),i=_(n);u.value={ptt:r,score:n,rating:i,songName:t,constant:e,inputMode:o.value}}},w=(e,t)=>e>=1e7?t+2:e>=98e5?t+1+(e-98e5)/2e5:t+Math.max(0,(e-95e5)/3e5),E=(e,t)=>{const r=e-t;return r>=2?1e7:r>=1?Math.floor(98e5+2e5*(r-1)):Math.floor(95e5+3e5*r)},_=e=>1e7===e?"PM":e>=99e5?"EX+":e>=98e5?"EX":e>=95e5?"AA":e>=92e5?"A":e>=89e5?"B":e>=86e5?"C":"D",S=e=>({PM:"rating-pm","EX+":"rating-ex-plus",EX:"rating-ex",AA:"rating-aa",A:"rating-a",B:"rating-b",C:"rating-c",D:"rating-d"}[e]||""),x=e=>({pst:"PAST",prs:"PRESENT",ftr:"FUTURE",byd:"BEYOND",etr:"ETERNAL"}[e]||e.toUpperCase()),N=e=>{c.value=e.toString(),v()},I=e=>{l.value=e.toString(),g()},T=()=>{if(!c.value)return 0;const e=parseInt(c.value)||0;return Math.min(e/1e7*100,100)},O=()=>{if(!l.value)return 0;const e=parseFloat(l.value)||0;return Math.min(e/15*100,100)},A=()=>{if(!u.value)return;if("song"===o.value&&!i.value.name)return;if("manual"===o.value&&!s.value)return;let e={score:u.value.score,ptt:u.value.ptt,rating:u.value.rating,timestamp:Date.now()};"song"===o.value?(e.songName=i.value.name,e.difficulty=i.value.difficulty,e.constant=i.value.constant):(e.songName=a.value||"æ‰‹åŠ¨è¾“å…¥",e.difficulty="manual",e.constant=parseFloat(s.value));try{let t=uni.getStorageSync("best30_records")||[];const r=t.findIndex(t=>t.songName===e.songName&&t.difficulty===e.difficulty);-1!==r?t[r]=e:t.push(e),t.sort((e,t)=>t.ptt-e.ptt),t=t.slice(0,30),uni.setStorageSync("best30_records",t),R(e),uni.showToast({title:"å·²ä¿å­˜åˆ°B30",icon:"success"}),setTimeout(()=>{uni.showModal({title:"æç¤º",content:"å·²æˆåŠŸä¿å­˜åˆ°B30ï¼Œæ˜¯å¦è·³è½¬åˆ°B30ç®¡ç†é¡µé¢ï¼Ÿ",success:e=>{e.confirm&&uni.navigateTo({url:"/pages/best30/best30"})}})},1500)}catch(r){t("error","at pages/calculator/score-ptt.vue:692","ä¿å­˜B30å¤±è´¥",r),uni.showToast({title:"ä¿å­˜å¤±è´¥",icon:"none"})}},R=e=>{try{let t=uni.getStorageSync("recent_scores")||[];const r=t.findIndex(t=>t.songName===e.songName&&t.difficulty===e.difficulty);-1!==r&&t.splice(r,1),t.unshift(e),t=t.slice(0,10),uni.setStorageSync("recent_scores",t)}catch(r){t("error","at pages/calculator/score-ptt.vue:724","æ›´æ–°æœ€è¿‘æˆç»©å¤±è´¥",r)}};return(t,r)=>{return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"card mode-selector-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"è½¬æ¢æ¨¡å¼")]),e.createElementVNode("view",{class:"mode-selector"},[e.createElementVNode("view",{class:e.normalizeClass(["mode-item",{active:"scoreToPtt"===n.value}]),onClick:r[0]||(r[0]=e=>p("scoreToPtt"))},[e.createElementVNode("text",{class:"mode-icon"},"ğŸ¯"),e.createElementVNode("text",{class:"mode-text"},"æˆç»© â†’ PTT"),e.createElementVNode("view",{class:"mode-indicator"})],2),e.createElementVNode("view",{class:e.normalizeClass(["mode-item",{active:"pttToScore"===n.value}]),onClick:r[1]||(r[1]=e=>p("pttToScore"))},[e.createElementVNode("text",{class:"mode-icon"},"â­"),e.createElementVNode("text",{class:"mode-text"},"PTT â†’ æˆç»©"),e.createElementVNode("view",{class:"mode-indicator"})],2)])]),e.createElementVNode("view",{class:"card song-selector"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"æ­Œæ›²/å®šæ•°è®¾ç½®"),e.createElementVNode("view",{class:"mode-indicator-icon"},e.toDisplayString("song"===o.value?"ğŸµ":"âœï¸"),1)]),e.createElementVNode("view",{class:"input-mode-selector"},[e.createElementVNode("view",{class:e.normalizeClass(["mode-item",{active:"song"===o.value}]),onClick:r[2]||(r[2]=e=>h("song"))},[e.createElementVNode("text",{class:"mode-icon"},"ğŸµ"),e.createElementVNode("text",{class:"mode-text"},"é€‰æ‹©æ­Œæ›²"),e.createElementVNode("view",{class:"mode-indicator"})],2),e.createElementVNode("view",{class:e.normalizeClass(["mode-item",{active:"manual"===o.value}]),onClick:r[3]||(r[3]=e=>h("manual"))},[e.createElementVNode("text",{class:"mode-icon"},"âœï¸"),e.createElementVNode("text",{class:"mode-text"},"æ‰‹åŠ¨è¾“å…¥å®šæ•°"),e.createElementVNode("view",{class:"mode-indicator"})],2)]),"song"===o.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"song-info",onClick:y},[e.createElementVNode("view",{class:"song-content"},[e.createElementVNode("view",{class:"song-main-info"},[i.value.name?(e.openBlock(),e.createElementBlock("text",{key:0,class:"song-name"},e.toDisplayString(i.value.name),1)):(e.openBlock(),e.createElementBlock("text",{key:1,class:"song-placeholder"},"ç‚¹å‡»é€‰æ‹©æ­Œæ›²")),i.value.constant?(e.openBlock(),e.createElementBlock("view",{key:2,class:"song-difficulty"},[e.createElementVNode("text",{class:e.normalizeClass(["difficulty-text",(w=i.value.difficulty,{pst:"difficulty-pst",prs:"difficulty-prs",ftr:"difficulty-ftr",byd:"difficulty-byd",etr:"difficulty-etr"}[w]||"")])},e.toDisplayString(x(i.value.difficulty)),3),e.createElementVNode("text",{class:"difficulty-constant"},e.toDisplayString(i.value.constant),1)])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"selection-arrow"},[e.createElementVNode("text",{class:"arrow-icon"},"â†’")])])])):e.createCommentVNode("",!0),"manual"===o.value?(e.openBlock(),e.createElementBlock("view",{key:1,class:"manual-input"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"æ­Œæ›²åç§°ï¼ˆå¯é€‰ï¼‰"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"text","onUpdate:modelValue":r[4]||(r[4]=e=>a.value=e),placeholder:"ç”¨äºè®°å½•ï¼Œä¸å½±å“è®¡ç®—"},null,512),[[e.vModelText,a.value]]),e.createElementVNode("text",{class:"form-hint"},"æ­¤åç§°ä»…ç”¨äºè®°å½•ï¼Œä¸ä¼šå½±å“è®¡ç®—ç»“æœ")]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"å®šæ•°"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"digit","onUpdate:modelValue":r[5]||(r[5]=e=>s.value=e),placeholder:"ä¾‹å¦‚: 11.5",onInput:m},null,544),[[e.vModelText,s.value]]),e.createElementVNode("text",{class:"form-hint"},"æ­Œæ›²çš„å®šæ•°èŒƒå›´é€šå¸¸åœ¨1.0-12.5ä¹‹é—´")])])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"card conversion-form"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},e.toDisplayString("scoreToPtt"===n.value?"æˆç»© â†’ PTT":"PTT â†’ æˆç»©"),1),e.createElementVNode("view",{class:"conversion-icon"},e.toDisplayString("scoreToPtt"===n.value?"ğŸ”„":"ğŸ¯"),1)]),"scoreToPtt"===n.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"form-group"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"form-label-wrapper"},[e.createElementVNode("text",{class:"form-label"},"è¾“å…¥æˆç»©"),e.createElementVNode("view",{class:"form-icon"},"ğŸ“Š")]),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"number","onUpdate:modelValue":r[6]||(r[6]=e=>c.value=e),placeholder:"0 - 10000000",onInput:v,maxlength:8},null,544),[[e.vModelText,c.value]]),e.createElementVNode("view",{class:"input-range-hint"},[e.createElementVNode("text",{class:"range-text"},"èŒƒå›´: 0 - 10,000,000"),e.createElementVNode("view",{class:"range-indicator",style:e.normalizeStyle({width:T()+"%"})},null,4)])]),"scoreToPtt"===n.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"quick-input-buttons"},[e.createElementVNode("button",{class:"quick-btn",onClick:r[7]||(r[7]=e=>N(95e5))},[e.createElementVNode("text",{class:"quick-btn-text"},"950ä¸‡")]),e.createElementVNode("button",{class:"quick-btn",onClick:r[8]||(r[8]=e=>N(98e5))},[e.createElementVNode("text",{class:"quick-btn-text"},"980ä¸‡")]),e.createElementVNode("button",{class:"quick-btn",onClick:r[9]||(r[9]=e=>N(99e5))},[e.createElementVNode("text",{class:"quick-btn-text"},"990ä¸‡")]),e.createElementVNode("button",{class:"quick-btn",onClick:r[10]||(r[10]=e=>N(1e7))},[e.createElementVNode("text",{class:"quick-btn-text"},"1000ä¸‡")])])):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0),"pttToScore"===n.value?(e.openBlock(),e.createElementBlock("view",{key:1,class:"form-group"},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("view",{class:"form-label-wrapper"},[e.createElementVNode("text",{class:"form-label"},"è¾“å…¥ç›®æ ‡PTT"),e.createElementVNode("view",{class:"form-icon"},"â­")]),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"digit","onUpdate:modelValue":r[11]||(r[11]=e=>l.value=e),placeholder:"ä¾‹å¦‚: 11.50",onInput:g},null,544),[[e.vModelText,l.value]]),e.createElementVNode("view",{class:"input-range-hint"},[e.createElementVNode("text",{class:"range-text"},"é€šå¸¸èŒƒå›´: 0 - 15.0"),e.createElementVNode("view",{class:"range-indicator",style:e.normalizeStyle({width:O()+"%"})},null,4)])]),"pttToScore"===n.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"quick-input-buttons"},[e.createElementVNode("button",{class:"quick-btn",onClick:r[12]||(r[12]=e=>I(10))},[e.createElementVNode("text",{class:"quick-btn-text"},"10.0")]),e.createElementVNode("button",{class:"quick-btn",onClick:r[13]||(r[13]=e=>I(11))},[e.createElementVNode("text",{class:"quick-btn-text"},"11.0")]),e.createElementVNode("button",{class:"quick-btn",onClick:r[14]||(r[14]=e=>I(12))},[e.createElementVNode("text",{class:"quick-btn-text"},"12.0")]),e.createElementVNode("button",{class:"quick-btn",onClick:r[15]||(r[15]=e=>I(13))},[e.createElementVNode("text",{class:"quick-btn-text"},"13.0")])])):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"calculate-btn",onClick:b,disabled:!d.value},[e.createElementVNode("text",{class:"btn-icon"},e.toDisplayString("scoreToPtt"===n.value?"ğŸ”„":"ğŸ¯"),1),e.createElementVNode("text",{class:"btn-text"},"è®¡ç®—è½¬æ¢")],8,["disabled"])]),u.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"card result-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"è®¡ç®—ç»“æœ"),e.createElementVNode("view",{class:"result-status success"},[e.createElementVNode("text",{class:"status-icon"},"âœ“")])]),e.createElementVNode("view",{class:"result-content"},["scoreToPtt"===n.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"result-section"},[e.createElementVNode("view",{class:"result-item primary"},[e.createElementVNode("view",{class:"result-icon"},"â­"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},"PTT"),e.createElementVNode("text",{class:"result-value highlight"},e.toDisplayString(u.value.ptt.toFixed(2)),1)])]),e.createElementVNode("view",{class:"result-item"},[e.createElementVNode("view",{class:"result-icon"},"ğŸ¯"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},"æˆç»©"),e.createElementVNode("text",{class:"result-value"},e.toDisplayString(u.value.score.toLocaleString()),1)])]),e.createElementVNode("view",{class:"result-item"},[e.createElementVNode("view",{class:"result-icon"},"ğŸ†"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},"è¯„çº§"),e.createElementVNode("text",{class:e.normalizeClass(["result-value rating",S(u.value.rating)])},e.toDisplayString(u.value.rating),3)])]),i.value.name||a.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"result-item"},[e.createElementVNode("view",{class:"result-icon"},"ğŸµ"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},"æ­Œæ›²"),e.createElementVNode("text",{class:"result-value"},e.toDisplayString(i.value.name||a.value||"æ‰‹åŠ¨è¾“å…¥"),1)])])):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0),"pttToScore"===n.value?(e.openBlock(),e.createElementBlock("view",{key:1,class:"result-section"},[e.createElementVNode("view",{class:"result-item primary"},[e.createElementVNode("view",{class:"result-icon"},"ğŸ¯"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},"æ‰€éœ€æˆç»©"),e.createElementVNode("text",{class:"result-value highlight"},e.toDisplayString(u.value.score.toLocaleString()),1)])]),e.createElementVNode("view",{class:"result-item"},[e.createElementVNode("view",{class:"result-icon"},"â­"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},"ç›®æ ‡PTT"),e.createElementVNode("text",{class:"result-value"},e.toDisplayString(u.value.ptt.toFixed(2)),1)])]),e.createElementVNode("view",{class:"result-item"},[e.createElementVNode("view",{class:"result-icon"},"ğŸ†"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},"æœ€ä½è¯„çº§"),e.createElementVNode("text",{class:e.normalizeClass(["result-value rating",S(u.value.rating)])},e.toDisplayString(u.value.rating),3)])]),i.value.name||a.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"result-item"},[e.createElementVNode("view",{class:"result-icon"},"ğŸµ"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},"æ­Œæ›²"),e.createElementVNode("text",{class:"result-value"},e.toDisplayString(i.value.name||a.value||"æ‰‹åŠ¨è¾“å…¥"),1)])])):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)]),u.value&&f.value?(e.openBlock(),e.createElementBlock("button",{key:0,class:"save-btn",onClick:A},[e.createElementVNode("text",{class:"btn-icon"},"ğŸ’¾"),e.createElementVNode("text",{class:"btn-text"},"ä¿å­˜åˆ°B30")])):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"card formula-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"PTTè®¡ç®—å…¬å¼"),e.createElementVNode("view",{class:"info-icon"},"â„¹ï¸")]),e.createElementVNode("view",{class:"formula-list"},[e.createElementVNode("view",{class:"formula-item"},[e.createElementVNode("view",{class:"formula-condition"},[e.createElementVNode("view",{class:"condition-icon"},"ğŸ†"),e.createElementVNode("text",{class:"condition-text"},"â‰¥10,000,000åˆ†")]),e.createElementVNode("view",{class:"formula-result"},[e.createElementVNode("text",{class:"result-text"},"å®šæ•° + 2.0")])]),e.createElementVNode("view",{class:"formula-item"},[e.createElementVNode("view",{class:"formula-condition"},[e.createElementVNode("view",{class:"condition-icon"},"ğŸ¥‡"),e.createElementVNode("text",{class:"condition-text"},"9,800,000-9,999,999åˆ†")]),e.createElementVNode("view",{class:"formula-result"},[e.createElementVNode("text",{class:"result-text"},"å®šæ•° + 1.0 + (å¾—åˆ†-9,800,000)/200,000")])]),e.createElementVNode("view",{class:"formula-item"},[e.createElementVNode("view",{class:"formula-condition"},[e.createElementVNode("view",{class:"condition-icon"},"ğŸ¥ˆ"),e.createElementVNode("text",{class:"condition-text"},"<9,800,000åˆ†")]),e.createElementVNode("view",{class:"formula-result"},[e.createElementVNode("text",{class:"result-text"},"å®šæ•° + (å¾—åˆ†-9,500,000)/300,000")])]),e.createElementVNode("view",{class:"formula-item"},[e.createElementVNode("view",{class:"formula-condition"},[e.createElementVNode("view",{class:"condition-icon"},"âš ï¸"),e.createElementVNode("text",{class:"condition-text"},"å•æ¬¡PTTä¸º0çš„æ¡ä»¶")]),e.createElementVNode("view",{class:"formula-result"},[e.createElementVNode("text",{class:"result-text"},"åˆ†æ•° â‰¤ 9,500,000 - å®šæ•° Ã— 300,000")])])])])]);var w}}}),[["__scopeId","data-v-6f40f0a3"]]),l=a(e.defineComponent({__name:"tolerance",setup(t){const r=e.ref("rating"),n=e.ref("current"),o=e.ref("far"),i=e.ref({}),a=[{name:"PM",minScore:1e7},{name:"EX+",minScore:99e5},{name:"EX",minScore:98e5},{name:"AA",minScore:95e5},{name:"A",minScore:92e5},{name:"B",minScore:89e5},{name:"C",minScore:86e5},{name:"D",minScore:0}],s=e.ref(1),c=e.ref("1000"),l=e.ref("0"),u=e.ref("0"),d=e.ref("0"),f=e.ref("1200"),p=e.ref(""),h=e.ref(""),m=e.ref(""),y=e.ref(null),v=e.computed(()=>!!i.value.constant&&("theoretical"===n.value?"rating"===r.value||("score"===r.value?""!==p.value&&!isNaN(parseInt(p.value)):"ptt"===r.value&&(""!==m.value&&!isNaN(parseFloat(m.value)))):"rating"===r.value?""!==c.value&&!isNaN(parseInt(c.value)):"score"===r.value?""!==p.value&&""!==h.value&&!isNaN(parseInt(p.value))&&!isNaN(parseInt(h.value)):"ptt"===r.value&&(""!==m.value&&""!==c.value&&!isNaN(parseFloat(m.value))&&!isNaN(parseInt(c.value)))));e.onMounted(()=>{const e=uni.getStorageSync("recent_song");e&&(i.value=e),uni.$on("songSelected",e=>{i.value=e})}),e.onUnmounted(()=>{uni.$off("songSelected")});const g=e=>{r.value=e,y.value=null},b=e=>{n.value=e,y.value=null},w=e=>{o.value=e,y.value=null},E=()=>{uni.navigateTo({url:"/pages/songs/songs?from=tolerance"})},_=e=>{s.value=e.detail.value},S=()=>{const e=parseInt(f.value)||1200;if("theoretical"!==n.value){if("rating"===r.value){const t=parseInt(c.value)||0,r=parseInt(l.value)||0,n=parseInt(u.value)||0,o=parseInt(d.value)||0,i=a[s.value],f=1e7/e,p=t*f+r*(f/2),h=o,m=Math.floor(p+h),v=i.minScore,g=m-v;if(g>=0){const o=Math.floor(g/(f/2)),i=Math.floor((g-o*(f/2))/f),a=e-t-r-n,s=Math.min(i,a),c=g-s*f,l=r+Math.floor(c/(f/2));y.value={minScore:v,maxScore:m,maxFarCount:l,maxLostCount:s,currentScore:m,canAchieve:!0}}else{const o=-g,i=e-t-r-n;if(m+i*f<v)y.value={minScore:v,maxScore:m,maxFarCount:r,maxLostCount:n,currentScore:m,canAchieve:!1};else{const e=i-Math.ceil(o/f),t=r+e,a=n+Math.floor(e/2);y.value={minScore:v,maxScore:m,maxFarCount:t,maxLostCount:a,currentScore:m,canAchieve:!1}}}}else if("score"===r.value){const t=parseInt(p.value)||0,r=parseInt(h.value)||0,n=parseInt(l.value)||0,o=parseInt(u.value)||0,i=1e7/e,a=r*i+n*(i/2),s=parseInt(d.value)||0,c=Math.floor(a+s),f=c-t;if(f>=0){const a=Math.floor(f/(i/2)),s=Math.floor((f-a*(i/2))/i),l=e-r-n-o,u=Math.min(s,l),d=f-u*i,p=n+Math.floor(d/(i/2));y.value={targetScore:t,currentScore:c,scoreGap:f,tolerableFar:p,tolerableLost:u,canAchieve:!0}}else{const a=-f,s=e-r-n-o;if(c+s*i<t)y.value={targetScore:t,currentScore:c,scoreGap:f,tolerableFar:n,tolerableLost:o,canAchieve:!1};else{const e=s-Math.ceil(a/i),r=n+e,l=o+Math.floor(e/2);y.value={targetScore:t,currentScore:c,scoreGap:f,tolerableFar:r,tolerableLost:l,canAchieve:!1}}}}else if("ptt"===r.value){const t=parseFloat(m.value)||0,r=parseInt(c.value)||0,n=parseInt(l.value)||0,o=parseInt(u.value)||0,a=parseInt(d.value)||0,s=i.value.constant||0;let f;const p=t-s;f=p>=2?1e7:p>=1.5?Math.floor(99e5+1e5*(p-1.5)):p>=1?Math.floor(98e5+4e5*(p-1)):Math.floor(95e5+3e5*p);const h=1e7/e,v=r*h+n*(h/2),g=a,b=Math.floor(v+g);let w;w=b>=1e7?s+2:b>=99e5?s+1.5+(b-99e5)/1e5:b>=98e5?s+1+(b-98e5)/4e5:s+Math.max(0,(b-95e5)/3e5);const E=b-f;if(E>=0){const i=Math.floor(E/(h/2)),a=Math.floor((E-i*(h/2))/h),s=e-r-n-o,c=Math.min(a,s),l=E-c*h,u=n+Math.floor(l/(h/2));y.value={targetPtt:t,currentPtt:w,pttGap:w-t,tolerableFar:u,tolerableLost:c,canAchieve:!0}}else{const i=-E,a=e-r-n-o;if(b+a*h<f)y.value={targetPtt:t,currentPtt:w,pttGap:w-t,tolerableFar:n,tolerableLost:o,canAchieve:!1};else{const e=a-Math.ceil(i/h),r=n+e,s=o+Math.floor(e/2);y.value={targetPtt:t,currentPtt:w,pttGap:w-t,tolerableFar:r,tolerableLost:s,canAchieve:!1}}}}}else x(e)},x=e=>{const t=1e7/e,n=1e7+e;if("rating"===r.value){const e=a[s.value].minScore,r=n-e;let i=0,c=0;"far"===o.value?(i=Math.floor(r/(t/2)),c=0):(c=Math.floor(r/t),i=0),y.value={minScore:e,maxScore:n,maxFarCount:i,maxLostCount:c,currentScore:n,canAchieve:!0}}else if("score"===r.value){const e=parseInt(p.value)||0,r=n-e;let i=0,a=0;"far"===o.value?(i=Math.floor(r/(t/2)),a=0):(a=Math.floor(r/t),i=0),y.value={targetScore:e,currentScore:n,scoreGap:r,tolerableFar:i,tolerableLost:a,canAchieve:!0}}else if("ptt"===r.value){const e=parseFloat(m.value)||0,r=i.value.constant||0;let a;const s=e-r;a=s>=2?1e7:s>=1.5?Math.floor(99e5+1e5*(s-1.5)):s>=1?Math.floor(98e5+4e5*(s-1)):Math.floor(95e5+3e5*s);const c=n-a;let l=0,u=0;"far"===o.value?(l=Math.floor(c/(t/2)),u=0):(u=Math.floor(c/t),l=0),y.value={targetPtt:e,currentPtt:r+2,pttGap:r+2-e,tolerableFar:l,tolerableLost:u,canAchieve:!0}}},N=e=>({pst:"PAST",prs:"PRESENT",ftr:"FUTURE",byd:"BEYOND",etr:"ETERNAL"}[e]||e.toUpperCase());return(t,x)=>{return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"card mode-selector-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"å®¹é”™ç±»å‹")]),e.createElementVNode("view",{class:"mode-selector"},[e.createElementVNode("view",{class:e.normalizeClass(["mode-item",{active:"rating"===r.value}]),onClick:x[0]||(x[0]=e=>g("rating"))},[e.createElementVNode("text",{class:"mode-icon"},"ğŸ†"),e.createElementVNode("text",{class:"mode-text"},"è¯„çº§å®¹é”™"),e.createElementVNode("view",{class:"mode-indicator"})],2),e.createElementVNode("view",{class:e.normalizeClass(["mode-item",{active:"score"===r.value}]),onClick:x[1]||(x[1]=e=>g("score"))},[e.createElementVNode("text",{class:"mode-icon"},"ğŸ¯"),e.createElementVNode("text",{class:"mode-text"},"åˆ†æ•°å®¹é”™"),e.createElementVNode("view",{class:"mode-indicator"})],2),e.createElementVNode("view",{class:e.normalizeClass(["mode-item",{active:"ptt"===r.value}]),onClick:x[2]||(x[2]=e=>g("ptt"))},[e.createElementVNode("text",{class:"mode-icon"},"ğŸ“Š"),e.createElementVNode("text",{class:"mode-text"},"PTTå®¹é”™"),e.createElementVNode("view",{class:"mode-indicator"})],2)])]),e.createElementVNode("view",{class:"card tolerance-mode-selector"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"å®¹é”™è®¡ç®—æ–¹å¼"),e.createElementVNode("view",{class:"info-icon"},"â„¹ï¸")]),e.createElementVNode("view",{class:"mode-selector"},[e.createElementVNode("view",{class:e.normalizeClass(["mode-item",{active:"current"===n.value}]),onClick:x[3]||(x[3]=e=>b("current"))},[e.createElementVNode("text",{class:"mode-icon"},"ğŸ“"),e.createElementVNode("text",{class:"mode-text"},"åŸºäºå½“å‰åˆ¤å®š"),e.createElementVNode("view",{class:"mode-indicator"})],2),e.createElementVNode("view",{class:e.normalizeClass(["mode-item",{active:"theoretical"===n.value}]),onClick:x[4]||(x[4]=e=>b("theoretical"))},[e.createElementVNode("text",{class:"mode-icon"},"ğŸ”¢"),e.createElementVNode("text",{class:"mode-text"},"åŸºäºç†è®ºå€¼"),e.createElementVNode("view",{class:"mode-indicator"})],2)]),e.createElementVNode("view",{class:"mode-description"},["current"===n.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"description-card"},[e.createElementVNode("view",{class:"description-icon"},"ğŸ’¡"),e.createElementVNode("text",{class:"description-text"}," åŸºäºå½“å‰Pure/Far/Lostæ•°é‡è®¡ç®—è¿˜èƒ½å®¹é”™å¤šå°‘åˆ¤å®š ")])):(e.openBlock(),e.createElementBlock("view",{key:1},[e.createElementVNode("view",{class:"description-card"},[e.createElementVNode("view",{class:"description-icon"},"ğŸ“"),e.createElementVNode("text",{class:"description-text"}," åŸºäºç†è®ºæ»¡åˆ†(10,000,000 + Noteæ€»æ•°)åˆ°ç›®æ ‡çš„è¯¯å·®è®¡ç®— ")]),e.createElementVNode("view",{class:"display-mode-selector"},[e.createElementVNode("text",{class:"selector-label"},"æ˜¾ç¤ºæ–¹å¼ï¼š"),e.createElementVNode("view",{class:"mode-selector-small"},[e.createElementVNode("view",{class:e.normalizeClass(["mode-item-small",{active:"far"===o.value}]),onClick:x[5]||(x[5]=e=>w("far"))},[e.createElementVNode("text",{class:"mode-text-small"},"æ˜¾ç¤ºå¯å®¹é”™Faræ•°")],2),e.createElementVNode("view",{class:e.normalizeClass(["mode-item-small",{active:"lost"===o.value}]),onClick:x[6]||(x[6]=e=>w("lost"))},[e.createElementVNode("text",{class:"mode-text-small"},"æ˜¾ç¤ºå¯å®¹é”™Lostæ•°")],2)])])]))])]),e.createElementVNode("view",{class:"card song-selector"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"é€‰æ‹©æ­Œæ›²"),i.value.name?(e.openBlock(),e.createElementBlock("view",{key:0,class:"song-count"},"1")):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"song-info",onClick:E},[e.createElementVNode("view",{class:"song-content"},[e.createElementVNode("view",{class:"song-main-info"},[i.value.name?(e.openBlock(),e.createElementBlock("text",{key:0,class:"song-name"},e.toDisplayString(i.value.name),1)):(e.openBlock(),e.createElementBlock("text",{key:1,class:"song-placeholder"},"ç‚¹å‡»é€‰æ‹©æ­Œæ›²")),i.value.constant?(e.openBlock(),e.createElementBlock("view",{key:2,class:"song-difficulty"},[e.createElementVNode("text",{class:e.normalizeClass(["difficulty-text",(T=i.value.difficulty,{pst:"difficulty-pst",prs:"difficulty-prs",ftr:"difficulty-ftr",byd:"difficulty-byd",etr:"difficulty-etr"}[T]||"")])},e.toDisplayString(N(i.value.difficulty)),3),e.createElementVNode("text",{class:"difficulty-constant"},e.toDisplayString(i.value.constant),1)])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"selection-arrow"},[e.createElementVNode("text",{class:"arrow-icon"},"â†’")])])])]),e.createElementVNode("view",{class:"card tolerance-form"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},e.toDisplayString({rating:"è¯„çº§å®¹é”™è®¡ç®—",score:"åˆ†æ•°å®¹é”™è®¡ç®—",ptt:"PTTå®¹é”™è®¡ç®—"}[r.value]),1)]),"rating"===r.value?(e.openBlock(),e.createElementBlock("view",{key:0},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"é€‰æ‹©è¯„çº§"),e.createElementVNode("picker",{range:a,"range-key":"name",value:s.value,onChange:_,class:"picker"},[e.createElementVNode("view",{class:"picker-text"},e.toDisplayString(a[s.value].name),1)],40,["value"])]),"current"===n.value?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"Pureæ•°é‡"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"number","onUpdate:modelValue":x[7]||(x[7]=e=>c.value=e),placeholder:"0-1000"},null,512),[[e.vModelText,c.value]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"Faræ•°é‡"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"number","onUpdate:modelValue":x[8]||(x[8]=e=>l.value=e),placeholder:"0-1000"},null,512),[[e.vModelText,l.value]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"Lostæ•°é‡"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"number","onUpdate:modelValue":x[9]||(x[9]=e=>u.value=e),placeholder:"0-1000"},null,512),[[e.vModelText,u.value]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"å¤§Pureæ•°é‡ï¼ˆå¯é€‰ï¼‰"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"number","onUpdate:modelValue":x[10]||(x[10]=e=>d.value=e),placeholder:"æ¯ä¸ªå¤§Pureé¢å¤–+1åˆ†"},null,512),[[e.vModelText,d.value]])])],64)):(e.openBlock(),e.createElementBlock("view",{key:1,class:"form-item"},[e.createElementVNode("text",{class:"form-tip"}," åŸºäºç†è®ºå€¼è®¡ç®—å®¹é”™ä¸éœ€è¦è¾“å…¥åˆ¤å®šæ•°é‡ï¼Œå°†ç›´æ¥ä»ç†è®ºæ»¡åˆ†(10,000,000 + Noteæ€»æ•°)è®¡ç®— ")])),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"è°±é¢Noteæ€»é‡"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"number","onUpdate:modelValue":x[11]||(x[11]=e=>f.value=e),placeholder:"æ­Œæ›²çš„æ€»Noteæ•°é‡ï¼ˆä¾‹å¦‚ï¼š1200ï¼‰"},null,512),[[e.vModelText,f.value]]),e.createElementVNode("text",{class:"form-hint"},"æç¤ºï¼šå¯ä»¥åœ¨æ¸¸æˆç»“æœç•Œé¢æŸ¥çœ‹è°±é¢Noteæ•°é‡")])])):e.createCommentVNode("",!0),"score"===r.value?(e.openBlock(),e.createElementBlock("view",{key:1},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"ç›®æ ‡åˆ†æ•° (0-10,000,000)"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"number","onUpdate:modelValue":x[12]||(x[12]=e=>p.value=e),placeholder:"ä¾‹å¦‚: 9900000"},null,512),[[e.vModelText,p.value]])]),"current"===n.value?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"å½“å‰Pureæ•°é‡"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"number","onUpdate:modelValue":x[13]||(x[13]=e=>h.value=e),placeholder:"0-1000"},null,512),[[e.vModelText,h.value]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"Faræ•°é‡"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"number","onUpdate:modelValue":x[14]||(x[14]=e=>l.value=e),placeholder:"0-1000"},null,512),[[e.vModelText,l.value]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"Lostæ•°é‡"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"number","onUpdate:modelValue":x[15]||(x[15]=e=>u.value=e),placeholder:"0-1000"},null,512),[[e.vModelText,u.value]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"å¤§Pureæ•°é‡ï¼ˆå¯é€‰ï¼‰"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"number","onUpdate:modelValue":x[16]||(x[16]=e=>d.value=e),placeholder:"æ¯ä¸ªå¤§Pureé¢å¤–+1åˆ†"},null,512),[[e.vModelText,d.value]])])],64)):(e.openBlock(),e.createElementBlock("view",{key:1,class:"form-item"},[e.createElementVNode("text",{class:"form-tip"}," åŸºäºç†è®ºå€¼è®¡ç®—å®¹é”™ä¸éœ€è¦è¾“å…¥åˆ¤å®šæ•°é‡ï¼Œå°†ç›´æ¥ä»ç†è®ºæ»¡åˆ†(10,000,000 + Noteæ€»æ•°)è®¡ç®— ")])),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"è°±é¢Noteæ€»é‡"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"number","onUpdate:modelValue":x[17]||(x[17]=e=>f.value=e),placeholder:"æ­Œæ›²çš„æ€»Noteæ•°é‡ï¼ˆä¾‹å¦‚ï¼š1200ï¼‰"},null,512),[[e.vModelText,f.value]]),e.createElementVNode("text",{class:"form-hint"},"æç¤ºï¼šå¯ä»¥åœ¨æ¸¸æˆç»“æœç•Œé¢æŸ¥çœ‹è°±é¢Noteæ•°é‡")])])):e.createCommentVNode("",!0),"ptt"===r.value?(e.openBlock(),e.createElementBlock("view",{key:2},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"ç›®æ ‡PTT"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"digit","onUpdate:modelValue":x[18]||(x[18]=e=>m.value=e),placeholder:"ä¾‹å¦‚: 12.50"},null,512),[[e.vModelText,m.value]])]),"current"===n.value?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"å½“å‰Pureæ•°é‡"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"number","onUpdate:modelValue":x[19]||(x[19]=e=>c.value=e),placeholder:"0-1000"},null,512),[[e.vModelText,c.value]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"Faræ•°é‡"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"number","onUpdate:modelValue":x[20]||(x[20]=e=>l.value=e),placeholder:"0-1000"},null,512),[[e.vModelText,l.value]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"Lostæ•°é‡"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"number","onUpdate:modelValue":x[21]||(x[21]=e=>u.value=e),placeholder:"0-1000"},null,512),[[e.vModelText,u.value]])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"å¤§Pureæ•°é‡ï¼ˆå¯é€‰ï¼‰"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"number","onUpdate:modelValue":x[22]||(x[22]=e=>d.value=e),placeholder:"æ¯ä¸ªå¤§Pureé¢å¤–+1åˆ†"},null,512),[[e.vModelText,d.value]])])],64)):(e.openBlock(),e.createElementBlock("view",{key:1,class:"form-item"},[e.createElementVNode("text",{class:"form-tip"}," åŸºäºç†è®ºå€¼è®¡ç®—å®¹é”™ä¸éœ€è¦è¾“å…¥åˆ¤å®šæ•°é‡ï¼Œå°†ç›´æ¥ä»ç†è®ºæ»¡åˆ†(10,000,000 + Noteæ€»æ•°)è®¡ç®— ")])),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"è°±é¢Noteæ€»é‡"),e.withDirectives(e.createElementVNode("input",{class:"form-input",type:"number","onUpdate:modelValue":x[23]||(x[23]=e=>f.value=e),placeholder:"æ­Œæ›²çš„æ€»Noteæ•°é‡ï¼ˆä¾‹å¦‚ï¼š1200ï¼‰"},null,512),[[e.vModelText,f.value]]),e.createElementVNode("text",{class:"form-hint"},"æç¤ºï¼šå¯ä»¥åœ¨æ¸¸æˆç»“æœç•Œé¢æŸ¥çœ‹è°±é¢Noteæ•°é‡")])])):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"calculate-btn",onClick:S,disabled:!v.value}," è®¡ç®—å®¹é”™ ",8,["disabled"])]),y.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"card result-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"å®¹é”™ç»“æœ"),e.createElementVNode("view",{class:e.normalizeClass(["result-status",y.value.canAchieve?"success":"failed"])},[e.createElementVNode("text",{class:"status-icon"},e.toDisplayString(y.value.canAchieve?"âœ“":"âœ—"),1)],2)]),"rating"===r.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"result-content"},[e.createElementVNode("view",{class:"result-item primary"},[e.createElementVNode("view",{class:"result-icon"},"ğŸ†"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},"è¯„çº§"),e.createElementVNode("text",{class:e.normalizeClass(["result-value rating",(I=a[s.value].name,{PM:"rating-pm","EX+":"rating-ex-plus",EX:"rating-ex",AA:"rating-aa",A:"rating-a",B:"rating-b",C:"rating-c",D:"rating-d"}[I]||"")])},e.toDisplayString(a[s.value].name),3)])]),e.createElementVNode("view",{class:"result-item"},[e.createElementVNode("view",{class:"result-icon"},"ğŸ“Š"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},e.toDisplayString("current"===n.value?"å½“å‰åˆ†æ•°":"ç†è®ºæ»¡åˆ†"),1),e.createElementVNode("text",{class:"result-value"},e.toDisplayString(y.value.currentScore.toLocaleString()),1)])]),e.createElementVNode("view",{class:"result-item"},[e.createElementVNode("view",{class:"result-icon"},"ğŸ¯"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},"ç›®æ ‡åˆ†æ•°"),e.createElementVNode("text",{class:"result-value"},e.toDisplayString(y.value.minScore.toLocaleString()),1)])]),"current"===n.value||"far"===o.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"result-item highlight"},[e.createElementVNode("view",{class:"result-icon"},"âš¡"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},e.toDisplayString("current"===n.value?"æœ€å¤§Faræ•°é‡":"å¯å®¹é”™Faræ•°"),1),e.createElementVNode("text",{class:"result-value highlight"},e.toDisplayString(y.value.maxFarCount),1)])])):e.createCommentVNode("",!0),"current"===n.value||"lost"===o.value?(e.openBlock(),e.createElementBlock("view",{key:1,class:"result-item"},[e.createElementVNode("view",{class:"result-icon"},"ğŸ’”"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},e.toDisplayString("current"===n.value?"æœ€å¤§Lostæ•°é‡":"å¯å®¹é”™Lostæ•°"),1),e.createElementVNode("text",{class:"result-value"},e.toDisplayString(y.value.maxLostCount),1)])])):e.createCommentVNode("",!0),"current"===n.value?(e.openBlock(),e.createElementBlock("view",{key:2,class:"result-item"},[e.createElementVNode("view",{class:"result-icon"},"ğŸ"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},"æ˜¯å¦è¾¾æˆ"),e.createElementVNode("text",{class:e.normalizeClass(["result-value",y.value.canAchieve?"success":"failed"])},e.toDisplayString(y.value.canAchieve?"å·²è¾¾æˆ":"æœªè¾¾æˆ"),3)])])):(e.openBlock(),e.createElementBlock("view",{key:3,class:"result-item"},[e.createElementVNode("view",{class:"result-icon"},"ğŸ”¢"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},"è®¡ç®—æ–¹å¼"),e.createElementVNode("text",{class:"result-value"},"åŸºäºç†è®ºæ»¡åˆ†")])]))])):e.createCommentVNode("",!0),"score"===r.value?(e.openBlock(),e.createElementBlock("view",{key:1,class:"result-content"},[e.createElementVNode("view",{class:"result-item primary"},[e.createElementVNode("view",{class:"result-icon"},"ğŸ¯"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},"ç›®æ ‡åˆ†æ•°"),e.createElementVNode("text",{class:"result-value"},e.toDisplayString(y.value.targetScore.toLocaleString()),1)])]),e.createElementVNode("view",{class:"result-item"},[e.createElementVNode("view",{class:"result-icon"},"ğŸ“Š"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},e.toDisplayString("current"===n.value?"å½“å‰åˆ†æ•°":"ç†è®ºæ»¡åˆ†"),1),e.createElementVNode("text",{class:"result-value"},e.toDisplayString(y.value.currentScore.toLocaleString()),1)])]),e.createElementVNode("view",{class:"result-item highlight"},[e.createElementVNode("view",{class:"result-icon"},"ğŸ“ˆ"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},e.toDisplayString("current"===n.value?"å·®è·":"è¯¯å·®èŒƒå›´"),1),e.createElementVNode("text",{class:"result-value highlight"},e.toDisplayString(Math.abs(y.value.scoreGap).toLocaleString()),1)])]),"current"===n.value||"far"===o.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"result-item highlight"},[e.createElementVNode("view",{class:"result-icon"},"âš¡"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},e.toDisplayString("current"===n.value?"å¯Faræ•°é‡":"å¯å®¹é”™Faræ•°"),1),e.createElementVNode("text",{class:"result-value highlight"},e.toDisplayString(y.value.tolerableFar),1)])])):e.createCommentVNode("",!0),"current"===n.value||"lost"===o.value?(e.openBlock(),e.createElementBlock("view",{key:1,class:"result-item"},[e.createElementVNode("view",{class:"result-icon"},"ğŸ’”"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},e.toDisplayString("current"===n.value?"å¯Lostæ•°é‡":"å¯å®¹é”™Lostæ•°"),1),e.createElementVNode("text",{class:"result-value"},e.toDisplayString(y.value.tolerableLost),1)])])):e.createCommentVNode("",!0),"current"===n.value?(e.openBlock(),e.createElementBlock("view",{key:2,class:"result-item"},[e.createElementVNode("view",{class:"result-icon"},"ğŸ"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},"æ˜¯å¦è¾¾æˆ"),e.createElementVNode("text",{class:e.normalizeClass(["result-value",y.value.canAchieve?"success":"failed"])},e.toDisplayString(y.value.canAchieve?"å·²è¾¾æˆ":"æœªè¾¾æˆ"),3)])])):(e.openBlock(),e.createElementBlock("view",{key:3,class:"result-item"},[e.createElementVNode("view",{class:"result-icon"},"ğŸ”¢"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},"è®¡ç®—æ–¹å¼"),e.createElementVNode("text",{class:"result-value"},"åŸºäºç†è®ºæ»¡åˆ†")])]))])):e.createCommentVNode("",!0),"ptt"===r.value?(e.openBlock(),e.createElementBlock("view",{key:2,class:"result-content"},[e.createElementVNode("view",{class:"result-item primary"},[e.createElementVNode("view",{class:"result-icon"},"â­"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},"ç›®æ ‡PTT"),e.createElementVNode("text",{class:"result-value"},e.toDisplayString(y.value.targetPtt.toFixed(2)),1)])]),e.createElementVNode("view",{class:"result-item"},[e.createElementVNode("view",{class:"result-icon"},"ğŸ“Š"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},e.toDisplayString("current"===n.value?"å½“å‰PTT":"ç†è®ºæœ€å¤§PTT"),1),e.createElementVNode("text",{class:"result-value"},e.toDisplayString(y.value.currentPtt.toFixed(2)),1)])]),e.createElementVNode("view",{class:"result-item highlight"},[e.createElementVNode("view",{class:"result-icon"},"ğŸ“ˆ"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},e.toDisplayString("current"===n.value?"PTTå·®è·":"PTTè¯¯å·®"),1),e.createElementVNode("text",{class:"result-value highlight"},e.toDisplayString(Math.abs(y.value.pttGap).toFixed(2)),1)])]),"current"===n.value||"far"===o.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"result-item highlight"},[e.createElementVNode("view",{class:"result-icon"},"âš¡"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},e.toDisplayString("current"===n.value?"å¯Faræ•°é‡":"å¯å®¹é”™Faræ•°"),1),e.createElementVNode("text",{class:"result-value highlight"},e.toDisplayString(y.value.tolerableFar),1)])])):e.createCommentVNode("",!0),"current"===n.value||"lost"===o.value?(e.openBlock(),e.createElementBlock("view",{key:1,class:"result-item"},[e.createElementVNode("view",{class:"result-icon"},"ğŸ’”"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},e.toDisplayString("current"===n.value?"å¯Lostæ•°é‡":"å¯å®¹é”™Lostæ•°"),1),e.createElementVNode("text",{class:"result-value"},e.toDisplayString(y.value.tolerableLost),1)])])):e.createCommentVNode("",!0),"current"===n.value?(e.openBlock(),e.createElementBlock("view",{key:2,class:"result-item"},[e.createElementVNode("view",{class:"result-icon"},"ğŸ"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},"æ˜¯å¦è¾¾æˆ"),e.createElementVNode("text",{class:e.normalizeClass(["result-value",y.value.canAchieve?"success":"failed"])},e.toDisplayString(y.value.canAchieve?"å·²è¾¾æˆ":"æœªè¾¾æˆ"),3)])])):(e.openBlock(),e.createElementBlock("view",{key:3,class:"result-item"},[e.createElementVNode("view",{class:"result-icon"},"ğŸ”¢"),e.createElementVNode("view",{class:"result-content"},[e.createElementVNode("text",{class:"result-label"},"è®¡ç®—æ–¹å¼"),e.createElementVNode("text",{class:"result-value"},"åŸºäºç†è®ºæ»¡åˆ†")])]))])):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"card formula-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"å®¹é”™è®¡ç®—è¯´æ˜")]),e.createElementVNode("view",{class:"explanation"},[e.createElementVNode("text",{class:"explanation-text"}," å®¹é”™è®¡ç®—åŸºäºArcaeaçš„çœŸå®è¯„åˆ†ç³»ç»Ÿï¼š "),e.createElementVNode("view",{class:"calculation-tips"},[e.createElementVNode("text",{class:"tip-title"},"åŸºæœ¬åˆ†è®¡ç®—ï¼š"),e.createElementVNode("text",{class:"tip-item"},"â€¢ å•ä¸ªNoteåˆ†æ•° = 10,000,000 Ã· è°±é¢Noteæ€»é‡"),e.createElementVNode("text",{class:"tip-item"},"â€¢ Pureè·å¾—å®Œæ•´åˆ†æ•°ï¼ŒFarè·å¾—ä¸€åŠåˆ†æ•°ï¼ŒLostä¸å¾—åˆ†"),e.createElementVNode("text",{class:"tip-item"},"â€¢ åŸºæœ¬åˆ† = Pureæ•°é‡Ã—å•Noteåˆ† + Faræ•°é‡Ã—(å•Noteåˆ†Ã·2)"),e.createElementVNode("text",{class:"tip-title"},"åˆ¤å®šé™„åŠ åˆ†ï¼š"),e.createElementVNode("text",{class:"tip-item"},"â€¢ æ¯ä¸ªå¤§Pureé¢å¤–åŠ 1åˆ†ï¼Œå…¶ä»–åˆ¤å®šä¸åŠ åˆ†"),e.createElementVNode("text",{class:"tip-item"},"â€¢ é™„åŠ åˆ†æ— ä¸Šé™ï¼Œç†è®ºæ»¡åˆ† = 10,000,000 + è°±é¢Noteæ€»é‡"),e.createElementVNode("text",{class:"tip-item"},"â€¢ æ³¨æ„ï¼šPTTè®¡ç®—ä¸­ï¼Œåˆ†æ•°è¾¾åˆ°10,000,000åPTTå›ºå®šä¸ºå®šæ•°+2.0"),e.createElementVNode("text",{class:"tip-title"},"å®¹é”™è®¡ç®—æ–¹å¼ï¼š"),e.createElementVNode("text",{class:"tip-item"},"â€¢ åŸºäºå½“å‰åˆ¤å®šï¼šæ ¹æ®å½“å‰Pure/Far/Lostæ•°é‡è®¡ç®—è¿˜èƒ½å®¹é”™å¤šå°‘"),e.createElementVNode("text",{class:"tip-item"},"â€¢ åŸºäºç†è®ºå€¼ï¼šä»ç†è®ºæ»¡åˆ†(10,000,000+Noteæ€»æ•°)åˆ°ç›®æ ‡çš„è¯¯å·®è®¡ç®—"),e.createElementVNode("text",{class:"tip-title"},"å®¹é”™è®¡ç®—ï¼š"),e.createElementVNode("text",{class:"tip-item"},"â€¢ æ ¹æ®ç›®æ ‡è¯„çº§/åˆ†æ•°/PTTè®¡ç®—æ‰€éœ€æœ€ä½åˆ†æ•°"),e.createElementVNode("text",{class:"tip-item"},"â€¢ æ¯ä¸ªFarå¯æ¢ç®—ä¸º(å•Noteåˆ†Ã·2)çš„å®¹é”™ç©ºé—´"),e.createElementVNode("text",{class:"tip-item"},"â€¢ æ¯ä¸ªLostå¯æ¢ç®—ä¸ºå•Noteåˆ†çš„å®¹é”™ç©ºé—´")])])])]);var I,T}}}),[["__scopeId","data-v-d4b607a5"]]),u=a(e.defineComponent({__name:"best30",setup(r){const o=e.ref(11.23),i=e.ref(12.45),a=e.ref(11.78),s=e.ref(10.56),c=e.ref([]),l=[{name:"å…¨éƒ¨éš¾åº¦",value:"all"},{name:"PAST",value:"pst"},{name:"PRESENT",value:"prs"},{name:"FUTURE",value:"ftr"},{name:"BEYOND",value:"byd"},{name:"ETERNAL",value:"etr"}],u=e.ref(0),d=[{name:"PTTé™åº",value:"ptt-desc"},{name:"PTTå‡åº",value:"ptt-asc"},{name:"åˆ†æ•°é™åº",value:"score-desc"},{name:"åˆ†æ•°å‡åº",value:"score-asc"},{name:"æ­Œæ›²åç§°",value:"name"}],f=e.ref(0),p=e.computed(()=>{let e=[...c.value];"all"!==l[u.value].value&&(e=e.filter(e=>e.difficulty===l[u.value].value));switch(d[f.value].value){case"ptt-desc":e.sort((e,t)=>t.ptt-e.ptt);break;case"ptt-asc":e.sort((e,t)=>e.ptt-t.ptt);break;case"score-desc":e.sort((e,t)=>t.score-e.score);break;case"score-asc":e.sort((e,t)=>e.score-t.score);break;case"name":e.sort((e,t)=>e.songName.localeCompare(t.songName))}return e});e.onMounted(()=>{h()}),n(()=>{h()});const h=()=>{try{const e=uni.getStorageSync("best30_records")||[];c.value=e;const t=uni.getStorageSync("ptt_data");t&&(o.value=t.currentPTT||0,i.value=t.best10Avg||0,a.value=t.best30Avg||0,s.value=t.recent10Avg||0),m()}catch(e){t("error","at pages/best30/best30.vue:287","åŠ è½½æ•°æ®å¤±è´¥",e)}},m=()=>{if(0===c.value.length)return o.value=0,i.value=0,void(a.value=0);const e=c.value.reduce((e,t)=>e+t.ptt,0);a.value=e/c.value.length;const r=[...c.value].sort((e,t)=>t.ptt-e.ptt).slice(0,10),n=r.reduce((e,t)=>e+t.ptt,0);i.value=n/r.length;try{const e=uni.getStorageSync("recent_scores")||[];if(e.length>0){const t=e.reduce((e,t)=>e+t.ptt,0);s.value=t/e.length}}catch(l){t("error","at pages/best30/best30.vue:317","è·å–R10æ•°æ®å¤±è´¥",l)}o.value=.75*i.value+.25*s.value,y()},y=()=>{try{const e={currentPTT:o.value,best10Avg:i.value,best30Avg:a.value,recent10Avg:s.value,lastUpdated:Date.now()};uni.setStorageSync("ptt_data",e)}catch(e){t("error","at pages/best30/best30.vue:339","ä¿å­˜PTTæ•°æ®å¤±è´¥",e)}},v=e=>{u.value=e.detail.value},g=e=>{f.value=e.detail.value},b=()=>{uni.navigateTo({url:"/pages/best30/add"})},w=()=>{uni.navigateTo({url:"/pages/data/data"})},E=()=>{uni.chooseFile({count:1,type:"file",success:e=>{const r=e.tempFilePaths;if(r&&r.length>0){uni.getFileSystemManager().readFile({filePath:r[0],encoding:"utf8",success:e=>{try{const t=JSON.parse(e.data);t.best30Records&&Array.isArray(t.best30Records)?(c.value=t.best30Records,N(),m(),uni.showToast({title:"å¯¼å…¥æˆåŠŸ",icon:"success"})):uni.showToast({title:"æ•°æ®æ ¼å¼ä¸æ­£ç¡®",icon:"none"})}catch(r){t("error","at pages/best30/best30.vue:443","è§£ææ•°æ®å¤±è´¥",r),uni.showToast({title:"è§£ææ•°æ®å¤±è´¥",icon:"none"})}},fail:e=>{t("error","at pages/best30/best30.vue:451","è¯»å–æ–‡ä»¶å¤±è´¥",e),uni.showToast({title:"è¯»å–æ–‡ä»¶å¤±è´¥",icon:"none"})}})}},fail:e=>{t("error","at pages/best30/best30.vue:462","é€‰æ‹©æ–‡ä»¶å¤±è´¥",e),uni.showToast({title:"é€‰æ‹©æ–‡ä»¶å¤±è´¥",icon:"none"})}})},_=()=>{try{const e={best30Records:c.value,pttData:{currentPTT:o.value,best10Avg:i.value,best30Avg:a.value,recent10Avg:s.value},exportTime:(new Date).toISOString(),version:"1.0.0"},r=JSON.stringify(e,null,2),n=`arcaea-ptt-backup-${Date.now()}.json`,l=uni.getFileSystemManager(),u=`${uni.env.USER_DATA_PATH}/${n}`;l.writeFile({filePath:u,data:r,encoding:"utf8",success:()=>{uni.showModal({title:"å¯¼å‡ºæˆåŠŸ",content:`æ•°æ®å·²å¯¼å‡ºåˆ°: ${u}`,showCancel:!1}),uni.showToast({title:"å¯¼å‡ºæˆåŠŸ",icon:"success"})},fail:e=>{t("error","at pages/best30/best30.vue:546","å¯¼å‡ºå¤±è´¥",e),uni.showToast({title:"å¯¼å‡ºå¤±è´¥",icon:"none"})}})}catch(e){t("error","at pages/best30/best30.vue:556","å¯¼å‡ºæ•°æ®å¤±è´¥",e),uni.showToast({title:"å¯¼å‡ºå¤±è´¥",icon:"none"})}},S=()=>{uni.showModal({title:"ç¡®è®¤æ¸…ç©º",content:"ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰B30è®°å½•å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼",success:e=>{e.confirm&&x()}})},x=()=>{try{c.value=[],uni.removeStorageSync("best30_records"),m(),uni.showToast({title:"å·²æ¸…ç©ºæ‰€æœ‰æ•°æ®",icon:"success"})}catch(e){t("error","at pages/best30/best30.vue:588","æ¸…ç©ºæ•°æ®å¤±è´¥",e),uni.showToast({title:"æ¸…ç©ºå¤±è´¥",icon:"none"})}},N=()=>{try{uni.setStorageSync("best30_records",c.value)}catch(e){t("error","at pages/best30/best30.vue:601","ä¿å­˜B30è®°å½•å¤±è´¥",e)}},I=e=>({pst:"PAST",prs:"PRESENT",ftr:"FUTURE",byd:"BEYOND",etr:"ETERNAL"}[e]||e.toUpperCase()),T=e=>Math.min(e/13*100,100),O=e=>`${e.toFixed(2)} / ${13..toFixed(1)}`,A=e=>0===e?"rank-first":1===e?"rank-second":2===e?"rank-third":"";return(t,r)=>{return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"card overview-card"},[e.createElementVNode("view",{class:"ptt-overview"},[e.createElementVNode("view",{class:"ptt-value-container"},[e.createElementVNode("view",{class:"ptt-value"},[e.createElementVNode("text",{class:"value"},e.toDisplayString(o.value.toFixed(2)),1),e.createElementVNode("text",{class:"label"},"å½“å‰PTT")]),e.createElementVNode("view",{class:"ptt-indicator"},[e.createElementVNode("text",{class:"indicator-text"},e.toDisplayString((n=o.value,n>=12.5?"å®šæ•°ä¸Šé™":n>=12?"é¡¶çº§ç©å®¶":n>=11?"é«˜æ‰‹ç©å®¶":n>=10?"è¿›é˜¶ç©å®¶":n>=9?"æ™®é€šç©å®¶":n>=8?"å…¥é—¨ç©å®¶":"æ–°æ‰‹ç©å®¶")),1)])]),e.createElementVNode("view",{class:"ptt-stats"},[e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(i.value.toFixed(2)),1),e.createElementVNode("text",{class:"stat-label"},"B10å¹³å‡")]),e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(a.value.toFixed(2)),1),e.createElementVNode("text",{class:"stat-label"},"B30å¹³å‡")]),e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(s.value.toFixed(2)),1),e.createElementVNode("text",{class:"stat-label"},"R10å¹³å‡")])])]),e.createElementVNode("view",{class:"ptt-progress"},[e.createElementVNode("view",{class:"progress-bar"},[e.createElementVNode("view",{class:"progress-fill",style:e.normalizeStyle({width:T(o.value)+"%"})},null,4)]),e.createElementVNode("text",{class:"progress-text"},e.toDisplayString(O(o.value)),1)])]),e.createElementVNode("view",{class:"actions"},[e.createElementVNode("button",{class:"action-btn primary",onClick:b},[e.createElementVNode("view",{class:"btn-content"},[e.createElementVNode("text",{class:"btn-icon"},"â•"),e.createElementVNode("text",{class:"btn-text"},"æ·»åŠ æˆç»©")])]),e.createElementVNode("button",{class:"action-btn secondary",onClick:E},[e.createElementVNode("view",{class:"btn-content"},[e.createElementVNode("text",{class:"btn-icon"},"ğŸ“¥"),e.createElementVNode("text",{class:"btn-text"},"å¯¼å…¥æ•°æ®")])]),e.createElementVNode("button",{class:"action-btn secondary",onClick:_},[e.createElementVNode("view",{class:"btn-content"},[e.createElementVNode("text",{class:"btn-icon"},"ğŸ“¤"),e.createElementVNode("text",{class:"btn-text"},"å¯¼å‡ºæ•°æ®")])]),e.createElementVNode("button",{class:"action-btn danger",onClick:S},[e.createElementVNode("view",{class:"btn-content"},[e.createElementVNode("text",{class:"btn-icon"},"ğŸ—‘ï¸"),e.createElementVNode("text",{class:"btn-text"},"æ¸…ç©ºæ•°æ®")])])]),e.createElementVNode("view",{class:"filter-section"},[e.createElementVNode("view",{class:"filter-header"},[e.createElementVNode("text",{class:"filter-title"},"ç­›é€‰ä¸æ’åº"),e.createElementVNode("text",{class:"filter-count"},"å…± "+e.toDisplayString(p.value.length)+" æ¡è®°å½•",1)]),e.createElementVNode("view",{class:"filter-content"},[e.createElementVNode("view",{class:"filter-item"},[e.createElementVNode("view",{class:"filter-item-header"},[e.createElementVNode("text",{class:"filter-label"},"éš¾åº¦"),e.createElementVNode("text",{class:"filter-value"},e.toDisplayString(l[u.value].name),1)]),e.createElementVNode("picker",{range:l,"range-key":"name",value:u.value,onChange:v,class:"picker"},[e.createElementVNode("view",{class:"picker-indicator"},[e.createElementVNode("text",{class:"picker-arrow"},"â–¼")])],40,["value"])]),e.createElementVNode("view",{class:"filter-item"},[e.createElementVNode("view",{class:"filter-item-header"},[e.createElementVNode("text",{class:"filter-label"},"æ’åº"),e.createElementVNode("text",{class:"filter-value"},e.toDisplayString(d[f.value].name),1)]),e.createElementVNode("picker",{range:d,"range-key":"name",value:f.value,onChange:g,class:"picker"},[e.createElementVNode("view",{class:"picker-indicator"},[e.createElementVNode("text",{class:"picker-arrow"},"â–¼")])],40,["value"])])])]),e.createElementVNode("view",{class:"card scores-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"B30åˆ—è¡¨ ("+e.toDisplayString(p.value.length)+")",1),e.createElementVNode("text",{class:"card-action",onClick:w},"æŸ¥çœ‹R10")]),p.value.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"scores-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.value,(t,r)=>{return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["score-item",{"top-score":r<3}]),key:r},[e.createElementVNode("view",{class:e.normalizeClass(["score-rank",A(r)])},e.toDisplayString(r+1),3),e.createElementVNode("view",{class:"song-info"},[e.createElementVNode("text",{class:"song-name"},e.toDisplayString(t.songName),1),e.createElementVNode("view",{class:"song-meta"},[e.createElementVNode("text",{class:e.normalizeClass(["song-difficulty",(o=t.difficulty,{pst:"difficulty-pst",prs:"difficulty-prs",ftr:"difficulty-ftr",byd:"difficulty-byd",etr:"difficulty-etr"}[o]||"")])},e.toDisplayString(I(t.difficulty)),3),e.createElementVNode("text",{class:"song-constant"},e.toDisplayString(t.constant),1)])]),e.createElementVNode("view",{class:"score-details"},[e.createElementVNode("text",{class:"score-text"},e.toDisplayString(t.score.toLocaleString()),1),e.createElementVNode("view",{class:"score-stats"},[e.createElementVNode("text",{class:"score-ptt"},"PTT "+e.toDisplayString(t.ptt.toFixed(2)),1),e.createElementVNode("view",{class:"score-rating-container"},[e.createElementVNode("text",{class:e.normalizeClass(["score-rating",(n=t.rating,{PM:"rating-pm","EX+":"rating-ex-plus",EX:"rating-ex",AA:"rating-aa",A:"rating-a",B:"rating-b",C:"rating-c",D:"rating-d"}[n]||"")])},e.toDisplayString(t.rating),3)])])]),e.createElementVNode("view",{class:"score-actions"},[e.createElementVNode("button",{class:"action-btn-small edit-btn",onClick:e=>(e=>{const t=p.value[e],r=c.value.findIndex(e=>e.songName===t.songName&&e.difficulty===t.difficulty);uni.navigateTo({url:`/pages/best30/add?edit=${r}`})})(r)},[e.createElementVNode("text",{class:"action-icon"},"âœï¸")],8,["onClick"]),e.createElementVNode("button",{class:"action-btn-small delete-btn",onClick:e=>(e=>{const t=p.value[e],r=c.value.findIndex(e=>e.songName===t.songName&&e.difficulty===t.difficulty);uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:`ç¡®å®šè¦åˆ é™¤ã€Š${t.songName}ã€‹çš„æˆç»©è®°å½•å—ï¼Ÿ`,success:e=>{e.confirm&&(c.value.splice(r,1),N(),m(),uni.showToast({title:"å·²åˆ é™¤",icon:"success"}))}})})(r)},[e.createElementVNode("text",{class:"action-icon"},"ğŸ—‘ï¸")],8,["onClick"])])],2);var n,o}),128))])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-state"},[e.createElementVNode("view",{class:"empty-illustration"},[e.createElementVNode("view",{class:"empty-circle"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸµ")])]),e.createElementVNode("view",{class:"empty-content"},[e.createElementVNode("text",{class:"empty-title"},"å¼€å§‹è®°å½•æ‚¨çš„Arcaeaä¹‹æ—…"),e.createElementVNode("text",{class:"empty-subtitle"},"æ·»åŠ æ‚¨çš„ç¬¬ä¸€ä¸ªB30æˆç»©ï¼Œå¼€å¯éŸ³ä¹æ¸¸æˆæ•°æ®åˆ†æ"),e.createElementVNode("view",{class:"empty-stats"},[e.createElementVNode("view",{class:"empty-stat-item"},[e.createElementVNode("text",{class:"stat-number"},"0"),e.createElementVNode("text",{class:"stat-label"},"æœ€ä½³è®°å½•")]),e.createElementVNode("view",{class:"empty-stat-divider"}),e.createElementVNode("view",{class:"empty-stat-item"},[e.createElementVNode("text",{class:"stat-number"},"0.00"),e.createElementVNode("text",{class:"stat-label"},"PTTæ½œåŠ›å€¼")])]),e.createElementVNode("button",{class:"empty-btn",onClick:b},[e.createElementVNode("text",{class:"empty-btn-text"},"æ·»åŠ ç¬¬ä¸€é¦–æ­Œçš„æˆç»©"),e.createElementVNode("text",{class:"empty-btn-icon"},"â†’")])])]))])]);var n}}}),[["__scopeId","data-v-b047ea61"]]),d=a(e.defineComponent({__name:"add",setup(r){const n=e.ref(!1),o=e.ref(-1),i=e.ref({}),a=e.ref(""),s=e.ref(""),c=e.ref(""),l=e.ref(""),u=e.ref(""),d=e.ref(0),f=e.ref(""),p=e.computed(()=>i.value.constant&&""!==a.value&&parseInt(a.value)>=0&&parseInt(a.value)<=1e7);e.onMounted(()=>{const e=getCurrentPages(),t=e[e.length-1].options;if(t&&void 0!==t.edit){const e=parseInt(t.edit);!isNaN(e)&&e>=0&&(n.value=!0,o.value=e,h(e))}const r=uni.getStorageSync("recent_song");r&&(i.value=r),uni.$on("songSelected",e=>{i.value=e,g()})});const h=e=>{try{const t=uni.getStorageSync("best30_records")||[];if(t[e]){const r=t[e];i.value={name:r.songName,difficulty:r.difficulty,constant:r.constant},a.value=r.score.toString(),d.value=r.ptt,f.value=r.rating,void 0!==r.pureCount&&(s.value=r.pureCount.toString()),void 0!==r.farCount&&(c.value=r.farCount.toString()),void 0!==r.lostCount&&(l.value=r.lostCount.toString()),u.value=r.remark||""}}catch(r){t("error","at pages/best30/add.vue:205","åŠ è½½æˆç»©å¤±è´¥",r)}},m=()=>{uni.navigateTo({url:"/pages/songs/songs?from=add"})},y=()=>{a.value="10000000",g()},v=()=>{const e=parseInt(a.value);isNaN(e)||e<0?a.value="0":e>1e7&&(a.value="10000000"),g()},g=()=>{if(!i.value.constant||""===a.value)return d.value=0,void(f.value="");const e=parseInt(a.value),t=i.value.constant;d.value=b(e,t),f.value=w(e)},b=(e,t)=>e>=1e7?t+2:e>=98e5?t+1+(e-98e5)/2e5:t+Math.max(0,(e-95e5)/3e5),w=e=>1e7===e?"PM":e>=99e5?"EX+":e>=98e5?"EX":e>=95e5?"AA":e>=92e5?"A":e>=89e5?"B":e>=86e5?"C":"D",E=()=>{if(!p.value)return void uni.showToast({title:"è¯·å¡«å†™å®Œæ•´ä¿¡æ¯",icon:"none"});const e=parseInt(a.value),r={songName:i.value.name,difficulty:i.value.difficulty,constant:i.value.constant,score:e,ptt:d.value,rating:f.value,pureCount:s.value?parseInt(s.value):void 0,farCount:c.value?parseInt(c.value):void 0,lostCount:l.value?parseInt(l.value):void 0,remark:u.value.trim(),timestamp:Date.now()};try{let e=uni.getStorageSync("best30_records")||[];if(n.value)e[o.value]=r;else{const t=e.findIndex(e=>e.songName===r.songName&&e.difficulty===r.difficulty);if(-1!==t)return void uni.showModal({title:"æç¤º",content:"å·²å­˜åœ¨ç›¸åŒæ­Œæ›²å’Œéš¾åº¦çš„è®°å½•ï¼Œæ˜¯å¦è¦†ç›–ï¼Ÿ",success:n=>{n.confirm&&(e[t]=r,_(e,r))}});e.push(r)}_(e,r)}catch(h){t("error","at pages/best30/add.vue:360","ä¿å­˜æˆç»©å¤±è´¥",h),uni.showToast({title:"ä¿å­˜å¤±è´¥",icon:"none"})}},_=(e,t)=>{e.sort((e,t)=>t.ptt-e.ptt),e=e.slice(0,30),uni.setStorageSync("best30_records",e),uni.setStorageSync("recent_song",{name:t.songName,difficulty:t.difficulty,constant:t.constant}),S(t),x(e),uni.showToast({title:n.value?"æ›´æ–°æˆåŠŸ":"ä¿å­˜æˆåŠŸ",icon:"success"}),setTimeout(()=>{uni.navigateBack()},1500)},S=e=>{try{let t=uni.getStorageSync("recent_scores")||[];const r=t.findIndex(t=>t.songName===e.songName&&t.difficulty===e.difficulty);-1!==r&&t.splice(r,1),t.unshift(e),t=t.slice(0,10),uni.setStorageSync("recent_scores",t)}catch(r){t("error","at pages/best30/add.vue:427","æ›´æ–°æœ€è¿‘æˆç»©å¤±è´¥",r)}},x=e=>{try{let n=0,o=0,i=0,a=0;if(e.length>0){i=e.reduce((e,t)=>e+t.ptt,0)/e.length;const s=e.slice(0,10);o=s.reduce((e,t)=>e+t.ptt,0)/s.length;try{const e=uni.getStorageSync("recent_scores")||[];if(e.length>0){a=e.reduce((e,t)=>e+t.ptt,0)/e.length}}catch(r){t("error","at pages/best30/add.vue:457","è·å–R10æ•°æ®å¤±è´¥",r)}n=.75*o+.25*a}const s={currentPTT:n,best10Avg:o,best30Avg:i,recent10Avg:a,lastUpdated:Date.now()};uni.setStorageSync("ptt_data",s)}catch(r){t("error","at pages/best30/add.vue:474","è®¡ç®—PTTæ¦‚è§ˆå¤±è´¥",r)}},N=()=>{uni.navigateBack()};return(t,r)=>{return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"header"},[e.createElementVNode("text",{class:"title"},e.toDisplayString(n.value?"ç¼–è¾‘æˆç»©":"æ·»åŠ æˆç»©"),1)]),e.createElementVNode("view",{class:"card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"é€‰æ‹©æ­Œæ›²")]),e.createElementVNode("view",{class:"song-info",onClick:m},[i.value.name?(e.openBlock(),e.createElementBlock("text",{key:0,class:"song-name"},e.toDisplayString(i.value.name),1)):(e.openBlock(),e.createElementBlock("text",{key:1,class:"song-placeholder"},"ç‚¹å‡»é€‰æ‹©æ­Œæ›²")),i.value.constant?(e.openBlock(),e.createElementBlock("text",{key:2,class:"song-difficulty"},e.toDisplayString((h=i.value.difficulty,{pst:"PAST",prs:"PRESENT",ftr:"FUTURE",byd:"BEYOND",etr:"ETERNAL"}[h]||h.toUpperCase()))+" ("+e.toDisplayString(i.value.constant)+") ",1)):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"æˆç»©ä¿¡æ¯")]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"åˆ†æ•°"),e.createElementVNode("view",{class:"score-input-group"},[e.withDirectives(e.createElementVNode("input",{class:"score-input",type:"number","onUpdate:modelValue":r[0]||(r[0]=e=>a.value=e),placeholder:"0 - 10000000",onInput:v,maxlength:8},null,544),[[e.vModelText,a.value]]),e.createElementVNode("button",{class:"max-score-btn",onClick:y},"æœ€é«˜åˆ†")])]),f.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"è¯„çº§"),e.createElementVNode("view",{class:e.normalizeClass(["rating-display",(o=f.value,{PM:"rating-pm","EX+":"rating-ex-plus",EX:"rating-ex",AA:"rating-aa",A:"rating-a",B:"rating-b",C:"rating-c",D:"rating-d"}[o]||"")])},e.toDisplayString(f.value),3)])):e.createCommentVNode("",!0),d.value?(e.openBlock(),e.createElementBlock("view",{key:1,class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"PTT"),e.createElementVNode("view",{class:"ptt-display"},e.toDisplayString(d.value.toFixed(2)),1)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"form-section"},[e.createElementVNode("text",{class:"form-section-title"},"è¯¦ç»†è¯„ä»·ï¼ˆå¯é€‰ï¼‰"),e.createElementVNode("view",{class:"detail-inputs"},[e.createElementVNode("view",{class:"detail-input-item"},[e.createElementVNode("text",{class:"detail-label"},"Pure"),e.withDirectives(e.createElementVNode("input",{class:"detail-input",type:"number","onUpdate:modelValue":r[1]||(r[1]=e=>s.value=e),placeholder:"0"},null,512),[[e.vModelText,s.value]])]),e.createElementVNode("view",{class:"detail-input-item"},[e.createElementVNode("text",{class:"detail-label"},"Far"),e.withDirectives(e.createElementVNode("input",{class:"detail-input",type:"number","onUpdate:modelValue":r[2]||(r[2]=e=>c.value=e),placeholder:"0"},null,512),[[e.vModelText,c.value]])]),e.createElementVNode("view",{class:"detail-input-item"},[e.createElementVNode("text",{class:"detail-label"},"Lost"),e.withDirectives(e.createElementVNode("input",{class:"detail-input",type:"number","onUpdate:modelValue":r[3]||(r[3]=e=>l.value=e),placeholder:"0"},null,512),[[e.vModelText,l.value]])])])]),e.createElementVNode("view",{class:"form-item"},[e.createElementVNode("text",{class:"form-label"},"å¤‡æ³¨"),e.withDirectives(e.createElementVNode("textarea",{class:"remark-input","onUpdate:modelValue":r[4]||(r[4]=e=>u.value=e),placeholder:"æ·»åŠ ä¸€äº›å¤‡æ³¨...",maxlength:"200"},null,512),[[e.vModelText,u.value]])])]),e.createElementVNode("view",{class:"actions"},[e.createElementVNode("button",{class:"action-btn cancel-btn",onClick:N},"å–æ¶ˆ"),e.createElementVNode("button",{class:"action-btn save-btn",onClick:E,disabled:!p.value},e.toDisplayString(n.value?"æ›´æ–°":"ä¿å­˜"),9,["disabled"])])]);var o,h}}}),[["__scopeId","data-v-ea7238a1"]]);function f(e){try{uni.setStorageSync("songs_data",e)}catch(r){t("error","at utils/songs-database.ts:27","ä¿å­˜æ­Œæ›²æ•°æ®å¤±è´¥",r)}}function p(){try{return uni.getStorageSync("songs_data")||[]}catch(e){return t("error","at utils/songs-database.ts:39","åŠ è½½æ­Œæ›²æ•°æ®å¤±è´¥",e),[]}}function h(){try{const e=p();(0===e.length||e.length<400)&&(e.length>0&&e.length<400&&t("log","at utils/songs-database.ts:169","æ£€æµ‹åˆ°æœ¬åœ°æ­Œæ›²æ•°æ®ä¸å®Œæ•´ï¼Œä»…",e.length,"é¦–ï¼Œé‡æ–°åŠ è½½å®Œæ•´æ•°æ®"),async function(){try{const{getSongsData:t}=await(e=()=>Promise.resolve().then(()=>S),Promise.resolve().then(()=>e()).catch(e=>{const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}));return t()}catch(r){throw t("error","at utils/songs-database.ts:206","åŠ è½½æ­Œæ›²æ•°æ®å¤±è´¥:",r),r}var e}().then(e=>{if(e.length>0)f(e),t("log","at utils/songs-database.ts:175","å·²åŠ è½½å®Œæ•´æ­Œæ›²æ•°æ®ï¼Œå…±",e.length,"é¦–æ­Œæ›²");else{f([{name:"Testify",artist:"Neko Hacker",pst:7.8,prs:9.4,ftr:10.9,byd:12,etr:null},{name:"Fracture Ray",artist:"xi",pst:5,prs:7,ftr:9.8,byd:11.2,etr:null},{name:"Ringed Genesis",artist:"ARForest",pst:4,prs:6,ftr:8.8,byd:10.5,etr:null},{name:"Grievous Lady",artist:"Laur",pst:5.5,prs:7.5,ftr:9.9,byd:11.1,etr:null},{name:"Harutopia ~Utopia of Spring~",artist:"ARForest",pst:3,prs:5,ftr:7.5,byd:9.5,etr:null},{name:"World Ender",artist:"Camellia",pst:5.5,prs:8,ftr:10.5,byd:11.7,etr:null},{name:"Modelista",artist:"Kukka",pst:2,prs:5,ftr:8,byd:10.5,etr:null},{name:"GOODTEK (Arcaea Edit)",artist:"EBIMAYO",pst:4,prs:6.5,ftr:9,byd:11,etr:null},{name:"Cyaegha",artist:"USAO",pst:6,prs:8,ftr:10,byd:11.4,etr:null},{name:"SOUNDWiTCH",artist:"Kobaryo",pst:4.5,prs:7,ftr:9.2,byd:10.8,etr:null}]),t("log","at utils/songs-database.ts:180","å·²åˆå§‹åŒ–é»˜è®¤æ­Œæ›²æ•°æ®")}}).catch(e=>{t("error","at utils/songs-database.ts:183","åŠ è½½å®Œæ•´æ­Œæ›²æ•°æ®å¤±è´¥:",e);f([{name:"Testify",artist:"Neko Hacker",pst:7.8,prs:9.4,ftr:10.9,byd:12,etr:null},{name:"Fracture Ray",artist:"xi",pst:5,prs:7,ftr:9.8,byd:11.2,etr:null},{name:"Ringed Genesis",artist:"ARForest",pst:4,prs:6,ftr:8.8,byd:10.5,etr:null},{name:"Grievous Lady",artist:"Laur",pst:5.5,prs:7.5,ftr:9.9,byd:11.1,etr:null},{name:"Harutopia ~Utopia of Spring~",artist:"ARForest",pst:3,prs:5,ftr:7.5,byd:9.5,etr:null},{name:"World Ender",artist:"Camellia",pst:5.5,prs:8,ftr:10.5,byd:11.7,etr:null},{name:"Modelista",artist:"Kukka",pst:2,prs:5,ftr:8,byd:10.5,etr:null},{name:"GOODTEK (Arcaea Edit)",artist:"EBIMAYO",pst:4,prs:6.5,ftr:9,byd:11,etr:null},{name:"Cyaegha",artist:"USAO",pst:6,prs:8,ftr:10,byd:11.4,etr:null},{name:"SOUNDWiTCH",artist:"Kobaryo",pst:4.5,prs:7,ftr:9.2,byd:10.8,etr:null}])}))}catch(e){t("error","at utils/songs-database.ts:189","åˆå§‹åŒ–æ­Œæ›²æ•°æ®åº“å¤±è´¥",e);f([{name:"Testify",artist:"Neko Hacker",pst:7.8,prs:9.4,ftr:10.9,byd:12,etr:null},{name:"Fracture Ray",artist:"xi",pst:5,prs:7,ftr:9.8,byd:11.2,etr:null},{name:"Ringed Genesis",artist:"ARForest",pst:4,prs:6,ftr:8.8,byd:10.5,etr:null},{name:"Grievous Lady",artist:"Laur",pst:5.5,prs:7.5,ftr:9.9,byd:11.1,etr:null},{name:"Harutopia ~Utopia of Spring~",artist:"ARForest",pst:3,prs:5,ftr:7.5,byd:9.5,etr:null},{name:"World Ender",artist:"Camellia",pst:5.5,prs:8,ftr:10.5,byd:11.7,etr:null},{name:"Modelista",artist:"Kukka",pst:2,prs:5,ftr:8,byd:10.5,etr:null},{name:"GOODTEK (Arcaea Edit)",artist:"EBIMAYO",pst:4,prs:6.5,ftr:9,byd:11,etr:null},{name:"Cyaegha",artist:"USAO",pst:6,prs:8,ftr:10,byd:11.4,etr:null},{name:"SOUNDWiTCH",artist:"Kobaryo",pst:4.5,prs:7,ftr:9.2,byd:10.8,etr:null}])}}const m=[{name:"Testify",artist:"Neko Hacker",pst:7.8,prs:9.4,ftr:10.9,byd:12,etr:null},{name:"Designant.",artist:"USA",pst:7.5,prs:9.6,ftr:10.9,byd:11.9,etr:null},{name:"Tempestissimo",artist:"xi",pst:7,prs:9.5,ftr:10.7,byd:11.7,etr:null},{name:"Arcana Eden",artist:"BlackY",pst:5.5,prs:8.7,ftr:10.5,byd:11.6,etr:null},{name:"Pentiment",artist:"xi",pst:7,prs:8.7,ftr:10.4,byd:11.5,etr:null},{name:"Aether Crest: Astral",artist:"CAMeLIA",pst:6,prs:8.9,ftr:10.6,byd:null,etr:11.5},{name:"Lament Rain",artist:"Fractal Dreamers",pst:6.5,prs:8.8,ftr:10.6,byd:11.4,etr:null},{name:"Abstruse Dilemma",artist:"Camellia",pst:5.5,prs:8.9,ftr:11.3,byd:null,etr:null},{name:"Arghena",artist:"Etnea",pst:7.5,prs:9.6,ftr:11.3,byd:null,etr:null},{name:"ALTER EGO",artist:"M2U",pst:6.5,prs:9.2,ftr:10.5,byd:null,etr:11.3},{name:"Extradimensional Cosmic Phenomenon",artist:"NIWASHI",pst:6.5,prs:8.8,ftr:10.6,byd:null,etr:11.3},{name:"Aegleseeker",artist:"PUPA",pst:5.5,prs:9.1,ftr:11.2,byd:null,etr:null},{name:"Grievous Lady",artist:"Laur",pst:6.5,prs:9.3,ftr:11.1,byd:null,etr:null},{name:"Fracture Ray",artist:"xi",pst:6,prs:9.5,ftr:11.1,byd:null,etr:null},{name:"#1f1e33",artist:"xi",pst:5.5,prs:9.2,ftr:11.1,byd:null,etr:null},{name:"World Ender",artist:"Camellia",pst:4,prs:7.8,ftr:10,byd:11.1,etr:null},{name:"SAIKYO STRONGER",artist:"t+pazolite",pst:5.5,prs:9.4,ftr:11,byd:null,etr:null},{name:"LAMIA",artist:"xi",pst:5,prs:8.5,ftr:11,byd:null,etr:null},{name:"Undying Macula",artist:"SOUNDWALKER",pst:5.5,prs:8.7,ftr:10.1,byd:null,etr:11},{name:"Misdeed -la bontÃ© de Dieu et l'origine du mal-",artist:"66ron",pst:5.5,prs:8.5,ftr:10.9,byd:null,etr:null},{name:"Infinite Strife,",artist:"Team Grimoire",pst:4,prs:7.5,ftr:9.9,byd:10.9,etr:null},{name:"TEmPTaTiON",artist:"t+pazolite",pst:5,prs:8.2,ftr:10.9,byd:null,etr:null},{name:"CHAOS",artist:"xi",pst:5.5,prs:7.5,ftr:10.9,byd:null,etr:null},{name:"VulcÄnus",artist:"xi",pst:5.5,prs:8.5,ftr:10.9,byd:null,etr:null},{name:"And Revive The Melody",artist:"anubasu-anubasu",pst:5.5,prs:8.5,ftr:10.9,byd:null,etr:null},{name:"Breach of Faith",artist:"xi",pst:5.5,prs:8.4,ftr:10.3,byd:10.9,etr:null},{name:"DA'AT -The First Seeker of Souls-",artist:"Laur",pst:5.5,prs:8.4,ftr:10.9,byd:null,etr:null},{name:"ViRTUS",artist:"xi",pst:5.5,prs:8.6,ftr:9.9,byd:null,etr:10.9},{name:"MEGALOVANIA (Camellia Remix)",artist:"Camellia",pst:5.5,prs:8.4,ftr:9.8,byd:null,etr:10.9},{name:"We're All Gonna Die",artist:"xi",pst:5.5,prs:8,ftr:10.1,byd:null,etr:10.9},{name:"Welcome, Queen of Fiction.",artist:"xi",pst:5,prs:8.5,ftr:10.1,byd:null,etr:10.9},{name:"Code: Oblivion",artist:"xi",pst:5.5,prs:8.3,ftr:9.9,byd:null,etr:10.9},{name:"Ringed Genesis",artist:"ARForest",pst:5.5,prs:8.4,ftr:10.8,byd:null,etr:null},{name:"Dantalion",artist:"Team Grimoire",pst:5,prs:8.2,ftr:10.8,byd:null,etr:null},{name:"BUCHiGiRE Berserker",artist:"xi",pst:5,prs:8.6,ftr:10.8,byd:null,etr:null},{name:"Ï‰4",artist:"xi",pst:3.5,prs:7.8,ftr:10.8,byd:null,etr:null},{name:"Divine Light of Myriad",artist:"A.SAKA",pst:4.5,prs:7.8,ftr:10.8,byd:null,etr:null},{name:"GENOCIDER",artist:"xi",pst:4.5,prs:8.9,ftr:10.8,byd:null,etr:null},{name:"Stasis",artist:"xi",pst:4.5,prs:7,ftr:10.8,byd:null,etr:null},{name:"PRIMITIVE LIGHTS",artist:"xi",pst:5.5,prs:8.8,ftr:10.8,byd:null,etr:null},{name:"Spider's Thread",artist:"xi",pst:4.5,prs:7.8,ftr:10.8,byd:null,etr:null},{name:"ÍŸÍÍâ…¡ÌÌ•",artist:"xi",pst:5,prs:8.9,ftr:10.8,byd:null,etr:null},{name:"TeraVolt",artist:"xi",pst:5,prs:8.9,ftr:10.8,byd:null,etr:null},{name:"Meta-Mysteria",artist:"xi",pst:5,prs:7.8,ftr:10.8,byd:null,etr:null},{name:"Distorted Fate",artist:"xi",pst:4.5,prs:7.8,ftr:9.6,byd:null,etr:10.8},{name:"DÃ©sive",artist:"xi",pst:5,prs:8,ftr:9.9,byd:null,etr:10.8},{name:"Black MInD",artist:"xi",pst:5,prs:8,ftr:10.8,byd:null,etr:10.8},{name:"Nightmare",artist:"xi",pst:4.5,prs:7.8,ftr:9.8,byd:null,etr:10.8},{name:"Lilly",artist:"xi",pst:5,prs:8.4,ftr:9.9,byd:null,etr:10.8},{name:"ANDORXOR",artist:"xi",pst:4.5,prs:7.8,ftr:9.9,byd:null,etr:10.8},{name:"MARENYX",artist:"xi",pst:4.5,prs:7.8,ftr:9.5,byd:null,etr:10.8},{name:"ouroboros -twin stroke of the end-",artist:"xi",pst:4.5,prs:7.5,ftr:10.7,byd:null,etr:null},{name:"Cyaegha",artist:"xi",pst:5.5,prs:8.4,ftr:10.7,byd:null,etr:null},{name:"World Vanquisher",artist:"xi",pst:2.5,prs:5.5,ftr:10.7,byd:null,etr:null},{name:"AMAZING MIGHTYYYY!!!!",artist:"xi",pst:4.5,prs:7.8,ftr:10.7,byd:null,etr:null},{name:"REKKA RESONANCE",artist:"xi",pst:5,prs:8.9,ftr:10.7,byd:null,etr:null},{name:"NULL APOPHENIA",artist:"xi",pst:4.5,prs:8.8,ftr:10.7,byd:null,etr:null},{name:"KYOREN ROMANCE",artist:"xi",pst:4,prs:7.8,ftr:10.7,byd:null,etr:null},{name:"Inverted World",artist:"xi",pst:3,prs:7,ftr:9.5,byd:null,etr:10.7},{name:"Don't Fight The Music",artist:"xi",pst:4.5,prs:7.8,ftr:9.3,byd:null,etr:10.7},{name:"AlterGate",artist:"xi",pst:5.5,prs:8.7,ftr:10.7,byd:null,etr:null},{name:"Xterfusion",artist:"xi",pst:4.5,prs:8.3,ftr:9.8,byd:null,etr:10.7},{name:"Axium Crisis",artist:"xi",pst:5.5,prs:8.5,ftr:10.6,byd:null,etr:null},{name:"cyanine",artist:"xi",pst:4,prs:7.8,ftr:10.6,byd:null,etr:null},{name:"corps-sans-organes",artist:"xi",pst:4.5,prs:7.8,ftr:10.6,byd:null,etr:null},{name:"AttraqtiA",artist:"xi",pst:4,prs:8.3,ftr:10.6,byd:null,etr:null},{name:"Overwhelm",artist:"xi",pst:5,prs:8.5,ftr:10.6,byd:null,etr:null},{name:"Seclusion",artist:"xi",pst:4,prs:7.5,ftr:10.6,byd:null,etr:null},{name:"Live Fast Die Young",artist:"xi",pst:4.5,prs:8.5,ftr:10.6,byd:null,etr:null},{name:"Good bye, Merry-Go-Round.",artist:"xi",pst:4.5,prs:7.5,ftr:10.6,byd:null,etr:null},{name:"Crimson Throne",artist:"xi",pst:4,prs:8,ftr:10.6,byd:null,etr:null},{name:"Manic Jeer",artist:"xi",pst:4,prs:7.8,ftr:10.6,byd:null,etr:null},{name:"[X]",artist:"xi",pst:4.5,prs:7.8,ftr:10.6,byd:null,etr:null},{name:"UNKNOWN LEVELS",artist:"xi",pst:4,prs:8.1,ftr:10.6,byd:null,etr:null},{name:"Back to Basics",artist:"xi",pst:5,prs:8.7,ftr:10.6,byd:null,etr:null},{name:"MVURBD",artist:"xi",pst:4.5,prs:7.8,ftr:10.6,byd:null,etr:null},{name:"Dies irae",artist:"xi",pst:4.5,prs:7.5,ftr:9.5,byd:null,etr:10.6},{name:"Astral Quantization",artist:"xi",pst:5,prs:8.1,ftr:10.6,byd:null,etr:null},{name:"Singularity",artist:"xi",pst:4.5,prs:7.8,ftr:10.5,byd:10.4,etr:null},{name:"Halcyon",artist:"xi",pst:5.5,prs:8.2,ftr:10.5,byd:null,etr:null},{name:"GLORYï¼šROAD",artist:"xi",pst:4.5,prs:7,ftr:10.5,byd:null,etr:null},{name:"GIMME DA BLOOD",artist:"xi",pst:3.5,prs:7.5,ftr:10.5,byd:null,etr:null},{name:"Sheriruth (Laur Remix)",artist:"xi",pst:4,prs:7.8,ftr:10.5,byd:null,etr:null},{name:"Lightning Screw",artist:"xi",pst:4.5,prs:7.8,ftr:10.5,byd:null,etr:null},{name:"Aurgelmir",artist:"xi",pst:4.5,prs:8.5,ftr:10.5,byd:null,etr:null},{name:"Chronicle",artist:"xi",pst:5,prs:8.9,ftr:10.5,byd:null,etr:null},{name:"Lucid Traveler",artist:"xi",pst:4.5,prs:8.9,ftr:10.5,byd:null,etr:null},{name:"Rise of World",artist:"xi",pst:4.5,prs:8.1,ftr:10.5,byd:null,etr:null},{name:"Ego Eimi",artist:"xi",pst:5.5,prs:8.6,ftr:10.5,byd:null,etr:null},{name:"XTREME",artist:"xi",pst:4.5,prs:7.8,ftr:10.5,byd:null,etr:null},{name:"eden",artist:"xi",pst:4.5,prs:8.2,ftr:10.5,byd:null,etr:null},{name:"Wish Upon a Snow",artist:"xi",pst:4.5,prs:7.5,ftr:10.5,byd:null,etr:null},{name:"Aleph-0",artist:"xi",pst:5.5,prs:8.8,ftr:10.5,byd:null,etr:null},{name:"Twilight Concerto",artist:"xi",pst:4.5,prs:7.8,ftr:9.5,byd:null,etr:10.5},{name:"10pt8ion",artist:"xi",pst:4,prs:7.8,ftr:9.8,byd:null,etr:10.5},{name:"Judgement",artist:"xi",pst:5.5,prs:8.6,ftr:10.5,byd:null,etr:null},{name:"Rain of Conflict in a Radiant Abyss",artist:"xi",pst:5,prs:7.8,ftr:9.5,byd:null,etr:10.5},{name:"Spirit of Dauntless",artist:"xi",pst:4.5,prs:7.8,ftr:10.5,byd:null,etr:null},{name:"Straight into lights",artist:"xi",pst:4,prs:7.5,ftr:9.5,byd:null,etr:10.5},{name:"MEGALOVANIA",artist:"xi",pst:4.5,prs:7.5,ftr:9.5,byd:null,etr:10.5},{name:"Dull Blade",artist:"xi",pst:4.5,prs:8,ftr:10.5,byd:null,etr:null},{name:"BlythE",artist:"xi",pst:3,prs:7.5,ftr:9.4,byd:null,etr:10.5},{name:"CHAOSBLAST",artist:"xi",pst:4.5,prs:7.8,ftr:9.6,byd:null,etr:10.5},{name:"Xxium and Purple haze",artist:"xi",pst:2.5,prs:7.8,ftr:9.9,byd:null,etr:10.5},{name:"Î³uarÎ´ina",artist:"xi",pst:4,prs:8,ftr:10.4,byd:null,etr:null},{name:"Garakuta Doll Play",artist:"xi",pst:4.5,prs:6.5,ftr:10.4,byd:null,etr:null},{name:"Felis",artist:"xi",pst:4,prs:7.5,ftr:10.4,byd:null,etr:null},{name:"Climax",artist:"xi",pst:4.5,prs:7.8,ftr:10.4,byd:null,etr:null},{name:"Last Celebration",artist:"xi",pst:3.5,prs:6.5,ftr:10.4,byd:null,etr:null},{name:"Kissing Lucifer",artist:"xi",pst:4.5,prs:7.8,ftr:10.4,byd:null,etr:null},{name:"PUPA",artist:"xi",pst:4,prs:7.8,ftr:10.4,byd:null,etr:null},{name:"IMPACT",artist:"xi",pst:3.5,prs:7.8,ftr:9.6,byd:10.4,etr:null},{name:"To: Milky Way",artist:"xi",pst:5,prs:8.9,ftr:10.4,byd:null,etr:null},{name:"Qovat",artist:"xi",pst:4.5,prs:8.2,ftr:10.4,byd:null,etr:null},{name:"Lethal Voltage",artist:"xi",pst:4.5,prs:7.8,ftr:10.4,byd:null,etr:null},{name:"MIRINAE",artist:"xi",pst:4.5,prs:8.3,ftr:10.4,byd:null,etr:null},{name:"Rays of Remnant",artist:"xi",pst:4.5,prs:7.5,ftr:9.7,byd:10.4,etr:null},{name:"Placeboâ™¥Battler",artist:"xi",pst:5.5,prs:8.3,ftr:10.4,byd:null,etr:null},{name:"Dual Dependency",artist:"xi",pst:4.5,prs:7.8,ftr:9.5,byd:10.4,etr:null},{name:"Eternity Break",artist:"xi",pst:3.5,prs:7.5,ftr:9.6,byd:10.4,etr:null},{name:"No Way Back",artist:"xi",pst:4.5,prs:7.5,ftr:8.9,byd:10.4,etr:null},{name:"INCARNATORâ‚€â‚€",artist:"xi",pst:3.5,prs:6.5,ftr:8.9,byd:10.4,etr:null},{name:"Metallic Punisher",artist:"xi",pst:3,prs:7,ftr:10.3,byd:null,etr:null},{name:"Ether Strike",artist:"xi",pst:5.5,prs:8.3,ftr:10.3,byd:null,etr:null},{name:"Tiferet",artist:"xi",pst:4.5,prs:7.8,ftr:10.3,byd:null,etr:null},{name:"Ikazuchi",artist:"xi",pst:3.5,prs:7.5,ftr:10.3,byd:null,etr:null},{name:"IZANA",artist:"xi",pst:5,prs:8.3,ftr:10.3,byd:null,etr:null},{name:"To: Alice Liddell",artist:"xi",pst:4,prs:7.5,ftr:10.3,byd:null,etr:null},{name:"Viyella's Tears",artist:"xi",pst:4,prs:7.8,ftr:10.3,byd:null,etr:null},{name:"Hiiro Gekka, Kyoushou no Zetsu (nayuta 2017 ver.)",artist:"xi",pst:3.5,prs:6.5,ftr:10.3,byd:null,etr:null},{name:"99 Glooms",artist:"xi",pst:4,prs:7.8,ftr:10.3,byd:null,etr:null},{name:"ultradiaxon-N3",artist:"xi",pst:4.5,prs:8.5,ftr:10.3,byd:null,etr:null},{name:"Dual Doom Deathmatch",artist:"xi",pst:3.5,prs:6.5,ftr:8.9,byd:10.3,etr:null},{name:"SUPER AMBULANCE",artist:"xi",pst:4.5,prs:7.5,ftr:10.3,byd:null,etr:null},{name:"8-EM",artist:"xi",pst:4.5,prs:7.8,ftr:9.5,byd:10.3,etr:null},{name:"BREaK! BREaK! BREaK!",artist:"xi",pst:3.5,prs:6.5,ftr:8.8,byd:10.3,etr:null},{name:"ROST PAGE GENE",artist:"xi",pst:5,prs:8.2,ftr:10.3,byd:null,etr:null},{name:"zephyrlasting",artist:"xi",pst:3.5,prs:7.5,ftr:9.5,byd:10.3,etr:null},{name:"Nirv lucE",artist:"xi",pst:2.5,prs:7,ftr:10.2,byd:null,etr:null},{name:"Î±terlÎ²us",artist:"xi",pst:4,prs:7.5,ftr:10.2,byd:null,etr:null},{name:"conflict",artist:"xi",pst:4.5,prs:7.5,ftr:10.2,byd:null,etr:null},{name:"Valhalla:0",artist:"xi",pst:4.5,prs:7.5,ftr:10.2,byd:null,etr:null},{name:"Malicious Mischance",artist:"xi",pst:4,prs:7.8,ftr:10.2,byd:null,etr:null},{name:"LÃ¶schen",artist:"xi",pst:3.5,prs:7,ftr:10.2,byd:null,etr:null},{name:"Quon",artist:"xi",pst:2.5,prs:6,ftr:8.7,byd:10.2,etr:null},{name:"lastendconductor",artist:"xi",pst:3.5,prs:7.5,ftr:9.4,byd:10.2,etr:null},{name:"Redolent Shape",artist:"xi",pst:4.5,prs:7.5,ftr:10.2,byd:null,etr:null},{name:"NEO WINGS",artist:"xi",pst:4,prs:7.5,ftr:10.2,byd:null,etr:null},{name:"Capella",artist:"xi",pst:4.5,prs:7.8,ftr:10.2,byd:null,etr:null},{name:"Magnolia",artist:"xi",pst:4.5,prs:7.8,ftr:10.2,byd:null,etr:null},{name:"Logos",artist:"xi",pst:4,prs:7.8,ftr:10.2,byd:null,etr:null},{name:"Renegade",artist:"xi",pst:4.5,prs:7.8,ftr:9.6,byd:10.2,etr:null},{name:"Your Best Nightmare",artist:"xi",pst:3.5,prs:6.5,ftr:8.9,byd:10.2,etr:null},{name:"Angel's Boundary",artist:"xi",pst:5,prs:8.5,ftr:10.2,byd:null,etr:null},{name:"Grandspell",artist:"xi",pst:4.5,prs:8.4,ftr:10.2,byd:null,etr:null},{name:"PRAGMATISM",artist:"xi",pst:4.5,prs:8.6,ftr:10.1,byd:11.2,etr:null},{name:"G e n g a o z o",artist:"xi",pst:4,prs:8.1,ftr:10.1,byd:null,etr:null},{name:"Medusa",artist:"xi",pst:4.5,prs:7,ftr:10.1,byd:null,etr:null},{name:"Trrricksters!!",artist:"xi",pst:4.5,prs:7.5,ftr:10.1,byd:null,etr:null},{name:"Kanbu de Tomatte Sugu Tokeru",artist:"xi",pst:4,prs:7.5,ftr:10.1,byd:null,etr:null},{name:"Gensou no Satellite",artist:"xi",pst:2.5,prs:6.5,ftr:8.7,byd:10.1,etr:null},{name:"BlazinG AIR",artist:"xi",pst:3.5,prs:6.5,ftr:8.9,byd:10.1,etr:null},{name:"Don't Die",artist:"xi",pst:3.5,prs:7,ftr:9.4,byd:10.1,etr:null},{name:"OBLIVION",artist:"xi",pst:4,prs:7,ftr:9.5,byd:10.1,etr:null},{name:"INFINITE DIMENSION",artist:"xi",pst:2.5,prs:6,ftr:8.6,byd:10.1,etr:null},{name:"Sheriruth",artist:"xi",pst:5.5,prs:7.5,ftr:10,byd:null,etr:null},{name:"Alexandrite",artist:"xi",pst:4.5,prs:7.5,ftr:10,byd:null,etr:null},{name:"Scarlet Lance",artist:"xi",pst:4,prs:7,ftr:10,byd:null,etr:null},{name:"Vicious Heroism",artist:"xi",pst:4,prs:7.5,ftr:10,byd:11.2,etr:null},{name:"Xanatos",artist:"xi",pst:4,prs:7.5,ftr:10,byd:null,etr:null},{name:"Oshama Scramble!",artist:"xi",pst:3.5,prs:6.5,ftr:10,byd:null,etr:null},{name:"Bamboo",artist:"xi",pst:3,prs:6.5,ftr:10,byd:null,etr:null},{name:"HIVEMIND",artist:"xi",pst:4,prs:8.6,ftr:10,byd:null,etr:null},{name:"Free Myself",artist:"xi",pst:4.5,prs:7.5,ftr:10,byd:null,etr:null},{name:"Masquerade Legion",artist:"xi",pst:3.5,prs:6.5,ftr:10,byd:null,etr:null},{name:"Chromafill",artist:"xi",pst:4,prs:7,ftr:10,byd:null,etr:null},{name:"Third Sun",artist:"xi",pst:3.5,prs:7,ftr:9.4,byd:10,etr:null},{name:"TRPNO",artist:"xi",pst:4.5,prs:7.8,ftr:10,byd:null,etr:null},{name:"Liar",artist:"xi",pst:4.5,prs:7.8,ftr:10,byd:null,etr:null},{name:"Î›ZÎ›LEÎ›",artist:"xi",pst:4,prs:7,ftr:9.4,byd:10,etr:null},{name:"Modelista",artist:"xi",pst:3.5,prs:7.5,ftr:9.9,byd:null,etr:null},{name:"trappola bewitching",artist:"xi",pst:3,prs:6,ftr:9.9,byd:10.6,etr:null},{name:"Nhelv",artist:"xi",pst:3,prs:6.5,ftr:9.9,byd:10.9,etr:null},{name:"Heavensdoor",artist:"xi",pst:4.5,prs:7.5,ftr:9.9,byd:10.8,etr:null},{name:"Mirzam",artist:"xi",pst:4,prs:7.5,ftr:9.9,byd:null,etr:null},{name:"Antagonism",artist:"xi",pst:4.5,prs:7.8,ftr:9.9,byd:null,etr:null},{name:"Arcahv",artist:"xi",pst:4.5,prs:7.8,ftr:9.9,byd:null,etr:null},{name:"Galaxy Friends",artist:"xi",pst:3.5,prs:6,ftr:9.9,byd:null,etr:null},{name:"7thSense",artist:"xi",pst:3,prs:7.8,ftr:9.9,byd:null,etr:null},{name:"Summer Fireworks of Love",artist:"xi",pst:3,prs:6.5,ftr:9.9,byd:null,etr:null},{name:"Trap Crow",artist:"xi",pst:4.5,prs:7.8,ftr:9.9,byd:null,etr:null},{name:"Astra walkthrough",artist:"xi",pst:4.5,prs:7.8,ftr:9.9,byd:null,etr:null},{name:"MAXRAGE",artist:"xi",pst:3.5,prs:6.5,ftr:9.9,byd:null,etr:null},{name:"The Survivor (Game Edit)",artist:"xi",pst:3.5,prs:6.5,ftr:9.9,byd:null,etr:null},{name:"New York Back Raise",artist:"xi",pst:4.5,prs:7,ftr:9.9,byd:null,etr:null},{name:"INTERNET YAMERO",artist:"xi",pst:4.5,prs:7.8,ftr:9.9,byd:null,etr:null},{name:"Devillic Sphere",artist:"xi",pst:4,prs:7.8,ftr:9.9,byd:null,etr:null},{name:"Ultimate taste",artist:"xi",pst:3.5,prs:6.5,ftr:9.9,byd:null,etr:null},{name:"Amekagura",artist:"xi",pst:4,prs:7.5,ftr:9.9,byd:null,etr:null},{name:"Beautiful Dreamer",artist:"xi",pst:4,prs:7.8,ftr:9.9,byd:null,etr:null},{name:"STARGATE EXTREME",artist:"xi",pst:4,prs:6,ftr:9.3,byd:9.9,etr:null},{name:"Distortion Human",artist:"xi",pst:3,prs:6.5,ftr:9.9,byd:null,etr:null},{name:"Hypnotize",artist:"xi",pst:3.5,prs:7,ftr:8.9,byd:9.9,etr:null},{name:"Ashen 6oundary",artist:"xi",pst:4.5,prs:7.8,ftr:9.9,byd:null,etr:null},{name:"Swan Song",artist:"xi",pst:3,prs:7.5,ftr:9.9,byd:null,etr:null},{name:"Shinchoku Doudesuka?",artist:"xi",pst:3.5,prs:7.5,ftr:8.8,byd:9.9,etr:null},{name:"Tic! Tac! Toe!",artist:"xi",pst:3.5,prs:7.5,ftr:8.8,byd:9.9,etr:null},{name:"Syriana",artist:"xi",pst:4.5,prs:7.5,ftr:9.9,byd:null,etr:null},{name:"incomplete one",artist:"xi",pst:3.5,prs:7.5,ftr:8.8,byd:9.9,etr:null},{name:"Vainspire",artist:"xi",pst:3.5,prs:7,ftr:8.4,byd:9.9,etr:null},{name:"Paradox Palette",artist:"xi",pst:4,prs:7.5,ftr:8.8,byd:9.9,etr:null},{name:"SOUNDWiTCH",artist:"xi",pst:3.5,prs:6.5,ftr:9.8,byd:null,etr:null},{name:"Memory Forest",artist:"xi",pst:3.5,prs:6,ftr:9.8,byd:null,etr:null},{name:"Linear Accelerator",artist:"xi",pst:2.5,prs:6.5,ftr:9.8,byd:null,etr:null},{name:"Black Territory",artist:"xi",pst:3,prs:7.5,ftr:9.8,byd:null,etr:null},{name:"Corruption",artist:"xi",pst:3,prs:6.5,ftr:9.8,byd:null,etr:null},{name:"Heavenly caress",artist:"xi",pst:3.5,prs:7.5,ftr:9.8,byd:null,etr:null},{name:"Einherjar Joker",artist:"xi",pst:4,prs:7,ftr:9.8,byd:10.9,etr:null},{name:"Lost Desire",artist:"xi",pst:4,prs:7.8,ftr:9.8,byd:null,etr:null},{name:"Altale",artist:"xi",pst:2.5,prs:5.5,ftr:9.8,byd:10,etr:null},{name:"Scarlet Cage",artist:"xi",pst:4,prs:7.5,ftr:9.8,byd:null,etr:null},{name:"Got hive of Ra",artist:"xi",pst:3,prs:6.5,ftr:9.8,byd:null,etr:null},{name:"Xeraphinite",artist:"xi",pst:3,prs:7.5,ftr:9.8,byd:null,etr:null},{name:"Far Away Light",artist:"xi",pst:4.5,prs:7.8,ftr:9.8,byd:null,etr:null},{name:"THE ULTIMACY",artist:"xi",pst:3,prs:7,ftr:9.8,byd:null,etr:null},{name:"Mazy Metroplex",artist:"xi",pst:3,prs:7.8,ftr:9.8,byd:null,etr:null},{name:"Ascent",artist:"xi",pst:3,prs:6,ftr:9.8,byd:null,etr:null},{name:"Haze of Autumn",artist:"xi",pst:3.5,prs:7,ftr:9.8,byd:null,etr:null},{name:"init()",artist:"xi",pst:4,prs:7.5,ftr:9.8,byd:null,etr:null},{name:"Macrocosmic Modulation",artist:"xi",pst:4,prs:7.8,ftr:9.8,byd:null,etr:null},{name:"Protoflicker",artist:"xi",pst:3,prs:7,ftr:9.8,byd:null,etr:null},{name:"Defection",artist:"xi",pst:3.5,prs:6.5,ftr:9.8,byd:null,etr:null},{name:"Callima Karma",artist:"xi",pst:3.5,prs:7.5,ftr:9.8,byd:null,etr:null},{name:"Ai Drew",artist:"xi",pst:3.5,prs:6.5,ftr:9.8,byd:null,etr:null},{name:"FLUFFY FLASH",artist:"xi",pst:3.5,prs:6.5,ftr:9.8,byd:null,etr:null},{name:"World Fragments III(radio edit)",artist:"xi",pst:3.5,prs:7,ftr:9.8,byd:null,etr:null},{name:"Genesis",artist:"xi",pst:4,prs:7,ftr:9.8,byd:null,etr:null},{name:"Hybris (The one who shattered)",artist:"xi",pst:4.5,prs:7.8,ftr:9.8,byd:null,etr:null},{name:"RGB",artist:"xi",pst:4,prs:7.8,ftr:9.8,byd:null,etr:null},{name:"Kanjou no Matenrou ï½Arr.Demetori",artist:"xi",pst:3.5,prs:6.5,ftr:9.8,byd:null,etr:null},{name:"To Furthest Dream",artist:"xi",pst:4.5,prs:8.5,ftr:9.8,byd:null,etr:null},{name:"Technicolour",artist:"xi",pst:3.5,prs:7,ftr:9.8,byd:null,etr:null},{name:"Nameless Passion",artist:"xi",pst:3,prs:7,ftr:9.8,byd:null,etr:null},{name:"OuvertÃ¼re",artist:"xi",pst:2.5,prs:7.5,ftr:9.8,byd:null,etr:null},{name:"LIVHT MY WÎ”Y",artist:"xi",pst:4.5,prs:7.5,ftr:9.8,byd:null,etr:null},{name:"MORNINGLOOM",artist:"xi",pst:3,prs:6.5,ftr:8.8,byd:9.8,etr:null},{name:"Old School Salvage",artist:"xi",pst:4,prs:7.8,ftr:9.8,byd:null,etr:null},{name:"HYPER VISION",artist:"xi",pst:4.5,prs:7.5,ftr:9.8,byd:null,etr:null},{name:"shrink",artist:"xi",pst:3.5,prs:7,ftr:9.8,byd:null,etr:null},{name:"Waltz for Lorelei",artist:"xi",pst:2.5,prs:5.5,ftr:8.8,byd:9.8,etr:null},{name:"Crimson Quartz",artist:"xi",pst:3,prs:6,ftr:8.8,byd:9.8,etr:null},{name:"LiftOff",artist:"xi",pst:3,prs:6.5,ftr:8.2,byd:9.8,etr:null},{name:"Ignition",artist:"xi",pst:3.5,prs:6,ftr:9.8,byd:null,etr:null},{name:"yomibito_shirazu",artist:"xi",pst:4.5,prs:8,ftr:9.8,byd:null,etr:null},{name:"Won't Back Down",artist:"xi",pst:3.5,prs:6.5,ftr:9.8,byd:null,etr:null},{name:"U.A.D",artist:"xi",pst:3.5,prs:6.5,ftr:8.7,byd:9.8,etr:null},{name:"Miles",artist:"xi",pst:3.5,prs:6.5,ftr:8.2,byd:9.8,etr:null},{name:"Scarlet Lunar Empress",artist:"xi",pst:3.5,prs:7,ftr:9.8,byd:null,etr:null},{name:"disintegration",artist:"xi",pst:4,prs:6.5,ftr:8.3,byd:9.8,etr:null},{name:"taboo tears you up 2017",artist:"xi",pst:3,prs:6.5,ftr:8.4,byd:9.8,etr:null},{name:"Lethaeus",artist:"xi",pst:3.5,prs:6.5,ftr:9.7,byd:null,etr:null},{name:"The Message",artist:"xi",pst:3,prs:6.5,ftr:9.7,byd:null,etr:null},{name:"Sulfur",artist:"xi",pst:4,prs:6,ftr:9.7,byd:null,etr:null},{name:"Fallensquare",artist:"xi",pst:3,prs:7.5,ftr:9.7,byd:null,etr:null},{name:"DX Choseinou Full Metal Shojo",artist:"xi",pst:3,prs:6,ftr:9.7,byd:null,etr:null},{name:"SUPERNOVA",artist:"xi",pst:3,prs:6,ftr:9.7,byd:null,etr:null},{name:"Dreadnought",artist:"xi",pst:4,prs:7,ftr:9.7,byd:null,etr:null},{name:"Monochrome Princess",artist:"xi",pst:4.5,prs:7.8,ftr:9.7,byd:null,etr:null},{name:"Filament",artist:"xi",pst:4.5,prs:7.8,ftr:9.7,byd:null,etr:null},{name:"BATTLE NO.1",artist:"xi",pst:3.5,prs:6.5,ftr:9.7,byd:null,etr:null},{name:"BLRINK",artist:"xi",pst:3.5,prs:7.8,ftr:9.7,byd:null,etr:null},{name:"amygdata",artist:"xi",pst:4,prs:7.5,ftr:9.7,byd:null,etr:null},{name:"Black Lotus",artist:"xi",pst:3,prs:6.5,ftr:9.7,byd:null,etr:null},{name:"BADTEK",artist:"xi",pst:4,prs:7,ftr:9.7,byd:null,etr:null},{name:"Heart Jackin'",artist:"xi",pst:3,prs:5.5,ftr:9.7,byd:null,etr:null},{name:"Dazzle hop",artist:"xi",pst:3.5,prs:6.5,ftr:9.7,byd:null,etr:null},{name:"Vandalism",artist:"xi",pst:3.5,prs:7,ftr:9.7,byd:null,etr:null},{name:"AlterAle",artist:"xi",pst:3,prs:6,ftr:9.7,byd:null,etr:null},{name:"goldenslaughterer",artist:"xi",pst:4,prs:6.5,ftr:9.7,byd:null,etr:null},{name:"nÎ­Î¿ ÎºÏŒsmo",artist:"xi",pst:4,prs:7.8,ftr:9.7,byd:null,etr:null},{name:"Î¼",artist:"xi",pst:3.5,prs:7.5,ftr:9.7,byd:null,etr:null},{name:"Loveless Dress",artist:"xi",pst:3.5,prs:6.5,ftr:9.7,byd:null,etr:null},{name:"Last | Eternity",artist:"xi",pst:null,prs:null,ftr:9.7,byd:null,etr:null},{name:"Let's Rock (Arcaea mix)",artist:"xi",pst:3,prs:7,ftr:9.7,byd:null,etr:null},{name:"Lost in Abyss",artist:"xi",pst:3.5,prs:6.5,ftr:9.7,byd:null,etr:null},{name:"SACRIFICE feat. ayame",artist:"xi",pst:3.5,prs:7.5,ftr:9.7,byd:null,etr:null},{name:"B.B.K.K.B.K.K.",artist:"xi",pst:4.5,prs:7,ftr:9.7,byd:null,etr:null},{name:"Hotarubi no Yuki",artist:"xi",pst:3.5,prs:7,ftr:9.7,byd:null,etr:null},{name:"Luna Rossa",artist:"xi",pst:3,prs:6,ftr:9.7,byd:null,etr:null},{name:"Innocence",artist:"xi",pst:3,prs:6.5,ftr:8.5,byd:9.7,etr:null},{name:"IONOSTREAM",artist:"xi",pst:3.5,prs:6,ftr:8.7,byd:9.7,etr:null},{name:"Awaken In Ruins",artist:"xi",pst:3.5,prs:7.5,ftr:9.7,byd:null,etr:null},{name:"Hailstone",artist:"xi",pst:3.5,prs:7,ftr:9.7,byd:null,etr:null},{name:"Last Goodbye",artist:"xi",pst:2.5,prs:6.5,ftr:8.2,byd:9.7,etr:null},{name:"Black Mirror on Wall",artist:"xi",pst:3.5,prs:6.5,ftr:8.6,byd:9.7,etr:null},{name:"Ï„ (tau)",artist:"xi",pst:4.5,prs:7.8,ftr:9.7,byd:null,etr:null},{name:"Acheron",artist:"xi",pst:3.5,prs:7.5,ftr:9.7,byd:null,etr:null},{name:"Particle",artist:"xi",pst:3.5,prs:6,ftr:9.5,byd:9.7,etr:null},{name:"Quon",artist:"xi",pst:4,prs:6.5,ftr:9.6,byd:null,etr:null},{name:"carmine:scythe",artist:"xi",pst:4,prs:7.8,ftr:9.6,byd:null,etr:null},{name:"LunarOrbit -believe in Espebranch road-",artist:"xi",pst:3.5,prs:6,ftr:9.6,byd:null,etr:null},{name:"Astral tale",artist:"xi",pst:4.5,prs:7,ftr:9.6,byd:null,etr:null},{name:"Vindication",artist:"xi",pst:4,prs:6.5,ftr:9.6,byd:null,etr:null},{name:"A Wandering Melody of Love",artist:"xi",pst:3.5,prs:7.5,ftr:9.6,byd:null,etr:null},{name:"Avant Raze",artist:"xi",pst:3.5,prs:6.5,ftr:9.6,byd:null,etr:null},{name:"Purple Verse",artist:"xi",pst:4,prs:7.5,ftr:9.6,byd:10.6,etr:null},{name:"Lazy Addiction",artist:"xi",pst:2.5,prs:6,ftr:9.6,byd:null,etr:null},{name:"ENERGY SYNERGY MATRIX",artist:"xi",pst:3.5,prs:7,ftr:9.6,byd:10.3,etr:null},{name:"Last",artist:"xi",pst:4,prs:7,ftr:9,byd:9.6,etr:null},{name:"Heart",artist:"xi",pst:1,prs:5,ftr:9.6,byd:null,etr:null},{name:"Remind Souls (Short Version)",artist:"xi",pst:3.5,prs:7,ftr:9.6,byd:null,etr:null},{name:"Stratoliner",artist:"xi",pst:3.5,prs:6.5,ftr:9.6,byd:null,etr:null},{name:"Alone & Lorn",artist:"xi",pst:3,prs:6.5,ftr:9.6,byd:null,etr:null},{name:"epitaxy",artist:"xi",pst:3,prs:6,ftr:8.6,byd:9.6,etr:null},{name:"See Lights!",artist:"xi",pst:3.5,prs:6.5,ftr:8.6,byd:9.6,etr:null},{name:"Factorder",artist:"xi",pst:2.5,prs:6.5,ftr:8.6,byd:9.6,etr:null},{name:"DataErr0r",artist:"xi",pst:3,prs:7,ftr:9.5,byd:null,etr:null},{name:"Cybernecia Catharsis",artist:"xi",pst:4,prs:7,ftr:9.5,byd:9.8,etr:null},{name:"Illegal Paradise",artist:"xi",pst:2,prs:7,ftr:9.5,byd:null,etr:null},{name:"STAGER (ALL STAGE CLEAR)",artist:"xi",pst:3,prs:6.5,ftr:9.5,byd:null,etr:null},{name:"OMAKENO Stroke",artist:"xi",pst:3,prs:6.5,ftr:9.5,byd:10.3,etr:null},{name:"MAHOROBA",artist:"xi",pst:3,prs:6.5,ftr:9.5,byd:null,etr:null},{name:"ÎŸÎ”Î¥Î£Î£Î•Î™Î‘",artist:"xi",pst:4,prs:7.8,ftr:9.5,byd:null,etr:null},{name:"Evening in Scarlet",artist:"xi",pst:4,prs:7,ftr:9.5,byd:null,etr:null},{name:"NULCTRL",artist:"xi",pst:3,prs:7.5,ftr:9.5,byd:null,etr:null},{name:"GIMMICK",artist:"xi",pst:2.5,prs:6.5,ftr:9.5,byd:null,etr:null},{name:"DynitikÃ³s",artist:"xi",pst:4,prs:7.5,ftr:9.5,byd:null,etr:null},{name:"Transient Space",artist:"xi",pst:2.5,prs:7,ftr:9.5,byd:null,etr:null},{name:"felys final remix",artist:"xi",pst:3,prs:6.5,ftr:9.5,byd:null,etr:null},{name:"On And On!! feat. Jenga",artist:"xi",pst:3,prs:7,ftr:9.5,byd:null,etr:null},{name:"Jingle",artist:"xi",pst:2.5,prs:5.5,ftr:7.8,byd:9.5,etr:null},{name:"ã€‡ã€",artist:"xi",pst:2.5,prs:6.5,ftr:9.5,byd:null,etr:null},{name:"In Vain",artist:"xi",pst:3.5,prs:6.5,ftr:9.5,byd:null,etr:null},{name:"astral.exe",artist:"xi",pst:3,prs:6,ftr:9.5,byd:null,etr:null},{name:"End of The Moonlight",artist:"xi",pst:3,prs:5.5,ftr:9.5,byd:null,etr:null},{name:"SATISFACTION",artist:"xi",pst:3.5,prs:6.5,ftr:8.5,byd:9.5,etr:null},{name:"Someday",artist:"xi",pst:3,prs:6,ftr:9.5,byd:null,etr:null},{name:"Viola Illyria",artist:"xi",pst:2.5,prs:6.5,ftr:9.5,byd:null,etr:null},{name:"Party Vinyl",artist:"xi",pst:4,prs:7.8,ftr:9.4,byd:10.3,etr:null},{name:"CROSSâ€ SOUL",artist:"xi",pst:4,prs:7,ftr:9.4,byd:null,etr:null},{name:"Your voice so... feat. Such",artist:"xi",pst:3.5,prs:6.5,ftr:9.4,byd:null,etr:null},{name:"Impure Bird",artist:"xi",pst:2,prs:5.5,ftr:9.4,byd:null,etr:null},{name:"Dreamin' Attraction!!",artist:"xi",pst:4.5,prs:7,ftr:9.4,byd:null,etr:null},{name:"Red and Blue",artist:"xi",pst:4,prs:7.8,ftr:9.4,byd:10.2,etr:null},{name:"Yosakura Fubuki",artist:"xi",pst:4.5,prs:7,ftr:9.4,byd:null,etr:null},{name:"Specta",artist:"xi",pst:3.5,prs:6.5,ftr:9.4,byd:null,etr:null},{name:"Be There",artist:"xi",pst:4,prs:7.5,ftr:9.4,byd:null,etr:null},{name:"VECTOĞ¯",artist:"xi",pst:3,prs:7,ftr:9.4,byd:null,etr:null},{name:"AI[UE]OON",artist:"xi",pst:3.5,prs:6.5,ftr:9.4,byd:null,etr:null},{name:"Equilibrium",artist:"xi",pst:3.5,prs:6.5,ftr:9.4,byd:null,etr:null},{name:"Teriqma",artist:"xi",pst:3,prs:6.5,ftr:9.4,byd:9.7,etr:null},{name:"CROSSâ€ OVER",artist:"xi",pst:4,prs:6.5,ftr:9.4,byd:null,etr:null},{name:"Lapis",artist:"xi",pst:2,prs:6,ftr:9.4,byd:null,etr:null},{name:"Crystal Gravity",artist:"xi",pst:3.5,prs:6.5,ftr:9.4,byd:null,etr:null},{name:"with U",artist:"xi",pst:2.5,prs:6.5,ftr:9.4,byd:null,etr:null},{name:"Let you DIVE! (nitro rmx)",artist:"xi",pst:3,prs:6.5,ftr:9.4,byd:null,etr:null},{name:"Final Step!",artist:"xi",pst:3.5,prs:6.5,ftr:9.4,byd:null,etr:null},{name:"Sakura Fubuki",artist:"xi",pst:3.5,prs:6.5,ftr:9.4,byd:null,etr:null},{name:"Head BONK ache",artist:"xi",pst:4,prs:7,ftr:9.4,byd:null,etr:null},{name:"PICO-Pico-Translation!",artist:"xi",pst:2,prs:6,ftr:9.4,byd:null,etr:null},{name:"Redraw Colorless World",artist:"xi",pst:4,prs:6.5,ftr:9.4,byd:null,etr:null},{name:"MANTIS (Arcaea Ultra-Bloodrush VIP)",artist:"xi",pst:3,prs:7,ftr:9.4,byd:null,etr:null},{name:"DRG",artist:"xi",pst:3.5,prs:7,ftr:9.4,byd:null,etr:null},{name:"Raven's Pride",artist:"xi",pst:3,prs:7,ftr:9.4,byd:null,etr:null},{name:"FANTA5Y",artist:"xi",pst:3,prs:7,ftr:9.4,byd:null,etr:null},{name:"FURETE-MITAI",artist:"xi",pst:2.5,prs:6,ftr:8.4,byd:9.4,etr:null},{name:"Death By Glamour",artist:"xi",pst:2.5,prs:5,ftr:7.8,byd:9.4,etr:null},{name:"I want You",artist:"xi",pst:3,prs:5.5,ftr:8.3,byd:9.4,etr:null},{name:"mod",artist:"xi",pst:3.5,prs:6.5,ftr:9.4,byd:null,etr:null},{name:"GOODTEK (Arcaea Edit)",artist:"xi",pst:4,prs:6.5,ftr:9.3,byd:9.8,etr:null},{name:"Oracle",artist:"xi",pst:3,prs:5.5,ftr:9.3,byd:null,etr:null},{name:"Ignotus",artist:"xi",pst:3.5,prs:6.5,ftr:9.3,byd:9.9,etr:null},{name:"Auxesia",artist:"xi",pst:3.5,prs:6.5,ftr:9.3,byd:null,etr:null},{name:"Syro",artist:"xi",pst:3.5,prs:6.5,ftr:9.3,byd:null,etr:null},{name:"Blaster",artist:"xi",pst:4,prs:7,ftr:9.3,byd:null,etr:null},{name:"Feels So Right feat. Renko",artist:"xi",pst:3.5,prs:6.5,ftr:9.3,byd:null,etr:null},{name:"Glow",artist:"xi",pst:4,prs:7.5,ftr:9.3,byd:null,etr:null},{name:"Can I Friend You on Bassbook? Lol",artist:"xi",pst:3,prs:6.5,ftr:9.3,byd:null,etr:null},{name:"Small Cloud Sugar Candy",artist:"xi",pst:3,prs:6.5,ftr:9.3,byd:null,etr:null},{name:"False Embellishment",artist:"xi",pst:3.5,prs:6.5,ftr:9.3,byd:null,etr:null},{name:"Blocked Library",artist:"xi",pst:3.5,prs:6.5,ftr:9.3,byd:null,etr:null},{name:"Lost Emotion feat. nomico",artist:"xi",pst:3.5,prs:7,ftr:9.3,byd:null,etr:null},{name:"The Formula",artist:"xi",pst:3,prs:6,ftr:9.3,byd:null,etr:null},{name:"HELLOHELL",artist:"xi",pst:2.5,prs:5,ftr:7.5,byd:9.3,etr:null},{name:"Floating World",artist:"xi",pst:3,prs:7,ftr:9.3,byd:null,etr:null},{name:"Lost Civilization",artist:"xi",pst:4,prs:7,ftr:9.2,byd:9.8,etr:null},{name:"AnÃ¶kumene",artist:"xi",pst:2.5,prs:6.5,ftr:9.2,byd:9.9,etr:null},{name:"Strongholds",artist:"xi",pst:2.5,prs:5,ftr:9.2,byd:null,etr:null},{name:"Rugie",artist:"xi",pst:3,prs:6,ftr:9.2,byd:null,etr:null},{name:"Phantasia",artist:"xi",pst:4,prs:5.5,ftr:9.2,byd:null,etr:null},{name:"Libertas",artist:"xi",pst:3.5,prs:5.5,ftr:9.2,byd:10.5,etr:null},{name:"Alice Ã  la mode",artist:"xi",pst:2.5,prs:6.5,ftr:9.2,byd:null,etr:null},{name:"Dancin' on a Cat's Paw",artist:"xi",pst:3,prs:6,ftr:9.2,byd:null,etr:null},{name:"cocoro*cosmetic",artist:"xi",pst:3,prs:7,ftr:9.2,byd:null,etr:null},{name:"Used to be",artist:"xi",pst:4,prs:6.5,ftr:9.2,byd:null,etr:null},{name:"Leave All Behind",artist:"xi",pst:2,prs:5.5,ftr:9.2,byd:null,etr:null},{name:'Sign of "10.5km"',artist:"xi",pst:3,prs:6.5,ftr:9.2,byd:null,etr:null},{name:"Ladymade Star",artist:"xi",pst:2.5,prs:6.5,ftr:8.4,byd:9.2,etr:null},{name:"qualia -ideaesthesia-",artist:"xi",pst:4.5,prs:7,ftr:9.1,byd:9.8,etr:null},{name:"Essence of Twilight",artist:"xi",pst:4.5,prs:7,ftr:9.1,byd:null,etr:null},{name:"Iconoclast",artist:"xi",pst:4,prs:7,ftr:9.1,byd:null,etr:null},{name:"Journey",artist:"xi",pst:3,prs:6,ftr:9.1,byd:null,etr:null},{name:"dropdead",artist:"xi",pst:1.5,prs:9.5,ftr:9.1,byd:10.5,etr:null},{name:"Empire of Winter",artist:"xi",pst:3.5,prs:6.5,ftr:9.1,byd:null,etr:null},{name:"ReviXy",artist:"xi",pst:3,prs:7,ftr:9.1,byd:null,etr:null},{name:"La'qryma of Wasteland",artist:"xi",pst:3.5,prs:6.5,ftr:9.1,byd:10,etr:null},{name:"Faint Light (Arcaea Edit)",artist:"xi",pst:3,prs:6,ftr:9.1,byd:null,etr:null},{name:"Alice's Suitcase",artist:"xi",pst:3.5,prs:6,ftr:9.1,byd:null,etr:null},{name:"Life is PIANO",artist:"xi",pst:3.5,prs:6,ftr:9.1,byd:null,etr:null},{name:"Coastal Highway",artist:"xi",pst:3,prs:6,ftr:9.1,byd:null,etr:null},{name:"Blue Rose",artist:"xi",pst:2,prs:6,ftr:9.1,byd:null,etr:null},{name:"Prayer",artist:"xi",pst:2.5,prs:5.5,ftr:8.2,byd:9.1,etr:null},{name:"Flyburg and Endroll",artist:"xi",pst:3,prs:6,ftr:9,byd:null,etr:null},{name:"Kanagawa Cyber Culvert",artist:"xi",pst:1,prs:5.5,ftr:9,byd:9.8,etr:null},{name:"Jump",artist:"xi",pst:4,prs:6,ftr:9,byd:null,etr:null},{name:"Turbocharger",artist:"xi",pst:2.5,prs:6,ftr:9,byd:null,etr:null},{name:"Galactic Love",artist:"xi",pst:3,prs:6.5,ftr:9,byd:null,etr:null},{name:"Lawless Point",artist:"xi",pst:3,prs:6,ftr:9,byd:null,etr:null},{name:"Primeval Texture",artist:"xi",pst:3,prs:7.5,ftr:9,byd:null,etr:null},{name:"memoryfactory.lzh",artist:"xi",pst:2.5,prs:5.5,ftr:8.9,byd:null,etr:null},{name:"Flashback",artist:"xi",pst:2,prs:5,ftr:8.9,byd:null,etr:null},{name:"Chronostasis",artist:"xi",pst:3.5,prs:7.5,ftr:8.9,byd:null,etr:null},{name:"Evoltex (poppi'n mix)",artist:"xi",pst:2,prs:7,ftr:8.9,byd:null,etr:null},{name:"Maze No.9",artist:"xi",pst:3,prs:3.5,ftr:8.9,byd:null,etr:null},{name:"MERLIN",artist:"xi",pst:3,prs:5.5,ftr:8.9,byd:9.4,etr:null},{name:"Chelsea",artist:"xi",pst:3,prs:6,ftr:8.9,byd:null,etr:null},{name:"Give Me a Nightmare",artist:"xi",pst:3.5,prs:5.5,ftr:8.9,byd:null,etr:null},{name:"Lights of Muse",artist:"xi",pst:2.5,prs:6,ftr:8.9,byd:null,etr:null},{name:"Surrender",artist:"xi",pst:3,prs:6.5,ftr:8.8,byd:null,etr:null},{name:"next to you",artist:"xi",pst:4.5,prs:7,ftr:8.8,byd:9.6,etr:null},{name:"Solitary Dream",artist:"xi",pst:4,prs:7,ftr:8.8,byd:null,etr:null},{name:"Antithese",artist:"xi",pst:2,prs:5,ftr:8.8,byd:9.6,etr:null},{name:"Vivid Theory",artist:"xi",pst:2,prs:5,ftr:8.8,byd:null,etr:null},{name:"Cosmica",artist:"xi",pst:2.5,prs:5,ftr:8.8,byd:null,etr:null},{name:"Dialnote",artist:"xi",pst:3,prs:6,ftr:8.8,byd:null,etr:null},{name:"CYCLES",artist:"xi",pst:2,prs:5,ftr:8.8,byd:null,etr:null},{name:"Cosmo Pop Funclub",artist:"xi",pst:2.5,prs:6,ftr:8.8,byd:null,etr:null},{name:"Hidden Rainbows of Epicurus",artist:"xi",pst:2.5,prs:5.5,ftr:7.5,byd:8.8,etr:null},{name:"Saint or Sinner",artist:"xi",pst:3,prs:6,ftr:8.8,byd:null,etr:null},{name:"cry of viyella",artist:"xi",pst:3.5,prs:6,ftr:8.7,byd:null,etr:null},{name:"Call My Name feat. Yukacco",artist:"xi",pst:3.5,prs:6,ftr:8.7,byd:null,etr:null},{name:"Grimheart",artist:"xi",pst:2.5,prs:5,ftr:8.7,byd:null,etr:null},{name:"Senkyou",artist:"xi",pst:3,prs:5.5,ftr:8.7,byd:null,etr:null},{name:"Beside You",artist:"xi",pst:2.5,prs:6,ftr:8.7,byd:null,etr:null},{name:"Paper Witch",artist:"xi",pst:2,prs:5,ftr:8.7,byd:null,etr:null},{name:"Tsuki ni Murakumo, Hana ni Kaze",artist:"xi",pst:3,prs:6,ftr:8.7,byd:null,etr:null},{name:"WAIT FOR DAWN",artist:"xi",pst:2.5,prs:7.8,ftr:8.7,byd:null,etr:null},{name:"Heartache",artist:"xi",pst:1.5,prs:4.5,ftr:7.5,byd:8.7,etr:null},{name:"Wake in Hour",artist:"xi",pst:2.5,prs:5.5,ftr:7.5,byd:8.7,etr:null},{name:"Silent Rush",artist:"xi",pst:2.5,prs:5,ftr:8.6,byd:null,etr:null},{name:"FREEF4LL",artist:"xi",pst:4,prs:7,ftr:8.6,byd:9.8,etr:null},{name:"Gekka (Short Version)",artist:"xi",pst:4,prs:6.5,ftr:8.6,byd:null,etr:null},{name:"April showers",artist:"xi",pst:2,prs:5.5,ftr:8.6,byd:null,etr:null},{name:"enchanted love",artist:"xi",pst:2,prs:4.5,ftr:8.6,byd:null,etr:null},{name:"Babaroque",artist:"xi",pst:3,prs:6.5,ftr:8.5,byd:null,etr:null},{name:"Dandelion",artist:"xi",pst:2.5,prs:6,ftr:8.5,byd:null,etr:null},{name:"Harutopia ~Utopia of Spring~",artist:"xi",pst:1,prs:4.5,ftr:8.5,byd:null,etr:null},{name:"Reinvent",artist:"xi",pst:2.5,prs:6.5,ftr:8.5,byd:null,etr:null},{name:"DDD",artist:"xi",pst:2.5,prs:6.5,ftr:8.5,byd:null,etr:null},{name:"Altair (feat. *spiLa*)",artist:"xi",pst:2.5,prs:6,ftr:8.5,byd:null,etr:null},{name:"syÅ«ten",artist:"xi",pst:2,prs:5,ftr:8.5,byd:null,etr:null},{name:"Snow White",artist:"xi",pst:2.5,prs:5,ftr:8.4,byd:9.7,etr:null},{name:"Lumia",artist:"xi",pst:2.5,prs:5.5,ftr:8.4,byd:9.5,etr:null},{name:"REconstruction",artist:"xi",pst:2.5,prs:6,ftr:8.4,byd:null,etr:null},{name:"Moonheart",artist:"xi",pst:2.5,prs:5.5,ftr:8.4,byd:9.7,etr:null},{name:"Rabbit In The Black Room",artist:"xi",pst:2.5,prs:5.5,ftr:8.4,byd:null,etr:null},{name:"Purgatorium",artist:"xi",pst:2.5,prs:6,ftr:8.4,byd:9.6,etr:null},{name:"Eccentric Tale",artist:"xi",pst:2,prs:5.5,ftr:8.4,byd:null,etr:null},{name:"INTERNET OVERDOSE",artist:"xi",pst:3,prs:6.5,ftr:8.4,byd:null,etr:null},{name:"Shades of Light in a Transcendent Realm",artist:"xi",pst:3,prs:6,ftr:8.3,byd:9.1,etr:null},{name:"Bookmaker (2D Version)",artist:"xi",pst:4.5,prs:6.5,ftr:8.3,byd:10,etr:null},{name:"Dot to Dot feat. shully",artist:"xi",pst:3,prs:6,ftr:8.3,byd:null,etr:null},{name:"Tie me down gently",artist:"xi",pst:3,prs:5.5,ftr:8.3,byd:null,etr:null},{name:"Oblivia",artist:"xi",pst:3.5,prs:5,ftr:8.3,byd:9.7,etr:null},{name:"Ã„vril -Flicka i krans-",artist:"xi",pst:3,prs:6,ftr:8.3,byd:null,etr:null},{name:"san skia",artist:"xi",pst:3.5,prs:6,ftr:8.3,byd:null,etr:null},{name:"Dematerialized",artist:"xi",pst:1.5,prs:4.5,ftr:7.5,byd:8.3,etr:null},{name:"Lucifer",artist:"xi",pst:3.5,prs:5.5,ftr:8.2,byd:null,etr:null},{name:"Genesis",artist:"xi",pst:2,prs:5.5,ftr:8.2,byd:null,etr:null},{name:"One Last Drive",artist:"xi",pst:2.5,prs:5.5,ftr:8.2,byd:null,etr:null},{name:"Hall of Mirrors",artist:"xi",pst:3,prs:5.5,ftr:8.2,byd:null,etr:null},{name:"1Fâˆš",artist:"xi",pst:2.5,prs:6.5,ftr:8.2,byd:null,etr:null},{name:"blue comet",artist:"xi",pst:3.5,prs:5,ftr:8.2,byd:null,etr:null},{name:"I've heard it said",artist:"xi",pst:3.5,prs:6,ftr:8.1,byd:null,etr:null},{name:"Hikari",artist:"xi",pst:2.5,prs:6,ftr:8.1,byd:null,etr:null},{name:"Diode",artist:"xi",pst:2.5,prs:5.5,ftr:8.1,byd:null,etr:null},{name:"Bullet Waiting for Me (James Landino remix)",artist:"xi",pst:2.5,prs:4.5,ftr:8.1,byd:null,etr:null},{name:"Relentless",artist:"xi",pst:4.5,prs:6.5,ftr:8,byd:null,etr:null},{name:"world.execute(me);",artist:"xi",pst:3.5,prs:5,ftr:8,byd:null,etr:null},{name:"Prism",artist:"xi",pst:2,prs:5,ftr:8,byd:null,etr:null},{name:"Rise",artist:"xi",pst:2.5,prs:4,ftr:7.8,byd:null,etr:null},{name:"Dement ~after legend~",artist:"xi",pst:3.5,prs:6,ftr:7.8,byd:9.9,etr:null},{name:"Infinity Heaven",artist:"xi",pst:1.5,prs:5.5,ftr:7.8,byd:9.6,etr:null},{name:"Brand new world",artist:"xi",pst:2,prs:4,ftr:7.8,byd:null,etr:null},{name:"Paradise",artist:"xi",pst:1,prs:4,ftr:7.8,byd:null,etr:null},{name:"Clotho and stargazer",artist:"xi",pst:2,prs:5,ftr:7.8,byd:8.8,etr:null},{name:"Moonlight of Sand Castle",artist:"xi",pst:1.5,prs:5,ftr:7.8,byd:null,etr:null},{name:"Romance Wars",artist:"xi",pst:1,prs:4,ftr:7.8,byd:null,etr:null},{name:"Dream goes on",artist:"xi",pst:1.5,prs:5,ftr:7.8,byd:null,etr:null},{name:"inkar-usi",artist:"xi",pst:2,prs:4,ftr:7.8,byd:9.4,etr:null},{name:"Suomi",artist:"xi",pst:2,prs:5,ftr:7.8,byd:8.9,etr:null},{name:"First Snow",artist:"xi",pst:2.5,prs:4.5,ftr:7.8,byd:null,etr:null},{name:"Sayonara Hatsukoi",artist:"xi",pst:1.5,prs:4.5,ftr:7,byd:8.5,etr:null},{name:"Fairytale",artist:"xi",pst:1,prs:3.5,ftr:7,byd:9.5,etr:null},{name:"Vexaria",artist:"xi",pst:2.5,prs:5,ftr:7,byd:9,etr:null},{name:"Blossoms",artist:"xi",pst:1,prs:4,ftr:7,byd:null,etr:null}];function y(){return m}function v(e){return m.find(t=>t.name===e)||null}function g(e,t){const r=v(e);return r?r[t]:null}function b(){return m.map(e=>e.name)}function w(e){return m.filter(t=>null!==t[e]&&void 0!==t[e])}function E(e,t,r){return m.filter(n=>{const o=n[e];return null!=o&&o>=t&&o<r})}const _={getSongsData:y,getSongByName:v,getSongConstant:g,getSongNames:b,getSongsByDifficulty:w,getSongsByConstantRange:E},S=Object.freeze(Object.defineProperty({__proto__:null,default:_,getSongByName:v,getSongConstant:g,getSongNames:b,getSongsByConstantRange:E,getSongsByDifficulty:w,getSongsData:y},Symbol.toStringTag,{value:"Module"})),x=a(e.defineComponent({__name:"songs",setup(r){const n=e.ref(""),o=e.ref(""),i=[{name:"å…¨éƒ¨éš¾åº¦",value:"all"},{name:"æœ‰PAST",value:"pst"},{name:"æœ‰PRESENT",value:"prs"},{name:"æœ‰FUTURE",value:"ftr"},{name:"æœ‰BEYOND",value:"byd"},{name:"æœ‰ETERNAL",value:"etr"}],a=e.ref(0),s=[{name:"å…¨éƒ¨å®šæ•°",min:0,max:20},{name:"1-3",min:1,max:3},{name:"3-5",min:3,max:5},{name:"5-7",min:5,max:7},{name:"7-9",min:7,max:9},{name:"9-11",min:9,max:11},{name:"11-13",min:11,max:13}],c=e.ref(0),l=e.ref([]),u=e.computed(()=>{let e=[...l.value];if(o.value.trim()){const t=o.value.toLowerCase();e=e.filter(e=>e.name.toLowerCase().includes(t)||e.artist&&e.artist.toLowerCase().includes(t))}if("all"!==i[a.value].value){const t=i[a.value].value;e=e.filter(e=>null!==e[t]&&void 0!==e[t])}const t=s[c.value];return(t.min>0||t.max<20)&&(e=e.filter(e=>["pst","prs","ftr","byd","etr"].some(r=>{const n=e[r];return null!=n&&n>=t.min&&n<t.max}))),e});e.onMounted(()=>{const e=getCurrentPages(),t=e[e.length-1].options;t&&t.from&&(n.value=t.from),d()});const d=()=>{try{const e=p();e&&e.length>0?e.length<400?(t("log","at pages/songs/songs.vue:189","æœ¬åœ°å­˜å‚¨çš„æ­Œæ›²æ•°æ®ä¸å®Œæ•´ï¼Œåªæœ‰",e.length,"é¦–ï¼Œé‡æ–°åŠ è½½å®Œæ•´æ•°æ®"),f()):(l.value=e,t("log","at pages/songs/songs.vue:193","ä»æœ¬åœ°å­˜å‚¨åŠ è½½æ­Œæ›²æ•°æ®ï¼Œå…±",e.length,"é¦–æ­Œæ›²")):(t("log","at pages/songs/songs.vue:197","æœ¬åœ°æ²¡æœ‰æ•°æ®ï¼Œç›´æ¥åŠ è½½å®Œæ•´æ­Œæ›²æ•°æ®"),f())}catch(e){t("error","at pages/songs/songs.vue:201","åŠ è½½æ­Œæ›²æ•°æ®å¤±è´¥",e),f()}},f=()=>{try{const r=y();l.value=r;try{uni.setStorageSync("songs_data",r),t("log","at pages/songs/songs.vue:215","åŠ è½½å®Œæ•´æ­Œæ›²æ•°æ®æˆåŠŸï¼Œå…±",r.length,"é¦–æ­Œæ›²")}catch(e){t("error","at pages/songs/songs.vue:217","å­˜å‚¨æ•°æ®å¤±è´¥:",e)}}catch(r){t("error","at pages/songs/songs.vue:220","åŠ è½½æ­Œæ›²å¸¸é‡å¤±è´¥:",r)}},h=()=>{},m=()=>{t("log","at pages/songs/songs.vue:234","æœç´¢æ­Œæ›²:",o.value)},v=e=>{a.value=e.detail.value},g=e=>{c.value=e.detail.value},b=()=>{o.value="",a.value=0,c.value=0},w=e=>{const t={pst:{name:"PST",constant:e.pst},prs:{name:"PRS",constant:e.prs},ftr:{name:"FTR",constant:e.ftr},byd:{name:"BYD",constant:e.byd},etr:{name:"ETR",constant:e.etr}},r={};for(const n in t)null!==t[n].constant&&void 0!==t[n].constant&&(r[n]=t[n]);return r},E=(e,t)=>{const r={name:e.name,artist:e.artist,difficulty:t,constant:e[t]};uni.setStorageSync("recent_song",r),_(r)},_=e=>{"calculator"===n.value||"tolerance"===n.value||"add"===n.value?(uni.navigateBack(),uni.$emit("songSelected",e)):uni.navigateBack()},S=e=>({pst:"difficulty-pst",prs:"difficulty-prs",ftr:"difficulty-ftr",byd:"difficulty-byd",etr:"difficulty-etr"}[e]||"");return(t,r)=>(e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"card search-card"},[e.createElementVNode("view",{class:"search-bar"},[e.withDirectives(e.createElementVNode("input",{class:"search-input","onUpdate:modelValue":r[0]||(r[0]=e=>o.value=e),placeholder:"æœç´¢æ­Œæ›²åç§°...",onInput:h},null,544),[[e.vModelText,o.value]]),e.createElementVNode("button",{class:"search-btn",onClick:m},"æœç´¢")]),e.createElementVNode("view",{class:"filter-row"},[e.createElementVNode("view",{class:"filter-item"},[e.createElementVNode("text",{class:"filter-label"},"éš¾åº¦ç­›é€‰"),e.createElementVNode("picker",{range:i,"range-key":"name",value:a.value,onChange:v,class:"picker"},[e.createElementVNode("view",{class:"picker-text"},e.toDisplayString(i[a.value].name),1)],40,["value"])]),e.createElementVNode("view",{class:"filter-item"},[e.createElementVNode("text",{class:"filter-label"},"å®šæ•°èŒƒå›´"),e.createElementVNode("picker",{range:s,"range-key":"name",value:c.value,onChange:g,class:"picker"},[e.createElementVNode("view",{class:"picker-text"},e.toDisplayString(s[c.value].name),1)],40,["value"])])])]),e.createElementVNode("view",{class:"card songs-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"æ­Œæ›²åˆ—è¡¨ ("+e.toDisplayString(u.value.length)+")",1)]),u.value.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"songs-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(u.value,(t,r)=>(e.openBlock(),e.createElementBlock("view",{class:"song-item",key:r,onClick:e=>(e=>{const t=null!==e.ftr&&void 0!==e.ftr?"ftr":null!==e.prs&&void 0!==e.prs?"prs":null!==e.pst&&void 0!==e.pst?"pst":"";t&&E(e,t)})(t)},[e.createElementVNode("view",{class:"song-info"},[e.createElementVNode("text",{class:"song-name"},e.toDisplayString(t.name),1),e.createElementVNode("text",{class:"song-artist"},e.toDisplayString(t.artist||""),1)]),e.createElementVNode("view",{class:"song-difficulties"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(w(t),(r,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["difficulty-item",S(n)]),key:n,onClick:e.withModifiers(e=>E(t,n),["stop"])},[e.createElementVNode("text",{class:"difficulty-name"},e.toDisplayString(r.name),1),e.createElementVNode("text",{class:"difficulty-constant"},e.toDisplayString(r.constant),1)],10,["onClick"]))),128))])],8,["onClick"]))),128))])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-state"},[e.createElementVNode("text",{class:"empty-icon"},"ğŸµ"),e.createElementVNode("text",{class:"empty-text"},"æ²¡æœ‰æ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„æ­Œæ›²"),e.createElementVNode("button",{class:"reset-btn",onClick:b},"é‡ç½®ç­›é€‰æ¡ä»¶")]))])]))}}),[["__scopeId","data-v-ecddd35a"]]),N=a(e.defineComponent({__name:"data",setup(r){const n=e.ref(0),o=e.ref(0),i=e.ref(0),a=e.ref(0),s=e.ref("æœªçŸ¥"),c=e.ref([]),l=e.ref([]),u=e.ref(0),d=e.ref("best30"),f=e.ref(!0),p=e.computed(()=>"best30"===d.value?c.value:l.value);e.onMounted(()=>{h()});const h=()=>{try{const e=uni.getStorageSync("ptt_data");if(e&&(n.value=e.currentPTT||0,o.value=e.best10Avg||0,i.value=e.best30Avg||0,a.value=e.recent10Avg||0,e.lastUpdated)){const t=new Date(e.lastUpdated);s.value=y(t)}const t=uni.getStorageSync("best30_records")||[];c.value=t;const r=uni.getStorageSync("recent_scores")||[];l.value=r;const d=uni.getStorageSync("songs_data")||[];u.value=d.length}catch(e){t("error","at pages/data/data.vue:281","åŠ è½½æ•°æ®å¤±è´¥",e)}},m=()=>{f.value=!f.value},y=e=>{e.getFullYear();return`${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")} ${String(e.getHours()).padStart(2,"0")}:${String(e.getMinutes()).padStart(2,"0")}`},v=()=>{try{let e=0,t=0,r=0,u=0;if(c.value.length>0){r=c.value.reduce((e,t)=>e+t.ptt,0)/c.value.length;const e=[...c.value].sort((e,t)=>t.ptt-e.ptt).slice(0,10);t=e.reduce((e,t)=>e+t.ptt,0)/e.length}if(l.value.length>0){u=l.value.reduce((e,t)=>e+t.ptt,0)/l.value.length}e=.75*t+.25*u,n.value=e,o.value=t,i.value=r,a.value=u,s.value=y(new Date);const d={currentPTT:e,best10Avg:t,best30Avg:r,recent10Avg:u,lastUpdated:Date.now()};uni.setStorageSync("ptt_data",d),uni.showToast({title:"åˆ·æ–°æˆåŠŸ",icon:"success"})}catch(e){t("error","at pages/data/data.vue:352","åˆ·æ–°PTTå¤±è´¥",e),uni.showToast({title:"åˆ·æ–°å¤±è´¥",icon:"none"})}},g=e=>{d.value=e},b=()=>{try{const e={best30Records:c.value,recentRecords:l.value,pttData:{currentPTT:n.value,best10Avg:o.value,best30Avg:i.value,recent10Avg:a.value},exportTime:(new Date).toISOString(),version:"1.0.0",type:"full-export"},r=JSON.stringify(e,null,2),s=`arcaea-ptt-full-backup-${Date.now()}.json`,u=uni.getFileSystemManager(),d=`${uni.env.USER_DATA_PATH}/${s}`;u.writeFile({filePath:d,data:r,encoding:"utf8",success:()=>{uni.showModal({title:"å¯¼å‡ºæˆåŠŸ",content:`æ•°æ®å·²å¯¼å‡ºåˆ°: ${d}`,showCancel:!1}),uni.showToast({title:"å¯¼å‡ºæˆåŠŸ",icon:"success"})},fail:e=>{t("error","at pages/data/data.vue:422","å¯¼å‡ºå¤±è´¥",e),uni.showToast({title:"å¯¼å‡ºå¤±è´¥",icon:"none"})}})}catch(e){t("error","at pages/data/data.vue:430","å¯¼å‡ºæ•°æ®å¤±è´¥",e),uni.showToast({title:"å¯¼å‡ºå¤±è´¥",icon:"none"})}},w=()=>{uni.chooseFile({count:1,type:"file",success:e=>{const r=e.tempFilePaths;if(r&&r.length>0){uni.getFileSystemManager().readFile({filePath:r[0],encoding:"utf8",success:e=>{try{const t=JSON.parse(e.data);if("full-export"===t.type){if(t.best30Records&&Array.isArray(t.best30Records)&&(c.value=t.best30Records,uni.setStorageSync("best30_records",t.best30Records)),t.recentRecords&&Array.isArray(t.recentRecords)&&(l.value=t.recentRecords,uni.setStorageSync("recent_scores",t.recentRecords)),t.pttData){if(n.value=t.pttData.currentPTT||0,o.value=t.pttData.best10Avg||0,i.value=t.pttData.best30Avg||0,a.value=t.pttData.recent10Avg||0,t.pttData.lastUpdated){const e=new Date(t.pttData.lastUpdated);s.value=y(e)}uni.setStorageSync("ptt_data",{currentPTT:n.value,best10Avg:o.value,best30Avg:i.value,recent10Avg:a.value,lastUpdated:t.pttData.lastUpdated||Date.now()})}uni.showToast({title:"å¯¼å…¥æˆåŠŸ",icon:"success"})}else t.best30Records&&Array.isArray(t.best30Records)?(c.value=t.best30Records,uni.setStorageSync("best30_records",t.best30Records),v(),uni.showToast({title:"å¯¼å…¥æˆåŠŸ",icon:"success"})):uni.showToast({title:"æ•°æ®æ ¼å¼ä¸æ­£ç¡®",icon:"none"})}catch(r){t("error","at pages/data/data.vue:507","è§£ææ•°æ®å¤±è´¥",r),uni.showToast({title:"è§£ææ•°æ®å¤±è´¥",icon:"none"})}},fail:e=>{t("error","at pages/data/data.vue:515","è¯»å–æ–‡ä»¶å¤±è´¥",e),uni.showToast({title:"è¯»å–æ–‡ä»¶å¤±è´¥",icon:"none"})}})}}})},E=()=>{uni.showModal({title:"æç¤º",content:"æ˜¯å¦ä»äº‘ç«¯åŒæ­¥æ•°æ®ï¼Ÿæ­¤åŠŸèƒ½éœ€è¦ç™»å½•äº‘å¼€å‘ç¯å¢ƒã€‚",success:e=>{e.confirm&&uni.showToast({title:"åŒæ­¥åŠŸèƒ½å¼€å‘ä¸­",icon:"none"})}})},_=()=>{uni.showModal({title:"ç¡®è®¤æ¸…ç©º",content:"ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ï¼",success:e=>{e.confirm&&S()}})},S=()=>{try{uni.removeStorageSync("best30_records"),uni.removeStorageSync("recent_scores"),uni.removeStorageSync("ptt_data"),n.value=0,o.value=0,i.value=0,a.value=0,c.value=[],l.value=[],s.value="æœªçŸ¥",uni.showToast({title:"å·²æ¸…ç©ºæ‰€æœ‰æ•°æ®",icon:"success"})}catch(e){t("error","at pages/data/data.vue:579","æ¸…ç©ºæ•°æ®å¤±è´¥",e),uni.showToast({title:"æ¸…ç©ºå¤±è´¥",icon:"none"})}},x=()=>{uni.switchTab({url:"/pages/best30/best30"})},N=e=>({pst:"PAST",prs:"PRESENT",ftr:"FUTURE",byd:"BEYOND",etr:"ETERNAL"}[e]||e.toUpperCase()),I=e=>Math.min(e/13*100,100),T=e=>`${e.toFixed(2)} / ${13..toFixed(1)}`,O=e=>0===e?"rank-first":1===e?"rank-second":2===e?"rank-third":"";return(r,h)=>{return e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"card overview-card"},[e.createElementVNode("view",{class:"ptt-overview"},[e.createElementVNode("view",{class:"ptt-value-container"},[e.createElementVNode("view",{class:"ptt-value"},[e.createElementVNode("text",{class:"value"},e.toDisplayString(n.value.toFixed(2)),1),e.createElementVNode("text",{class:"label"},"å½“å‰PTT")]),e.createElementVNode("view",{class:"ptt-indicator"},[e.createElementVNode("text",{class:"indicator-text"},e.toDisplayString((y=n.value,y>=12.5?"å®šæ•°ä¸Šé™":y>=12?"é¡¶çº§ç©å®¶":y>=11?"é«˜æ‰‹ç©å®¶":y>=10?"è¿›é˜¶ç©å®¶":y>=9?"æ™®é€šç©å®¶":y>=8?"å…¥é—¨ç©å®¶":"æ–°æ‰‹ç©å®¶")),1)])]),e.createElementVNode("view",{class:"ptt-stats"},[e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(o.value.toFixed(2)),1),e.createElementVNode("text",{class:"stat-label"},"B10å¹³å‡")]),e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(i.value.toFixed(2)),1),e.createElementVNode("text",{class:"stat-label"},"B30å¹³å‡")]),e.createElementVNode("view",{class:"stat-item"},[e.createElementVNode("text",{class:"stat-value"},e.toDisplayString(a.value.toFixed(2)),1),e.createElementVNode("text",{class:"stat-label"},"R10å¹³å‡")])])]),e.createElementVNode("view",{class:"ptt-progress"},[e.createElementVNode("view",{class:"progress-bar"},[e.createElementVNode("view",{class:"progress-fill",style:e.normalizeStyle({width:I(n.value)+"%"})},null,4)]),e.createElementVNode("text",{class:"progress-text"},e.toDisplayString(T(n.value)),1)]),e.createElementVNode("view",{class:"overview-actions"},[e.createElementVNode("button",{class:"refresh-btn",onClick:v},[e.createElementVNode("text",{class:"refresh-icon"},"ğŸ”„"),e.createElementVNode("text",{class:"refresh-text"},"åˆ·æ–°æ•°æ®")])])]),e.createElementVNode("view",{class:"actions"},[e.createElementVNode("button",{class:"action-btn secondary",onClick:b},[e.createElementVNode("view",{class:"btn-content"},[e.createElementVNode("text",{class:"btn-icon"},"ğŸ“¤"),e.createElementVNode("text",{class:"btn-text"},"å¯¼å‡ºå…¨éƒ¨")])]),e.createElementVNode("button",{class:"action-btn secondary",onClick:w},[e.createElementVNode("view",{class:"btn-content"},[e.createElementVNode("text",{class:"btn-icon"},"ğŸ“¥"),e.createElementVNode("text",{class:"btn-text"},"å¯¼å…¥æ•°æ®")])]),e.createElementVNode("button",{class:"action-btn secondary",onClick:E},[e.createElementVNode("view",{class:"btn-content"},[e.createElementVNode("text",{class:"btn-icon"},"ğŸ”„"),e.createElementVNode("text",{class:"btn-text"},"åŒæ­¥æ•°æ®")])]),e.createElementVNode("button",{class:"action-btn danger",onClick:_},[e.createElementVNode("view",{class:"btn-content"},[e.createElementVNode("text",{class:"btn-icon"},"ğŸ—‘ï¸"),e.createElementVNode("text",{class:"btn-text"},"æ¸…ç©ºæ•°æ®")])])]),e.createElementVNode("view",{class:"card stats-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"æ•°æ®ç»Ÿè®¡"),e.createElementVNode("view",{class:"stats-toggle",onClick:m},[e.createElementVNode("text",{class:"toggle-icon"},e.toDisplayString(f.value?"â–¼":"â–¶"),1)])]),e.createElementVNode("view",{class:e.normalizeClass(["stats-grid",{expanded:f.value}])},[e.createElementVNode("view",{class:e.normalizeClass(["stat-card",{highlight:c.value.length>0}])},[e.createElementVNode("view",{class:"stat-icon"},"ğŸ†"),e.createElementVNode("text",{class:"stat-number"},e.toDisplayString(c.value.length),1),e.createElementVNode("text",{class:"stat-label"},"B30è®°å½•")],2),e.createElementVNode("view",{class:e.normalizeClass(["stat-card",{highlight:l.value.length>0}])},[e.createElementVNode("view",{class:"stat-icon"},"ğŸ“Š"),e.createElementVNode("text",{class:"stat-number"},e.toDisplayString(l.value.length),1),e.createElementVNode("text",{class:"stat-label"},"æœ€è¿‘è®°å½•")],2),e.createElementVNode("view",{class:e.normalizeClass(["stat-card",{highlight:u.value>0}])},[e.createElementVNode("view",{class:"stat-icon"},"ğŸµ"),e.createElementVNode("text",{class:"stat-number"},e.toDisplayString(u.value),1),e.createElementVNode("text",{class:"stat-label"},"æ­Œæ›²æ€»æ•°")],2),e.createElementVNode("view",{class:"stat-card"},[e.createElementVNode("view",{class:"stat-icon"},"â°"),e.createElementVNode("text",{class:"stat-number"},e.toDisplayString(s.value),1),e.createElementVNode("text",{class:"stat-label"},"æœ€åæ›´æ–°")])],2)]),e.createElementVNode("view",{class:"tabs-container"},[e.createElementVNode("view",{class:"tabs"},[e.createElementVNode("view",{class:e.normalizeClass(["tab-item",{active:"best30"===d.value}]),onClick:h[0]||(h[0]=e=>g("best30"))},[e.createElementVNode("text",{class:"tab-icon"},"ğŸ†"),e.createElementVNode("text",{class:"tab-text"},"B30è®°å½•"),e.createElementVNode("view",{class:"tab-count"},e.toDisplayString(c.value.length),1),e.createElementVNode("view",{class:"tab-indicator"})],2),e.createElementVNode("view",{class:e.normalizeClass(["tab-item",{active:"recent"===d.value}]),onClick:h[1]||(h[1]=e=>g("recent"))},[e.createElementVNode("text",{class:"tab-icon"},"ğŸ“Š"),e.createElementVNode("text",{class:"tab-text"},"æœ€è¿‘è®°å½•"),e.createElementVNode("view",{class:"tab-count"},e.toDisplayString(l.value.length),1),e.createElementVNode("view",{class:"tab-indicator"})],2)])]),e.createElementVNode("view",{class:"card records-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},e.toDisplayString("best30"===d.value?"B30è®°å½•":"æœ€è¿‘è®°å½•")+" ("+e.toDisplayString(p.value.length)+") ",1)]),p.value.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"records-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.value,(r,n)=>{return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["record-item",{"top-record":n<3}]),key:n},[e.createElementVNode("view",{class:e.normalizeClass(["record-rank",O(n)])},e.toDisplayString(n+1),3),e.createElementVNode("view",{class:"song-info"},[e.createElementVNode("text",{class:"song-name"},e.toDisplayString(r.songName),1),e.createElementVNode("view",{class:"song-meta"},[e.createElementVNode("text",{class:e.normalizeClass(["song-difficulty",(i=r.difficulty,{pst:"difficulty-pst",prs:"difficulty-prs",ftr:"difficulty-ftr",byd:"difficulty-byd",etr:"difficulty-etr"}[i]||"")])},e.toDisplayString(N(r.difficulty)),3),e.createElementVNode("text",{class:"song-constant"},e.toDisplayString(r.constant),1)])]),e.createElementVNode("view",{class:"record-details"},[e.createElementVNode("text",{class:"record-score"},e.toDisplayString(r.score.toLocaleString()),1),e.createElementVNode("view",{class:"record-stats"},[e.createElementVNode("text",{class:"record-ptt"},"PTT "+e.toDisplayString(r.ptt.toFixed(2)),1),e.createElementVNode("view",{class:"record-rating-container"},[e.createElementVNode("text",{class:e.normalizeClass(["record-rating",(o=r.rating,{PM:"rating-pm","EX+":"rating-ex-plus",EX:"rating-ex",AA:"rating-aa",A:"rating-a",B:"rating-b",C:"rating-c",D:"rating-d"}[o]||"")])},e.toDisplayString(r.rating),3)])])]),e.createElementVNode("view",{class:"record-actions"},[e.createElementVNode("button",{class:"action-btn-small edit-btn",onClick:e=>(e=>{p.value[e],"best30"===d.value?uni.navigateTo({url:`/pages/best30/add?edit=${e}`}):uni.showModal({title:"æç¤º",content:"æœ€è¿‘è®°å½•æ— æ³•ç›´æ¥ç¼–è¾‘ï¼Œæ‚¨å¯ä»¥åœ¨B30é¡µé¢ä¸­ç¼–è¾‘ã€‚",showCancel:!1})})(n)},[e.createElementVNode("text",{class:"action-icon"},"âœï¸")],8,["onClick"]),e.createElementVNode("button",{class:"action-btn-small delete-btn",onClick:e=>(e=>{const r=p.value[e];uni.showModal({title:"ç¡®è®¤åˆ é™¤",content:`ç¡®å®šè¦åˆ é™¤ã€Š${r.songName}ã€‹çš„è®°å½•å—ï¼Ÿ`,success:r=>{if(r.confirm)try{"best30"===d.value?(c.value.splice(e,1),uni.setStorageSync("best30_records",c.value),v()):(l.value.splice(e,1),uni.setStorageSync("recent_scores",l.value),v()),uni.showToast({title:"å·²åˆ é™¤",icon:"success"})}catch(n){t("error","at pages/data/data.vue:640","åˆ é™¤è®°å½•å¤±è´¥",n),uni.showToast({title:"åˆ é™¤å¤±è´¥",icon:"none"})}}})})(n)},[e.createElementVNode("text",{class:"action-icon"},"ğŸ—‘ï¸")],8,["onClick"])])],2);var o,i}),128))])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty-state"},[e.createElementVNode("view",{class:"empty-illustration"},[e.createElementVNode("view",{class:"empty-circle"},[e.createElementVNode("text",{class:"empty-icon"},e.toDisplayString("best30"===d.value?"ğŸ†":"ğŸ“Š"),1)])]),e.createElementVNode("view",{class:"empty-content"},[e.createElementVNode("text",{class:"empty-title"},e.toDisplayString("best30"===d.value?"è¿˜æ²¡æœ‰B30è®°å½•":"è¿˜æ²¡æœ‰æœ€è¿‘æˆç»©"),1),e.createElementVNode("text",{class:"empty-subtitle"},e.toDisplayString("best30"===d.value?"å¼€å§‹è®°å½•æ‚¨çš„æœ€ä½³æˆç»©ï¼Œæ„å»ºæ‚¨çš„B30åˆ—è¡¨":"è®°å½•æ‚¨æœ€è¿‘çš„æ¸¸æˆæˆç»©ï¼Œè¿½è¸ªPTTå˜åŒ–"),1),e.createElementVNode("view",{class:"empty-stats"},[e.createElementVNode("view",{class:"empty-stat-item"},[e.createElementVNode("text",{class:"stat-number"},"0"),e.createElementVNode("text",{class:"stat-label"},e.toDisplayString("best30"===d.value?"æœ€ä½³è®°å½•":"æœ€è¿‘è®°å½•"),1)]),e.createElementVNode("view",{class:"empty-stat-divider"}),e.createElementVNode("view",{class:"empty-stat-item"},[e.createElementVNode("text",{class:"stat-number"},"0.00"),e.createElementVNode("text",{class:"stat-label"},"å¹³å‡PTT")])]),e.createElementVNode("button",{class:"empty-btn",onClick:x},[e.createElementVNode("text",{class:"empty-btn-text"},"å»æ·»åŠ æˆç»©"),e.createElementVNode("text",{class:"empty-btn-icon"},"â†’")])])]))])]);var y}}}),[["__scopeId","data-v-e29ed498"]]),I=a(e.defineComponent({__name:"about",setup(t){const r=()=>{uni.setClipboardData({data:"https://github.com/hopedloki/-arcaea-ptt-calculator",success:()=>{uni.showToast({title:"é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿",icon:"success"})}})},n=()=>{uni.showModal({title:"æç¤º",content:"è¯·è®¿é—®GitHubä»“åº“æäº¤Issueï¼š\nhttps://github.com/hopedloki/-arcaea-ptt-calculator/issues",confirmText:"å¤åˆ¶é“¾æ¥",success:e=>{e.confirm&&uni.setClipboardData({data:"https://github.com/hopedloki/-arcaea-ptt-calculator/issues",success:()=>{uni.showToast({title:"é“¾æ¥å·²å¤åˆ¶",icon:"success"})}})}})},o=()=>{uni.setClipboardData({data:"example@example.com",success:()=>{uni.showToast({title:"é‚®ç®±å·²å¤åˆ¶",icon:"success"})}})};return(t,i)=>(e.openBlock(),e.createElementBlock("view",{class:"container"},[e.createElementVNode("view",{class:"card app-info-card"},[e.createElementVNode("view",{class:"app-icon"},[e.createElementVNode("image",{class:"icon",src:"/static/logo.png",mode:"aspectFit"})]),e.createElementVNode("text",{class:"app-name"},"Arcaea PTTè®¡ç®—å™¨"),e.createElementVNode("text",{class:"app-version"},"ç‰ˆæœ¬ 1.0.0"),e.createElementVNode("text",{class:"app-desc"},"ä¸“ä¸ºArcaeaç©å®¶è®¾è®¡çš„PTTè®¡ç®—å’Œç®¡ç†å·¥å…·")]),e.createElementVNode("view",{class:"card features-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"ä¸»è¦åŠŸèƒ½")]),e.createElementVNode("view",{class:"features-list"},[e.createElementVNode("view",{class:"feature-item"},[e.createElementVNode("text",{class:"feature-icon"},"ğŸ§®"),e.createElementVNode("text",{class:"feature-text"},"æˆç»©ä¸PTTåŒå‘è½¬æ¢è®¡ç®—")]),e.createElementVNode("view",{class:"feature-item"},[e.createElementVNode("text",{class:"feature-icon"},"âš–ï¸"),e.createElementVNode("text",{class:"feature-text"},"è¯„çº§å®¹é”™å’Œåˆ†æ•°å®¹é”™è®¡ç®—")]),e.createElementVNode("view",{class:"feature-item"},[e.createElementVNode("text",{class:"feature-icon"},"ğŸ“‹"),e.createElementVNode("text",{class:"feature-text"},"B30æˆç»©ç®¡ç†å’Œç»Ÿè®¡")]),e.createElementVNode("view",{class:"feature-item"},[e.createElementVNode("text",{class:"feature-icon"},"ğŸµ"),e.createElementVNode("text",{class:"feature-text"},"å†…ç½®å®Œæ•´æ­Œæ›²æ•°æ®åº“")]),e.createElementVNode("view",{class:"feature-item"},[e.createElementVNode("text",{class:"feature-icon"},"ğŸ“Š"),e.createElementVNode("text",{class:"feature-text"},"PTTæ¦‚è§ˆå’Œæ•°æ®ç»Ÿè®¡")]),e.createElementVNode("view",{class:"feature-item"},[e.createElementVNode("text",{class:"feature-icon"},"ğŸ’¾"),e.createElementVNode("text",{class:"feature-text"},"æ•°æ®å¯¼å…¥å¯¼å‡ºå’Œå¤‡ä»½")])])]),e.createElementVNode("view",{class:"card formula-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"PTTè®¡ç®—å…¬å¼")]),e.createElementVNode("view",{class:"formula-list"},[e.createElementVNode("view",{class:"formula-item"},[e.createElementVNode("text",{class:"formula-condition"},"â‰¥10,000,000åˆ†"),e.createElementVNode("text",{class:"formula-result"},"å®šæ•° + 2.0")]),e.createElementVNode("view",{class:"formula-item"},[e.createElementVNode("text",{class:"formula-condition"},"9,900,000-9,999,999åˆ†"),e.createElementVNode("text",{class:"formula-result"},"å®šæ•° + 1.5 + (å¾—åˆ†-9,900,000)/100,000")]),e.createElementVNode("view",{class:"formula-item"},[e.createElementVNode("text",{class:"formula-condition"},"9,800,000-9,899,999åˆ†"),e.createElementVNode("text",{class:"formula-result"},"å®šæ•° + 1.0 + (å¾—åˆ†-9,800,000)/400,000")]),e.createElementVNode("view",{class:"formula-item"},[e.createElementVNode("text",{class:"formula-condition"},"â‰¤9,800,000åˆ†"),e.createElementVNode("text",{class:"formula-result"},"å®šæ•° + (å¾—åˆ†-9,500,000)/300,000")])])]),e.createElementVNode("view",{class:"card dev-info-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"å¼€å‘ä¿¡æ¯")]),e.createElementVNode("view",{class:"info-list"},[e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"info-label"},"å¼€å‘æ¡†æ¶"),e.createElementVNode("text",{class:"info-value"},"UniApp")]),e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"info-label"},"åŸé¡¹ç›®"),e.createElementVNode("text",{class:"info-value",onClick:r},"hopedloki/-arcaea-ptt-calculator")]),e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"info-label"},"é‡æ„æ—¥æœŸ"),e.createElementVNode("text",{class:"info-value"},"2025-12-14")]),e.createElementVNode("view",{class:"info-item"},[e.createElementVNode("text",{class:"info-label"},"è®¸å¯è¯"),e.createElementVNode("text",{class:"info-value"},"MIT")])])]),e.createElementVNode("view",{class:"card thanks-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"è‡´è°¢")]),e.createElementVNode("view",{class:"thanks-content"},[e.createElementVNode("text",{class:"thanks-text"},"æ„Ÿè°¢ä»¥ä¸‹é¡¹ç›®å’Œè´¡çŒ®è€…ï¼š"),e.createElementVNode("view",{class:"thanks-list"},[e.createElementVNode("text",{class:"thanks-item"},"â€¢ åŸç‰ˆArcaea PTTè®¡ç®—å™¨çš„å¼€å‘è€…hopedloki"),e.createElementVNode("text",{class:"thanks-item"},"â€¢ Arcaeaæ¸¸æˆå®˜æ–¹å›¢é˜Ÿ"),e.createElementVNode("text",{class:"thanks-item"},"â€¢ UniAppå¼€å‘å›¢é˜Ÿ"),e.createElementVNode("text",{class:"thanks-item"},"â€¢ æ‰€æœ‰ä½¿ç”¨å’Œåé¦ˆæœ¬åº”ç”¨çš„ç”¨æˆ·")])])]),e.createElementVNode("view",{class:"card feedback-card"},[e.createElementVNode("view",{class:"card-header"},[e.createElementVNode("text",{class:"card-title"},"åé¦ˆå’Œå»ºè®®")]),e.createElementVNode("view",{class:"feedback-content"},[e.createElementVNode("text",{class:"feedback-text"},"å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜ã€å»ºè®®æˆ–å‘ç°é”™è¯¯ï¼Œæ¬¢è¿é€šè¿‡ä»¥ä¸‹æ–¹å¼åé¦ˆï¼š"),e.createElementVNode("view",{class:"feedback-actions"},[e.createElementVNode("button",{class:"feedback-btn",onClick:n},"GitHub Issues"),e.createElementVNode("button",{class:"feedback-btn",onClick:o},"å¤åˆ¶é‚®ç®±")])])]),e.createElementVNode("view",{class:"footer"},[e.createElementVNode("text",{class:"copyright"},"Â© 2025 Arcaea PTTè®¡ç®—å™¨"),e.createElementVNode("text",{class:"disclaimer"},"æœ¬åº”ç”¨éå®˜æ–¹ï¼Œä¸Arcaeaæ¸¸æˆå¼€å‘å•†æ— å…³è”")])]))}}),[["__scopeId","data-v-b2c0cf14"]]);__definePage("pages/index/index",s),__definePage("pages/calculator/score-ptt",c),__definePage("pages/calculator/tolerance",l),__definePage("pages/best30/best30",u),__definePage("pages/best30/add",d),__definePage("pages/songs/songs",x),__definePage("pages/data/data",N),__definePage("pages/about/about",I);var T="@cloudbase/js-sdk";function O(){return T}var A="https:";var R,P,C="https://support.qq.com/products/148793",k={INVALID_PARAMS:"INVALID_PARAMS",INVALID_OPERATION:"INVALID_OPERATION",OPERATION_FAIL:"OPERATION_FAIL"};(P=R||(R={})).local="local",P.none="none",P.session="session";var V=function(){return function(){}}(),L=function(){return function(){}}();function U(e,t,r){void 0===r&&(r={});var n=/\?/.test(t),o="";for(var i in r)""===o?!n&&(t+="?"):o+="&",o+=i+"="+encodeURIComponent(r[i]);return/^http(s)?\:\/\//.test(t+=o)?t:""+e+t}const D=Object.freeze(Object.defineProperty({__proto__:null,AbstractSDKRequest:V,AbstractStorage:L,get StorageType(){return R},formatUrl:U},Symbol.toStringTag,{value:"Module"}));function j(e){return"[object Array]"===Object.prototype.toString.call(e)}function M(e){return"string"==typeof e}function q(e){return"[object FormData]"===Object.prototype.toString.call(e)}function B(){var e=(new Date).getTime(),t=(null===Date||void 0===Date?void 0:Date.now)&&1e3*Date.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var n=16*Math.random();return e>0?(n=(e+n)%16|0,e=Math.floor(e/16)):(n=(t+n)%16|0,t=Math.floor(t/16)),("x"===r?n:7&n|8).toString(16)})}function F(e,t,r){void 0===r&&(r={});var n=/\?/.test(t),o="";return Object.keys(r).forEach(function(e){""===o?!n&&(t+="?"):o+="&",o+="".concat(e,"=").concat(encodeURIComponent(r[e]))}),/^http(s)?:\/\//.test(t+=o)?t:"".concat(e).concat(t)}function W(e,t,r){if(void 0===r&&(r=null),e&&"function"==typeof e)return e(t,r);if(t)throw t;return r}function H(e,t){console.warn("[".concat(O(),"][").concat(e,"]:").concat(t))}var G=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),$=function(){return $=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},$.apply(this,arguments)},z=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},K=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},J=function(e){function t(t){var r=e.call(this)||this,n=t.timeout,o=t.timeoutMsg,i=t.restrictedMethods;return r.timeout=n||0,r.timeoutMsg=o||"è¯·æ±‚è¶…æ—¶",r.restrictedMethods=i||["get","post","upload","download"],r}return G(t,e),t.prototype.get=function(e){return this.request($($({},e),{method:"get"}),this.restrictedMethods.includes("get"))},t.prototype.post=function(e){return this.request($($({},e),{method:"post"}),this.restrictedMethods.includes("post"))},t.prototype.put=function(e){return this.request($($({},e),{method:"put"}))},t.prototype.upload=function(e){var t=e.data,r=e.file,n=e.name,o=e.method,i=e.headers,a=void 0===i?{}:i,s={post:"post",put:"put"}[null==o?void 0:o.toLowerCase()]||"put",c=new FormData;return"post"===s?(Object.keys(t).forEach(function(e){c.append(e,t[e])}),c.append("key",n),c.append("file",r),this.request($($({},e),{data:c,method:s}),this.restrictedMethods.includes("upload"))):this.request($($({},e),{method:"put",headers:a,body:r}),this.restrictedMethods.includes("upload"))},t.prototype.download=function(e){return z(this,void 0,void 0,function(){var t,r,n,o;return K(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.get($($({},e),{headers:{},responseType:"blob"}))];case 1:return t=i.sent().data,r=window.URL.createObjectURL(new Blob([t])),n=decodeURIComponent(new URL(e.url).pathname.split("/").pop()||""),(o=document.createElement("a")).href=r,o.setAttribute("download",n),o.style.display="none",document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(r),document.body.removeChild(o),[3,3];case 2:return i.sent(),[3,3];case 3:return[2,new Promise(function(t){t({statusCode:200,tempFilePath:e.url})})]}})})},t.prototype.fetch=function(e){var t;return z(this,void 0,void 0,function(){var r,n,o,i,a,s,c,l,u,d,f,p,h,m=this;return K(this,function(y){switch(y.label){case 0:return r=new AbortController,n=e.url,o=e.enableAbort,i=void 0!==o&&o,a=e.stream,s=void 0!==a&&a,c=e.signal,l=e.timeout,u=e.shouldThrowOnError,d=void 0===u||u,f=null!=l?l:this.timeout,c&&(c.aborted&&r.abort(),c.addEventListener("abort",function(){return r.abort()})),p=null,i&&f&&(p=setTimeout(function(){console.warn(m.timeoutMsg),r.abort(new Error(m.timeoutMsg))},f)),[4,fetch(n,$($({},e),{signal:r.signal})).then(function(e){return z(m,void 0,void 0,function(){var t,r,n;return K(this,function(o){switch(o.label){case 0:return clearTimeout(p),d?e.ok?(t=e,[3,3]):[3,1]:[3,4];case 1:return n=(r=Promise).reject,[4,e.json()];case 2:t=n.apply(r,[o.sent()]),o.label=3;case 3:return[2,t];case 4:return[2,e]}})})}).catch(function(e){if(clearTimeout(p),d)return Promise.reject(e)})];case 1:return h=y.sent(),[2,{data:s?h.body:(null===(t=h.headers.get("content-type"))||void 0===t?void 0:t.includes("application/json"))?h.json():h.text(),statusCode:h.status,header:h.headers}]}})})},t.prototype.request=function(e,t){var r=this;void 0===t&&(t=!1);var n=String(e.method).toLowerCase()||"get";return new Promise(function(o){var i,a,s=e.url,c=e.headers,l=void 0===c?{}:c,u=e.data,d=e.responseType,f=e.withCredentials,p=e.body,h=e.onUploadProgress,m=F(A,s,"get"===n?u:{}),y=new XMLHttpRequest;y.open(n,m),d&&(y.responseType=d),Object.keys(l).forEach(function(e){y.setRequestHeader(e,l[e])}),h&&y.upload.addEventListener("progress",h),y.onreadystatechange=function(){var e={};if(4===y.readyState){var t=y.getAllResponseHeaders().trim().split(/[\r\n]+/),r={};t.forEach(function(e){var t=e.split(": "),n=t.shift().toLowerCase(),o=t.join(": ");r[n]=o}),e.header=r,e.statusCode=y.status;try{e.data="blob"===d?y.response:JSON.parse(y.responseText)}catch(n){e.data="blob"===d?y.response:y.responseText}clearTimeout(i),o(e)}},t&&r.timeout&&(i=setTimeout(function(){console.warn(r.timeoutMsg),y.abort()},r.timeout)),a=q(u)?u:"application/x-www-form-urlencoded"===l["content-type"]?function(e){void 0===e&&(e={});var t=[];return Object.keys(e).forEach(function(r){t.push("".concat(r,"=").concat(encodeURIComponent(e[r])))}),t.join("&")}(u):p||(u?JSON.stringify(u):void 0),f&&(y.withCredentials=!0),y.send(a)})},t}(V);var Y,X,Q=function(){return Q=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Q.apply(this,arguments)};(X=Y||(Y={})).WEB="web",X.WX_MP="wx_mp";var Z={},ee=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),te=function(e,t,r,n){return new(r||(r=Promise))(function(t,o){function i(e){try{s(n.next(e))}catch(t){o(t)}}function a(e){try{s(n.throw(e))}catch(t){o(t)}}function s(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r(function(e){e(n)})).then(i,a)}s((n=n.apply(e,[])).next())})},re=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ne=function(e){function t(t){var r=e.call(this)||this;return r.root=t,t.tcbCacheObject||(t.tcbCacheObject={}),r}return ee(t,e),t.prototype.setItem=function(e,t){this.root.tcbCacheObject[e]=t},t.prototype.getItem=function(e){return this.root.tcbCacheObject[e]},t.prototype.removeItem=function(e){delete this.root.tcbCacheObject[e]},t.prototype.clear=function(){delete this.root.tcbCacheObject},t}(L);var oe=function(){function e(e){this.keys={};var t=e.persistence,r=e.platformInfo,n=void 0===r?{}:r,o=e.keys,i=void 0===o?{}:o;this.platformInfo=n,this.storage||(this.persistenceTag=this.platformInfo.adapter.primaryStorage||t,this.storage=function(e,t){switch(e){case"local":default:return t.localStorage?t.localStorage:(H(k.INVALID_PARAMS,"localStorage is not supported on current platform"),new ne(t.root));case"none":return new ne(t.root)}}(this.persistenceTag,this.platformInfo.adapter),this.keys=i)}return Object.defineProperty(e.prototype,"mode",{get:function(){return this.storage.mode||"sync"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"persistence",{get:function(){return this.persistenceTag},enumerable:!1,configurable:!0}),e.prototype.setStore=function(e,t,r){if("async"!==this.mode){if(this.storage)try{var n={version:r||"localCachev1",content:t};this.storage.setItem(e,JSON.stringify(n))}catch(o){throw new Error(JSON.stringify({code:k.OPERATION_FAIL,msg:"[".concat(O(),"][").concat(k.OPERATION_FAIL,"]setStore failed"),info:o}))}}else H(k.INVALID_OPERATION,"current platform's storage is asynchronous, please use setStoreAsync insteed")},e.prototype.setStoreAsync=function(e,t,r){return te(this,0,void 0,function(){var n;return re(this,function(o){switch(o.label){case 0:if(!this.storage)return[2];o.label=1;case 1:return o.trys.push([1,3,,4]),n={version:r||"localCachev1",content:t},[4,this.storage.setItem(e,JSON.stringify(n))];case 2:return o.sent(),[3,4];case 3:return o.sent(),[2];case 4:return[2]}})})},e.prototype.getStore=function(e,t){var r;if("async"!==this.mode){try{if("undefined"!=typeof process&&(null===(r=Z)||void 0===r?void 0:r.tcb_token))return Z.tcb_token;if(!this.storage)return""}catch(o){return""}t=t||"localCachev1";var n=this.storage.getItem(e);return n&&n.indexOf(t)>=0?JSON.parse(n).content:""}H(k.INVALID_OPERATION,"current platform's storage is asynchronous, please use getStoreAsync insteed")},e.prototype.getStoreAsync=function(e,t){var r;return te(this,0,void 0,function(){var n;return re(this,function(o){switch(o.label){case 0:try{if("undefined"!=typeof process&&(null===(r=Z)||void 0===r?void 0:r.tcb_token))return[2,Z.tcb_token];if(!this.storage)return[2,""]}catch(i){return[2,""]}return t=t||"localCachev1",[4,this.storage.getItem(e)];case 1:return(n=o.sent())&&n.indexOf(t)>=0?[2,JSON.parse(n).content]:[2,""]}})})},e.prototype.removeStore=function(e){"async"!==this.mode?this.storage.removeItem(e):H(k.INVALID_OPERATION,"current platform's storage is asynchronous, please use removeStoreAsync insteed")},e.prototype.removeStoreAsync=function(e){return te(this,0,void 0,function(){return re(this,function(t){switch(t.label){case 0:return[4,this.storage.removeItem(e)];case 1:return t.sent(),[2]}})})},e}(),ie=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();var ae=function(){return function(e,t){this.data=t||null,this.name=e}}(),se=function(e){function t(t,r){var n=e.call(this,"error",{error:t,data:r})||this;return n.error=t,n}return ie(t,e),t}(ae),ce=function(){function e(){this.listeners={}}return e.prototype.on=function(e,t){return function(e,t,r){r[e]=r[e]||[],r[e].push(t)}(e,t,this.listeners),this},e.prototype.off=function(e,t){return function(e,t,r){if(null==r?void 0:r[e]){var n=r[e].indexOf(t);-1!==n&&r[e].splice(n,1)}}(e,t,this.listeners),this},e.prototype.fire=function(e,t){if(e instanceof se)return console.error(e.error),this;var r=M(e)?new ae(e,t||{}):e,n=r.name;if(this.listens(n)){r.target=this;for(var o=this.listeners[n]?function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}([],this.listeners[n],!0):[],i=0,a=o;i<a.length;i++){a[i].call(this,r)}}return this},e.prototype.listens=function(e){return this.listeners[e]&&this.listeners[e].length>0},e}(),le=new ce,ue="lang_change";function de(e){return e.mode,e.customInfo,e.title,e.messages,function(e,t,r){}}function fe(e){this.message=e}function pe(e){this.message=e}"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.indexOf("Firefox"),fe.prototype=new Error,fe.prototype.name="InvalidCharacterError","undefined"!=typeof window&&window.atob&&window.atob.bind(window),pe.prototype=new Error,pe.prototype.name="InvalidTokenError";var he=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},me=k,ye={};function ve(e,t){var r=t.name,n=t.namespace,o=t.entity,i=t.injectEvents,a=t.IIFE,s=void 0!==a&&a;if(ye[r]||n&&e[n])throw new Error(JSON.stringify({code:me.INVALID_OPERATION,msg:"Duplicate component ".concat(r)}));if(s){if(!o||"function"!=typeof o)throw new Error(JSON.stringify({code:me.INVALID_PARAMS,msg:"IIFE component's entity must be a function"}));o.call(e)}if(ye[r]=t,n?e.prototype[n]=o:ge(e.prototype,o),i){var c=i.bus,l=i.events;if(!c||!l||0===l.length)return;var u=e.prototype.fire||function(){};e.prototype.events||(e.prototype.events={}),(e.prototype.events||{})[r]?e.prototype.events[r].events=he(he([],e.prototype.events[r].events,!0),l,!0):e.prototype.events[r]={bus:c,events:l},e.prototype.fire=function(e,t){u(e,t);for(var r=0,n=Object.keys(this.events);r<n.length;r++){var o=n[r],i=this.events[o],a=i.bus;if(i.events.includes(e)){a.fire(e,t);break}}}}}function ge(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var r=0,n=Object.keys(t);r<n.length;r++){var o=n[r];Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=ge(e[o],t[o]))}return e}
/**
   * @license
   * web-streams-polyfill v4.2.0
   * Copyright 2025 Mattias Buelens, Diwank Singh Tomer and other contributors.
   * This code is released under the MIT license.
   * SPDX-License-Identifier: MIT
   */
function be(){}function we(e){return"object"==typeof e&&null!==e||"function"==typeof e}const Ee=be;function _e(e,t){try{Object.defineProperty(e,"name",{value:t,configurable:!0})}catch(r){}}const Se=Promise,xe=Promise.resolve.bind(Se),Ne=Promise.prototype.then,Ie=Promise.reject.bind(Se),Te=xe;function Oe(e){return new Se(e)}function Ae(e){return Oe(t=>t(e))}function Re(e){return Ie(e)}function Pe(e,t,r){return Ne.call(e,t,r)}function Ce(e,t,r){Pe(Pe(e,t,r),void 0,Ee)}function ke(e,t){Ce(e,t)}function Ve(e,t){Ce(e,void 0,t)}function Le(e,t,r){return Pe(e,t,r)}function Ue(e){Pe(e,void 0,Ee)}let De=e=>{if("function"==typeof queueMicrotask)De=queueMicrotask;else{const e=Ae(void 0);De=t=>Pe(e,t)}return De(e)};function je(e,t,r){if("function"!=typeof e)throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,r)}function Me(e,t,r){try{return Ae(je(e,t,r))}catch(n){return Re(n)}}class qe{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(e){const t=this._back;let r=t;16383===t._elements.length&&(r={_elements:[],_next:void 0}),t._elements.push(e),r!==t&&(this._back=r,t._next=r),++this._size}shift(){const e=this._front;let t=e;const r=this._cursor;let n=r+1;const o=e._elements,i=o[r];return 16384===n&&(t=e._next,n=0),--this._size,this._cursor=n,e!==t&&(this._front=t),o[r]=void 0,i}forEach(e){let t=this._cursor,r=this._front,n=r._elements;for(;!(t===n.length&&void 0===r._next||t===n.length&&(r=r._next,n=r._elements,t=0,0===n.length));)e(n[t]),++t}peek(){const e=this._front,t=this._cursor;return e._elements[t]}}const Be=Symbol("[[AbortSteps]]"),Fe=Symbol("[[ErrorSteps]]"),We=Symbol("[[CancelSteps]]"),He=Symbol("[[PullSteps]]"),Ge=Symbol("[[ReleaseSteps]]");function $e(e,t){var r;e._ownerReadableStream=t,t._reader=e,"readable"===t._state?Ye(e):"closed"===t._state?(Ye(r=e),Ze(r)):Xe(e,t._storedError)}function ze(e,t){return ro(e._ownerReadableStream,t)}function Ke(e){const t=e._ownerReadableStream;"readable"===t._state?Qe(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):Xe(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),t._readableStreamController[Ge](),t._reader=void 0,e._ownerReadableStream=void 0}function Je(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function Ye(e){e._closedPromise=Oe((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r})}function Xe(e,t){Ye(e),Qe(e,t)}function Qe(e,t){void 0!==e._closedPromise_reject&&(Ue(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function Ze(e){void 0!==e._closedPromise_resolve&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}const et=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},tt=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function rt(e,t){if(void 0!==e&&"object"!=typeof(r=e)&&"function"!=typeof r)throw new TypeError(`${t} is not an object.`);var r}function nt(e,t){if("function"!=typeof e)throw new TypeError(`${t} is not a function.`)}function ot(e,t){if(!function(e){return"object"==typeof e&&null!==e||"function"==typeof e}(e))throw new TypeError(`${t} is not an object.`)}function it(e,t,r){if(void 0===e)throw new TypeError(`Parameter ${t} is required in '${r}'.`)}function at(e,t,r){if(void 0===e)throw new TypeError(`${t} is required in '${r}'.`)}function st(e){return Number(e)}function ct(e){return 0===e?0:e}function lt(e,t){const r=Number.MAX_SAFE_INTEGER;let n=Number(e);if(n=ct(n),!et(n))throw new TypeError(`${t} is not a finite number`);if(n=ct(tt(n)),n<0||n>r)throw new TypeError(`${t} is outside the accepted range of 0 to ${r}, inclusive`);return et(n)&&0!==n?n:0}function ut(e,t){if(!eo(e))throw new TypeError(`${t} is not a ReadableStream.`)}function dt(e){return new yt(e)}function ft(e,t){e._reader._readRequests.push(t)}function pt(e,t,r){const n=e._reader._readRequests.shift();r?n._closeSteps():n._chunkSteps(t)}function ht(e){return e._reader._readRequests.length}function mt(e){const t=e._reader;return void 0!==t&&!!vt(t)}class yt{constructor(e){if(it(e,1,"ReadableStreamDefaultReader"),ut(e,"First parameter"),to(e))throw new TypeError("This stream has already been locked for exclusive reading by another reader");$e(this,e),this._readRequests=new qe}get closed(){return vt(this)?this._closedPromise:Re(wt("closed"))}cancel(e=void 0){return vt(this)?void 0===this._ownerReadableStream?Re(Je("cancel")):ze(this,e):Re(wt("cancel"))}read(){if(!vt(this))return Re(wt("read"));if(void 0===this._ownerReadableStream)return Re(Je("read from"));let e,t;const r=Oe((r,n)=>{e=r,t=n});return gt(this,{_chunkSteps:t=>e({value:t,done:!1}),_closeSteps:()=>e({value:void 0,done:!0}),_errorSteps:e=>t(e)}),r}releaseLock(){if(!vt(this))throw wt("releaseLock");void 0!==this._ownerReadableStream&&function(e){Ke(e);bt(e,new TypeError("Reader was released"))}(this)}}function vt(e){return!!we(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readRequests")&&e instanceof yt}function gt(e,t){const r=e._ownerReadableStream;r._disturbed=!0,"closed"===r._state?t._closeSteps():"errored"===r._state?t._errorSteps(r._storedError):r._readableStreamController[He](t)}function bt(e,t){const r=e._readRequests;e._readRequests=new qe,r.forEach(e=>{e._errorSteps(t)})}function wt(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}var Et,_t,St;function xt(e){return e.slice()}function Nt(e,t,r,n,o){new Uint8Array(e).set(new Uint8Array(r,n,o),t)}Object.defineProperties(yt.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),_e(yt.prototype.cancel,"cancel"),_e(yt.prototype.read,"read"),_e(yt.prototype.releaseLock,"releaseLock"),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(yt.prototype,Symbol.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});let It=e=>(It="function"==typeof e.transfer?e=>e.transfer():"function"==typeof structuredClone?e=>structuredClone(e,{transfer:[e]}):e=>e,It(e)),Tt=e=>(Tt="boolean"==typeof e.detached?e=>e.detached:e=>0===e.byteLength,Tt(e));function Ot(e,t,r){if(e.slice)return e.slice(t,r);const n=r-t,o=new ArrayBuffer(n);return Nt(o,0,e,t,n),o}function At(e,t){const r=e[t];if(null!=r){if("function"!=typeof r)throw new TypeError(`${String(t)} is not a function`);return r}}function Rt(e){try{const t=e.done,r=e.value;return Pe(Te(r),e=>({done:t,value:e}))}catch(t){return Re(t)}}const Pt=null!==(St=null!==(Et=Symbol.asyncIterator)&&void 0!==Et?Et:null===(_t=Symbol.for)||void 0===_t?void 0:_t.call(Symbol,"Symbol.asyncIterator"))&&void 0!==St?St:"@@asyncIterator";function Ct(e,t="sync",r){if(void 0===r)if("async"===t){if(void 0===(r=At(e,Pt)))return function(e){const t={next(){let t;try{t=kt(e)}catch(r){return Re(r)}return Rt(t)},return(t){let r;try{const n=At(e.iterator,"return");if(void 0===n)return Ae({done:!0,value:t});r=je(n,e.iterator,[t])}catch(n){return Re(n)}return we(r)?Rt(r):Re(new TypeError("The iterator.return() method must return an object"))}};return{iterator:t,nextMethod:t.next,done:!1}}(Ct(e,"sync",At(e,Symbol.iterator)))}else r=At(e,Symbol.iterator);if(void 0===r)throw new TypeError("The object is not iterable");const n=je(r,e,[]);if(!we(n))throw new TypeError("The iterator method must return an object");return{iterator:n,nextMethod:n.next,done:!1}}function kt(e){const t=je(e.nextMethod,e.iterator,[]);if(!we(t))throw new TypeError("The iterator.next() method must return an object");return t}class Vt{constructor(e,t){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=e,this._preventCancel=t}next(){const e=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?Le(this._ongoingPromise,e,e):e(),this._ongoingPromise}return(e){const t=()=>this._returnSteps(e);return this._ongoingPromise=this._ongoingPromise?Le(this._ongoingPromise,t,t):t(),this._ongoingPromise}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});const e=this._reader;let t,r;const n=Oe((e,n)=>{t=e,r=n});return gt(e,{_chunkSteps:e=>{this._ongoingPromise=void 0,De(()=>t({value:e,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,Ke(e),t({value:void 0,done:!0})},_errorSteps:t=>{this._ongoingPromise=void 0,this._isFinished=!0,Ke(e),r(t)}}),n}_returnSteps(e){if(this._isFinished)return Promise.resolve({value:e,done:!0});this._isFinished=!0;const t=this._reader;if(!this._preventCancel){const r=ze(t,e);return Ke(t),Le(r,()=>({value:e,done:!0}))}return Ke(t),Ae({value:e,done:!0})}}const Lt={next(){return Ut(this)?this._asyncIteratorImpl.next():Re(Dt("next"))},return(e){return Ut(this)?this._asyncIteratorImpl.return(e):Re(Dt("return"))},[Pt](){return this}};function Ut(e){if(!we(e))return!1;if(!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof Vt}catch(t){return!1}}function Dt(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}Object.defineProperty(Lt,Pt,{enumerable:!1});const jt=Number.isNaN||function(e){return e!=e};function Mt(e){const t=Ot(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(t)}function qt(e){const t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value}function Bt(e,t,r){if("number"!=typeof(n=r)||jt(n)||n<0||r===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");var n;e._queue.push({value:t,size:r}),e._queueTotalSize+=r}function Ft(e){e._queue=new qe,e._queueTotalSize=0}function Wt(e){return e===DataView}class Ht{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!zt(this))throw br("view");return this._view}respond(e){if(!zt(this))throw br("respond");if(it(e,1,"respond"),e=lt(e,"First parameter"),void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");if(Tt(this._view.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be used as a response");yr(this._associatedReadableByteStreamController,e)}respondWithNewView(e){if(!zt(this))throw br("respondWithNewView");if(it(e,1,"respondWithNewView"),!ArrayBuffer.isView(e))throw new TypeError("You can only respond with array buffer views");if(void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");if(Tt(e.buffer))throw new TypeError("The given view's buffer has been detached and so cannot be used as a response");vr(this._associatedReadableByteStreamController,e)}}Object.defineProperties(Ht.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),_e(Ht.prototype.respond,"respond"),_e(Ht.prototype.respondWithNewView,"respondWithNewView"),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(Ht.prototype,Symbol.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class Gt{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!$t(this))throw wr("byobRequest");return hr(this)}get desiredSize(){if(!$t(this))throw wr("desiredSize");return mr(this)}close(){if(!$t(this))throw wr("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");const e=this._controlledReadableByteStream._state;if("readable"!==e)throw new TypeError(`The stream (in ${e} state) is not in the readable state and cannot be closed`);ur(this)}enqueue(e){if(!$t(this))throw wr("enqueue");if(it(e,1,"enqueue"),!ArrayBuffer.isView(e))throw new TypeError("chunk must be an array buffer view");if(0===e.byteLength)throw new TypeError("chunk must have non-zero byteLength");if(0===e.buffer.byteLength)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");const t=this._controlledReadableByteStream._state;if("readable"!==t)throw new TypeError(`The stream (in ${t} state) is not in the readable state and cannot be enqueued to`);dr(this,e)}error(e=void 0){if(!$t(this))throw wr("error");fr(this,e)}[We](e){Jt(this),Ft(this);const t=this._cancelAlgorithm(e);return lr(this),t}[He](e){const t=this._controlledReadableByteStream;if(this._queueTotalSize>0)return void pr(this,e);const r=this._autoAllocateChunkSize;if(void 0!==r){let t;try{t=new ArrayBuffer(r)}catch(n){return void e._errorSteps(n)}const o={buffer:t,bufferByteLength:r,byteOffset:0,byteLength:r,bytesFilled:0,minimumFill:1,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(o)}ft(t,e),Kt(this)}[Ge](){if(this._pendingPullIntos.length>0){const e=this._pendingPullIntos.peek();e.readerType="none",this._pendingPullIntos=new qe,this._pendingPullIntos.push(e)}}}function $t(e){return!!we(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")&&e instanceof Gt}function zt(e){return!!we(e)&&!!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")&&e instanceof Ht}function Kt(e){(function(e){const t=e._controlledReadableByteStream;if("readable"!==t._state)return!1;if(e._closeRequested)return!1;if(!e._started)return!1;if(mt(t)&&ht(t)>0)return!0;if(Nr(t)&&xr(t)>0)return!0;return mr(e)>0})(e)&&(e._pulling?e._pullAgain=!0:(e._pulling=!0,Ce(e._pullAlgorithm(),()=>(e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Kt(e)),null),t=>(fr(e,t),null))))}function Jt(e){ir(e),e._pendingPullIntos=new qe}function Yt(e,t){let r=!1;"closed"===e._state&&(r=!0);const n=Qt(t);"default"===t.readerType?pt(e,n,r):function(e,t,r){const n=e._reader._readIntoRequests.shift();r?n._closeSteps(t):n._chunkSteps(t)}(e,n,r)}function Xt(e,t){for(let r=0;r<t.length;++r)Yt(e,t[r])}function Qt(e){const t=e.bytesFilled,r=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,t/r)}function Zt(e,t,r,n){e._queue.push({buffer:t,byteOffset:r,byteLength:n}),e._queueTotalSize+=n}function er(e,t,r,n){let o;try{o=Ot(t,r,r+n)}catch(i){throw fr(e,i),i}Zt(e,o,0,n)}function tr(e,t){t.bytesFilled>0&&er(e,t.buffer,t.byteOffset,t.bytesFilled),cr(e)}function rr(e,t){const r=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),n=t.bytesFilled+r;let o=r,i=!1;const a=n-n%t.elementSize;a>=t.minimumFill&&(o=a-t.bytesFilled,i=!0);const s=e._queue;for(;o>0;){const r=s.peek(),n=Math.min(o,r.byteLength),i=t.byteOffset+t.bytesFilled;Nt(t.buffer,i,r.buffer,r.byteOffset,n),r.byteLength===n?s.shift():(r.byteOffset+=n,r.byteLength-=n),e._queueTotalSize-=n,nr(e,n,t),o-=n}return i}function nr(e,t,r){r.bytesFilled+=t}function or(e){0===e._queueTotalSize&&e._closeRequested?(lr(e),no(e._controlledReadableByteStream)):Kt(e)}function ir(e){null!==e._byobRequest&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function ar(e){const t=[];for(;e._pendingPullIntos.length>0&&0!==e._queueTotalSize;){const r=e._pendingPullIntos.peek();rr(e,r)&&(cr(e),t.push(r))}return t}function sr(e,t){const r=e._pendingPullIntos.peek();ir(e),"closed"===e._controlledReadableByteStream._state?function(e,t){"none"===t.readerType&&cr(e);const r=e._controlledReadableByteStream;if(Nr(r)){const t=[];for(;t.length<xr(r);)t.push(cr(e));Xt(r,t)}}(e,r):function(e,t,r){if(nr(0,t,r),"none"===r.readerType){tr(e,r);const t=ar(e);return void Xt(e._controlledReadableByteStream,t)}if(r.bytesFilled<r.minimumFill)return;cr(e);const n=r.bytesFilled%r.elementSize;if(n>0){const t=r.byteOffset+r.bytesFilled;er(e,r.buffer,t-n,n)}r.bytesFilled-=n;const o=ar(e);Yt(e._controlledReadableByteStream,r),Xt(e._controlledReadableByteStream,o)}(e,t,r),Kt(e)}function cr(e){return e._pendingPullIntos.shift()}function lr(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function ur(e){const t=e._controlledReadableByteStream;if(!e._closeRequested&&"readable"===t._state)if(e._queueTotalSize>0)e._closeRequested=!0;else{if(e._pendingPullIntos.length>0){const t=e._pendingPullIntos.peek();if(t.bytesFilled%t.elementSize!==0){const t=new TypeError("Insufficient bytes to fill elements in the given buffer");throw fr(e,t),t}}lr(e),no(t)}}function dr(e,t){const r=e._controlledReadableByteStream;if(e._closeRequested||"readable"!==r._state)return;const{buffer:n,byteOffset:o,byteLength:i}=t;if(Tt(n))throw new TypeError("chunk's buffer is detached and so cannot be enqueued");const a=It(n);if(e._pendingPullIntos.length>0){const t=e._pendingPullIntos.peek();if(Tt(t.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be filled with an enqueued chunk");ir(e),t.buffer=It(t.buffer),"none"===t.readerType&&tr(e,t)}mt(r)?(function(e){const t=e._controlledReadableByteStream._reader;for(;t._readRequests.length>0;){if(0===e._queueTotalSize)return;pr(e,t._readRequests.shift())}}(e),0===ht(r)?Zt(e,a,o,i):(e._pendingPullIntos.length>0&&cr(e),pt(r,new Uint8Array(a,o,i),!1))):Nr(r)?(Zt(e,a,o,i),Xt(r,ar(e))):Zt(e,a,o,i),Kt(e)}function fr(e,t){const r=e._controlledReadableByteStream;"readable"===r._state&&(Jt(e),Ft(e),lr(e),oo(r,t))}function pr(e,t){const r=e._queue.shift();e._queueTotalSize-=r.byteLength,or(e);const n=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);t._chunkSteps(n)}function hr(e){if(null===e._byobRequest&&e._pendingPullIntos.length>0){const o=e._pendingPullIntos.peek(),i=new Uint8Array(o.buffer,o.byteOffset+o.bytesFilled,o.byteLength-o.bytesFilled),a=Object.create(Ht.prototype);r=e,n=i,(t=a)._associatedReadableByteStreamController=r,t._view=n,e._byobRequest=a}var t,r,n;return e._byobRequest}function mr(e){const t=e._controlledReadableByteStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function yr(e,t){const r=e._pendingPullIntos.peek();if("closed"===e._controlledReadableByteStream._state){if(0!==t)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(0===t)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(r.bytesFilled+t>r.byteLength)throw new RangeError("bytesWritten out of range")}r.buffer=It(r.buffer),sr(e,t)}function vr(e,t){const r=e._pendingPullIntos.peek();if("closed"===e._controlledReadableByteStream._state){if(0!==t.byteLength)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(0===t.byteLength)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(r.byteOffset+r.bytesFilled!==t.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(r.bufferByteLength!==t.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(r.bytesFilled+t.byteLength>r.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");const n=t.byteLength;r.buffer=It(t.buffer),sr(e,n)}function gr(e,t,r,n,o,i,a){t._controlledReadableByteStream=e,t._pullAgain=!1,t._pulling=!1,t._byobRequest=null,t._queue=t._queueTotalSize=void 0,Ft(t),t._closeRequested=!1,t._started=!1,t._strategyHWM=i,t._pullAlgorithm=n,t._cancelAlgorithm=o,t._autoAllocateChunkSize=a,t._pendingPullIntos=new qe,e._readableStreamController=t,Ce(Ae(r()),()=>(t._started=!0,Kt(t),null),e=>(fr(t,e),null))}function br(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function wr(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function Er(e,t){if("byob"!=(e=`${e}`))throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function _r(e){return new Ir(e)}function Sr(e,t){e._reader._readIntoRequests.push(t)}function xr(e){return e._reader._readIntoRequests.length}function Nr(e){const t=e._reader;return void 0!==t&&!!Tr(t)}Object.defineProperties(Gt.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),_e(Gt.prototype.close,"close"),_e(Gt.prototype.enqueue,"enqueue"),_e(Gt.prototype.error,"error"),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(Gt.prototype,Symbol.toStringTag,{value:"ReadableByteStreamController",configurable:!0});class Ir{constructor(e){if(it(e,1,"ReadableStreamBYOBReader"),ut(e,"First parameter"),to(e))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!$t(e._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");$e(this,e),this._readIntoRequests=new qe}get closed(){return Tr(this)?this._closedPromise:Re(Rr("closed"))}cancel(e=void 0){return Tr(this)?void 0===this._ownerReadableStream?Re(Je("cancel")):ze(this,e):Re(Rr("cancel"))}read(e,t={}){if(!Tr(this))return Re(Rr("read"));if(!ArrayBuffer.isView(e))return Re(new TypeError("view must be an array buffer view"));if(0===e.byteLength)return Re(new TypeError("view must have non-zero byteLength"));if(0===e.buffer.byteLength)return Re(new TypeError("view's buffer must have non-zero byteLength"));if(Tt(e.buffer))return Re(new TypeError("view's buffer has been detached"));let r;try{rt(n=t,o="options"),r={min:lt(null!==(i=null==n?void 0:n.min)&&void 0!==i?i:1,`${o} has member 'min' that`)}}catch(n){return Re(n)}var n,o,i;const a=r.min;if(0===a)return Re(new TypeError("options.min must be greater than 0"));if(function(e){return Wt(e.constructor)}(e)){if(a>e.byteLength)return Re(new RangeError("options.min must be less than or equal to view's byteLength"))}else if(a>e.length)return Re(new RangeError("options.min must be less than or equal to view's length"));if(void 0===this._ownerReadableStream)return Re(Je("read from"));let s,c;const l=Oe((e,t)=>{s=e,c=t});return Or(this,e,a,{_chunkSteps:e=>s({value:e,done:!1}),_closeSteps:e=>s({value:e,done:!0}),_errorSteps:e=>c(e)}),l}releaseLock(){if(!Tr(this))throw Rr("releaseLock");void 0!==this._ownerReadableStream&&function(e){Ke(e);Ar(e,new TypeError("Reader was released"))}(this)}}function Tr(e){return!!we(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")&&e instanceof Ir}function Or(e,t,r,n){const o=e._ownerReadableStream;o._disturbed=!0,"errored"===o._state?n._errorSteps(o._storedError):function(e,t,r,n){const o=e._controlledReadableByteStream,i=t.constructor,a=Wt(u=i)?1:u.BYTES_PER_ELEMENT,{byteOffset:s,byteLength:c}=t,l=r*a;var u;let d;try{d=It(t.buffer)}catch(u){return void n._errorSteps(u)}const f={buffer:d,bufferByteLength:d.byteLength,byteOffset:s,byteLength:c,bytesFilled:0,minimumFill:l,elementSize:a,viewConstructor:i,readerType:"byob"};if(e._pendingPullIntos.length>0)return e._pendingPullIntos.push(f),void Sr(o,n);if("closed"===o._state){const e=new i(f.buffer,f.byteOffset,0);return void n._closeSteps(e)}if(e._queueTotalSize>0){if(rr(e,f)){const t=Qt(f);return or(e),void n._chunkSteps(t)}if(e._closeRequested){const t=new TypeError("Insufficient bytes to fill elements in the given buffer");return fr(e,t),void n._errorSteps(t)}}e._pendingPullIntos.push(f),Sr(o,n),Kt(e)}(o._readableStreamController,t,r,n)}function Ar(e,t){const r=e._readIntoRequests;e._readIntoRequests=new qe,r.forEach(e=>{e._errorSteps(t)})}function Rr(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function Pr(e,t){const{highWaterMark:r}=e;if(void 0===r)return t;if(jt(r)||r<0)throw new RangeError("Invalid highWaterMark");return r}function Cr(e){const{size:t}=e;return t||(()=>1)}function kr(e,t){rt(e,t);const r=null==e?void 0:e.highWaterMark,n=null==e?void 0:e.size;return{highWaterMark:void 0===r?void 0:st(r),size:void 0===n?void 0:Vr(n,`${t} has member 'size' that`)}}function Vr(e,t){return nt(e,t),t=>st(e(t))}function Lr(e,t,r){return nt(e,r),r=>Me(e,t,[r])}function Ur(e,t,r){return nt(e,r),()=>Me(e,t,[])}function Dr(e,t,r){return nt(e,r),r=>je(e,t,[r])}function jr(e,t,r){return nt(e,r),(r,n)=>Me(e,t,[r,n])}function Mr(e,t){if(!Wr(e))throw new TypeError(`${t} is not a WritableStream.`)}Object.defineProperties(Ir.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),_e(Ir.prototype.cancel,"cancel"),_e(Ir.prototype.read,"read"),_e(Ir.prototype.releaseLock,"releaseLock"),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(Ir.prototype,Symbol.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});class qr{constructor(e={},t={}){void 0===e?e=null:ot(e,"First parameter");const r=kr(t,"Second parameter"),n=function(e,t){rt(e,t);const r=null==e?void 0:e.abort,n=null==e?void 0:e.close,o=null==e?void 0:e.start,i=null==e?void 0:e.type,a=null==e?void 0:e.write;return{abort:void 0===r?void 0:Lr(r,e,`${t} has member 'abort' that`),close:void 0===n?void 0:Ur(n,e,`${t} has member 'close' that`),start:void 0===o?void 0:Dr(o,e,`${t} has member 'start' that`),write:void 0===a?void 0:jr(a,e,`${t} has member 'write' that`),type:i}}(e,"First parameter");if(Fr(this),void 0!==n.type)throw new RangeError("Invalid type is specified");const o=Cr(r);!function(e,t,r,n){const o=Object.create(sn.prototype);let i,a,s,c;i=void 0!==t.start?()=>t.start(o):()=>{},a=void 0!==t.write?e=>t.write(e,o):()=>Ae(void 0),s=void 0!==t.close?()=>t.close():()=>Ae(void 0),c=void 0!==t.abort?e=>t.abort(e):()=>Ae(void 0),ln(e,o,i,a,s,c,r,n)}(this,n,Pr(r,1),o)}get locked(){if(!Wr(this))throw yn("locked");return Hr(this)}abort(e=void 0){return Wr(this)?Hr(this)?Re(new TypeError("Cannot abort a stream that already has a writer")):Gr(this,e):Re(yn("abort"))}close(){return Wr(this)?Hr(this)?Re(new TypeError("Cannot close a stream that already has a writer")):Yr(this)?Re(new TypeError("Cannot close an already-closing stream")):$r(this):Re(yn("close"))}getWriter(){if(!Wr(this))throw yn("getWriter");return Br(this)}}function Br(e){return new Zr(e)}function Fr(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new qe,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function Wr(e){return!!we(e)&&!!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")&&e instanceof qr}function Hr(e){return void 0!==e._writer}function Gr(e,t){var r;if("closed"===e._state||"errored"===e._state)return Ae(void 0);e._writableStreamController._abortReason=t,null===(r=e._writableStreamController._abortController)||void 0===r||r.abort(t);const n=e._state;if("closed"===n||"errored"===n)return Ae(void 0);if(void 0!==e._pendingAbortRequest)return e._pendingAbortRequest._promise;let o=!1;"erroring"===n&&(o=!0,t=void 0);const i=Oe((r,n)=>{e._pendingAbortRequest={_promise:void 0,_resolve:r,_reject:n,_reason:t,_wasAlreadyErroring:o}});return e._pendingAbortRequest._promise=i,o||Kr(e,t),i}function $r(e){const t=e._state;if("closed"===t||"errored"===t)return Re(new TypeError(`The stream (in ${t} state) is not in the writable state and cannot be closed`));const r=Oe((t,r)=>{const n={_resolve:t,_reject:r};e._closeRequest=n}),n=e._writer;var o;return void 0!==n&&e._backpressure&&"writable"===t&&On(n),Bt(o=e._writableStreamController,an,0),fn(o),r}function zr(e,t){"writable"!==e._state?Jr(e):Kr(e,t)}function Kr(e,t){const r=e._writableStreamController;e._state="erroring",e._storedError=t;const n=e._writer;var o;void 0!==n&&rn(n,t),void 0===(o=e)._inFlightWriteRequest&&void 0===o._inFlightCloseRequest&&r._started&&Jr(e)}function Jr(e){e._state="errored",e._writableStreamController[Fe]();const t=e._storedError;if(e._writeRequests.forEach(e=>{e._reject(t)}),e._writeRequests=new qe,void 0===e._pendingAbortRequest)return void Xr(e);const r=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,r._wasAlreadyErroring)return r._reject(t),void Xr(e);Ce(e._writableStreamController[Be](r._reason),()=>(r._resolve(),Xr(e),null),t=>(r._reject(t),Xr(e),null))}function Yr(e){return void 0!==e._closeRequest||void 0!==e._inFlightCloseRequest}function Xr(e){void 0!==e._closeRequest&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);const t=e._writer;void 0!==t&&_n(t,e._storedError)}function Qr(e,t){const r=e._writer;void 0!==r&&t!==e._backpressure&&(t?xn(r):On(r)),e._backpressure=t}Object.defineProperties(qr.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),_e(qr.prototype.abort,"abort"),_e(qr.prototype.close,"close"),_e(qr.prototype.getWriter,"getWriter"),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(qr.prototype,Symbol.toStringTag,{value:"WritableStream",configurable:!0});class Zr{constructor(e){if(it(e,1,"WritableStreamDefaultWriter"),Mr(e,"First parameter"),Hr(e))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=e,e._writer=this;const t=e._state;if("writable"===t)!Yr(e)&&e._backpressure?xn(this):In(this),wn(this);else if("erroring"===t)Nn(this,e._storedError),wn(this);else if("closed"===t)In(this),wn(this),Sn(this);else{const t=e._storedError;Nn(this,t),En(this,t)}}get closed(){return en(this)?this._closedPromise:Re(gn("closed"))}get desiredSize(){if(!en(this))throw gn("desiredSize");if(void 0===this._ownerWritableStream)throw bn("desiredSize");return function(e){const t=e._ownerWritableStream,r=t._state;return"errored"===r||"erroring"===r?null:"closed"===r?0:dn(t._writableStreamController)}(this)}get ready(){return en(this)?this._readyPromise:Re(gn("ready"))}abort(e=void 0){return en(this)?void 0===this._ownerWritableStream?Re(bn("abort")):(t=e,Gr(this._ownerWritableStream,t)):Re(gn("abort"));var t}close(){if(!en(this))return Re(gn("close"));const e=this._ownerWritableStream;return void 0===e?Re(bn("close")):Yr(e)?Re(new TypeError("Cannot close an already-closing stream")):tn(this)}releaseLock(){if(!en(this))throw gn("releaseLock");void 0!==this._ownerWritableStream&&nn(this)}write(e=void 0){return en(this)?void 0===this._ownerWritableStream?Re(bn("write to")):on(this,e):Re(gn("write"))}}function en(e){return!!we(e)&&!!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")&&e instanceof Zr}function tn(e){return $r(e._ownerWritableStream)}function rn(e,t){"pending"===e._readyPromiseState?Tn(e,t):Nn(e,t)}function nn(e){const t=e._ownerWritableStream,r=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");rn(e,r),function(e,t){"pending"===e._closedPromiseState?_n(e,t):En(e,t)}(e,r),t._writer=void 0,e._ownerWritableStream=void 0}function on(e,t){const r=e._ownerWritableStream,n=r._writableStreamController,o=function(e,t){if(void 0===e._strategySizeAlgorithm)return 1;try{return e._strategySizeAlgorithm(t)}catch(r){return pn(e,r),1}}(n,t);if(r!==e._ownerWritableStream)return Re(bn("write to"));const i=r._state;if("errored"===i)return Re(r._storedError);if(Yr(r)||"closed"===i)return Re(new TypeError("The stream is closing or closed and cannot be written to"));if("erroring"===i)return Re(r._storedError);const a=(s=r,Oe((e,t)=>{const r={_resolve:e,_reject:t};s._writeRequests.push(r)}));var s;return function(e,t,r){try{Bt(e,t,r)}catch(o){return void pn(e,o)}const n=e._controlledWritableStream;Yr(n)||"writable"!==n._state||Qr(n,hn(e)),fn(e)}(n,t,o),a}Object.defineProperties(Zr.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),_e(Zr.prototype.abort,"abort"),_e(Zr.prototype.close,"close"),_e(Zr.prototype.releaseLock,"releaseLock"),_e(Zr.prototype.write,"write"),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(Zr.prototype,Symbol.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});const an={};class sn{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!cn(this))throw vn("abortReason");return this._abortReason}get signal(){if(!cn(this))throw vn("signal");if(void 0===this._abortController)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(e=void 0){if(!cn(this))throw vn("error");"writable"===this._controlledWritableStream._state&&mn(this,e)}[Be](e){const t=this._abortAlgorithm(e);return un(this),t}[Fe](){Ft(this)}}function cn(e){return!!we(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")&&e instanceof sn}function ln(e,t,r,n,o,i,a,s){t._controlledWritableStream=e,e._writableStreamController=t,t._queue=void 0,t._queueTotalSize=void 0,Ft(t),t._abortReason=void 0,t._abortController=function(){if("function"==typeof AbortController)return new AbortController}(),t._started=!1,t._strategySizeAlgorithm=s,t._strategyHWM=a,t._writeAlgorithm=n,t._closeAlgorithm=o,t._abortAlgorithm=i;const c=hn(t);Qr(e,c),Ce(Ae(r()),()=>(t._started=!0,fn(t),null),r=>(t._started=!0,zr(e,r),null))}function un(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function dn(e){return e._strategyHWM-e._queueTotalSize}function fn(e){const t=e._controlledWritableStream;if(!e._started)return;if(void 0!==t._inFlightWriteRequest)return;if("erroring"===t._state)return void Jr(t);if(0===e._queue.length)return;const r=e._queue.peek().value;r===an?function(e){const t=e._controlledWritableStream;var r;(r=t)._inFlightCloseRequest=r._closeRequest,r._closeRequest=void 0,qt(e);const n=e._closeAlgorithm();un(e),Ce(n,()=>(function(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,"erroring"===e._state&&(e._storedError=void 0,void 0!==e._pendingAbortRequest&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";const t=e._writer;void 0!==t&&Sn(t)}(t),null),e=>{return n=e,(r=t)._inFlightCloseRequest._reject(n),r._inFlightCloseRequest=void 0,void 0!==r._pendingAbortRequest&&(r._pendingAbortRequest._reject(n),r._pendingAbortRequest=void 0),zr(r,n),null;var r,n})}(e):function(e,t){const r=e._controlledWritableStream;var n;(n=r)._inFlightWriteRequest=n._writeRequests.shift();Ce(e._writeAlgorithm(t),()=>{!function(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}(r);const t=r._state;if(qt(e),!Yr(r)&&"writable"===t){const t=hn(e);Qr(r,t)}return fn(e),null},t=>("writable"===r._state&&un(e),function(e,t){e._inFlightWriteRequest._reject(t),e._inFlightWriteRequest=void 0,zr(e,t)}(r,t),null))}(e,r)}function pn(e,t){"writable"===e._controlledWritableStream._state&&mn(e,t)}function hn(e){return dn(e)<=0}function mn(e,t){const r=e._controlledWritableStream;un(e),Kr(r,t)}function yn(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function vn(e){return new TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function gn(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function bn(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function wn(e){e._closedPromise=Oe((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r,e._closedPromiseState="pending"})}function En(e,t){wn(e),_n(e,t)}function _n(e,t){void 0!==e._closedPromise_reject&&(Ue(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function Sn(e){void 0!==e._closedPromise_resolve&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function xn(e){e._readyPromise=Oe((t,r)=>{e._readyPromise_resolve=t,e._readyPromise_reject=r}),e._readyPromiseState="pending"}function Nn(e,t){xn(e),Tn(e,t)}function In(e){xn(e),On(e)}function Tn(e,t){void 0!==e._readyPromise_reject&&(Ue(e._readyPromise),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function On(e){void 0!==e._readyPromise_resolve&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}Object.defineProperties(sn.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(sn.prototype,Symbol.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});const An="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof global?global:void 0,Rn=function(){const e=null==An?void 0:An.DOMException;return function(e){if("function"!=typeof e&&"object"!=typeof e)return!1;if("DOMException"!==e.name)return!1;try{return new e,!0}catch(t){return!1}}(e)?e:void 0}()||function(){const e=function(e,t){this.message=e||"",this.name=t||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return _e(e,"DOMException"),e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}();function Pn(e,t,r,n,o,i){const a=dt(e),s=Br(t);e._disturbed=!0;let c=!1,l=Ae(void 0);return Oe((u,d)=>{let f;if(void 0!==i){if(f=()=>{const r=void 0!==i.reason?i.reason:new Rn("Aborted","AbortError"),a=[];n||a.push(()=>"writable"===t._state?Gr(t,r):Ae(void 0)),o||a.push(()=>"readable"===e._state?ro(e,r):Ae(void 0)),g(()=>Promise.all(a.map(e=>e())),!0,r)},i.aborted)return void f();i.addEventListener("abort",f)}var p,h,m;if(v(e,a._closedPromise,e=>(n?b(!0,e):g(()=>Gr(t,e),!0,e),null)),v(t,s._closedPromise,t=>(o?b(!0,t):g(()=>ro(e,t),!0,t),null)),p=e,h=a._closedPromise,m=()=>(r?b():g(()=>function(e){const t=e._ownerWritableStream,r=t._state;return Yr(t)||"closed"===r?Ae(void 0):"errored"===r?Re(t._storedError):tn(e)}(s)),null),"closed"===p._state?m():ke(h,m),Yr(t)||"closed"===t._state){const t=new TypeError("the destination writable stream closed before all data could be piped to it");o?b(!0,t):g(()=>ro(e,t),!0,t)}function y(){const e=l;return Pe(l,()=>e!==l?y():void 0)}function v(e,t,r){"errored"===e._state?r(e._storedError):Ve(t,r)}function g(e,r,n){function o(){return Ce(e(),()=>w(r,n),e=>w(!0,e)),null}c||(c=!0,"writable"!==t._state||Yr(t)?o():ke(y(),o))}function b(e,r){c||(c=!0,"writable"!==t._state||Yr(t)?w(e,r):ke(y(),()=>w(e,r)))}function w(e,t){return nn(s),Ke(a),void 0!==i&&i.removeEventListener("abort",f),e?d(t):u(void 0),null}Ue(Oe((e,t)=>{!function r(n){n?e():Pe(c?Ae(!0):Pe(s._readyPromise,()=>Oe((e,t)=>{gt(a,{_chunkSteps:t=>{l=Pe(on(s,t),void 0,be),e(!1)},_closeSteps:()=>e(!0),_errorSteps:t})})),r,t)}(!1)}))})}class Cn{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!kn(this))throw Wn("desiredSize");return qn(this)}close(){if(!kn(this))throw Wn("close");if(!Bn(this))throw new TypeError("The stream is not in a state that permits close");Dn(this)}enqueue(e=void 0){if(!kn(this))throw Wn("enqueue");if(!Bn(this))throw new TypeError("The stream is not in a state that permits enqueue");return jn(this,e)}error(e=void 0){if(!kn(this))throw Wn("error");Mn(this,e)}[We](e){Ft(this);const t=this._cancelAlgorithm(e);return Un(this),t}[He](e){const t=this._controlledReadableStream;if(this._queue.length>0){const r=qt(this);this._closeRequested&&0===this._queue.length?(Un(this),no(t)):Vn(this),e._chunkSteps(r)}else ft(t,e),Vn(this)}[Ge](){}}function kn(e){return!!we(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")&&e instanceof Cn}function Vn(e){Ln(e)&&(e._pulling?e._pullAgain=!0:(e._pulling=!0,Ce(e._pullAlgorithm(),()=>(e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Vn(e)),null),t=>(Mn(e,t),null))))}function Ln(e){const t=e._controlledReadableStream;return!!Bn(e)&&(!!e._started&&(!!(to(t)&&ht(t)>0)||qn(e)>0))}function Un(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Dn(e){if(!Bn(e))return;const t=e._controlledReadableStream;e._closeRequested=!0,0===e._queue.length&&(Un(e),no(t))}function jn(e,t){if(!Bn(e))return;const r=e._controlledReadableStream;if(to(r)&&ht(r)>0)pt(r,t,!1);else{let r;try{r=e._strategySizeAlgorithm(t)}catch(n){throw Mn(e,n),n}try{Bt(e,t,r)}catch(n){throw Mn(e,n),n}}Vn(e)}function Mn(e,t){const r=e._controlledReadableStream;"readable"===r._state&&(Ft(e),Un(e),oo(r,t))}function qn(e){const t=e._controlledReadableStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function Bn(e){const t=e._controlledReadableStream._state;return!e._closeRequested&&"readable"===t}function Fn(e,t,r,n,o,i,a){t._controlledReadableStream=e,t._queue=void 0,t._queueTotalSize=void 0,Ft(t),t._started=!1,t._closeRequested=!1,t._pullAgain=!1,t._pulling=!1,t._strategySizeAlgorithm=a,t._strategyHWM=i,t._pullAlgorithm=n,t._cancelAlgorithm=o,e._readableStreamController=t,Ce(Ae(r()),()=>(t._started=!0,Vn(t),null),e=>(Mn(t,e),null))}function Wn(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function Hn(e){return we(t=e)&&void 0!==t.getReader?function(e){let t;return t=Xn(be,function(){let r;try{r=e.read()}catch(n){return Re(n)}return Le(r,e=>{if(!we(e))throw new TypeError("The promise returned by the reader.read() method must fulfill with an object");if(e.done)Dn(t._readableStreamController);else{const r=e.value;jn(t._readableStreamController,r)}})},function(t){try{return Ae(e.cancel(t))}catch(r){return Re(r)}},0),t}(e.getReader()):function(e){let t;const r=Ct(e,"async");return t=Xn(be,function(){let e;try{e=kt(r)}catch(n){return Re(n)}return Le(Ae(e),e=>{if(!we(e))throw new TypeError("The promise returned by the iterator.next() method must fulfill with an object");if(e.done)Dn(t._readableStreamController);else{const r=e.value;jn(t._readableStreamController,r)}})},function(e){const t=r.iterator;let n;try{n=At(t,"return")}catch(o){return Re(o)}return void 0===n?Ae(void 0):Le(Me(n,t,[e]),e=>{if(!we(e))throw new TypeError("The promise returned by the iterator.return() method must fulfill with an object")})},0),t}(e);var t}function Gn(e,t,r){return nt(e,r),r=>Me(e,t,[r])}function $n(e,t,r){return nt(e,r),r=>Me(e,t,[r])}function zn(e,t,r){return nt(e,r),r=>je(e,t,[r])}function Kn(e,t){if("bytes"!=(e=`${e}`))throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function Jn(e,t){rt(e,t);const r=null==e?void 0:e.preventAbort,n=null==e?void 0:e.preventCancel,o=null==e?void 0:e.preventClose,i=null==e?void 0:e.signal;return void 0!==i&&function(e,t){if(!function(e){if("object"!=typeof e||null===e)return!1;try{return"boolean"==typeof e.aborted}catch(t){return!1}}(e))throw new TypeError(`${t} is not an AbortSignal.`)}(i,`${t} has member 'signal' that`),{preventAbort:Boolean(r),preventCancel:Boolean(n),preventClose:Boolean(o),signal:i}}Object.defineProperties(Cn.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),_e(Cn.prototype.close,"close"),_e(Cn.prototype.enqueue,"enqueue"),_e(Cn.prototype.error,"error"),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(Cn.prototype,Symbol.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});let Yn=class{constructor(e={},t={}){void 0===e?e=null:ot(e,"First parameter");const r=kr(t,"Second parameter"),n=function(e,t){rt(e,t);const r=e,n=null==r?void 0:r.autoAllocateChunkSize,o=null==r?void 0:r.cancel,i=null==r?void 0:r.pull,a=null==r?void 0:r.start,s=null==r?void 0:r.type;return{autoAllocateChunkSize:void 0===n?void 0:lt(n,`${t} has member 'autoAllocateChunkSize' that`),cancel:void 0===o?void 0:Gn(o,r,`${t} has member 'cancel' that`),pull:void 0===i?void 0:$n(i,r,`${t} has member 'pull' that`),start:void 0===a?void 0:zn(a,r,`${t} has member 'start' that`),type:void 0===s?void 0:Kn(s,`${t} has member 'type' that`)}}(e,"First parameter");if(Zn(this),"bytes"===n.type){if(void 0!==r.size)throw new RangeError("The strategy for a byte stream cannot have a size function");!function(e,t,r){const n=Object.create(Gt.prototype);let o,i,a;o=void 0!==t.start?()=>t.start(n):()=>{},i=void 0!==t.pull?()=>t.pull(n):()=>Ae(void 0),a=void 0!==t.cancel?e=>t.cancel(e):()=>Ae(void 0);const s=t.autoAllocateChunkSize;if(0===s)throw new TypeError("autoAllocateChunkSize must be greater than 0");gr(e,n,o,i,a,r,s)}(this,n,Pr(r,0))}else{const e=Cr(r);!function(e,t,r,n){const o=Object.create(Cn.prototype);let i,a,s;i=void 0!==t.start?()=>t.start(o):()=>{},a=void 0!==t.pull?()=>t.pull(o):()=>Ae(void 0),s=void 0!==t.cancel?e=>t.cancel(e):()=>Ae(void 0),Fn(e,o,i,a,s,r,n)}(this,n,Pr(r,1),e)}}get locked(){if(!eo(this))throw io("locked");return to(this)}cancel(e=void 0){return eo(this)?to(this)?Re(new TypeError("Cannot cancel a stream that already has a reader")):ro(this,e):Re(io("cancel"))}getReader(e=void 0){if(!eo(this))throw io("getReader");return void 0===function(e,t){rt(e,t);const r=null==e?void 0:e.mode;return{mode:void 0===r?void 0:Er(r,`${t} has member 'mode' that`)}}(e,"First parameter").mode?dt(this):_r(this)}pipeThrough(e,t={}){if(!eo(this))throw io("pipeThrough");it(e,1,"pipeThrough");const r=function(e,t){rt(e,t);const r=null==e?void 0:e.readable;at(r,"readable","ReadableWritablePair"),ut(r,`${t} has member 'readable' that`);const n=null==e?void 0:e.writable;return at(n,"writable","ReadableWritablePair"),Mr(n,`${t} has member 'writable' that`),{readable:r,writable:n}}(e,"First parameter"),n=Jn(t,"Second parameter");if(to(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(Hr(r.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");return Ue(Pn(this,r.writable,n.preventClose,n.preventAbort,n.preventCancel,n.signal)),r.readable}pipeTo(e,t={}){if(!eo(this))return Re(io("pipeTo"));if(void 0===e)return Re("Parameter 1 is required in 'pipeTo'.");if(!Wr(e))return Re(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let r;try{r=Jn(t,"Second parameter")}catch(n){return Re(n)}return to(this)?Re(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):Hr(e)?Re(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):Pn(this,e,r.preventClose,r.preventAbort,r.preventCancel,r.signal)}tee(){if(!eo(this))throw io("tee");return xt($t((e=this)._readableStreamController)?function(e){let t,r,n,o,i,a=dt(e),s=!1,c=!1,l=!1,u=!1,d=!1;const f=Oe(e=>{i=e});function p(e){Ve(e._closedPromise,t=>(e!==a||(fr(n._readableStreamController,t),fr(o._readableStreamController,t),u&&d||i(void 0)),null))}function h(){Tr(a)&&(Ke(a),a=dt(e),p(a)),gt(a,{_chunkSteps:t=>{De(()=>{c=!1,l=!1;const r=t;let a=t;if(!u&&!d)try{a=Mt(t)}catch(f){return fr(n._readableStreamController,f),fr(o._readableStreamController,f),void i(ro(e,f))}u||dr(n._readableStreamController,r),d||dr(o._readableStreamController,a),s=!1,c?y():l&&v()})},_closeSteps:()=>{s=!1,u||ur(n._readableStreamController),d||ur(o._readableStreamController),n._readableStreamController._pendingPullIntos.length>0&&yr(n._readableStreamController,0),o._readableStreamController._pendingPullIntos.length>0&&yr(o._readableStreamController,0),u&&d||i(void 0)},_errorSteps:()=>{s=!1}})}function m(t,r){vt(a)&&(Ke(a),a=_r(e),p(a));const f=r?o:n,h=r?n:o;Or(a,t,1,{_chunkSteps:t=>{De(()=>{c=!1,l=!1;const n=r?d:u;if(r?u:d)n||vr(f._readableStreamController,t);else{let r;try{r=Mt(t)}catch(o){return fr(f._readableStreamController,o),fr(h._readableStreamController,o),void i(ro(e,o))}n||vr(f._readableStreamController,t),dr(h._readableStreamController,r)}s=!1,c?y():l&&v()})},_closeSteps:e=>{s=!1;const t=r?d:u,n=r?u:d;t||ur(f._readableStreamController),n||ur(h._readableStreamController),void 0!==e&&(t||vr(f._readableStreamController,e),!n&&h._readableStreamController._pendingPullIntos.length>0&&yr(h._readableStreamController,0)),t&&n||i(void 0)},_errorSteps:()=>{s=!1}})}function y(){if(s)return c=!0,Ae(void 0);s=!0;const e=hr(n._readableStreamController);return null===e?h():m(e._view,!1),Ae(void 0)}function v(){if(s)return l=!0,Ae(void 0);s=!0;const e=hr(o._readableStreamController);return null===e?h():m(e._view,!0),Ae(void 0)}function g(){}return n=Qn(g,y,function(n){if(u=!0,t=n,d){const n=xt([t,r]),o=ro(e,n);i(o)}return f}),o=Qn(g,v,function(n){if(d=!0,r=n,u){const n=xt([t,r]),o=ro(e,n);i(o)}return f}),p(a),[n,o]}(e):function(e){const t=dt(e);let r,n,o,i,a,s=!1,c=!1,l=!1,u=!1;const d=Oe(e=>{a=e});function f(){return s?(c=!0,Ae(void 0)):(s=!0,gt(t,{_chunkSteps:e=>{De(()=>{c=!1;const t=e,r=e;l||jn(o._readableStreamController,t),u||jn(i._readableStreamController,r),s=!1,c&&f()})},_closeSteps:()=>{s=!1,l||Dn(o._readableStreamController),u||Dn(i._readableStreamController),l&&u||a(void 0)},_errorSteps:()=>{s=!1}}),Ae(void 0))}function p(){}return o=Xn(p,f,function(t){if(l=!0,r=t,u){const t=xt([r,n]),o=ro(e,t);a(o)}return d}),i=Xn(p,f,function(t){if(u=!0,n=t,l){const t=xt([r,n]),o=ro(e,t);a(o)}return d}),Ve(t._closedPromise,e=>(Mn(o._readableStreamController,e),Mn(i._readableStreamController,e),l&&u||a(void 0),null)),[o,i]}(e));var e}values(e=void 0){if(!eo(this))throw io("values");return function(e,t){const r=dt(e),n=new Vt(r,t),o=Object.create(Lt);return o._asyncIteratorImpl=n,o}(this,function(e){rt(e,"First parameter");const t=null==e?void 0:e.preventCancel;return{preventCancel:Boolean(t)}}(e).preventCancel)}[Pt](e){return this.values(e)}static from(e){return Hn(e)}};function Xn(e,t,r,n=1,o=()=>1){const i=Object.create(Yn.prototype);return Zn(i),Fn(i,Object.create(Cn.prototype),e,t,r,n,o),i}function Qn(e,t,r){const n=Object.create(Yn.prototype);return Zn(n),gr(n,Object.create(Gt.prototype),e,t,r,0,void 0),n}function Zn(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function eo(e){return!!we(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")&&e instanceof Yn}function to(e){return void 0!==e._reader}function ro(e,t){if(e._disturbed=!0,"closed"===e._state)return Ae(void 0);if("errored"===e._state)return Re(e._storedError);no(e);const r=e._reader;if(void 0!==r&&Tr(r)){const e=r._readIntoRequests;r._readIntoRequests=new qe,e.forEach(e=>{e._closeSteps(void 0)})}return Le(e._readableStreamController[We](t),be)}function no(e){e._state="closed";const t=e._reader;if(void 0!==t&&(Ze(t),vt(t))){const e=t._readRequests;t._readRequests=new qe,e.forEach(e=>{e._closeSteps()})}}function oo(e,t){e._state="errored",e._storedError=t;const r=e._reader;void 0!==r&&(Qe(r,t),vt(r)?bt(r,t):Ar(r,t))}function io(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}Object.defineProperties(Yn,{from:{enumerable:!0}}),Object.defineProperties(Yn.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),_e(Yn.from,"from"),_e(Yn.prototype.cancel,"cancel"),_e(Yn.prototype.getReader,"getReader"),_e(Yn.prototype.pipeThrough,"pipeThrough"),_e(Yn.prototype.pipeTo,"pipeTo"),_e(Yn.prototype.tee,"tee"),_e(Yn.prototype.values,"values"),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(Yn.prototype,Symbol.toStringTag,{value:"ReadableStream",configurable:!0}),Object.defineProperty(Yn.prototype,Pt,{value:Yn.prototype.values,writable:!0,configurable:!0});_e(e=>e.byteLength,"size");function ao(e,t,r){return nt(e,r),r=>Me(e,t,[r])}function so(e,t,r){return nt(e,r),r=>je(e,t,[r])}function co(e,t,r){return nt(e,r),(r,n)=>Me(e,t,[r,n])}function lo(e,t,r){return nt(e,r),r=>Me(e,t,[r])}_e(()=>1,"size");let uo=class{constructor(e={},t={},r={}){void 0===e&&(e=null);const n=kr(t,"Second parameter"),o=kr(r,"Third parameter"),i=function(e,t){rt(e,t);const r=null==e?void 0:e.cancel,n=null==e?void 0:e.flush,o=null==e?void 0:e.readableType,i=null==e?void 0:e.start,a=null==e?void 0:e.transform,s=null==e?void 0:e.writableType;return{cancel:void 0===r?void 0:lo(r,e,`${t} has member 'cancel' that`),flush:void 0===n?void 0:ao(n,e,`${t} has member 'flush' that`),readableType:o,start:void 0===i?void 0:so(i,e,`${t} has member 'start' that`),transform:void 0===a?void 0:co(a,e,`${t} has member 'transform' that`),writableType:s}}(e,"First parameter");if(void 0!==i.readableType)throw new RangeError("Invalid readableType specified");if(void 0!==i.writableType)throw new RangeError("Invalid writableType specified");const a=Pr(o,0),s=Cr(o),c=Pr(n,1),l=Cr(n);let u;!function(e,t,r,n,o,i){function a(){return t}e._writable=function(e,t,r,n,o=1,i=()=>1){const a=Object.create(qr.prototype);return Fr(a),ln(a,Object.create(sn.prototype),e,t,r,n,o,i),a}(a,function(t){return function(e,t){const r=e._transformStreamController;return e._backpressure?Le(e._backpressureChangePromise,()=>{const n=e._writable;if("erroring"===n._state)throw n._storedError;return Eo(r,t)}):Eo(r,t)}(e,t)},function(){return function(e){const t=e._transformStreamController;if(void 0!==t._finishPromise)return t._finishPromise;const r=e._readable;t._finishPromise=Oe((e,r)=>{t._finishPromise_resolve=e,t._finishPromise_reject=r});const n=t._flushAlgorithm();return bo(t),Ce(n,()=>("errored"===r._state?xo(t,r._storedError):(Dn(r._readableStreamController),So(t)),null),e=>(Mn(r._readableStreamController,e),xo(t,e),null)),t._finishPromise}(e)},function(t){return function(e,t){const r=e._transformStreamController;if(void 0!==r._finishPromise)return r._finishPromise;const n=e._readable;r._finishPromise=Oe((e,t)=>{r._finishPromise_resolve=e,r._finishPromise_reject=t});const o=r._cancelAlgorithm(t);return bo(r),Ce(o,()=>("errored"===n._state?xo(r,n._storedError):(Mn(n._readableStreamController,t),So(r)),null),e=>(Mn(n._readableStreamController,e),xo(r,e),null)),r._finishPromise}(e,t)},r,n),e._readable=Xn(a,function(){return yo(t=e,!1),t._backpressureChangePromise;var t},function(t){return function(e,t){const r=e._transformStreamController;if(void 0!==r._finishPromise)return r._finishPromise;const n=e._writable;r._finishPromise=Oe((e,t)=>{r._finishPromise_resolve=e,r._finishPromise_reject=t});const o=r._cancelAlgorithm(t);return bo(r),Ce(o,()=>("errored"===n._state?xo(r,n._storedError):(pn(n._writableStreamController,t),mo(e),So(r)),null),t=>(pn(n._writableStreamController,t),mo(e),xo(r,t),null)),r._finishPromise}(e,t)},o,i),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,yo(e,!0),e._transformStreamController=void 0}(this,Oe(e=>{u=e}),c,l,a,s),function(e,t){const r=Object.create(vo.prototype);let n,o,i;var a,s,c,l,u;n=void 0!==t.transform?e=>t.transform(e,r):e=>{try{return wo(r,e),Ae(void 0)}catch(t){return Re(t)}},o=void 0!==t.flush?()=>t.flush(r):()=>Ae(void 0),i=void 0!==t.cancel?e=>t.cancel(e):()=>Ae(void 0),a=e,c=n,l=o,u=i,(s=r)._controlledTransformStream=a,a._transformStreamController=s,s._transformAlgorithm=c,s._flushAlgorithm=l,s._cancelAlgorithm=u,s._finishPromise=void 0,s._finishPromise_resolve=void 0,s._finishPromise_reject=void 0}(this,i),void 0!==i.start?u(i.start(this._transformStreamController)):u(void 0)}get readable(){if(!fo(this))throw No("readable");return this._readable}get writable(){if(!fo(this))throw No("writable");return this._writable}};function fo(e){return!!we(e)&&!!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")&&e instanceof uo}function po(e,t){Mn(e._readable._readableStreamController,t),ho(e,t)}function ho(e,t){bo(e._transformStreamController),pn(e._writable._writableStreamController,t),mo(e)}function mo(e){e._backpressure&&yo(e,!1)}function yo(e,t){void 0!==e._backpressureChangePromise&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=Oe(t=>{e._backpressureChangePromise_resolve=t}),e._backpressure=t}Object.defineProperties(uo.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(uo.prototype,Symbol.toStringTag,{value:"TransformStream",configurable:!0});class vo{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!go(this))throw _o("desiredSize");return qn(this._controlledTransformStream._readable._readableStreamController)}enqueue(e=void 0){if(!go(this))throw _o("enqueue");wo(this,e)}error(e=void 0){if(!go(this))throw _o("error");var t;t=e,po(this._controlledTransformStream,t)}terminate(){if(!go(this))throw _o("terminate");!function(e){const t=e._controlledTransformStream;Dn(t._readable._readableStreamController);ho(t,new TypeError("TransformStream terminated"))}(this)}}function go(e){return!!we(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")&&e instanceof vo}function bo(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0,e._cancelAlgorithm=void 0}function wo(e,t){const r=e._controlledTransformStream,n=r._readable._readableStreamController;if(!Bn(n))throw new TypeError("Readable side is not in a state that permits enqueue");try{jn(n,t)}catch(o){throw ho(r,o),r._readable._storedError}var o;!Ln(o=n)!==r._backpressure&&yo(r,!0)}function Eo(e,t){return Le(e._transformAlgorithm(t),void 0,t=>{throw po(e._controlledTransformStream,t),t})}function _o(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function So(e){void 0!==e._finishPromise_resolve&&(e._finishPromise_resolve(),e._finishPromise_resolve=void 0,e._finishPromise_reject=void 0)}function xo(e,t){void 0!==e._finishPromise_reject&&(Ue(e._finishPromise),e._finishPromise_reject(t),e._finishPromise_resolve=void 0,e._finishPromise_reject=void 0)}function No(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}Object.defineProperties(vo.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),_e(vo.prototype.enqueue,"enqueue"),_e(vo.prototype.error,"error"),_e(vo.prototype.terminate,"terminate"),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(vo.prototype,Symbol.toStringTag,{value:"TransformStreamDefaultController",configurable:!0});var Io=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),To=function(){return To=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},To.apply(this,arguments)},Oo=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},Ao=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(s){i=[6,s],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};var Ro="Error when aborting requestTask",Po=function(e){function t(t){void 0===t&&(t={});var r=e.call(this)||this,n=t.timeout,o=t.timeoutMsg,i=t.restrictedMethods;return r._timeout=n||0,r._timeoutMsg=o||"è¯·æ±‚è¶…æ—¶",r._restrictedMethods=i||["get","post","upload","download"],r}return Io(t,e),t.prototype.post=function(e){var t=this;return new Promise(function(r,n){var o=e.url,i=e.data,a=e.headers,s=wx.request({url:U("https:",o),data:i,timeout:t._timeout,method:"POST",header:a,success:function(e){e.statusCode>=200&&e.statusCode<300?r({statusCode:e.statusCode,status:e.statusCode,data:e.data}):n(e)},fail:function(e){n(e)},complete:function(e){if(e&&e.errMsg&&(t._timeout&&-1!==t._restrictedMethods.indexOf("post")&&"request:fail timeout"===e.errMsg)){console.warn(t._timeoutMsg);try{s.abort()}catch(r){}}}})})},t.prototype.get=function(e){var t=this;return new Promise(function(r,n){var o=e.url,i=e.body,a=e.headers,s=U("https:",o),c=wx.request({url:s,data:i,timeout:t._timeout,method:"GET",header:a,success:function(e){e.statusCode>=200&&e.statusCode<300?r({statusCode:e.statusCode,status:e.statusCode,data:e.data}):n(e)},fail:function(e){n(e)},complete:function(e){if(e&&e.errMsg&&(t._timeout&&-1!==t._restrictedMethods.indexOf("get")&&e.errMsg.includes("timeout"))){console.warn(t._timeoutMsg);try{c.abort()}catch(r){console.warn(Ro,r)}}}})})},t.prototype.upload=function(e){var t=this,r=this;return new Promise(function(n){return Oo(t,void 0,void 0,function(){var t,o,i,a,s,c;return Ao(this,function(l){return t=e.url,o=e.file,i=e.data,a=e.headers,s=e.onUploadProgress,c=wx.uploadFile({url:t,filePath:o,name:"file",formData:To({},i),header:a,timeout:this._timeout,success:function(e){var t={statusCode:e.statusCode,data:e.data||{}};200===e.statusCode&&i.success_action_status&&(t.statusCode=parseInt(i.success_action_status,10)),n(t)},fail:function(e){n(e)},complete:function(e){if(e&&e.errMsg&&(r._timeout&&-1!==r._restrictedMethods.indexOf("upload")&&"request:fail timeout"===e.errMsg)){console.warn(r._timeoutMsg);try{c.abort()}catch(t){}}}}),s&&c.onProgressUpdate(function(e){s(e)}),[2]})})})},t.prototype.download=function(e){var t=this,r=this;return new Promise(function(n,o){var i=e.url,a=e.headers,s=wx.downloadFile({url:U("https:",i),header:a,timeout:t._timeout,success:function(e){200===e.statusCode&&e.tempFilePath?n({statusCode:200,tempFilePath:e.tempFilePath}):n(e)},fail:function(e){o(e)},complete:function(e){if(e&&e.errMsg&&(r._timeout&&-1!==r._restrictedMethods.indexOf("download")&&"request:fail timeout"===e.errMsg)){console.warn(r._timeoutMsg);try{s.abort()}catch(t){}}}})})},t.prototype.fetch=function(e){var t=e.url,r=e.body,n=e.enableAbort,o=e.headers,i=e.method,a=e.stream,s=void 0!==a&&a,c=e.signal,l=e.timeout,u=this,d=null!=l?l:this._timeout,f=null,p=new Yn({start:function(e){f=e},cancel:function(){f=null}});return new Promise(function(e,a){s&&e({data:p});var l=wx.request({url:U("https:",t),data:r,timeout:d,method:i.toUpperCase(),header:o,success:function(t){var r;null===(r=f)||void 0===r||r.close(),!s&&e(t)},fail:function(e){var t;if(null===(t=f)||void 0===t||t.close(),a(e),s)throw e},complete:function(e){if(e&&e.errMsg&&(d&&-1!==u._restrictedMethods.indexOf("post")&&n&&"request:fail timeout"===e.errMsg)){console.warn(u._timeoutMsg);try{l.abort()}catch(t){console.warn(Ro,t)}}},enableChunked:s});if(l.onChunkReceived(function(e){var t;null===(t=f)||void 0===t||t.enqueue(new Uint8Array(e.data))}),c){var h=function(){try{l.abort()}catch(e){console.warn(Ro,e)}};c.aborted?h():c.addEventListener("abort",function(){return h()})}})},t}(V),Co={setItem:function(e,t){wx.setStorageSync(e,t)},getItem:function(e){return wx.getStorageSync(e)},removeItem:function(e){wx.removeStorageSync(e)},clear:function(){wx.clearStorageSync()}},ko=function(){return function(e,t){void 0===t&&(t={});var r=wx.connectSocket(To({url:e},t));return{set onopen(e){r.onOpen(e)},set onmessage(e){r.onMessage(e)},set onclose(e){r.onClose(e)},set onerror(e){r.onError(e)},send:function(e){return r.send({data:e})},close:function(e,t){return r.close({code:e,reason:t})},get readyState(){return r.readyState},CONNECTING:0,OPEN:1,CLOSING:2,CLOSED:3}}}();function Vo(e){var t={},r=e.replace(/^[?#]/,"");return r?(r.split("&").forEach(function(e){var r=e.split("="),n=r[0],o=r[1];n=decodeURIComponent(n),o=decodeURIComponent(o),n&&(t[n]?Array.isArray(t[n])?t[n].push(o):t[n]=[t[n],o]:t[n]=o)}),t):t}var Lo={genAdapter:function(e){return{root:{globalThis:{}},reqClass:Po,wsClass:ko,captchaOptions:{openURIWithCallback:function(t){var r=e.EventBus,n={},o=t;console.log("openURIWithCallback",t);var i=t.match(/^(data:.*?)(\?[^#\s]*)?$/);if(i){o=i[1],console.log("openURIWithCallback url",o);var a=i[2];a&&(n=Vo(a))}console.log("openURIWithCallback queryObj",n);var s=n.token,c=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(n,["token"]);return/^data:/.test(o)&&!s?Promise.reject({error:"invalid_argument",error_description:"invalie captcha data: "+t}):s?new Promise(function(e){console.log("wait for captcha..."),r.$emit("CAPTCHA_DATA_CHANGE",To(To({},c),{token:s,url:o})),r.$once("RESOLVE_CAPTCHA_DATA",function(t){e(t)})}):Promise.reject({error:"unimplemented",error_description:"need to impl captcha data"})}},localStorage:Co,primaryStorage:R.local,getAppSign:function(){var e=wx.getAccountInfoSync();return"undefined"!=typeof App||"undefined"!=typeof getApp||wx.onAppHide||wx.offAppHide||wx.onAppShow||wx.offAppShow?e&&e.miniProgram?e.miniProgram.appId:"":e&&e.plugin?e.plugin.appId:""}}},isMatch:function(){if("undefined"==typeof wx)return!1;if("undefined"==typeof Page)return!1;if(!wx.getSystemInfoSync)return!1;if(!wx.getStorageSync)return!1;if(!wx.setStorageSync)return!1;if(!wx.connectSocket)return!1;if(!wx.request)return!1;try{if(!wx.getSystemInfoSync())return!1;if("qq"===wx.getSystemInfoSync().AppPlatform)return!1}catch(e){return!1}return!0},runtime:"wx_mp"},Uo=function(){return Uo=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Uo.apply(this,arguments)},Do={},jo=function(){return jo=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},jo.apply(this,arguments)},Mo=oe,qo={},Bo={};function Fo(e){var t=e.env,r=e.platformInfo,n={userInfoKey:"".concat("user_info","_").concat(t)};qo[t]=qo[t]||new Mo(jo(jo({},e),{keys:n,platformInfo:r})),Bo[t]=Bo[t]||new Mo(jo(jo({},e),{keys:n,platformInfo:r,persistence:"local"}))}function Wo(e){return Bo[e]}var Ho=function(){return Ho=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ho.apply(this,arguments)},Go=["ap-shanghai","ap-guangzhou","ap-shenzhen-fsi","ap-shanghai-fsi","ap-nanjing","ap-beijing","ap-chengdu","ap-chongqing","ap-hongkong"],$o=function(e){T=e},zo=function(e){A=e},Ko="",Jo="@cloudbase/js-sdk";function Yo(){return Ko}var Xo,Qo,Zo=[],ei=["env","endPointKey","region"],ti="https:";function ri(e){return Zo.find(function(t){return ei.filter(function(t){return null!=e[t]}).every(function(r){return t[r]===e[r]})})}function ni(e){var t,r;e.protocol&&!/:$/.test(e.protocol)&&(e.protocol="".concat(e.protocol,":"));var n=ri(e);n?(null!=e.baseUrl&&(n.baseUrl=e.baseUrl),null!=e.protocol&&(n.protocol=e.protocol)):Zo.push(Ho(Ho({},e),{protocol:null!==(t=e.protocol)&&void 0!==t?t:ti})),"CLOUD_API"===e.endPointKey&&zo(null!==(r=e.protocol)&&void 0!==r?r:ti)}function oi(e,t,r){return ri({env:e,endPointKey:t,region:r})}function ii(e,t){void 0===t&&(t="CLOUD_API");var r=oi(e,t||"CLOUD_API"),n=r.protocol,o=r.baseUrl;return"".concat(n).concat(o).match(/(http(s)?:)?\/\/([^/?#]*)/)[0]}(Qo=Xo||(Xo={})).NULL="NULL",Qo.ANONYMOUS="ANONYMOUS",Qo.WECHAT="WECHAT",Qo.WECHAT_PUBLIC="WECHAT-PUBLIC",Qo.WECHAT_OPEN="WECHAT-OPEN",Qo.CUSTOM="CUSTOM",Qo.EMAIL="EMAIL",Qo.USERNAME="USERNAME",Qo.PHONE="PHONE";var ai=function(){return ai=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ai.apply(this,arguments)},si=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},ci=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},li=k,ui=function(){return Math.random().toString(16).slice(2)},di=q,fi=F,pi=["auth.getJwt","auth.logout","auth.signInWithTicket","auth.signInAnonymously","auth.signIn","auth.fetchAccessTokenWithRefreshToken","auth.signUpWithEmailAndPassword","auth.activateEndUserMail","auth.sendPasswordResetEmail","auth.resetPasswordWithToken","auth.isUsernameRegistered"];function hi(e,t,r){var n=e[t];e[t]=function(t){var o={},i={};r.forEach(function(r){var n=r.call(e,t),a=n.data,s=n.headers;Object.assign(o,a),Object.assign(i,s)});var a=t.data;return a&&(di(a)?Object.keys(o).forEach(function(e){a.append(e,o[e])}):t.data=ai(ai({},a),o)),t.headers=ai(ai({},t.headers||{}),i),n.call(e,t)}}function mi(){var e=ui();return{data:{seqId:e},headers:{"X-SDK-Version":"@cloudbase/js-sdk/".concat(Yo()),"x-seqid":e}}}var yi,vi,gi,bi=function(){function e(e){var t=this;this.throwWhenRequestFail=!1,this.config=e;var r={timeout:this.config.timeout,timeoutMsg:"[@cloudbase/js-sdk] è¯·æ±‚åœ¨".concat(this.config.timeout/1e3,"så†…æœªå®Œæˆï¼Œå·²ä¸­æ–­"),restrictedMethods:["post","put"]};this.reqClass=new Do.adapter.reqClass(r),this.throwWhenRequestFail=e.throw||!1,this.localCache=Wo(this.config.env),"GATEWAY"!==this.config.endPointMode&&(hi(this.reqClass,"post",[mi]),hi(this.reqClass,"upload",[mi]),hi(this.reqClass,"download",[mi])),le.on(ue,function(e){var r;t.config.i18n=(null===(r=e.data)||void 0===r?void 0:r.i18n)||t.config.i18n})}return e.prototype.getAccessToken=function(e){return void 0===e&&(e=null),si(this,void 0,void 0,function(){var t,r,n;return ci(this,function(o){switch(o.label){case 0:if(null!=e)return[2,e];if(!(t=this.config._fromApp).oauthInstance)throw new Error("you can't request without auth");return r=t.oauthInstance,n=r.oauth2client,[4,this.getOauthAccessTokenV2(n)];case 1:return[2,o.sent().accessToken]}})})},e.prototype.getDefaultHeaders=function(){var e,t,r;return(e={})[null===(t=this.config.i18n)||void 0===t?void 0:t.LANG_HEADER_KEY]=null===(r=this.config.i18n)||void 0===r?void 0:r.lang,e["X-SDK-Version"]="@cloudbase/js-sdk/".concat(Yo()),e},e.prototype.post=function(e,t){return si(this,void 0,void 0,function(){return ci(this,function(r){switch(r.label){case 0:return[4,this.reqClass.post(ai(ai({},e),{headers:ai(ai({},e.headers),this.getDefaultHeaders()),customReqOpts:t}))];case 1:return[2,r.sent()]}})})},e.prototype.upload=function(e){return si(this,void 0,void 0,function(){return ci(this,function(t){switch(t.label){case 0:return[4,this.reqClass.upload(ai(ai({},e),{headers:ai(ai({},e.headers),this.getDefaultHeaders())}))];case 1:return[2,t.sent()]}})})},e.prototype.download=function(e){return si(this,void 0,void 0,function(){return ci(this,function(t){switch(t.label){case 0:return[4,this.reqClass.download(ai(ai({},e),{headers:ai(ai({},e.headers),this.getDefaultHeaders())}))];case 1:return[2,t.sent()]}})})},e.prototype.getBaseEndPoint=function(e){return void 0===e&&(e="CLOUD_API"),ii(this.config.env,e)},e.prototype.getOauthAccessTokenV2=function(e){return si(this,void 0,void 0,function(){var t,r;return ci(this,function(n){switch(n.label){case 0:return[4,e.getAccessToken()];case 1:return t=n.sent(),[4,e.getCredentials()];case 2:return r=n.sent(),[2,{accessToken:t,accessTokenExpire:new Date(r.expires_at).getTime()}]}})})},e.prototype.request=function(e,t,r,n){var o,i;return si(this,void 0,void 0,function(){var a,s,c,l,u,d,f,p,h,m,y,v,g,b,w,E,_,S,x,N,I;return ci(this,function(T){switch(T.label){case 0:if(a="x-tcb-trace_".concat(this.config.env),s="application/x-www-form-urlencoded",c=ai({action:e,dataVersion:"2020-01-10",env:this.config.env},t),-1!==pi.indexOf(e))return[3,2];if(!(l=this.config._fromApp).oauthInstance)throw new Error("you can't request without auth");return u=l.oauthInstance,d=u.oauth2client,f=c,[4,this.getOauthAccessTokenV2(d)];case 1:f.access_token=T.sent().accessToken,T.label=2;case 2:return"storage.uploadFile"===e?(p=new FormData,Object.keys(p).forEach(function(e){Object.prototype.hasOwnProperty.call(p,e)&&void 0!==p[e]&&p.append(e,c[e])}),s="multipart/form-data"):(s="application/json;charset=UTF-8",p={},Object.keys(c).forEach(function(e){void 0!==c[e]&&(p[e]=c[e])})),h={headers:ai({"content-type":s},this.getDefaultHeaders())},(null==r?void 0:r.onUploadProgress)&&(h.onUploadProgress=r.onUploadProgress),this.config.region&&(h.headers["X-TCB-Region"]=this.config.region),(m=this.localCache.getStore(a))&&(h.headers["X-TCB-Trace"]=m),y=void 0!==(null==r?void 0:r.parse)?r.parse:t.parse,v=void 0!==(null==r?void 0:r.inQuery)?r.inQuery:t.inQuery,g=void 0!==(null==r?void 0:r.search)?r.search:t.search,b=ai(ai({},(null==r?void 0:r.defaultQuery)||{}),{env:this.config.env}),y&&(b.parse=!0),v&&(b=ai(ai({},v),b)),w=this.config.endPointMode||"CLOUD_API",E=oi(this.config.env,w),_=E.baseUrl,S=E.protocol,"GATEWAY"===w&&("functions.invokeFunction"===e||/^(storage|database)\./.test(e))&&(_="".concat(_.match(/\/\/([^/?#]*)/)[0],"/web")),x=r.pathname?fi(S,"".concat(null===(o=ii(this.config.env,w))||void 0===o?void 0:o.replace(/^https?:/,""),"/").concat(r.pathname),b):fi(S,_,b),g&&(x+=g),[4,this.post(ai({url:x,data:p},h),n)];case 3:if(N=T.sent(),(I=null===(i=N.header)||void 0===i?void 0:i["x-tcb-trace"])&&this.localCache.setStore(a,I),200!==Number(N.status)&&200!==Number(N.statusCode)||!N.data)throw new Error("network request error");return[2,N]}})})},e.prototype.fetch=function(e){var t,r,n,o,i,a,s,c;return si(this,void 0,void 0,function(){var l,u,d,f,p,h,m=this;return ci(this,function(y){switch(y.label){case 0:l=e.token,u=e.headers,d=void 0===u?{}:u,f=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,["token","headers"]),p=function(){return si(m,void 0,void 0,function(){var e,t,r,n,o;return ci(this,function(i){switch(i.label){case 0:return t=(e=this.reqClass).fetch,n={},o={"X-SDK-Version":"@cloudbase/js-sdk/".concat(Yo())},r="Bearer ".concat,[4,this.getAccessToken(l)];case 1:return[2,t.apply(e,[ai.apply(void 0,[(n.headers=ai.apply(void 0,[ai.apply(void 0,[(o.Authorization=r.apply("Bearer ",[i.sent()]),o),this.getDefaultHeaders()]),d]),n),f])])]}})})},y.label=1;case 1:return y.trys.push([1,3,,6]),[4,p()];case 2:return[2,y.sent()];case 3:if("ACCESS_TOKEN_EXPIRED"!==(null==(h=y.sent())?void 0:h.code))return[3,5];if("function"!=typeof(null===(o=null===(n=null===(r=null===(t=this.config)||void 0===t?void 0:t._fromApp)||void 0===r?void 0:r.oauthInstance)||void 0===n?void 0:n.authApi)||void 0===o?void 0:o.refreshTokenForce))throw h;return[4,null===(c=null===(s=null===(a=null===(i=this.config)||void 0===i?void 0:i._fromApp)||void 0===a?void 0:a.oauthInstance)||void 0===s?void 0:s.authApi)||void 0===c?void 0:c.refreshTokenForce()];case 4:return y.sent(),[2,p()];case 5:throw h;case 6:return[2]}})})},e.prototype.send=function(e,t,r,n){return void 0===t&&(t={}),void 0===r&&(r={}),si(this,void 0,void 0,function(){var o;return ci(this,function(i){switch(i.label){case 0:return[4,this.request(e,t,ai(ai({},r),{onUploadProgress:t.onUploadProgress}),n)];case 1:if((o=i.sent()).data.code&&this.throwWhenRequestFail)throw new Error(JSON.stringify({code:li.OPERATION_FAIL,msg:"[".concat(o.data.code,"] ").concat(o.data.message)}));return[2,o.data]}})})},e.prototype.gateWay=function(e,t){return si(this,void 0,void 0,function(){var r,n,o,i,a,s,c,l,u,d,f,p,h,m,y,v;return ci(this,function(g){switch(g.label){case 0:if(r=e.name,n=e.data,o=e.path,i=void 0===o?"":o,a=e.method,s=e.header,c=void 0===s?{}:s,!r||!i)throw new Error(JSON.stringify({code:li.INVALID_PARAMS,msg:"[gateWay] invalid function name or path"}));try{l=n?JSON.stringify(n):""}catch(b){throw new Error(JSON.stringify({code:li.INVALID_PARAMS,msg:"[gateWay] invalid data"}))}return u=B(),d=oi(this.config.env,"GATEWAY"),f=d.baseUrl,p=d.protocol,h="".concat(p).concat(f,"/").concat(i,"/").concat(r),[4,this.fetch({method:a||"POST",headers:ai({"Content-Type":"application/json; charset=utf-8","X-Request-Id":u},c),body:l,url:h,customReqOpts:t})];case 1:return m=g.sent(),y=[ai({requestId:u},m)],v={},[4,m.data];case 2:return[2,ai.apply(void 0,y.concat([(v.data=g.sent(),v)]))]}})})},e}(),wi={};(gi=vi||(vi={})).ZH="zh-CN",gi.EN="en-US";var Ei=((yi={})[vi.EN]={"è¯·æ£€æŸ¥è°ƒç”¨æ–¹å¼ï¼Œæˆ–å‰å¾€äº‘å¼€å‘ AI+ é¦–é¡µæŸ¥çœ‹æ–‡æ¡£":"Please check the calling method or visit the AI+ homepage to view the documentation","AI+ è¯·æ±‚å‡ºé”™ï¼Œé”™è¯¯ç ":"AI+ request error, error code","é”™è¯¯ä¿¡æ¯":"error message","æœªå®ç°":"not implemented","å°ç¨‹åºä¸æ”¯æŒ wasm åŠ è½½":"wasm loading is not supported in mini programs","å°ç¨‹åºä¸æ”¯æŒåŠ¨æ€ js åŠ è½½":"dynamic js loading is not supported in mini programs","è¯·æ±‚è¶…æ—¶":"request timeout","ç¼ºå°‘ privatelink sdk åœ°å€":"missing privatelink sdk address"},yi),_i=function(e,t){var r;return(null===(r=Ei[t])||void 0===r?void 0:r[e])||e},Si=function(e,t){var r,n,o=function(e){return"lang_".concat(e.clientId||e.env)}(t),i=(e.adapter||{}).localStorage,a=t.lang||(null===(r=null==i?void 0:i.getItem)||void 0===r?void 0:r.call(i,o))||vi.ZH;return null===(n=null==i?void 0:i.setItem)||void 0===n||n.call(i,o,a),new Proxy({t:function(e){return _i(e,a)},LANG_HEADER_KEY:"Accept-Language",lang:a},{get:function(e,t){var r;return"lang"===t&&(null===(r=null==i?void 0:i.getItem)||void 0===r?void 0:r.call(i,o))||e[t]},set:function(e,t,r){var n;return"lang"===t&&r!==e[t]&&(e[t]=r,e.t=function(e){return _i(e,r)},null===(n=null==i?void 0:i.setItem)||void 0===n||n.call(i,o,r),le.fire(ue,{i18n:e})),e[t]=r,!0}})},xi="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Ni(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Ii(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var r=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}),r}var Ti={},Oi={};Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.COMMUNITY_SITE_URL=Oi.IS_DEBUG_MODE=Oi.getProtocol=Oi.setProtocol=Oi.getSdkName=Oi.setSdkName=void 0;var Ai="@cloudbase/js-sdk";Oi.setSdkName=function(e){Ai=e},Oi.getSdkName=function(){return Ai};var Ri="https:";Oi.setProtocol=function(e){Ri=e},Oi.getProtocol=function(){return Ri},Oi.IS_DEBUG_MODE=!1,Oi.COMMUNITY_SITE_URL="https://support.qq.com/products/148793";var Pi,Ci,ki,Vi={};Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.ERRORS=void 0,Vi.ERRORS={INVALID_PARAMS:"INVALID_PARAMS",INVALID_SYNTAX:"INVALID_SYNTAX",INVALID_OPERATION:"INVALID_OPERATION",OPERATION_FAIL:"OPERATION_FAIL",NETWORK_ERROR:"NETWORK_ERROR",UNKOWN_ERROR:"UNKOWN_ERROR"},Pi=Ti,Ci=xi&&xi.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),ki=xi&&xi.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||Ci(t,e,r)},Object.defineProperty(Pi,"__esModule",{value:!0}),Pi.OATUH_LOGINTYPE=void 0,ki(Oi,Pi),ki(Vi,Pi),Pi.OATUH_LOGINTYPE="constants";var Li=function(){return Li=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Li.apply(this,arguments)},Ui=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},Di=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};function ji(e,t){var r,n,o;return Ui(this,void 0,void 0,function(){var i,a,s,c,l,u,d,f,p,h,m,y,v,g,b;return Di(this,function(w){switch(w.label){case 0:if(a=(i=e||{}).name,s=i.body,c=i.path,l=void 0===c?"":c,u=i.method,d=void 0===u?"POST":u,f=i.headers,p=void 0===f?{}:f,h=i.token,!a)throw new Error(JSON.stringify({code:Ti.ERRORS.INVALID_PARAMS,msg:"[apis] invalid api name"}));return m=this.getEndPointWithKey("GATEWAY"),y=m.BASE_URL,v=m.PROTOCOL,g="".concat(v).concat(y,"/apis/").concat(a),b=l.startsWith("/")?l:"/".concat(l),[4,this.request.fetch(Li({url:"".concat(g).concat(b),method:d||"POST",headers:Li({"Content-Type":"application/json; charset=utf-8"},p),body:s,token:(null===(r=null==h?void 0:h.trim)||void 0===r?void 0:r.call(h))||(null===(o=null===(n=p.Authorization)||void 0===n?void 0:n.replace)||void 0===o?void 0:o.call(n,/^Bearer /,""))||null},t))];case 1:return[4,w.sent().data];case 2:return[2,w.sent()]}})})}var Mi=["GET","POST","PUT","DELETE","HEAD","OPTIONS","PATCH","REQUEST"];function qi(e){var t=this;return new Proxy({},{get:function(r,n){if("string"!=typeof n)throw new Error("[apis] method must be string");var o=n.toLocaleUpperCase();if(!Mi.includes(o))throw new Error("[apis] invalid method: ".concat(n));return function(r,n){return Ui(t,void 0,void 0,function(){return Di(this,function(t){switch(t.label){case 0:return[4,ji.call(this,Li({name:e,method:("REQUEST"===o?r.method:o)||"POST"},r),n)];case 1:return[2,t.sent()]}})})}}})}function Bi(){var e=this;return new Proxy({},{get:function(t,r){if("string"==typeof r)return qi.call(e,r)}})}var Fi=function(){return Fi=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Fi.apply(this,arguments)},Wi=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Hi=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Gi=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(t){i(t)}}function s(e){try{c(n.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},$i=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(c){s=[6,c],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},zi=function(e,t){for(var r=0,n=j(e)?e:[e];r<n.length;r++){var o=n[r],i=o.isMatch,a=o.genAdapter,s=o.runtime;if(i())return{adapter:Q({isMatch:i},a(t)),runtime:s}}},Ki=function(){return{adapter:{type:"default",root:window,reqClass:J,wsClass:WebSocket,localStorage:localStorage},runtime:Y.WEB}},Ji=k,Yi=C,Xi=H,Qi=de,Zi={timeout:15e3,persistence:"local"},ea=6e5,ta={},ra=function(){function e(e){this.cloudbaseConfig=e||this.cloudbaseConfig,this.authInstance=null,this.oauthInstance=null,this.version=Yo()}return Object.defineProperty(e.prototype,"config",{get:function(){return this.cloudbaseConfig},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"platform",{get:function(){return Do},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cache",{get:function(){return e=this.cloudbaseConfig.env,qo[e];var e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localCache",{get:function(){return Wo(this.cloudbaseConfig.env)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"request",{get:function(){return e=this.cloudbaseConfig.env,wi[e];var e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"apis",{get:function(){return Bi.call(this)},enumerable:!1,configurable:!0}),e.prototype.init=function(t){var r;if(!t.env)throw new Error(JSON.stringify({code:Ji.INVALID_PARAMS,msg:"env must not be specified"}));Do.adapter||this.useDefaultAdapter();var n={timeout:t.timeout||5e3,timeoutMsg:"[".concat(Jo,"][REQUEST TIMEOUT] request had been abort since didn't finished within").concat(t.timeout/1e3,"s")};this.requestClient=new Do.adapter.reqClass(n),this.cloudbaseConfig=Fi(Fi(Fi({},Zi),t),{i18n:Si(Do,t)}),delete this.cloudbaseConfig.lang,this.cloudbaseConfig.timeout=this.formatTimeout(this.cloudbaseConfig.timeout);var o=this.cloudbaseConfig,i=o.env,a=o.persistence,s=o.debug,c=o.timeout,l=o.oauthClient,u=o.i18n;Fo({env:i,persistence:a,debug:s,platformInfo:this.platform}),function(e,t,r){ni({env:e,region:t,baseUrl:"//".concat(e,".").concat(t||"ap-shanghai",".tcb-api.tencentcloudapi.com/web"),protocol:r,endPointKey:"CLOUD_API"})}(i,t.region||""),function(e,t,r){void 0===r&&(r="ap-shanghai"),r=r||"ap-shanghai";var n="//".concat(e,".api.tcloudbasegateway.com/v1");Go.includes(r)||(n="//".concat(e,".api.intl.tcloudbasegateway.com/v1")),ni({endPointKey:"GATEWAY",env:e,baseUrl:n,protocol:t})}(i,ti,t.region||"");var d=new e(this.cloudbaseConfig);return function(e){wi[e.env]=new bi(ai(ai({},e),{throw:!0}))}({env:i,region:t.region||"",timeout:c,oauthClient:l,_fromApp:d,i18n:u,endPointMode:t.endPointMode}),d.requestClient=this.requestClient,null===(r=null==this?void 0:this.fire)||void 0===r||r.call(this,"cloudbase_init",d),this.try2InitAuth(t,d),d},e.prototype.updateConfig=function(e){var t=e.persistence,r=e.debug;this.cloudbaseConfig.persistence=t,this.cloudbaseConfig.debug=r,Fo({env:this.cloudbaseConfig.env,persistence:t,debug:r,platformInfo:this.platform})},e.prototype.updateLang=function(e){var t;e&&e!==(null===(t=this.cloudbaseConfig.i18n)||void 0===t?void 0:t.lang)&&(this.cloudbaseConfig.i18n.lang=e)},e.prototype.registerExtension=function(e){ta[e.name]=e},e.prototype.invokeExtension=function(e,t){return Gi(this,void 0,void 0,function(){var r;return $i(this,function(n){switch(n.label){case 0:if(!(r=ta[e]))throw new Error(JSON.stringify({code:Ji.INVALID_PARAMS,msg:"extension:".concat(e," must be registered before invoke")}));return[4,r.invoke(t,this)];case 1:return[2,n.sent()]}})})},e.prototype.useAdapters=function(e,t){var r=zi(e,t)||{},n=r.adapter,o=r.runtime;n&&(Do.adapter=n),o&&(Do.runtime=o)},e.prototype.registerHook=function(t){!function(e,t){var r=t.entity,n=t.target;if(Object.prototype.hasOwnProperty.call(e,n))throw new Error(JSON.stringify({code:me.INVALID_OPERATION,msg:"target:".concat(n," is not exist")}));var o=e.prototype[n];if("function"!=typeof o)throw new Error(JSON.stringify({code:me.INVALID_OPERATION,msg:"target:".concat(n," is not a function which is the only type supports hook")}));e.prototype[n]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.call.apply(r,he([this],e,!1)),o.call.apply(o,he([this],e,!1))}}(e,t)},e.prototype.registerComponent=function(t){ve(e,t)},e.prototype.registerVersion=function(e){!function(e){Ko=e}(e),this.version=e},e.prototype.registerSdkName=function(e){!function(e){Jo=e,$o(e)}(e)},e.prototype.registerEndPoint=function(e,t){ni({baseUrl:e,protocol:t,env:this.config.env,endPointKey:"CLOUD_API"})},e.prototype.registerEndPointWithKey=function(e){ni({env:this.config.env,endPointKey:e.key,baseUrl:e.url,protocol:e.protocol})},e.prototype.getEndPointWithKey=function(e){var t=oi(this.config.env,e);return{BASE_URL:t.baseUrl,PROTOCOL:t.protocol}},e.prototype.parseCaptcha=function(e){var t={},r=e.match(/^(data:.*?)(\?[^#\s]*)?$/);if(r){e=r[1];var n=r[2];n&&(t=function(e){e=e.replace(/^\?/,"");var t={};return e.split("&").forEach(function(e){var r=e.split("="),n=r[0],o=r[1];n=decodeURIComponent(n),o=decodeURIComponent(o),n&&(t[n]?Array.isArray(t[n])?t[n].push(o):t[n]=[t[n],o]:t[n]=o)}),t}(n))}var o=t.token,i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(t,["token"]);return/^data:/.test(e)&&!o?{error:"invalid_argument",error_description:"invalid captcha data: ".concat(e)}:o?{state:i.state,token:o,captchaData:e}:{error:"unimplemented",error_description:"need to impl captcha data"}},e.prototype.useDefaultAdapter=function(){var e=Ki(),t=e.adapter,r=e.runtime;Do.adapter=t,Do.runtime=r},e.prototype.formatTimeout=function(e){switch(!0){case e>ea:return Xi(Ji.INVALID_PARAMS,"timeout is greater than maximum value[10min]"),ea;case e<100:return Xi(Ji.INVALID_PARAMS,"timeout is less than maximum value[100ms]"),100;default:return e}},e.prototype.try2InitAuth=function(e,t){try{e.accessKey&&t.auth()}catch(r){console.log("try2InitAuth error:",r)}},Wi([Qi({mode:"sync",title:"Cloudbase åˆå§‹åŒ–å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ cloudbase.init() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","  2 - å¦‚æœæ˜¯éæµè§ˆå™¨ç¯å¢ƒï¼Œæ˜¯å¦é…ç½®äº†å®‰å…¨åº”ç”¨æ¥æºï¼ˆhttps://docs.cloudbase.net/api-reference/webv3/adapter#%E7%AC%AC-2-%E6%AD%A5%E9%85%8D%E7%BD%AE%E5%AE%89%E5%85%A8%E5%BA%94%E7%94%A8%E6%9D%A5%E6%BA%90ï¼‰","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Yi)]}),Hi("design:type",Function),Hi("design:paramtypes",[Object]),Hi("design:returntype",e)],e.prototype,"init",null),Wi([Qi({title:"è°ƒç”¨æ‰©å±•èƒ½åŠ›å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ invokeExtension() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","  2 - è¢«è°ƒç”¨çš„æ‰©å±•èƒ½åŠ›æ˜¯å¦å·²ç»å®‰è£…å¹¶é€šè¿‡ registerExtension() æ³¨å†Œ","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Yi)]}),Hi("design:type",Function),Hi("design:paramtypes",[String,Object]),Hi("design:returntype",Promise)],e.prototype,"invokeExtension",null),e}(),na=new ra;na.useAdapters((Po.prototype.upload=function(e){var t=this,r=this;return new Promise(function(n){var o=e.url,i=e.file,a=e.data,s=e.headers,c=wx.getFileSystemManager(),l=wx.request({url:o,method:e.method,header:Uo({"content-type":" "},s),data:c.readFileSync(i),timeout:t._timeout,success:function(e){var t={statusCode:e.statusCode,data:e.data||{}};200===e.statusCode&&(null==a?void 0:a.success_action_status)&&(t.statusCode=parseInt(a.success_action_status,10)),n(t)},fail:function(e){n(e)},complete:function(e){if((null==e?void 0:e.errMsg)&&r._timeout&&-1!==r._restrictedMethods.indexOf("upload")&&"request:fail timeout"===e.errMsg){console.warn(r._timeoutMsg);try{l.abort()}catch(t){}}}})})},Lo.genAdapter=function(e){return{root:{globalThis:{}},reqClass:Po,wsClass:ko,captchaOptions:{openURIWithCallback:function(t){var r=e.EventBus,n={},o=t;console.log("openURIWithCallback",t);var i=t.match(/^(data:.*?)(\?[^#\s]*)?$/);if(i){o=i[1],console.log("openURIWithCallback url",o);var a=i[2];a&&(n=Vo(a))}console.log("openURIWithCallback queryObj",n);var s=n.token,c=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(n,["token"]);return/^data:/.test(o)&&!s?Promise.reject({error:"invalid_argument",error_description:"invalie captcha data: ".concat(t)}):s?new Promise(function(e){console.log("wait for captcha..."),r.$emit("CAPTCHA_DATA_CHANGE",Uo(Uo({},c),{token:s,url:o})),r.$once("RESOLVE_CAPTCHA_DATA",function(t){e(t)})}):Promise.reject({error:"unimplemented",error_description:"need to impl captcha data"})}},localStorage:Co,primaryStorage:R.local,getAppSign:function(){var e=wx.getAccountInfoSync();return"undefined"!=typeof App||"undefined"!=typeof getApp||wx.onAppHide||wx.offAppHide||wx.onAppShow||wx.offAppShow?e&&e.miniProgram?e.miniProgram.appId:"":e&&e.plugin?e.plugin.appId:""}}},Lo));const oa="/auth";var ia,aa,sa,ca,la,ua,da,fa,pa,ha;function ma(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}(aa=ia||(ia={})).AUTH_SIGN_UP_URL="/v1/signup",aa.AUTH_TOKEN_URL="/v1/token",aa.AUTH_REVOKE_URL="/v1/revoke",aa.WEDA_USER_URL="/v1/plugin/weda/userinfo",aa.AUTH_RESET_PASSWORD="/v1/reset",aa.AUTH_GET_DEVICE_CODE="/v1/device/code",aa.CHECK_USERNAME="/v1/checkUsername",aa.CHECK_IF_USER_EXIST="/v1/checkIfUserExist",aa.GET_PROVIDER_TYPE="/v1/mgr/provider/providerSubType",aa.AUTH_SIGN_IN_URL="/v1/signin",aa.AUTH_SIGN_IN_ANONYMOUSLY_URL="/v1/signin/anonymously",aa.AUTH_SIGN_IN_WITH_PROVIDER_URL="/v1/signin/with/provider",aa.AUTH_SIGN_IN_WITH_WECHAT_URL="/v1/signin/wechat/noauth",aa.AUTH_SIGN_IN_CUSTOM="/v1/signin/custom",aa.PROVIDER_TOKEN_URL="/v1/provider/token",aa.PROVIDER_URI_URL="/v1/provider/uri",aa.USER_ME_URL="/v1/user/me",aa.AUTH_SIGNOUT_URL="/v1/user/signout",aa.USER_QUERY_URL="/v1/user/query",aa.USER_PRIFILE_URL="/v1/user/profile",aa.USER_BASIC_EDIT_URL="/v1/user/basic/edit",aa.USER_TRANS_BY_PROVIDER_URL="/v1/user/trans/by/provider",aa.PROVIDER_LIST="/v1/user/provider",aa.PROVIDER_BIND_URL="/v1/user/provider/bind",aa.PROVIDER_UNBIND_URL="/v1/user/provider",aa.CHECK_PWD_URL="/v1/user/sudo",aa.SUDO_URL="/v1/user/sudo",aa.BIND_CONTACT_URL="/v1/user/contact",aa.AUTH_SET_PASSWORD="/v1/user/password",aa.AUTHORIZE_DEVICE_URL="/v1/user/device/authorize",aa.AUTHORIZE_URL="/v1/user/authorize",aa.AUTHORIZE_INFO_URL="/v1/user/authorize/info",aa.AUTHORIZED_DEVICES_DELETE_URL="/v1/user/authorized/devices/",aa.AUTH_REVOKE_ALL_URL="/v1/user/revoke/all",aa.GET_USER_BEHAVIOR_LOG="/v1/user/security/history",aa.VERIFICATION_URL="/v1/verification",aa.VERIFY_URL="/v1/verification/verify",aa.CAPTCHA_DATA_URL="/v1/captcha/data",aa.VERIFY_CAPTCHA_DATA_URL="/v1/captcha/data/verify",aa.GET_CAPTCHA_URL="/v1/captcha/init",aa.GET_MINIPROGRAM_QRCODE="/v1/qrcode/generate",aa.GET_MINIPROGRAM_QRCODE_STATUS="/v1/qrcode/get/status",(ca=sa||(sa={})).AUTH_SIGN_IN_URL="/v2/signin/username",ca.AUTH_TOKEN_URL="/v2/token",ca.USER_ME_URL="/v2/user/me",ca.VERIFY_URL="/v2/signin/verificationcode",ca.AUTH_SIGN_IN_WITH_PROVIDER_URL="/v2/signin/with/provider",ca.AUTH_PUBLIC_KEY="/v2/signin/publichkey",ca.AUTH_RESET_PASSWORD="/v2/signin/password/update",(ua=la||(la={})).REGISTER="REGISTER",ua.SIGN_IN="SIGN_IN",ua.PASSWORD_RESET="PASSWORD_RESET",ua.EMAIL_ADDRESS_CHANGE="EMAIL_ADDRESS_CHANGE",ua.PHONE_NUMBER_CHANGE="PHONE_NUMBER_CHANGE",(fa=da||(da={})).UNREACHABLE="unreachable",fa.LOCAL="local",fa.CANCELLED="cancelled",fa.UNKNOWN="unknown",fa.UNAUTHENTICATED="unauthenticated",fa.RESOURCE_EXHAUSTED="resource_exhausted",fa.FAILED_PRECONDITION="failed_precondition",fa.INVALID_ARGUMENT="invalid_argument",fa.DEADLINE_EXCEEDED="deadline_exceeded",fa.NOT_FOUND="not_found",fa.ALREADY_EXISTS="already_exists",fa.PERMISSION_DENIED="permission_denied",fa.ABORTED="aborted",fa.OUT_OF_RANGE="out_of_range",fa.UNIMPLEMENTED="unimplemented",fa.INTERNAL="internal",fa.UNAVAILABLE="unavailable",fa.DATA_LOSS="data_loss",fa.INVALID_PASSWORD="invalid_password",fa.PASSWORD_NOT_SET="password_not_set",fa.INVALID_STATUS="invalid_status",fa.USER_PENDING="user_pending",fa.USER_BLOCKED="user_blocked",fa.INVALID_VERIFICATION_CODE="invalid_verification_code",fa.TWO_FACTOR_REQUIRED="two_factor_required",fa.INVALID_TWO_FACTOR="invalid_two_factor",fa.INVALID_TWO_FACTOR_RECOVERY="invalid_two_factor_recovery",fa.UNDER_REVIEW="under_review",fa.INVALID_REQUEST="invalid_request",fa.UNAUTHORIZED_CLIENT="unauthorized_client",fa.ACCESS_DENIED="access_denied",fa.UNSUPPORTED_RESPONSE_TYPE="unsupported_response_type",fa.INVALID_SCOPE="invalid_scope",fa.INVALID_GRANT="invalid_grant",fa.SERVER_ERROR="server_error",fa.TEMPORARILY_UNAVAILABLE="temporarily_unavailable",fa.INTERACTION_REQUIRED="interaction_required",fa.LOGIN_REQUIRED="login_required",fa.ACCOUNT_SELECTION_REQUIRED="account_selection_required",fa.CONSENT_REQUIRED="consent_required",fa.INVALID_REQUEST_URI="invalid_request_uri",fa.INVALID_REQUEST_OBJECT="invalid_request_object",fa.REQUEST_NOT_SUPPORTED="request_not_supported",fa.REQUEST_URI_NOT_SUPPORTED="request_uri_not_supported",fa.REGISTRATION_NOT_SUPPORTED="registration_not_supported",fa.CAPTCHA_REQUIRED="captcha_required",fa.CAPTCHA_INVALID="captcha_invalid",(ha=pa||(pa={})).CLIENT_ID="client_id",ha.CLIENT_SECRET="client_secret",ha.RESPONSE_TYPE="response_type",ha.SCOPE="scope",ha.STATE="state",ha.REDIRECT_URI="redirect_uri",ha.ERROR="error",ha.ERROR_DESCRIPTION="error_description",ha.ERROR_URI="error_uri",ha.GRANT_TYPE="grant_type",ha.CODE="code",ha.ACCESS_TOKEN="access_token",ha.TOKEN_TYPE="token_type",ha.EXPIRES_IN="expires_in",ha.USERNAME="username",ha.PASSWORD="password",ha.REFRESH_TOKEN="refresh_token";const ya=e=>{const t=t=>{for(const r in e)e.hasOwnProperty(r)&&(t[r]=ya(e[r]));return t},r=null==e?"NullOrUndefined":Object.prototype.toString.call(e).slice(8,-1);if(["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"].includes(r))return e.slice();switch(r){case"Object":return t(Object.create(Object.getPrototypeOf(e)));case"Array":return t([]);case"Date":return new Date(e.valueOf());case"RegExp":return new RegExp(e.source,(e.global?"g":"")+(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.sticky?"y":"")+(e.unicode?"u":""));default:return e}},va=e=>{const t=e.match(/^(?:http(s)?:\/\/[^\/]+)?(\/[^\?#]*)/);return t&&t[2]||""};let ga=new Map;class ba{constructor(e){this.clientId=(null==e?void 0:e.clientId)||"",ga=ga||new Map}async run(e,t){e=`${this.clientId}_${e}`;let r=ga.get(e);return r||(r=new Promise((r,n)=>{(async()=>{try{await this.runIdlePromise();const e=t();r(await e)}catch(o){n(o)}finally{ga.delete(e)}})()}),ga.set(e,r)),r}runIdlePromise(){return Promise.resolve()}}const wa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Ea(){if("undefined"==typeof globalThis)return!1;const{wx:e}=globalThis;if(void 0===e)return!1;if(void 0===globalThis.Page)return!1;if(!e.getSystemInfoSync)return!1;if(!e.getStorageSync)return!1;if(!e.setStorageSync)return!1;if(!e.connectSocket)return!1;if(!e.request)return!1;try{if(!e.getSystemInfoSync())return!1;if("qq"===e.getSystemInfoSync().AppPlatform)return!1}catch(t){return!1}return!0}let _a=!1;function Sa(){_a=_a||void 0!==typeof window&&"miniprogram"===window.__wxjs_environment}try{Ea()||(_a=_a||!!navigator.userAgent.match(/miniprogram/i)||"miniprogram"===window.__wxjs_environment,window&&window.WeixinJSBridge&&window.WeixinJSBridge.invoke?Sa():"undefined"!=typeof document&&document.addEventListener("WeixinJSBridgeReady",Sa,!1))}catch(hL){}function xa(){return _a}const Na="x-request-id",Ia="x-device-id",Ta="device_id",Oa=async function(e,t){let r=null,n=null;try{const o=Object.assign({},t);o.method||(o.method="GET"),o.body&&"string"!=typeof o.body&&(o.body=JSON.stringify(o.body));const i=await fetch(e,o),a=await i.json();(null==a?void 0:a.error)?(n=a,n.error_uri=new URL(e).pathname):r=a}catch(o){n={error:da.UNREACHABLE,error_description:o.message,error_uri:new URL(e).pathname}}if(n)throw n;return r};const Aa=new class{constructor(e){this._env=(null==e?void 0:e.env)||""}async getItem(e){return window.localStorage.getItem(`${e}${this._env}`)}async removeItem(e){window.localStorage.removeItem(`${e}${this._env}`)}async setItem(e,t){window.localStorage.setItem(`${e}${this._env}`,t)}getItemSync(e){return window.localStorage.getItem(`${e}${this._env}`)}removeItemSync(e){window.localStorage.removeItem(`${e}${this._env}`)}setItemSync(e,t){window.localStorage.setItem(`${e}${this._env}`,t)}};function Ra(e){let t=!0;return(null==e?void 0:e.expires_at)&&(null==e?void 0:e.access_token)&&(t=e.expires_at<new Date),t}class Pa{constructor(e){this.credentials=null,this.accessKeyCredentials=null,this.singlePromise=null,this.tokenSectionName=e.tokenSectionName,this.storage=e.storage,this.clientId=e.clientId,this.singlePromise=new ba({clientId:this.clientId}),this.credentials=e.credentials||null}getStorageCredentialsSync(){let e=null;const t=this.storage.getItemSync(this.tokenSectionName);if(null!=t)try{e=JSON.parse(t),(null==e?void 0:e.expires_at)&&(e.expires_at=new Date(e.expires_at))}catch(r){this.storage.removeItem(this.tokenSectionName),e=null}return e}async setCredentials(e){if(null==e?void 0:e.expires_in){if((null==e?void 0:e.expires_at)||(e.expires_at=new Date(Date.now()+1e3*(e.expires_in-30))),this.storage){const t=JSON.stringify(e);await this.storage.setItem(this.tokenSectionName,t)}this.credentials=e}else this.storage&&await this.storage.removeItem(this.tokenSectionName),this.credentials=null}setAccessKeyCredentials(e){this.accessKeyCredentials=e}async getCredentials(){return this.singlePromise.run("getCredentials",async()=>{if(Ra(this.credentials)){const{credentials:e,isAccessKeyCredentials:t}=await this.getStorageCredentials();if(t)return e;this.credentials=e}return this.credentials})}async getStorageCredentials(){return this.singlePromise.run("_getStorageCredentials",async()=>{let e=null,t=!1;const r=await this.storage.getItem(this.tokenSectionName);if(r)try{e=JSON.parse(r),(null==e?void 0:e.expires_at)&&(e.expires_at=new Date(e.expires_at))}catch(n){await this.storage.removeItem(this.tokenSectionName),e=null}else e=this.accessKeyCredentials||null,t=!0;return{credentials:e,isAccessKeyCredentials:t}})}}class Ca{constructor(e){this.singlePromise=null,e.clientSecret||(e.clientSecret=""),!e.clientId&&e.env&&(e.clientId=e.env),this.apiOrigin=e.apiOrigin,this.apiPath=e.apiPath||oa,this.clientId=e.clientId,this.i18n=e.i18n,this.singlePromise=new ba({clientId:this.clientId}),this.retry=this.formatRetry(e.retry,Ca.defaultRetry),e.baseRequest?this.baseRequest=e.baseRequest:this.baseRequest=Oa,this.tokenInURL=e.tokenInURL,this.headers=e.headers,this.storage=e.storage||Aa,this.localCredentials=new Pa({tokenSectionName:`credentials_${e.clientId}`,storage:this.storage,clientId:e.clientId}),this.clientSecret=e.clientSecret,e.clientId&&(this.basicAuth=`Basic ${function(e){let t,r,n,o,i="",a=0;const s=(e=String(e)).length%3;for(;a<e.length;){if((r=e.charCodeAt(a++))>255||(n=e.charCodeAt(a++))>255||(o=e.charCodeAt(a++))>255)throw new TypeError("Failed to execute 'btoa' on 'Window': The string to be encoded contains characters outside of the Latin1 range.");t=r<<16|n<<8|o,i+=wa.charAt(t>>18&63)+wa.charAt(t>>12&63)+wa.charAt(t>>6&63)+wa.charAt(63&t)}return s?i.slice(0,s-3)+"===".substring(s):i}(`${e.clientId}:${this.clientSecret}`)}`),this.wxCloud=e.wxCloud;try{Ea()&&(this.useWxCloud=e.useWxCloud,void 0===this.wxCloud&&e.env&&(wx.cloud.init({env:e.env}),this.wxCloud=wx.cloud))}catch(t){}this.refreshTokenFunc=e.refreshTokenFunc||this.defaultRefreshTokenFunc,this.anonymousSignInFunc=e.anonymousSignInFunc,this.onCredentialsError=e.onCredentialsError,le.on(ue,e=>{var t;this.i18n=(null==(t=e.data)?void 0:t.i18n)||this.i18n})}setCredentials(e){return this.localCredentials.setCredentials(e)}setAccessKeyCredentials(e){return this.localCredentials.setAccessKeyCredentials(e)}async getAccessToken(){const e=await this.getCredentials();if(null==e?void 0:e.access_token)return Promise.resolve(e.access_token);const t={error:da.UNAUTHENTICATED};return Promise.reject(t)}async request(e,t){var r,n;t||(t={});const o=this.formatRetry(t.retry,this.retry);if(t.headers={...t.headers,[null==(r=this.i18n)?void 0:r.LANG_HEADER_KEY]:null==(n=this.i18n)?void 0:n.lang},this.headers&&(t.headers={...this.headers,...t.headers}),t.headers[Na]||(t.headers[Na]=ma()),!t.headers[Ia]){const e=await this.getDeviceId();t.headers[Ia]=e}if((null==t?void 0:t.withBasicAuth)&&this.basicAuth&&(t.headers.Authorization=this.basicAuth),null==t?void 0:t.withCredentials){const r=await this.getCredentials();r&&(this.tokenInURL?(e.indexOf("?")<0&&(e+="?"),e+=`access_token=${r.access_token}`):t.headers.Authorization=`${r.token_type} ${r.access_token}`)}else this.clientId&&e.indexOf("client_id")<0&&(e+=e.indexOf("?")<0?"?":"&",e+=`client_id=${this.clientId}`);e.startsWith("/")&&(e=`${this.apiOrigin}${this.apiPath}${e}`);let i=null;const a=o+1;for(let c=0;c<a;c++){try{i=t.useWxCloud||this.useWxCloud?await this.wxCloudCallFunction(e,t):await this.baseRequest(e,t);break}catch(s){if(t.withCredentials&&s&&s.error===da.UNAUTHENTICATED)return await this.setCredentials(null),Promise.reject(s);if(c===o||!s||"unreachable"!==s.error)return Promise.reject(s)}await this.sleep(Ca.retryInterval)}return i}async wxCloudCallFunction(e,t){var r;let n=null,o=null;try{let a="";try{a=await wx.getRendererUserAgent()}catch(i){}const{result:s}=await this.wxCloud.callFunction({name:"httpOverCallFunction",data:{url:e,method:t.method,headers:{origin:"https://servicewechat.com","User-Agent":a,...t.headers},body:t.body}});(null==(r=null==s?void 0:s.body)?void 0:r.error_code)?(o=null==s?void 0:s.body,o.error_uri=va(e)):n=null==s?void 0:s.body}catch(i){o={error:da.UNREACHABLE,error_description:i.message,error_uri:va(e)}}if(o)throw o;return n}async getCredentials(){var e,t,r;let n=await this.localCredentials.getCredentials();if(!n){const t="credentials not found";return null==(e=this.onCredentialsError)||e.call(this,{msg:t}),this.unAuthenticatedError(t)}if(Ra(n))if(n.refresh_token)try{n=await this.refreshToken(n)}catch(o){if("anonymous"!==n.scope)return null==(t=this.onCredentialsError)||t.call(this,{msg:o.error_description}),Promise.reject(o);n=await this.anonymousLogin(n)}else{if("anonymous"!==n.scope){const e="no refresh token found in credentials";return null==(r=this.onCredentialsError)||r.call(this,{msg:e}),this.unAuthenticatedError(e)}n=await this.anonymousLogin(n)}return n}getCredentialsSync(){return this.localCredentials.getStorageCredentialsSync()}getCredentialsAsync(){return this.getCredentials()}async getScope(){var e;const t=await this.localCredentials.getCredentials();if(!t){const t="credentials not found";return null==(e=this.onCredentialsError)||e.call(this,{msg:t}),this.unAuthenticatedError(t)}return t.scope}async getGroups(){var e;const t=await this.localCredentials.getCredentials();if(!t){const t="credentials not found";return null==(e=this.onCredentialsError)||e.call(this,{msg:t}),this.unAuthenticatedError(t)}return t.groups}async refreshToken(e){return this.singlePromise.run("_refreshToken",async()=>{var t,r,n;if(!e||!e.refresh_token){const e="no refresh token found in credentials";return null==(t=this.onCredentialsError)||t.call(this,{msg:e}),this.unAuthenticatedError(e)}try{const t=await this.refreshTokenFunc(e.refresh_token,e);return await this.localCredentials.setCredentials(t),t}catch(o){if(o.error===da.INVALID_GRANT){await this.localCredentials.setCredentials(null);const e=o.error_description;return null==(r=this.onCredentialsError)||r.call(this,{msg:e}),this.unAuthenticatedError(e)}return null==(n=this.onCredentialsError)||n.call(this,{msg:o.error_description}),Promise.reject(o)}})}async anonymousLogin(e){return this.singlePromise.run("_anonymousLogin",async()=>{if(this.anonymousSignInFunc){const t=await this.anonymousSignInFunc(e);e=t||await this.localCredentials.getCredentials()}else e=await this.anonymousSignIn(e);return e})}checkRetry(e){let t=null;if(("number"!=typeof e||e<Ca.minRetry||e>Ca.maxRetry)&&(t={error:da.UNREACHABLE,error_description:"wrong options param: retry"}),t)throw t;return e}formatRetry(e,t){return void 0===e?t:this.checkRetry(e)}async sleep(e){return new Promise(t=>{setTimeout(()=>{t()},e)})}async anonymousSignIn(e){return this.singlePromise.run("_anonymous",async()=>{if(!e||"anonymous"!==e.scope)return this.unAuthenticatedError("no anonymous in credentials");try{const e=await this.request(ia.AUTH_SIGN_IN_ANONYMOUSLY_URL,{method:"POST",withBasicAuth:!0,body:{}});return await this.localCredentials.setCredentials(e),e}catch(t){return t.error===da.INVALID_GRANT?(await this.localCredentials.setCredentials(null),this.unAuthenticatedError(t.error_description)):Promise.reject(t)}})}async defaultRefreshTokenFunc(e,t){var r;if(void 0===e||""===e){const e="refresh token not found";return null==(r=this.onCredentialsError)||r.call(this,{msg:e}),this.unAuthenticatedError(e)}let n=ia.AUTH_TOKEN_URL;"v2"===(null==t?void 0:t.version)&&(n=sa.AUTH_TOKEN_URL);return{...await this.request(n,{method:"POST",body:{client_id:this.clientId,client_secret:this.clientSecret,grant_type:"refresh_token",refresh_token:e}}),version:(null==t?void 0:t.version)||"v1"}}async getDeviceId(){if(this.deviceID)return this.deviceID;let e=await this.storage.getItem(Ta);return"string"==typeof e&&e.length>=16&&e.length<=48||(e=ma(),await this.storage.setItem(Ta,e)),this.deviceID=e,e}unAuthenticatedError(e){const t={error:da.UNAUTHENTICATED,error_description:e};return Promise.reject(t)}}Ca.defaultRetry=2,Ca.minRetry=0,Ca.maxRetry=5,Ca.retryInterval=1e3;class ka{constructor(e){if(this.params={},"string"==typeof e)this.parse(e);else if(e&&"object"==typeof e)for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&this.append(t,e[t])}parse(e){e.split("&").forEach(e=>{const[t,r]=e.split("=").map(decodeURIComponent);this.append(t,r)})}append(e,t){this.params[e]?this.params[e]=this.params[e].concat([t]):this.params[e]=[t]}get(e){return this.params[e]?this.params[e][0]:null}getAll(e){return this.params[e]||[]}delete(e){delete this.params[e]}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}set(e,t){this.params[e]=[t]}toString(){const e=[];for(const t in this.params)Object.prototype.hasOwnProperty.call(this.params,t)&&this.params[t].forEach(r=>{e.push(`${encodeURIComponent(t)}=${encodeURIComponent(r)}`)});return e.join("&")}}class Va{constructor(e){e.openURIWithCallback||(e.openURIWithCallback=this.getDefaultOpenURIWithCallback()),e.storage||(e.storage=Aa),this.config=e,this.tokenSectionName=`captcha_${e.clientId}`}isMatch(){var e,t,r;return(null==(r=null==(t=null==(e=this.config)?void 0:e.adapter)?void 0:t.isMatch)?void 0:r.call(t))||Ea()}async request(e,t){t||(t={}),t.method||(t.method="GET");const r=`${t.method}:${e}`;let n,o=e;t.withCaptcha&&(o=await this.appendCaptchaTokenToURL(e,r,!1));try{n=await this.config.request(o,t)}catch(i){return i.error===da.CAPTCHA_REQUIRED||i.error===da.CAPTCHA_INVALID?(e=await this.appendCaptchaTokenToURL(e,r,i.error===da.CAPTCHA_INVALID),this.config.request(e,t)):Promise.reject(i)}return n}getDefaultOpenURIWithCallback(){if(!this.isMatch()&&!xa()&&(window.location.search.indexOf("__captcha")>0&&(document.body.style.display="none"),null===document.getElementById("captcha_panel_wrap"))){const e=document.createElement("div");e.style.cssText="background-color: rgba(0, 0, 0, 0.7);position: fixed;left: 0px;right: 0px;top: 0px;bottom: 0px;padding: 9vw 0 0 0;display: none;z-index:100;",e.setAttribute("id","captcha_panel_wrap"),setTimeout(()=>{document.body.appendChild(e)},0)}return this.defaultOpenURIWithCallback}async defaultOpenURIWithCallback(e,t){const{width:r="355px",height:n="355px"}=t||{};if(e.match(/^(data:.*)$/))return Promise.reject({error:da.UNIMPLEMENTED,error_description:"need to impl captcha data"});const o=document.getElementById("captcha_panel_wrap"),i=document.createElement("iframe");return o.innerHTML="",i.setAttribute("src",e),i.setAttribute("id","review-panel-iframe"),i.style.cssText=`min-width:${r};display:block;height:${n};margin:0 auto;background-color: rgb(255, 255, 255);border: none;`,o.appendChild(i),o.style.display="block",new Promise((e,t)=>{i.onload=function(){try{const r=window.location,n=i.contentWindow.location;if(n.host+n.pathname===r.host+r.pathname){o.style.display="none";const r=new ka(n.search),i=r.get("captcha_token");return i?e({captcha_token:i,expires_in:Number(r.get("expires_in"))}):t({error:r.get("error"),error_description:r.get("error_description")})}o.style.display="block"}catch(r){o.style.display="block"}}})}async getCaptchaToken(e,t){if(!e){const e=await this.findCaptchaToken();if(e)return e}let r;if(this.isMatch()||xa()){const e=await this.config.request(ia.CAPTCHA_DATA_URL,{method:"POST",body:{state:t,redirect_uri:""},withCredentials:!1});r={url:`${e.data}?state=${encodeURIComponent(t)}&token=${encodeURIComponent(e.token)}`}}else{const e=`${window.location.origin+window.location.pathname}?__captcha=on`;if(r=await this.config.request(ia.GET_CAPTCHA_URL,{method:"POST",body:{client_id:this.config.clientId,redirect_uri:e,state:t},withCredentials:!1}),r.captcha_token){const e={captcha_token:r.captcha_token,expires_in:r.expires_in};return this.saveCaptchaToken(e),r.captcha_token}}const n=await this.config.openURIWithCallback(r.url);return this.saveCaptchaToken(n),n.captcha_token}async appendCaptchaTokenToURL(e,t,r){const n=await this.getCaptchaToken(r,t);return e.indexOf("?")>0?e+=`&captcha_token=${n}`:e+=`?captcha_token=${n}`,e}async saveCaptchaToken(e){e.expires_at=new Date(Date.now()+1e3*(e.expires_in-10));const t=JSON.stringify(e);await this.config.storage.setItem(this.tokenSectionName,t)}async findCaptchaToken(){const e=await this.config.storage.getItem(this.tokenSectionName);if(null!=e)try{const t=JSON.parse(e);(null==t?void 0:t.expires_at)&&(t.expires_at=new Date(t.expires_at));return t.expires_at<new Date?null:t.captcha_token}catch(t){return await this.config.storage.removeItem(this.tokenSectionName),null}return null}}var La={};function Ua(e,t){var r;const n=()=>{try{return require("../utils/encrypt")}catch(e){return}};try{if(((null==(r=null==t?void 0:t.root)?void 0:r.globalThis)||globalThis).IS_MP_BUILD)return;if(!La.IS_MP_BUILD&&e)return n()}catch(o){if(e)return n()}}let Da=class e{static parseParamsToSearch(e){Object.keys(e).forEach(t=>{e[t]||delete e[t]});return new ka(e).toString()}constructor(e){let{request:t}=e,r=e.credentialsClient;if(!r){const t={apiOrigin:e.apiOrigin,apiPath:e.apiPath,clientId:e.clientId,storage:e.storage,env:e.env,baseRequest:e.baseRequest,anonymousSignInFunc:e.anonymousSignInFunc,wxCloud:e.wxCloud,onCredentialsError:e.onCredentialsError,headers:e.headers||{},i18n:e.i18n};r=new Ca(t)}if(!t){const n=r.request.bind(r),o=new Va({clientId:e.clientId,request:n,storage:e.storage,adapter:e.adapter,...e.captchaOptions});t=o.request.bind(o)}this.config={env:e.env,apiOrigin:e.apiOrigin,apiPath:e.apiPath,clientId:e.clientId,request:t,credentialsClient:r,storage:e.storage||Aa,adapter:e.adapter}}getParamsByVersion(e,t){var r;const n=ya(e),o=(null==(r={v2:sa}[null==n?void 0:n.version])?void 0:r[t])||ia[t];return n&&delete n.version,{params:n,url:o}}async signIn(e){const t=e.version||"v1",r=this.getParamsByVersion(e,"AUTH_SIGN_IN_URL");r.params.query&&delete r.params.query;const n=await this.getEncryptParams(r.params),o=await this.config.request(r.url,{method:"POST",body:n});return await this.config.credentialsClient.setCredentials({...o,version:t}),Promise.resolve(o)}async signInAnonymously(e={},t=!1){const r=await this.config.request(ia.AUTH_SIGN_IN_ANONYMOUSLY_URL,{method:"POST",body:e,useWxCloud:t});return await this.config.credentialsClient.setCredentials(r),Promise.resolve(r)}async signUp(e){const t=await this.config.request(ia.AUTH_SIGN_UP_URL,{method:"POST",body:e});return await this.config.credentialsClient.setCredentials(t),Promise.resolve(t)}async signOut(e){let t={};if(e){try{t=await this.config.request(ia.AUTH_SIGNOUT_URL,{method:"POST",withCredentials:!0,body:e})}catch(o){o.error!==da.UNAUTHENTICATED&&console.log("sign_out_error",o)}return await this.config.credentialsClient.setCredentials(),t}const r=await this.config.credentialsClient.getAccessToken(),n=await this.config.request(ia.AUTH_REVOKE_URL,{method:"POST",body:{token:r}});return await this.config.credentialsClient.setCredentials(),Promise.resolve(n)}async revokeAllDevices(){await this.config.request(ia.AUTH_REVOKE_ALL_URL,{method:"DELETE",withCredentials:!0})}async revokeDevice(e){await this.config.request(ia.AUTHORIZED_DEVICES_DELETE_URL+e.device_id,{method:"DELETE",withCredentials:!0})}async getVerification(e,t){let r=!1;if("CUR_USER"===e.target)r=!0;else{await this.hasLoginState()&&(r=!0)}const n=ya(e);return n.phone_number&&!/^\+\d{1,3}\s+\d+/.test(n.phone_number)&&(n.phone_number=`+86 ${n.phone_number}`),this.config.request(ia.VERIFICATION_URL,{method:"POST",body:n,withCaptcha:(null==t?void 0:t.withCaptcha)||!1,withCredentials:r})}async verify(e){const t=this.getParamsByVersion(e,"VERIFY_URL"),r=await this.config.request(t.url,{method:"POST",body:t.params});return"v2"===(null==e?void 0:e.version)&&await this.config.credentialsClient.setCredentials({...r,version:"v2"}),r}async genProviderRedirectUri(t){const{provider_redirect_uri:r,other_params:n={},...o}=t;r&&!o.redirect_uri&&(o.redirect_uri=r);let i=`${ia.PROVIDER_URI_URL}?${e.parseParamsToSearch(o)}`;return Object.keys(n).forEach(e=>{const t=n[e];("sign_out_uri"!==e||(null==t?void 0:t.length)>0)&&(i+=`&other_params[${e}]=${encodeURIComponent(t)}`)}),this.config.request(i,{method:"GET"})}async grantProviderToken(e,t=!1){return this.config.request(ia.PROVIDER_TOKEN_URL,{method:"POST",body:e,useWxCloud:t})}async patchProviderToken(e){return this.config.request(ia.PROVIDER_TOKEN_URL,{method:"PATCH",body:e})}async signInWithProvider(e,t=!1){const r=this.getParamsByVersion(e,"AUTH_SIGN_IN_WITH_PROVIDER_URL"),n=await this.config.request(r.url,{method:"POST",body:r.params,useWxCloud:t});return await this.config.credentialsClient.setCredentials({...n,version:(null==e?void 0:e.version)||"v1"}),Promise.resolve(n)}async signInCustom(e){const t=await this.config.request(ia.AUTH_SIGN_IN_CUSTOM,{method:"POST",body:e});return await this.config.credentialsClient.setCredentials(t),Promise.resolve(t)}async signInWithWechat(e={}){const t=await this.config.request(ia.AUTH_SIGN_IN_WITH_WECHAT_URL,{method:"POST",body:e});return await this.config.credentialsClient.setCredentials(t),Promise.resolve(t)}async bindWithProvider(e){return this.config.request(ia.PROVIDER_BIND_URL,{method:"POST",body:e,withCredentials:!0})}async getUserProfile(e){return this.getUserInfo(e)}async getUserInfo(e={}){var t;const r=this.getParamsByVersion(e,"USER_ME_URL");if(null==(t=r.params)?void 0:t.query){const e=new ka(r.params.query);r.url+=`?${e.toString()}`}const n=await this.config.request(r.url,{method:"GET",withCredentials:!0});return n.sub&&(n.uid=n.sub),n}async getWedaUserInfo(){return await this.config.request(ia.WEDA_USER_URL,{method:"GET",withCredentials:!0})}async deleteMe(t){const r=this.getParamsByVersion(t,"USER_ME_URL"),n=`${r.url}?${e.parseParamsToSearch(r.params)}`;return this.config.request(n,{method:"DELETE",withCredentials:!0})}async hasLoginState(){try{return await this.config.credentialsClient.getAccessToken(),!0}catch(e){return!1}}hasLoginStateSync(){return this.config.credentialsClient.getCredentialsSync()}async getLoginState(){return this.config.credentialsClient.getCredentialsAsync()}async transByProvider(e){return this.config.request(ia.USER_TRANS_BY_PROVIDER_URL,{method:"PATCH",body:e,withCredentials:!0})}async grantToken(e){const t=this.getParamsByVersion(e,"AUTH_TOKEN_URL");return this.config.request(t.url,{method:"POST",body:t.params})}async getProviders(){return this.config.request(ia.PROVIDER_LIST,{method:"GET",withCredentials:!0})}async unbindProvider(e){return this.config.request(`${ia.PROVIDER_UNBIND_URL}/${e.provider_id}`,{method:"DELETE",withCredentials:!0})}async checkPassword(e){return this.config.request(`${ia.CHECK_PWD_URL}`,{method:"POST",withCredentials:!0,body:e})}async editContact(e){return this.config.request(`${ia.BIND_CONTACT_URL}`,{method:"PATCH",withCredentials:!0,body:e})}async setPassword(e){return this.config.request(`${ia.AUTH_SET_PASSWORD}`,{method:"PATCH",withCredentials:!0,body:e})}async updatePasswordByOld(e){const t=await this.sudo({password:e.old_password});return this.setPassword({sudo_token:t.sudo_token,new_password:e.new_password})}async sudo(e){return this.config.request(`${ia.SUDO_URL}`,{method:"POST",withCredentials:!0,body:e})}async sendVerificationCodeToCurrentUser(e){return e.target="CUR_USER",this.config.request(ia.VERIFICATION_URL,{method:"POST",body:e,withCredentials:!0,withCaptcha:!0})}async changeBoundProvider(e){return this.config.request(`${ia.PROVIDER_LIST}/${e.provider_id}/trans`,{method:"POST",body:{provider_trans_token:e.trans_token},withCredentials:!0})}async setUserProfile(e){return this.config.request(ia.USER_PRIFILE_URL,{method:"PATCH",body:e,withCredentials:!0})}async updateUserBasicInfo(e){return this.config.request(ia.USER_BASIC_EDIT_URL,{method:"POST",withCredentials:!0,body:e})}async queryUserProfile(e){const t=new ka(e);return this.config.request(`${ia.USER_QUERY_URL}?${t.toString()}`,{method:"GET",withCredentials:!0})}setCustomSignFunc(e){this.getCustomSignTicketFn=e}async signInWithCustomTicket(){const e=this.getCustomSignTicketFn;if(!e)return Promise.reject({error:"failed_precondition",error_description:"please use setCustomSignFunc to set custom sign function"});const t=await e();return this.signInCustom({provider_id:"custom",ticket:t})}async resetPassword(e){return this.config.request(ia.AUTH_RESET_PASSWORD,{method:"POST",body:e})}async authorize(e){return this.config.request(ia.AUTHORIZE_URL,{method:"POST",withCredentials:!0,body:e})}async authorizeDevice(e){return this.config.request(ia.AUTHORIZE_DEVICE_URL,{method:"POST",withCredentials:!0,body:e})}async deviceAuthorize(e){return this.config.request(ia.AUTH_GET_DEVICE_CODE,{method:"POST",body:e,withCredentials:!0})}async authorizeInfo(t){const r=`${ia.AUTHORIZE_INFO_URL}?${e.parseParamsToSearch(t)}`;let n=!0,o=!1;return await this.hasLoginState()&&(o=!0,n=!1),this.config.request(r,{method:"GET",withBasicAuth:n,withCredentials:o})}async checkUsername(e){return this.config.request(ia.CHECK_USERNAME,{method:"GET",body:e,withCredentials:!0})}async checkIfUserExist(e){const t=new ka(e);return this.config.request(`${ia.CHECK_IF_USER_EXIST}?${t.toString()}`,{method:"GET"})}async loginScope(){return this.config.credentialsClient.getScope()}async loginGroups(){return this.config.credentialsClient.getGroups()}async refreshTokenForce(e){const t=await this.config.credentialsClient.getCredentials();return await this.config.credentialsClient.refreshToken({...t,version:(null==e?void 0:e.version)||"v1"})}async getCredentials(){return this.config.credentialsClient.getCredentials()}async getPublicKey(){return this.config.request(sa.AUTH_PUBLIC_KEY,{method:"POST",body:{}})}async getEncryptParams(e){const{isEncrypt:t}=e;delete e.isEncrypt;const r=ya(e),n=Ua(t,this.config.adapter);if(!n)return e;let o="",i="";try{const e=await this.getPublicKey();if(o=e.public_key,i=e.public_key_thumbprint,!o||!i)throw e}catch(a){throw a}return{params:n.getEncryptInfo({publicKey:o,payload:r}),public_key_thumbprint:i}}async getProviderSubType(){return this.config.request(ia.GET_PROVIDER_TYPE,{method:"POST",body:{provider_id:"weda"}})}async verifyCaptchaData({token:e,key:t}){return this.config.request(ia.VERIFY_CAPTCHA_DATA_URL,{method:"POST",body:{token:e,key:t},withCredentials:!1})}async createCaptchaData({state:e,redirect_uri:t}){return this.config.request(ia.CAPTCHA_DATA_URL,{method:"POST",body:{state:e,redirect_uri:t},withCredentials:!1})}async getMiniProgramCode(e){return this.config.request(ia.GET_MINIPROGRAM_QRCODE,{method:"POST",body:e})}async getMiniProgramQrCodeStatus(e){return this.config.request(ia.GET_MINIPROGRAM_QRCODE_STATUS,{method:"POST",body:e})}async getUserBehaviorLog(e){const t=`${ia.GET_USER_BEHAVIOR_LOG}?${{LOGIN:"query[action]=USER_LOGIN",MODIFY:"ne_query[action]=USER_LOGIN"}[e.type]}&limit=${e.limit}${e.page_token?`&page_token=${e.page_token}`:""}`;return this.config.request(t,{method:"GET",withCredentials:!0})}async modifyPassword(e){let t="",r="";const n=Ua(!0,this.config.adapter);if(!n)throw new Error("do not support encrypt, a encrypt util required.");try{const e=await this.getPublicKey();if(t=e.public_key,r=e.public_key_thumbprint,!t||!r)throw e}catch(a){throw a}const o=e.password?n.getEncryptInfo({publicKey:t,payload:e.password}):"",i=n.getEncryptInfo({publicKey:t,payload:e.new_password});return this.config.request(ia.USER_BASIC_EDIT_URL,{method:"POST",withCredentials:!0,body:{user_id:e.user_id,encrypt_password:o,encrypt_new_password:i,public_key_thumbprint:r}})}async modifyPasswordWithoutLogin(e){let t="",r="";const n=Ua(!0,this.config.adapter);if(!n)throw new Error("do not support encrypt, a encrypt util required.");try{const e=await this.getPublicKey();if(t=e.public_key,r=e.public_key_thumbprint,!t||!r)throw e}catch(a){throw a}const o=e.password?n.getEncryptInfo({publicKey:t,payload:e.password}):"",i=n.getEncryptInfo({publicKey:t,payload:e.new_password});return this.config.request(sa.AUTH_RESET_PASSWORD,{method:"POST",body:{username:e.username,password:o,new_password:i,public_key_thumbprint:r}})}};class ja{constructor(e){const{apiOrigin:t,apiPath:r=oa,clientId:n,env:o,storage:i,request:a,baseRequest:s,anonymousSignInFunc:c,wxCloud:l,adapter:u,onCredentialsError:d,headers:f,i18n:p,useWxCloud:h}=e;this.oauth2client=new Ca({apiOrigin:t,apiPath:r,clientId:n,env:o,storage:i,baseRequest:s||a,anonymousSignInFunc:c,wxCloud:l,onCredentialsError:d,headers:f||{},i18n:p,useWxCloud:h}),this.authApi=new Da({credentialsClient:this.oauth2client,...e,request:a?this.oauth2client.request.bind(this.oauth2client):void 0,adapter:u})}}var Ma={};Object.defineProperty(Ma,"__esModule",{value:!0}),Ma.parseQueryString=Ma.transformPhone=Ma.sleep=Ma.printGroupLog=Fa=Ma.throwError=Ma.printInfo=Ma.printError=Ba=Ma.printWarn=Ma.execCallback=Ma.createPromiseCallback=Ma.removeParam=Ma.getHash=Ma.getQuery=Ma.toQueryString=Ma.formatUrl=Ma.generateRequestId=Ma.genSeqId=Ma.isFormData=Ma.isInstanceOf=Ma.isNull=Ma.isPalinObject=Ma.isUndefined=Ma.isString=Ma.isArray=void 0;var qa=Ti;Ma.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},Ma.isString=function(e){return"string"==typeof e},Ma.isUndefined=function(e){return void 0===e},Ma.isPalinObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)},Ma.isNull=function(e){return"[object Null]"===Object.prototype.toString.call(e)},Ma.isInstanceOf=function(e,t){return e instanceof t},Ma.isFormData=function(e){return"[object FormData]"===Object.prototype.toString.call(e)},Ma.genSeqId=function(){return Math.random().toString(16).slice(2)},Ma.generateRequestId=function(){var e=(new Date).getTime(),t=(null===Date||void 0===Date?void 0:Date.now)&&1e3*Date.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){var n=16*Math.random();return e>0?(n=(e+n)%16|0,e=Math.floor(e/16)):(n=(t+n)%16|0,t=Math.floor(t/16)),("x"===r?n:7&n|8).toString(16)})},Ma.formatUrl=function(e,t,r){void 0===r&&(r={});var n=/\?/.test(t),o="";return Object.keys(r).forEach(function(e){""===o?!n&&(t+="?"):o+="&",o+="".concat(e,"=").concat(encodeURIComponent(r[e]))}),/^http(s)?:\/\//.test(t+=o)?t:"".concat(e).concat(t)},Ma.toQueryString=function(e){void 0===e&&(e={});var t=[];return Object.keys(e).forEach(function(r){t.push("".concat(r,"=").concat(encodeURIComponent(e[r])))}),t.join("&")},Ma.getQuery=function(e,t){if("undefined"==typeof window)return!1;var r=t||window.location.search,n=new RegExp("(^|&)".concat(e,"=([^&]*)(&|$)")),o=r.substr(r.indexOf("?")+1).match(n);return null!=o?o[2]:""};Ma.getHash=function(e){if("undefined"==typeof window)return"";var t=window.location.hash.match(new RegExp("[#?&/]".concat(e,"=([^&#]*)")));return t?t[1]:""},Ma.removeParam=function(e,t){var r=t.split("?")[0],n=[],o=-1!==t.indexOf("?")?t.split("?")[1]:"";if(""!==o){for(var i=(n=o.split("&")).length-1;i>=0;i-=1)n[i].split("=")[0]===e&&n.splice(i,1);r="".concat(r,"?").concat(n.join("&"))}return r},Ma.createPromiseCallback=function(){var e;if(!Promise){(e=function(){}).promise={};var t=function(){throw new Error('Your Node runtime does support ES6 Promises. Set "global.Promise" to your preferred implementation of promises.')};return Object.defineProperty(e.promise,"then",{get:t}),Object.defineProperty(e.promise,"catch",{get:t}),e}var r=new Promise(function(t,r){e=function(e,n){return e?r(e):t(n)}});return e.promise=r,e},Ma.execCallback=function(e,t,r){if(void 0===r&&(r=null),e&&"function"==typeof e)return e(t,r);if(t)throw t;return r};var Ba=Ma.printWarn=function(e,t){console.warn("[".concat((0,qa.getSdkName)(),"][").concat(e,"]:").concat(t))};Ma.printError=function(e,t){console.error({code:e,msg:"[".concat((0,qa.getSdkName)(),"][").concat(e,"]:").concat(t)})},Ma.printInfo=function(e,t){console.log("[".concat((0,qa.getSdkName)(),"][").concat(e,"]:").concat(t))};var Fa=Ma.throwError=function(e,t){throw new Error(JSON.stringify({code:e,msg:"[".concat((0,qa.getSdkName)(),"][").concat(e,"]:").concat(t)}))};Ma.printGroupLog=function(e){var t,r=e.title,n=e.subtitle,o=void 0===n?"":n,i=e.content,a=void 0===i?[]:i,s=e.printTrace,c=void 0!==s&&s,l=e.collapsed;void 0!==l&&l?(console.groupCollapsed||console.error)(r,o):(console.group||console.error)(r,o);for(var u=0,d=a;u<d.length;u++){var f=d[u],p=f.type,h=f.body;switch(p){case"info":console.log(h);break;case"warn":console.warn(h);break;case"error":console.error(h)}}c&&(console.trace||console.log)("stack trace:"),null===(t=console.groupEnd)||void 0===t||t.call(console)};Ma.sleep=function(e){return void 0===e&&(e=0),new Promise(function(t){return setTimeout(t,e)})},Ma.transformPhone=function(e){return"+86".concat(e)};Ma.parseQueryString=function(e){e=e.replace(/^\?/,"");var t={};return e.split("&").forEach(function(e){var r=e.split("="),n=r[0],o=r[1];n=decodeURIComponent(n),o=decodeURIComponent(o),n&&(t[n]?Array.isArray(t[n])?t[n].push(o):t[n]=[t[n],o]:t[n]=o)}),t};var Wa={},Ha={},Ga=xi&&xi.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},$a=xi&&xi.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};Object.defineProperty(Ha,"__esModule",{value:!0}),Ha.catchErrorsDecorator=void 0;var za=Ma,Ka=Ti,Ja=!1;"undefined"!=typeof navigator&&navigator.userAgent&&(Ja=-1!==navigator.userAgent.indexOf("Firefox"));var Ya=Ja?/(\.js\/)?__decorate(\$\d+)?<@.*\d$/:/(\/\w+\.js\.)?__decorate(\$\d+)?\s*\(.*\)$/,Xa=/https?:\/\/.+:\d*\/.*\.js:\d+:\d+/;function Qa(e){var t=e.err,r=e.className,n=e.methodName,o=e.sourceLink;if(!o)return null;var i,a=t.stack.split("\n"),s=Ja?/^catchErrorsDecorator\/<\/descriptor.value@.*\d$/:new RegExp("".concat(r,"\\.descriptor.value\\s*\\[as\\s").concat(n,"\\]\\s*\\(.*\\)$")),c=Ja?/^catchErrorsDecorator\/<\/descriptor.value/:new RegExp("".concat(r,"\\.descriptor.value\\s*\\[as\\s").concat(n,"\\]")),l=a.findIndex(function(e){return s.test(e)});if(-1!==l){var u=a.filter(function(e,t){return t>l});u.unshift(a[l].replace(c,"".concat(r,".").concat(n)).replace(Xa,o)),(i=new Error).stack="".concat(Ja?"@debugger":"Error","\n").concat(u.join("\n"))}return i}Ha.catchErrorsDecorator=function(e){var t=e.mode,r=void 0===t?"async":t,n=e.customInfo,o=void 0===n?{}:n,i=e.title,a=e.messages,s=void 0===a?[]:a;return function(e,t,n){if(Ka.IS_DEBUG_MODE){var a=o.className||e.constructor.name,c=o.methodName||t,l=n.value,u=function(e){var t="",r=e.stack.split("\n"),n=r.findIndex(function(e){return Ya.test(e)});if(-1!==n){var o=Xa.exec(r[n+1]||"");t=o?o[0]:""}return t}(new Error);n.value="sync"===r?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Qa({err:new Error,className:a,methodName:c,sourceLink:u});try{return l.apply(this,e)}catch(m){var n=m,o=m.message,d=m.error,f=m.error_description,p={title:i||"".concat(a,".").concat(c," failed"),content:[{type:"error",body:m}]};if(o&&/^\{.*\}$/.test(o)){var h=JSON.parse(o);p.subtitle=o,h.code&&(r?(r.code=h.code,r.msg=h.msg):(m.code=h.code,m.message=h.msg),n=r||m,p.content=s.map(function(e){return{type:"info",body:e}}))}throw d&&f&&(p.subtitle=f,r?(r.code=d,r.msg=f):(m.code=d,m.message=f),n=r||m,p.content=s.map(function(e){return{type:"info",body:e}})),(0,za.printGroupLog)(p),n}}:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ga(this,void 0,void 0,function(){var t,r,n,o,d,f,p,h;return $a(this,function(m){switch(m.label){case 0:t=Qa({err:new Error,className:a,methodName:c,sourceLink:u}),m.label=1;case 1:return m.trys.push([1,3,,4]),[4,l.apply(this,e)];case 2:return[2,m.sent()];case 3:throw r=m.sent(),n=r,o=r.message,d=r.error,f=r.error_description,p={title:i||"".concat(a,".").concat(c," failed"),content:[{type:"error",body:r}]},o&&/^\{.*\}$/.test(o)&&(h=JSON.parse(o),p.subtitle=h,h.code&&(t?(t.code=h.code,t.message=h.msg):(r.code=h.code,r.message=h.msg),n=t||r,p.content=s.map(function(e){return{type:"info",body:e}}))),d&&f&&(p.subtitle=f,t?(t.code=d,t.msg=f):(r.code=d,r.message=f),n=t||r,p.content=s.map(function(e){return{type:"info",body:e}})),(0,za.printGroupLog)(p),n;case 4:return[2]}})})}}}},function(e){var t=xi&&xi.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),r=xi&&xi.__exportStar||function(e,r){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(r,n)||t(r,e,n)};Object.defineProperty(e,"__esModule",{value:!0}),r(Ha,e)}(Wa);var Za={},es=xi&&xi.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ts=xi&&xi.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};Object.defineProperty(Za,"__esModule",{value:!0}),Za.removeEventListener=Za.activateEvent=Za.addEventListener=as=Za.CloudbaseEventEmitter=Za.IErrorEvent=Za.CloudbaseEvent=void 0;var rs=Ma;var ns=function(){return function(e,t){this.data=t||null,this.name=e}}();Za.CloudbaseEvent=ns;var os=function(e){function t(t,r){var n=e.call(this,"error",{error:t,data:r})||this;return n.error=t,n}return es(t,e),t}(ns);Za.IErrorEvent=os;var is=function(){function e(){this.listeners={}}return e.prototype.on=function(e,t){return function(e,t,r){r[e]=r[e]||[],r[e].push(t)}(e,t,this.listeners),this},e.prototype.off=function(e,t){return function(e,t,r){if(null==r?void 0:r[e]){var n=r[e].indexOf(t);-1!==n&&r[e].splice(n,1)}}(e,t,this.listeners),this},e.prototype.fire=function(e,t){if((0,rs.isInstanceOf)(e,os))return console.error(e.error),this;var r=(0,rs.isString)(e)?new ns(e,t||{}):e,n=r.name;if(this.listens(n)){r.target=this;for(var o=0,i=this.listeners[n]?ts([],this.listeners[n],!0):[];o<i.length;o++){i[o].call(this,r)}}return this},e.prototype.listens=function(e){return this.listeners[e]&&this.listeners[e].length>0},e}(),as=Za.CloudbaseEventEmitter=is,ss=new is;Za.addEventListener=function(e,t){ss.on(e,t)},Za.activateEvent=function(e,t){void 0===t&&(t={}),ss.fire(e,t)},Za.removeEventListener=function(e,t){ss.off(e,t)};var cs={};const ls=Ii(D);var us={},ds=xi&&xi.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),fs=xi&&xi.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},ps=xi&&xi.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};Object.defineProperty(cs,"__esModule",{value:!0});var hs=cs.CloudbaseCache=void 0,ms=Ma,ys=Ti,vs=function(e){function t(t){var r=e.call(this)||this;return r.root=t,t.tcbCacheObject||(t.tcbCacheObject={}),r}return ds(t,e),t.prototype.setItem=function(e,t){this.root.tcbCacheObject[e]=t},t.prototype.getItem=function(e){return this.root.tcbCacheObject[e]},t.prototype.removeItem=function(e){delete this.root.tcbCacheObject[e]},t.prototype.clear=function(){delete this.root.tcbCacheObject},t}(ls.AbstractStorage);var gs=function(){function e(e){this.keys={};var t=e.persistence,r=e.platformInfo,n=void 0===r?{}:r,o=e.keys,i=void 0===o?{}:o;this.platformInfo=n,this.storage||(this.persistenceTag=this.platformInfo.adapter.primaryStorage||t,this.storage=function(e,t){switch(e){case"local":default:return t.localStorage?t.localStorage:((0,ms.printWarn)(ys.ERRORS.INVALID_PARAMS,"localStorage is not supported on current platform"),new vs(t.root));case"none":return new vs(t.root)}}(this.persistenceTag,this.platformInfo.adapter),this.keys=i)}return Object.defineProperty(e.prototype,"mode",{get:function(){return this.storage.mode||"sync"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"persistence",{get:function(){return this.persistenceTag},enumerable:!1,configurable:!0}),e.prototype.setStore=function(e,t,r){if("async"!==this.mode){if(this.storage)try{var n={version:r||"localCachev1",content:t};this.storage.setItem(e,JSON.stringify(n))}catch(hL){throw new Error(JSON.stringify({code:ys.ERRORS.OPERATION_FAIL,msg:"[".concat((0,ys.getSdkName)(),"][").concat(ys.ERRORS.OPERATION_FAIL,"]setStore failed"),info:hL}))}}else(0,ms.printWarn)(ys.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use setStoreAsync insteed")},e.prototype.setStoreAsync=function(e,t,r){return fs(this,void 0,void 0,function(){var n;return ps(this,function(o){switch(o.label){case 0:if(!this.storage)return[2];o.label=1;case 1:return o.trys.push([1,3,,4]),n={version:r||"localCachev1",content:t},[4,this.storage.setItem(e,JSON.stringify(n))];case 2:return o.sent(),[3,4];case 3:return o.sent(),[2];case 4:return[2]}})})},e.prototype.getStore=function(e,t){var r;if("async"!==this.mode){try{if("undefined"!=typeof process&&(null===(r=us)||void 0===r?void 0:r.tcb_token))return us.tcb_token;if(!this.storage)return""}catch(hL){return""}t=t||"localCachev1";var n=this.storage.getItem(e);return n&&n.indexOf(t)>=0?JSON.parse(n).content:""}(0,ms.printWarn)(ys.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use getStoreAsync insteed")},e.prototype.getStoreAsync=function(e,t){var r;return fs(this,void 0,void 0,function(){var n;return ps(this,function(o){switch(o.label){case 0:try{if("undefined"!=typeof process&&(null===(r=us)||void 0===r?void 0:r.tcb_token))return[2,us.tcb_token];if(!this.storage)return[2,""]}catch(hL){return[2,""]}return t=t||"localCachev1",[4,this.storage.getItem(e)];case 1:return(n=o.sent())&&n.indexOf(t)>=0?[2,JSON.parse(n).content]:[2,""]}})})},e.prototype.removeStore=function(e){"async"!==this.mode?this.storage.removeItem(e):(0,ms.printWarn)(ys.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use removeStoreAsync insteed")},e.prototype.removeStoreAsync=function(e){return fs(this,void 0,void 0,function(){return ps(this,function(t){switch(t.label){case 0:return[4,this.storage.removeItem(e)];case 1:return t.sent(),[2]}})})},e}();hs=cs.CloudbaseCache=gs;var bs={},ws={},Es=xi&&xi.__extends||function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),_s=xi&&xi.__assign||function(){return _s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},_s.apply(this,arguments)},Ss=xi&&xi.__awaiter||function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},xs=xi&&xi.__generator||function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};Object.defineProperty(ws,"__esModule",{value:!0}),ws.WebRequest=ws.genAdapter=void 0;var Ns=Ma,Is=Oi,Ts=function(e){function t(t){var r=e.call(this)||this,n=t.timeout,o=t.timeoutMsg,i=t.restrictedMethods;return r.timeout=n||0,r.timeoutMsg=o||"è¯·æ±‚è¶…æ—¶",r.restrictedMethods=i||["get","post","upload","download"],r}return Es(t,e),t.prototype.get=function(e){return this.request(_s(_s({},e),{method:"get"}),this.restrictedMethods.includes("get"))},t.prototype.post=function(e){return this.request(_s(_s({},e),{method:"post"}),this.restrictedMethods.includes("post"))},t.prototype.put=function(e){return this.request(_s(_s({},e),{method:"put"}))},t.prototype.upload=function(e){var t=e.data,r=e.file,n=e.name,o=e.method,i=e.headers,a=void 0===i?{}:i,s={post:"post",put:"put"}[null==o?void 0:o.toLowerCase()]||"put",c=new FormData;return"post"===s?(Object.keys(t).forEach(function(e){c.append(e,t[e])}),c.append("key",n),c.append("file",r),this.request(_s(_s({},e),{data:c,method:s}),this.restrictedMethods.includes("upload"))):this.request(_s(_s({},e),{method:"put",headers:a,body:r}),this.restrictedMethods.includes("upload"))},t.prototype.download=function(e){return Ss(this,void 0,void 0,function(){var t,r,n,o;return xs(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,this.get(_s(_s({},e),{headers:{},responseType:"blob"}))];case 1:return t=i.sent().data,r=window.URL.createObjectURL(new Blob([t])),n=decodeURIComponent(new URL(e.url).pathname.split("/").pop()||""),(o=document.createElement("a")).href=r,o.setAttribute("download",n),o.style.display="none",document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(r),document.body.removeChild(o),[3,3];case 2:return i.sent(),[3,3];case 3:return[2,new Promise(function(t){t({statusCode:200,tempFilePath:e.url})})]}})})},t.prototype.fetch=function(e){var t;return Ss(this,void 0,void 0,function(){var r,n,o,i,a,s,c,l,u,d,f,p,h,m=this;return xs(this,function(y){switch(y.label){case 0:return r=new AbortController,n=e.url,o=e.enableAbort,i=void 0!==o&&o,a=e.stream,s=void 0!==a&&a,c=e.signal,l=e.timeout,u=e.shouldThrowOnError,d=void 0===u||u,f=null!=l?l:this.timeout,c&&(c.aborted&&r.abort(),c.addEventListener("abort",function(){return r.abort()})),p=null,i&&f&&(p=setTimeout(function(){console.warn(m.timeoutMsg),r.abort(new Error(m.timeoutMsg))},f)),[4,fetch(n,_s(_s({},e),{signal:r.signal})).then(function(e){return Ss(m,void 0,void 0,function(){var t,r,n;return xs(this,function(o){switch(o.label){case 0:return clearTimeout(p),d?e.ok?(t=e,[3,3]):[3,1]:[3,4];case 1:return n=(r=Promise).reject,[4,e.json()];case 2:t=n.apply(r,[o.sent()]),o.label=3;case 3:return[2,t];case 4:return[2,e]}})})}).catch(function(e){if(clearTimeout(p),d)return Promise.reject(e)})];case 1:return h=y.sent(),[2,{data:s?h.body:(null===(t=h.headers.get("content-type"))||void 0===t?void 0:t.includes("application/json"))?h.json():h.text(),statusCode:h.status,header:h.headers}]}})})},t.prototype.request=function(e,t){var r=this;void 0===t&&(t=!1);var n=String(e.method).toLowerCase()||"get";return new Promise(function(o){var i,a,s=e.url,c=e.headers,l=void 0===c?{}:c,u=e.data,d=e.responseType,f=e.withCredentials,p=e.body,h=e.onUploadProgress,m=(0,Ns.formatUrl)((0,Is.getProtocol)(),s,"get"===n?u:{}),y=new XMLHttpRequest;y.open(n,m),d&&(y.responseType=d),Object.keys(l).forEach(function(e){y.setRequestHeader(e,l[e])}),h&&y.upload.addEventListener("progress",h),y.onreadystatechange=function(){var e={};if(4===y.readyState){var t=y.getAllResponseHeaders().trim().split(/[\r\n]+/),r={};t.forEach(function(e){var t=e.split(": "),n=t.shift().toLowerCase(),o=t.join(": ");r[n]=o}),e.header=r,e.statusCode=y.status;try{e.data="blob"===d?y.response:JSON.parse(y.responseText)}catch(hL){e.data="blob"===d?y.response:y.responseText}clearTimeout(i),o(e)}},t&&r.timeout&&(i=setTimeout(function(){console.warn(r.timeoutMsg),y.abort()},r.timeout)),a=(0,Ns.isFormData)(u)?u:"application/x-www-form-urlencoded"===l["content-type"]?(0,Ns.toQueryString)(u):p||(u?JSON.stringify(u):void 0),f&&(y.withCredentials=!0),y.send(a)})},t}(ls.AbstractSDKRequest);ws.WebRequest=Ts,ws.genAdapter=function(){return{type:"default",root:window,reqClass:Ts,wsClass:WebSocket,localStorage:localStorage}},function(e){var t=xi&&xi.__assign||function(){return t=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},t.apply(this,arguments)},r=xi&&xi.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),n=xi&&xi.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=xi&&xi.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var o in e)"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&r(t,e,o);return n(t,e),t};Object.defineProperty(e,"__esModule",{value:!0}),e.useDefaultAdapter=e.useAdapters=e.RUNTIME=void 0;var i,a,s=o(ws),c=Ma;(a=i=e.RUNTIME||(e.RUNTIME={})).WEB="web",a.WX_MP="wx_mp",e.useAdapters=function(e,r){for(var n=0,o=(0,c.isArray)(e)?e:[e];n<o.length;n++){var i=o[n],a=i.isMatch,s=i.genAdapter,l=i.runtime;if(a())return{adapter:t({isMatch:a},s(r)),runtime:l}}},e.useDefaultAdapter=function(){return{adapter:s.genAdapter(),runtime:i.WEB}}}(bs);var Os=function(){return Os=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Os.apply(this,arguments)},As=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},Rs=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Ps=function(){function e(e){var t,r;try{this.localStorage=(null==e?void 0:e.localStorage)||((null===(r=null===(t=null==e?void 0:e.adapter)||void 0===t?void 0:t.root)||void 0===r?void 0:r.globalThis)||globalThis).localStorage}catch(n){this.localStorage=(null==e?void 0:e.localStorage)||{}}}return e.prototype.getItem=function(e){return As(this,void 0,void 0,function(){return Rs(this,function(t){return[2,this.localStorage.getItem(e)]})})},e.prototype.removeItem=function(e){return As(this,void 0,void 0,function(){return Rs(this,function(t){return this.localStorage.removeItem(e),[2]})})},e.prototype.setItem=function(e,t){return As(this,void 0,void 0,function(){return Rs(this,function(r){return this.localStorage.setItem(e,t),[2]})})},e.prototype.getItemSync=function(e){return this.localStorage.getItem(e)},e.prototype.setItemSync=function(e,t){this.localStorage.setItem(e,t)},e.prototype.removeItemSync=function(e){this.localStorage.removeItem(e)},e}(),Cs=/^[^:]+:\/\/[^/]+(\/[^?#]+)/,ks=function(e,t){var r,n,o,i,a=null===(r=null==t?void 0:t.headers)||void 0===r?void 0:r["x-request-id"];return e||(e={}),((null==e?void 0:e.code)||(null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.error_code))&&(e={error:e.code||e.data.error,error_description:e.data.error_description||e.message||e.code||e.data.error_code,request_id:e.requestId,error_code:null===(o=e.data)||void 0===o?void 0:o.error_code}),(null==e?void 0:e.request_id)||(e.request_id=e.request_id||a),(null==e?void 0:e.error)?(e.error_uri=(i=null==t?void 0:t.url,Cs.test(i)?RegExp.$1:i),e):(null==e?void 0:e.data)||{}};var Vs=function(e,t){if(!Lo.isMatch()||e.storage&&e.baseRequest)return e;var r=Os({},e),n={};try{var o=Lo.genAdapter({}),i=o.localStorage,a=o.reqClass;if(i&&(n.storage=new Ps({localStorage:i,adapter:t})),a){var s=new a({timeout:1e4,restrictedMethods:["get","post","upload","download","request"]});n.request=function(e){return function(t,r){return As(this,void 0,void 0,function(){return Rs(this,function(n){return[2,new Promise(function(n,o){var i=Object.assign({},r);i.body&&"string"!=typeof i.body&&(i.body=JSON.stringify(i.body));var a=wx.request({url:t,data:i.body,timeout:e._timeout,method:i.method||"GET",header:i.headers,success:function(e){(e=ks(e,Os(Os({},r),{url:t}))).error&&o(e),n(e)},fail:function(e){o({error:"unreachable",error_description:e.message})},complete:function(t){if(t&&t.errMsg&&e._timeout&&-1!==e._restrictedMethods.indexOf("request")&&"request:fail timeout"===t.errMsg){console.warn(e._timeoutMsg);try{a.abort()}catch(hL){}}}})})]})})}}(s)}return r.captchaOptions&&(n.baseRequest=n.request,n.request=void 0),Os(Os({},r),n)}catch(hL){console.error("adapter generate fail:",hL)}return r},Ls=function(e){return e.adapter&&"default"!==e.adapter.type?function(e,t){var r=Os({},e);try{if(!(null==e?void 0:e.storage)&&(null==t?void 0:t.localStorage)&&(r.storage=new Ps({localStorage:t.localStorage,adapter:t})),!e.captchaOptions&&(null==t?void 0:t.captchaOptions)&&(r.captchaOptions=t.captchaOptions),!e.baseRequest&&!e.request&&(null==t?void 0:t.reqClass)){var n=new t.reqClass({timeout:1e4,restrictedMethods:["get","post","upload","download","request"]});r.baseRequest=function(e,t){var r,o,i,a,s;return As(this,void 0,void 0,function(){var c,l,u,d;return Rs(this,function(f){switch(f.label){case 0:if(c={},l=(null===(r=t.method)||void 0===r?void 0:r.toLocaleLowerCase())||"post","function"!=typeof(u=null===(i=null===(o=null==n?void 0:n[l])||void 0===o?void 0:o.bind)||void 0===i?void 0:i.call(o,n)))throw new Error("invalid ã€".concat(l,"ã€‘ request method"));f.label=1;case 1:return f.trys.push([1,3,,4]),(null===(a=t.headers)||void 0===a?void 0:a["content-type"])&&!(null===(s=t.headers)||void 0===s?void 0:s["content-type"].includes("application/json"))||["string","undefined"].includes(typeof t.body)||(t.data=t.data||t.body,t.body=JSON.stringify(t.body)),[4,u(Os({url:e},t))];case 2:return c=f.sent(),c=ks(c,Os(Os({},t),{url:e})),[3,4];case 3:throw d=f.sent(),c=d,d;case 4:if(null==c?void 0:c.error)throw c;return[2,c]}})})}}}catch(hL){console.error("user adapter generate fail:",hL)}return r}(e,e.adapter):Vs(e,e.adapter)},Us=function(){return Us=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Us.apply(this,arguments)},Ds=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},js=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ms=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},qs=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},Bs="sign_out",Fs="sign_in",Ws="credentials_error",Hs="loginStateChanged",Gs=new as,$s=function(e){Gs.fire(Hs,Us(Us({},e),{eventType:Ws}))},zs=function(){function e(e){var t=e.cache,r=e.oauthInstance;this.cache=t,this.oauthInstance=r,this.setUserInfo()}return e.prototype.checkLocalInfo=function(){return Ms(this,void 0,void 0,function(){return qs(this,function(e){return this.uid=this.getLocalUserInfo("uid"),this.gender=this.getLocalUserInfo("gender"),this.picture=this.getLocalUserInfo("picture"),this.email=this.getLocalUserInfo("email"),this.emailVerified=this.getLocalUserInfo("email_verified"),this.phoneNumber=this.getLocalUserInfo("phone_number"),this.username=this.getLocalUserInfo("username"),this.name=this.getLocalUserInfo("name"),this.birthdate=this.getLocalUserInfo("birthdate"),this.zoneinfo=this.getLocalUserInfo("zoneinfo"),this.locale=this.getLocalUserInfo("locale"),this.sub=this.getLocalUserInfo("sub"),this.createdFrom=this.getLocalUserInfo("created_from"),this.providers=this.getLocalUserInfo("providers"),[2]})})},e.prototype.checkLocalInfoAsync=function(){return Ms(this,void 0,void 0,function(){var e,t,r,n;return qs(this,function(o){switch(o.label){case 0:return e=this,[4,this.getLocalUserInfoAsync("uid")];case 1:return e.uid=o.sent(),t=this,[4,this.getLocalUserInfoAsync("gender")];case 2:return t.gender=o.sent(),this.picture=this.getLocalUserInfo("picture"),r=this,[4,this.getLocalUserInfoAsync("email")];case 3:return r.email=o.sent(),this.emailVerified=this.getLocalUserInfo("email_verified"),this.phoneNumber=this.getLocalUserInfo("phone_number"),n=this,[4,this.getLocalUserInfoAsync("username")];case 4:return n.username=o.sent(),this.name=this.getLocalUserInfo("name"),this.birthdate=this.getLocalUserInfo("birthdate"),this.zoneinfo=this.getLocalUserInfo("zoneinfo"),this.locale=this.getLocalUserInfo("locale"),this.sub=this.getLocalUserInfo("sub"),this.createdFrom=this.getLocalUserInfo("created_from"),this.providers=this.getLocalUserInfo("providers"),[2]}})})},e.prototype.update=function(e){return Ms(this,void 0,void 0,function(){var t;return qs(this,function(r){switch(r.label){case 0:return[4,this.oauthInstance.authApi.setUserProfile(Us({},e))];case 1:return t=r.sent(),this.setLocalUserInfo(t),[2]}})})},e.prototype.updateUserBasicInfo=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){switch(t.label){case 0:return[4,this.oauthInstance.authApi.updateUserBasicInfo(Us({},e))];case 1:return t.sent(),this.setLocalUserInfo({username:e.username}),[2]}})})},e.prototype.updatePassword=function(e,t){return this.oauthInstance.authApi.updatePasswordByOld({old_password:t,new_password:e})},e.prototype.updateUsername=function(e){return"string"!=typeof e&&Fa(Ti.ERRORS.INVALID_PARAMS,"username must be a string"),this.update({username:e})},e.prototype.refresh=function(e){return Ms(this,void 0,void 0,function(){var t;return qs(this,function(r){switch(r.label){case 0:return[4,this.oauthInstance.authApi.getUserInfo(e)];case 1:if("INVALID_ACCESS_TOKEN"===(t=r.sent()).code)throw this.setLocalUserInfo({}),t;return this.setLocalUserInfo(t),[2,t]}})})},e.prototype.getLocalUserInfo=function(e){var t=this.cache.keys.userInfoKey;return this.cache.getStore(t)[e]},e.prototype.getLocalUserInfoAsync=function(e){return Ms(this,void 0,void 0,function(){var t;return qs(this,function(r){switch(r.label){case 0:return t=this.cache.keys.userInfoKey,[4,this.cache.getStoreAsync(t)];case 1:return[2,r.sent()[e]]}})})},e.prototype.setUserInfo=function(){var e=this,t=this.cache.keys.userInfoKey,r=this.cache.getStore(t);["uid","email","name","gender","picture","email_verified","phone_number","birthdate","zoneinfo","locale","sub","created_from","providers","username"].forEach(function(t){e[t]=r[t]})},e.prototype.setLocalUserInfo=function(e){var t=this.cache.keys.userInfoKey;this.cache.setStore(t,e),this.setUserInfo()},Ds([Wa.catchErrorsDecorator({title:"æ›´æ–°ç”¨æˆ·ä¿¡æ¯å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ User.update() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","  2 - ç”¨æˆ·ä¿¡æ¯ä¸­æ˜¯å¦åŒ…å«éæ³•å€¼","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[Object]),js("design:returntype",Promise)],e.prototype,"update",null),Ds([Wa.catchErrorsDecorator({title:"æ›´æ–°å¯†ç å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ User.updatePassword() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","  3 - æ–°å¯†ç ä¸­æ˜¯å¦åŒ…å«éæ³•å­—ç¬¦","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[String,String]),js("design:returntype",void 0)],e.prototype,"updatePassword",null),Ds([Wa.catchErrorsDecorator({title:"æ›´æ–°ç”¨æˆ·åå¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ User.updateUsername() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","  2 - å½“å‰ç¯å¢ƒæ˜¯å¦å¼€é€šäº†ç”¨æˆ·åå¯†ç ç™»å½•","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[String]),js("design:returntype",void 0)],e.prototype,"updateUsername",null),Ds([Wa.catchErrorsDecorator({title:"åˆ·æ–°æœ¬åœ°ç”¨æˆ·ä¿¡æ¯å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ User.refresh() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[Object]),js("design:returntype",Promise)],e.prototype,"refresh",null),e}(),Ks=function(){function e(e){var t=e.envId,r=e.cache,n=e.oauthInstance;t||Fa(Ti.ERRORS.INVALID_PARAMS,"envId is not defined"),this.cache=r,this.oauthInstance=n,this.user=new zs({cache:this.cache,oauthInstance:n})}return e.prototype.checkLocalState=function(){var e;this.oauthLoginState=null===(e=this.oauthInstance)||void 0===e?void 0:e.authApi.hasLoginStateSync(),this.user.checkLocalInfo()},e.prototype.checkLocalStateAsync=function(){var e;return Ms(this,void 0,void 0,function(){return qs(this,function(t){switch(t.label){case 0:return[4,null===(e=this.oauthInstance)||void 0===e?void 0:e.authApi.getLoginState()];case 1:return t.sent(),[4,this.user.checkLocalInfoAsync()];case 2:return t.sent(),[2]}})})},e}(),Js=function(){function e(e){this.config=e,this.cache=e.cache,this.oauthInstance=e.oauthInstance,this.setAccessKey()}return e.prototype.bindPhoneNumber=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){return[2,this.oauthInstance.authApi.editContact(e)]})})},e.prototype.unbindProvider=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){return[2,this.oauthInstance.authApi.unbindProvider(e)]})})},e.prototype.bindEmail=function(e){return this.oauthInstance.authApi.editContact(e)},e.prototype.verify=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){return[2,this.oauthInstance.authApi.verify(e)]})})},e.prototype.getVerification=function(e,t){return Ms(this,void 0,void 0,function(){return qs(this,function(r){return[2,this.oauthInstance.authApi.getVerification(e,t)]})})},Object.defineProperty(e.prototype,"currentUser",{get:function(){if("async"!==this.cache.mode){var e=this.hasLoginState();return e&&e.user||null}Ba(Ti.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use getCurrentUser instead")},enumerable:!1,configurable:!0}),e.prototype.getCurrentUser=function(){return Ms(this,void 0,void 0,function(){var e;return qs(this,function(t){switch(t.label){case 0:return[4,this.getLoginState()];case 1:return(e=t.sent())?[4,e.user.checkLocalInfoAsync()]:[3,3];case 2:return t.sent(),[2,e.user||null];case 3:return[2,null]}})})},e.prototype.signInAnonymously=function(e){return void 0===e&&(e={}),Ms(this,void 0,void 0,function(){return qs(this,function(t){switch(t.label){case 0:return[4,this.oauthInstance.authApi.signInAnonymously(e)];case 1:return t.sent(),[2,this.createLoginState()]}})})},e.prototype.signInAnonymouslyInWx=function(e){var t=(void 0===e?{}:e).useWxCloud;return Ms(this,void 0,void 0,function(){var e,r,n=this;return qs(this,function(o){switch(o.label){case 0:if(!Lo.isMatch())throw Error("wx api undefined");return e=wx.getAccountInfoSync().miniProgram,r=function(r){return Ms(n,void 0,void 0,function(){var n,o;return qs(this,function(i){switch(i.label){case 0:n=void 0,o=void 0,i.label=1;case 1:return i.trys.push([1,4,,5]),[4,this.oauthInstance.authApi.grantProviderToken({provider_id:null==e?void 0:e.appId,provider_code:r,provider_params:{provider_code_type:"open_id",appid:null==e?void 0:e.appId}},t)];case 2:if((null==(n=i.sent())?void 0:n.error_code)||!n.provider_token)throw n;return[4,this.oauthInstance.authApi.signInAnonymously({provider_token:n.provider_token},t)];case 3:if(null==(o=i.sent())?void 0:o.error_code)throw o;return[3,5];case 4:throw i.sent();case 5:return[2]}})})},[4,new Promise(function(e,t){wx.login({success:function(o){return Ms(n,void 0,void 0,function(){var n;return qs(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,r(o.code)];case 1:return i.sent(),e(!0),[3,3];case 2:return n=i.sent(),t(n),[3,3];case 3:return[2]}})})},fail:function(e){var r=new Error(null==e?void 0:e.errMsg);r.code=null==e?void 0:e.errno,t(r)}})})];case 1:return o.sent(),[2,this.createLoginState(void 0,{asyncRefreshUser:!0})]}})})},e.prototype.bindOpenId=function(){return Ms(this,void 0,void 0,function(){var e,t,r=this;return qs(this,function(n){switch(n.label){case 0:if(!Lo.isMatch())throw Error("wx api undefined");return e=wx.getAccountInfoSync().miniProgram,t=function(t){return Ms(r,void 0,void 0,function(){var r;return qs(this,function(n){switch(n.label){case 0:r=void 0,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,this.oauthInstance.authApi.grantProviderToken({provider_id:null==e?void 0:e.appId,provider_code:t,provider_params:{provider_code_type:"open_id",appid:null==e?void 0:e.appId}})];case 2:if((null==(r=n.sent())?void 0:r.error_code)||!r.provider_token)throw r;return[4,this.oauthInstance.authApi.bindWithProvider({provider_token:r.provider_token})];case 3:return n.sent(),[3,5];case 4:throw n.sent();case 5:return[2]}})})},[4,new Promise(function(e,n){wx.login({success:function(o){return Ms(r,void 0,void 0,function(){var r;return qs(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,t(o.code)];case 1:return i.sent(),e(!0),[3,3];case 2:return r=i.sent(),n(r),[3,3];case 3:return[2]}})})},fail:function(e){var t=new Error(null==e?void 0:e.errMsg);t.code=null==e?void 0:e.errno,n(t)}})})];case 1:return n.sent(),[2]}})})},e.prototype.signInWithOpenId=function(e){var t=(void 0===e?{}:e).useWxCloud,r=void 0===t||t;return Ms(this,void 0,void 0,function(){var e,t,n=this;return qs(this,function(o){switch(o.label){case 0:if(!Lo.isMatch())throw Error("wx api undefined");return e=wx.getAccountInfoSync().miniProgram,t=function(t){return Ms(n,void 0,void 0,function(){var n,o;return qs(this,function(i){switch(i.label){case 0:n=void 0,o=void 0,i.label=1;case 1:return i.trys.push([1,4,,5]),[4,this.oauthInstance.authApi.grantProviderToken({provider_id:null==e?void 0:e.appId,provider_code:t,provider_params:{provider_code_type:"open_id",appid:null==e?void 0:e.appId}},r)];case 2:if((null==(n=i.sent())?void 0:n.error_code)||!n.provider_token)throw n;return[4,this.oauthInstance.authApi.signInWithProvider({provider_token:n.provider_token},r)];case 3:if(null==(o=i.sent())?void 0:o.error_code)throw o;return[3,5];case 4:throw i.sent();case 5:return[4,this.oauthInstance.oauth2client.setCredentials(o)];case 6:return i.sent(),[2]}})})},[4,new Promise(function(e,r){wx.login({success:function(o){return Ms(n,void 0,void 0,function(){var n;return qs(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,t(o.code)];case 1:return i.sent(),e(!0),[3,3];case 2:return n=i.sent(),r(n),[3,3];case 3:return[2]}})})},fail:function(e){var t=new Error(null==e?void 0:e.errMsg);t.code=null==e?void 0:e.errno,r(t)}})})];case 1:return o.sent(),[2,this.createLoginState()]}})})},e.prototype.signInWithUnionId=function(){return Ms(this,void 0,void 0,function(){var e=this;return qs(this,function(t){switch(t.label){case 0:if(!Lo.isMatch())throw Error("wx api undefined");t.label=1;case 1:return t.trys.push([1,3,,4]),[4,new Promise(function(t,r){var n=wx.getAccountInfoSync().miniProgram;wx.login({success:function(o){return Ms(e,void 0,void 0,function(){var e,i,a,s,c;return qs(this,function(l){switch(l.label){case 0:e=null==n?void 0:n.appId,l.label=1;case 1:return l.trys.push([1,4,,5]),[4,this.oauthInstance.authApi.grantProviderToken({provider_code:o.code,provider_id:e,provider_params:{provider_code_type:"union_id",appid:null==n?void 0:n.appId}})];case 2:return i=l.sent(),(a=i.provider_token)?[4,this.oauthInstance.authApi.signInWithProvider({provider_id:e,provider_token:a})]:(r(i),[2]);case 3:return(null==(s=l.sent())?void 0:s.error_code)?(r(s),[2]):(t(!0),[3,5]);case 4:return c=l.sent(),r(c),[3,5];case 5:return[2]}})})},fail:function(e){var t=new Error(null==e?void 0:e.errMsg);t.code=null==e?void 0:e.errno,r(t)}})})];case 2:return t.sent(),[3,4];case 3:throw t.sent();case 4:return[2,this.createLoginState()]}})})},e.prototype.signInWithPhoneAuth=function(e){var t=e.phoneCode,r=void 0===t?"":t;return Ms(this,void 0,void 0,function(){var e,t,n,o,i;return qs(this,function(a){switch(a.label){case 0:if(!Lo.isMatch())throw Error("wx api undefined");return e=wx.getAccountInfoSync().miniProgram,t={provider_params:{provider_code_type:"phone"},provider_id:e.appId},[4,wx.login()];case 1:n=a.sent().code,t.provider_code=n,a.label=2;case 2:return a.trys.push([2,6,,7]),[4,this.oauthInstance.authApi.grantProviderToken(t)];case 3:if((o=a.sent()).error_code)throw o;return[4,this.oauthInstance.authApi.patchProviderToken({provider_token:o.provider_token,provider_id:e.appId,provider_params:{code:r,provider_code_type:"phone"}})];case 4:if((o=a.sent()).error_code)throw o;return[4,this.oauthInstance.authApi.signInWithProvider({provider_token:o.provider_token})];case 5:if(null==(i=a.sent())?void 0:i.error_code)throw i;return[3,7];case 6:throw a.sent();case 7:return[2,this.createLoginState()]}})})},e.prototype.signInWithSms=function(e){var t=e.verificationInfo,r=void 0===t?{verification_id:"",is_user:!1}:t,n=e.verificationCode,o=void 0===n?"":n,i=e.phoneNum,a=void 0===i?"":i,s=e.bindInfo,c=void 0===s?void 0:s;return Ms(this,void 0,void 0,function(){return qs(this,function(e){try{return[2,this.signInWithUsername({verificationInfo:r,verificationCode:o,bindInfo:c,username:a,loginType:"sms"})]}catch(t){throw t}return[2]})})},e.prototype.signInWithEmail=function(e){var t=e.verificationInfo,r=void 0===t?{verification_id:"",is_user:!1}:t,n=e.verificationCode,o=void 0===n?"":n,i=e.bindInfo,a=void 0===i?void 0:i,s=e.email,c=void 0===s?"":s;return Ms(this,void 0,void 0,function(){return qs(this,function(e){try{return[2,this.signInWithUsername({verificationInfo:r,verificationCode:o,bindInfo:a,username:c,loginType:"email"})]}catch(t){throw t}return[2]})})},e.prototype.setCustomSignFunc=function(e){this.oauthInstance.authApi.setCustomSignFunc(e)},e.prototype.signInWithCustomTicket=function(){return Ms(this,void 0,void 0,function(){return qs(this,function(e){switch(e.label){case 0:return[4,this.oauthInstance.authApi.signInWithCustomTicket()];case 1:return e.sent(),[2,this.createLoginState()]}})})},e.prototype.signIn=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){switch(t.label){case 0:return[4,this.oauthInstance.authApi.signIn(e)];case 1:return t.sent(),[2,this.createLoginState(e)]}})})},e.prototype.signUp=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){switch(t.label){case 0:return[4,this.oauthInstance.authApi.signUp(e)];case 1:return t.sent(),[2,this.createLoginState()]}})})},e.prototype.setPassword=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){return[2,this.oauthInstance.authApi.setPassword(e)]})})},e.prototype.isUsernameRegistered=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){switch(t.label){case 0:return"string"!=typeof e&&Fa(Ti.ERRORS.INVALID_PARAMS,"username must be a string"),[4,this.oauthInstance.authApi.checkIfUserExist({username:e})];case 1:return[2,t.sent().exist]}})})},e.prototype.signOut=function(e){return Ms(this,void 0,void 0,function(){var t,r;return qs(this,function(n){switch(n.label){case 0:return t=this.cache.keys.userInfoKey,[4,this.oauthInstance.authApi.signOut(e)];case 1:return r=n.sent(),[4,this.cache.removeStoreAsync(t)];case 2:return n.sent(),Gs.fire(Hs,{eventType:Bs}),[2,r]}})})},e.prototype.hasLoginState=function(){var e;if("async"!==this.cache.mode)return(null===(e=this.oauthInstance)||void 0===e?void 0:e.authApi.hasLoginStateSync())?new Ks({envId:this.config.env,cache:this.cache,oauthInstance:this.oauthInstance}):null;Ba(Ti.ERRORS.INVALID_OPERATION,"current platform's storage is asynchronous, please use getLoginState insteed")},e.prototype.getLoginState=function(){return Ms(this,void 0,void 0,function(){var e;return qs(this,function(t){switch(t.label){case 0:e=null,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.oauthInstance.authApi.getLoginState()];case 2:return e=t.sent(),[3,4];case 3:return t.sent(),[2,null];case 4:return e?[2,new Ks({envId:this.config.env,cache:this.cache,oauthInstance:this.oauthInstance})]:[2,null]}})})},e.prototype.getUserInfo=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){return[2,this.oauthInstance.authApi.getUserInfo(e)]})})},e.prototype.getWedaUserInfo=function(){return Ms(this,void 0,void 0,function(){return qs(this,function(e){return[2,this.oauthInstance.authApi.getWedaUserInfo()]})})},e.prototype.updateUserBasicInfo=function(e){return Ms(this,void 0,void 0,function(){var t;return qs(this,function(r){switch(r.label){case 0:return[4,this.getLoginState()];case 1:return(t=r.sent())?[4,t.user.updateUserBasicInfo(e)]:[3,3];case 2:r.sent(),r.label=3;case 3:return[2]}})})},e.prototype.getAuthHeader=function(){return console.error("Auth.getAuthHeader API å·²åºŸå¼ƒ"),{}},e.prototype.bindWithProvider=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){return[2,this.oauthInstance.authApi.bindWithProvider(e)]})})},e.prototype.queryUser=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){return[2,this.oauthInstance.authApi.queryUserProfile(e)]})})},e.prototype.getAccessToken=function(){return Ms(this,void 0,void 0,function(){return qs(this,function(e){switch(e.label){case 0:return[4,this.oauthInstance.oauth2client.getAccessToken()];case 1:return[2,{accessToken:e.sent(),env:this.config.env}]}})})},e.prototype.grantProviderToken=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){return[2,this.oauthInstance.authApi.grantProviderToken(e)]})})},e.prototype.patchProviderToken=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){return[2,this.oauthInstance.authApi.patchProviderToken(e)]})})},e.prototype.signInWithProvider=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){switch(t.label){case 0:return[4,this.oauthInstance.authApi.signInWithProvider(e)];case 1:return t.sent(),[2,this.createLoginState(e)]}})})},e.prototype.signInWithWechat=function(e){return void 0===e&&(e={}),Ms(this,void 0,void 0,function(){return qs(this,function(t){switch(t.label){case 0:return[4,this.oauthInstance.authApi.signInWithWechat(e)];case 1:return t.sent(),[2,this.createLoginState(e)]}})})},e.prototype.grantToken=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){switch(t.label){case 0:return[4,this.oauthInstance.authApi.grantToken(e)];case 1:return t.sent(),[2,this.createLoginState()]}})})},e.prototype.genProviderRedirectUri=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){return[2,this.oauthInstance.authApi.genProviderRedirectUri(e)]})})},e.prototype.resetPassword=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){return[2,this.oauthInstance.authApi.resetPassword(e)]})})},e.prototype.deviceAuthorize=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){return[2,this.oauthInstance.authApi.deviceAuthorize(e)]})})},e.prototype.sudo=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){return[2,this.oauthInstance.authApi.sudo(e)]})})},e.prototype.deleteMe=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){return[2,this.oauthInstance.authApi.deleteMe(e)]})})},e.prototype.getProviders=function(){return Ms(this,void 0,void 0,function(){return qs(this,function(e){return[2,this.oauthInstance.authApi.getProviders()]})})},e.prototype.loginScope=function(){return Ms(this,void 0,void 0,function(){return qs(this,function(e){return[2,this.oauthInstance.authApi.loginScope()]})})},e.prototype.loginGroups=function(){return Ms(this,void 0,void 0,function(){return qs(this,function(e){return[2,this.oauthInstance.authApi.loginGroups()]})})},e.prototype.onLoginStateChanged=function(e){return Ms(this,void 0,void 0,function(){var t,r=this;return qs(this,function(n){switch(n.label){case 0:return Gs.on(Hs,function(t){return Ms(r,void 0,void 0,function(){var r,n,o;return qs(this,function(i){switch(i.label){case 0:return(null===(o=null==t?void 0:t.data)||void 0===o?void 0:o.eventType)===Ws?[3,2]:[4,this.getLoginState()];case 1:return n=i.sent(),[3,3];case 2:n={},i.label=3;case 3:return r=n,e.call(this,Us(Us({},t),r)),[2]}})})}),[4,this.getLoginState()];case 1:return t=n.sent(),e.call(this,t),[2]}})})},e.prototype.refreshTokenForce=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){return[2,this.oauthInstance.authApi.refreshTokenForce(e)]})})},e.prototype.getCredentials=function(){return Ms(this,void 0,void 0,function(){return qs(this,function(e){return[2,this.oauthInstance.authApi.getCredentials()]})})},e.prototype.setCredentials=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){switch(t.label){case 0:return[4,this.oauthInstance.oauth2client.setCredentials(e)];case 1:return t.sent(),[2]}})})},e.prototype.getProviderSubType=function(){return Ms(this,void 0,void 0,function(){return qs(this,function(e){return[2,this.oauthInstance.authApi.getProviderSubType()]})})},e.prototype.createCaptchaData=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){return[2,this.oauthInstance.authApi.createCaptchaData(e)]})})},e.prototype.verifyCaptchaData=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){return[2,this.oauthInstance.authApi.verifyCaptchaData(e)]})})},e.prototype.getMiniProgramQrCode=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){return[2,this.oauthInstance.authApi.getMiniProgramCode(e)]})})},e.prototype.getMiniProgramQrCodeStatus=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){return[2,this.oauthInstance.authApi.getMiniProgramQrCodeStatus(e)]})})},e.prototype.modifyPassword=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){return[2,this.oauthInstance.authApi.modifyPassword(e)]})})},e.prototype.modifyPasswordWithoutLogin=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){return[2,this.oauthInstance.authApi.modifyPasswordWithoutLogin(e)]})})},e.prototype.getUserBehaviorLog=function(e){return Ms(this,void 0,void 0,function(){return qs(this,function(t){return[2,this.oauthInstance.authApi.getUserBehaviorLog(e)]})})},e.prototype.toDefaultLoginPage=function(e){return void 0===e&&(e={}),Ms(this,void 0,void 0,function(){var t,r,n,o,i;return qs(this,function(a){return t=e.config_version||"env",r=Object.keys(e.query||{}).map(function(t){return"".concat(t,"=").concat(e.query[t])}).join("&"),Lo.isMatch()?wx.navigateTo({url:"/packages/$wd_system/pages/login/index".concat(r?"?".concat(r):"")}):(n=e.redirect_uri||window.location.href,o=new URL(n),i="".concat(o.origin,"/__auth/?app_id=").concat(e.app_id||"","&env_id=").concat(this.config.env,"&client_id=").concat(this.config.clientId||this.config.env,"&config_version=").concat(t,"&redirect_uri=").concat(encodeURIComponent(n)).concat(r?"&".concat(r):""),window.location.href=i),[2]})})},e.prototype.createLoginState=function(e,t){return Ms(this,void 0,void 0,function(){var r;return qs(this,function(n){switch(n.label){case 0:return[4,(r=new Ks({envId:this.config.env,cache:this.cache,oauthInstance:this.oauthInstance})).checkLocalStateAsync()];case 1:return n.sent(),(null==t?void 0:t.asyncRefreshUser)?(r.user.refresh(e),[3,4]):[3,2];case 2:return[4,r.user.refresh(e)];case 3:n.sent(),n.label=4;case 4:return Gs.fire(Hs,{eventType:Fs}),[2,r]}})})},e.prototype.signInWithUsername=function(e){var t=e.verificationInfo,r=void 0===t?{verification_id:"",is_user:!1}:t,n=e.verificationCode,o=void 0===n?"":n,i=e.username,a=void 0===i?"":i,s=e.bindInfo,c=void 0===s?void 0:s,l=e.loginType,u=void 0===l?"":l;return Ms(this,void 0,void 0,function(){var e,t,n,i,s,l,d;return qs(this,function(f){switch(f.label){case 0:return f.trys.push([0,8,,9]),[4,this.oauthInstance.authApi.verify({verification_id:r.verification_id,verification_code:o})];case 1:if(null==(e=f.sent())?void 0:e.error_code)throw e;return t=e.verification_token,n=/^\+\d{1,3}\s+\d+/.test(a)?a:"+86 ".concat(a),i={phone_number:n},"email"===u&&(i={email:n=a}),r.is_user?[4,this.oauthInstance.authApi.signIn({username:n,verification_token:t})]:[3,5];case 2:if(null==(s=f.sent())?void 0:s.error_code)throw s;return c?[4,this.oauthInstance.authApi.bindWithProvider({provider_token:null==c?void 0:c.providerToken})]:[3,4];case 3:if(null==(l=f.sent())?void 0:l.error_code)throw l;f.label=4;case 4:return[3,7];case 5:return[4,this.oauthInstance.authApi.signUp(Us(Us({},i),{verification_token:t,provider_token:null==c?void 0:c.providerId}))];case 6:if(null==(d=f.sent())?void 0:d.error_code)throw d;f.label=7;case 7:return[2,this.createLoginState()];case 8:throw f.sent();case 9:return[2]}})})},e.prototype.setAccessKey=function(){return Ms(this,void 0,void 0,function(){return qs(this,function(e){if(this.config.accessKey)try{this.oauthInstance.oauth2client.setAccessKeyCredentials({access_token:this.config.accessKey,token_type:"Bearer",scope:"accessKey",expires_at:new Date(+new Date+ +new Date),expires_in:+new Date+ +new Date})}catch(t){console.warn("accessKey error: ",t)}return[2]})})},Ds([Wa.catchErrorsDecorator({title:"ç»‘å®šæ‰‹æœºå·å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ auth().bindPhoneNumber() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","  2 - å½“å‰ç¯å¢ƒæ˜¯å¦å¼€é€šäº†çŸ­ä¿¡éªŒè¯ç ç™»å½•","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[Object]),js("design:returntype",Promise)],e.prototype,"bindPhoneNumber",null),Ds([Wa.catchErrorsDecorator({title:"è§£é™¤ä¸‰æ–¹ç»‘å®šå¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ auth().unbindProvider() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","  2 - å½“å‰è´¦æˆ·æ˜¯å¦å·²ç»ä¸æ­¤ç™»å½•æ–¹å¼è§£ç»‘","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[Object]),js("design:returntype",Promise)],e.prototype,"unbindProvider",null),Ds([Wa.catchErrorsDecorator({title:"ç»‘å®šé‚®ç®±åœ°å€å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ auth().bindEmail() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","  2 - å½“å‰ç¯å¢ƒæ˜¯å¦å¼€é€šäº†é‚®ç®±å¯†ç ç™»å½•","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[Object]),js("design:returntype",void 0)],e.prototype,"bindEmail",null),Ds([Wa.catchErrorsDecorator({title:"éªŒè¯ç éªŒè¯å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ auth().verify() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","  2 - å½“å‰ç¯å¢ƒæ˜¯å¦å¼€é€šäº†æ‰‹æœºéªŒè¯ç /é‚®ç®±ç™»å½•","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[Object]),js("design:returntype",Promise)],e.prototype,"verify",null),Ds([Wa.catchErrorsDecorator({title:"è·å–éªŒè¯ç å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ auth().getVerification() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","  2 - å½“å‰ç¯å¢ƒæ˜¯å¦å¼€é€šäº†æ‰‹æœºéªŒè¯ç /é‚®ç®±ç™»å½•","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[Object,Object]),js("design:returntype",Promise)],e.prototype,"getVerification",null),Ds([Wa.catchErrorsDecorator({title:"è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ auth().getCurrentUser() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[]),js("design:returntype",Promise)],e.prototype,"getCurrentUser",null),Ds([Wa.catchErrorsDecorator({title:"åŒ¿åç™»å½•å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - å½“å‰ç¯å¢ƒæ˜¯å¦å¼€å¯äº†åŒ¿åç™»å½•","  2 - è°ƒç”¨ auth().signInAnonymously() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[Object]),js("design:returntype",Promise)],e.prototype,"signInAnonymously",null),Ds([Wa.catchErrorsDecorator({title:"å°ç¨‹åºåŒ¿åç™»å½•å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - å½“å‰ç¯å¢ƒæ˜¯å¦å¼€å¯äº†åŒ¿åç™»å½•","  2 - è°ƒç”¨ auth().signInAnonymouslyInWx() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[Object]),js("design:returntype",Promise)],e.prototype,"signInAnonymouslyInWx",null),Ds([Wa.catchErrorsDecorator({title:"å°ç¨‹åºç»‘å®šOpenIDå¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - å½“å‰ç¯å¢ƒæ˜¯å¦å¼€å¯äº†å°ç¨‹åºopenIdé™é»˜ç™»å½•","  2 - è°ƒç”¨ auth().bindOpenId() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[]),js("design:returntype",Promise)],e.prototype,"bindOpenId",null),Ds([Wa.catchErrorsDecorator({title:"å°ç¨‹åºopenIdé™é»˜ç™»å½•å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - å½“å‰ç¯å¢ƒæ˜¯å¦å¼€å¯äº†å°ç¨‹åºopenIdé™é»˜ç™»å½•","  2 - è°ƒç”¨ auth().signInWithOpenId() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[Object]),js("design:returntype",Promise)],e.prototype,"signInWithOpenId",null),Ds([Wa.catchErrorsDecorator({title:"å°ç¨‹åºunionIdé™é»˜ç™»å½•å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - å½“å‰ç¯å¢ƒæ˜¯å¦å¼€å¯äº†å°ç¨‹åºunionIdé™é»˜ç™»å½•","  2 - è°ƒç”¨ auth().signInWithUnionId() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[]),js("design:returntype",Promise)],e.prototype,"signInWithUnionId",null),Ds([Wa.catchErrorsDecorator({title:"å°ç¨‹åºæ‰‹æœºå·æˆæƒç™»å½•å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - å½“å‰ç¯å¢ƒæ˜¯å¦å¼€å¯äº†å°ç¨‹åºæ‰‹æœºå·æˆæƒç™»å½•","  2 - è°ƒç”¨ auth().signInWithPhoneAuth() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[Object]),js("design:returntype",Promise)],e.prototype,"signInWithPhoneAuth",null),Ds([Wa.catchErrorsDecorator({title:"çŸ­ä¿¡éªŒè¯ç ç™»é™†",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - å½“å‰ç¯å¢ƒæ˜¯å¦å¼€å¯äº†å°ç¨‹åºçŸ­ä¿¡éªŒè¯ç ç™»é™†","  2 - è°ƒç”¨ auth().signInWithSms() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[Object]),js("design:returntype",Promise)],e.prototype,"signInWithSms",null),Ds([Wa.catchErrorsDecorator({title:"é‚®ç®±éªŒè¯ç ç™»é™†",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - å½“å‰ç¯å¢ƒæ˜¯å¦å¼€å¯äº†é‚®ç®±ç™»é™†","  2 - è°ƒç”¨ auth().signInWithEmail() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[Object]),js("design:returntype",Promise)],e.prototype,"signInWithEmail",null),Ds([Wa.catchErrorsDecorator({title:"è‡ªå®šä¹‰ç™»å½•å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - å½“å‰ç¯å¢ƒæ˜¯å¦å¼€å¯äº†è‡ªå®šä¹‰ç™»å½•","  2 - è°ƒç”¨ auth().signInWithCustomTicket() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","  3 - ticket æ˜¯å¦å½’å±äºå½“å‰ç¯å¢ƒ","  4 - åˆ›å»º ticket çš„è‡ªå®šä¹‰ç™»å½•ç§é’¥æ˜¯å¦è¿‡æœŸ","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[]),js("design:returntype",Promise)],e.prototype,"signInWithCustomTicket",null),Ds([Wa.catchErrorsDecorator({title:"æ³¨å†Œå¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - å½“å‰ç¯å¢ƒæ˜¯å¦å¼€å¯äº†æŒ‡å®šç™»å½•æ–¹å¼","  2 - è°ƒç”¨ auth().signUp() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[Object]),js("design:returntype",Promise)],e.prototype,"signUp",null),Ds([Wa.catchErrorsDecorator({title:"è·å–ç”¨æˆ·æ˜¯å¦è¢«å ç”¨å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ auth().isUsernameRegistered() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[String]),js("design:returntype",Promise)],e.prototype,"isUsernameRegistered",null),Ds([Wa.catchErrorsDecorator({title:"ç”¨æˆ·ç™»å‡ºå¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ auth().signOut() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","  2 - å½“å‰ç”¨æˆ·æ˜¯å¦ä¸ºåŒ¿åç™»å½•ï¼ˆåŒ¿åç™»å½•ä¸æ”¯æŒsignOutï¼‰","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[Object]),js("design:returntype",Promise)],e.prototype,"signOut",null),Ds([Wa.catchErrorsDecorator({title:"è·å–æœ¬åœ°ç™»å½•æ€å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ auth().getLoginState() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[]),js("design:returntype",Promise)],e.prototype,"getLoginState",null),Ds([Wa.catchErrorsDecorator({title:"è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - æ˜¯å¦å·²ç™»å½•","  2 - è°ƒç”¨ auth().getUserInfo() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[Object]),js("design:returntype",Promise)],e.prototype,"getUserInfo",null),Ds([Wa.catchErrorsDecorator({title:"è·å–å¾®æ­æ’ä»¶ç”¨æˆ·ä¿¡æ¯å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - æ˜¯å¦å·²ç™»å½•","  2 - è°ƒç”¨ auth().getWedaUserInfo() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[]),js("design:returntype",Promise)],e.prototype,"getWedaUserInfo",null),Ds([Wa.catchErrorsDecorator({title:"ç»‘å®šç¬¬ä¸‰æ–¹ç™»å½•æ–¹å¼å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ auth().bindWithProvider() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","  2 - æ­¤è´¦æˆ·æ˜¯å¦å·²ç»ç»‘å®šæ­¤ç¬¬ä¸‰æ–¹","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[Object]),js("design:returntype",Promise)],e.prototype,"bindWithProvider",null),Ds([Wa.catchErrorsDecorator({title:"è·å–èº«ä»½æºç±»å‹",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ auth().getProviderSubType() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Ti.COMMUNITY_SITE_URL)]}),js("design:type",Function),js("design:paramtypes",[]),js("design:returntype",Promise)],e.prototype,"getProviderSubType",null),e}();var Ys={name:"auth",namespace:"auth",entity:function(e){if(void 0===e&&(e={region:"",persistence:"local",apiPath:oa}),this.authInstance)return Ba(Ti.ERRORS.INVALID_OPERATION,"every cloudbase instance should has only one auth object"),this.authInstance;var t=this.platform.adapter,r=e.persistence||t.primaryStorage;r&&r!==this.config.persistence&&this.updateConfig({persistence:r});var n=function(e,t){var r=e.region,n=void 0===r?"ap-shanghai":r,o=e.i18n,i=e.accessKey,a=e.useWxCloud,s=(null==t?void 0:t.platform)||bs.useDefaultAdapter(),c=s.runtime,l=s.adapter,u=t||{},d=u.env,f=u.clientId,p=u.debug,h=u.cache,m=u.app,y=(t||{}).apiOrigin;y||(y="https://".concat(d,".").concat(n,".tcb-api.tencentcloudapi.com"));var v={env:d,clientId:f,i18n:o,accessKey:i,useWxCloud:a},g=new ja(Ls(Us(Us({},v),{apiOrigin:y,apiPath:(null==e?void 0:e.apiPath)||oa,storage:null==e?void 0:e.storage,baseRequest:null==e?void 0:e.baseRequest,request:null==e?void 0:e.request,anonymousSignInFunc:null==e?void 0:e.anonymousSignInFunc,captchaOptions:null==e?void 0:e.captchaOptions,wxCloud:null==e?void 0:e.wxCloud,adapter:l,onCredentialsError:$s,headers:Us({"X-SDK-Version":"@cloudbase/js-sdk/".concat(e.sdkVersion)},e.headers||{})})));return{authInstance:new Js(Us(Us({},v),{region:n,persistence:e.persistence,debug:p,cache:h||new hs({persistence:e.persistence,keys:{userInfoKey:"user_info_".concat(d)},platformInfo:s}),runtime:c||"web",_fromApp:m,oauthInstance:g})),oauthInstance:g}}(Us(Us({wxCloud:this.config.wxCloud,storage:this.config.storage},e),{persistence:this.config.persistence,i18n:this.config.i18n,accessKey:this.config.accessKey,useWxCloud:this.config.useWxCloud,sdkVersion:this.version}),{env:this.config.env,clientId:this.config.clientId,apiOrigin:this.request.getBaseEndPoint(this.config.endPointMode||"CLOUD_API"),platform:this.platform,cache:this.cache,app:this,debug:this.config.debug}),o=n.authInstance,i=n.oauthInstance;return this.oauthInstance=i,this.authInstance=o,this.authInstance}};try{cloudbase.registerComponent(Ys)}catch(hL){}var Xs=function(){return Xs=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Xs.apply(this,arguments)},Qs=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},Zs=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ec=k,tc="cloudrun";function rc(e,t){return Qs(this,void 0,void 0,function(){var r,n,o,i,a,s,c,l,u,d,f,p,h;return Zs(this,function(m){switch(m.label){case 0:return r=e.name,n=e.data,o=e.path,i=void 0===o?"":o,a=e.method,s=e.header,c=void 0===s?{}:s,l=this.getEndPointWithKey("GATEWAY"),u=l.BASE_URL,d=l.PROTOCOL,f="".concat(d).concat(u,"/cloudrun/").concat(r),p=i.startsWith("/")?i:"/".concat(i),[4,this.request.fetch({method:a||"POST",headers:Object.assign({},{"Content-Type":"application/json; charset=utf-8"},c),body:n,url:"".concat(f).concat(p),customReqOpts:t})];case 1:return h=m.sent(),"node-sdk"===t.from?[2,h]:[4,h.data];case 2:return[2,m.sent()]}})})}var nc=new(function(){function e(){}return e.prototype.callContainer=function(e,t){return Qs(this,void 0,void 0,function(){var r,n,o;return Zs(this,function(i){switch(i.label){case 0:if(r=e.name,n=e.data,!r)throw new Error(JSON.stringify({code:ec.INVALID_PARAMS,msg:"[".concat(tc,".callContainer] invalid name")}));try{o=n?JSON.stringify(n):""}catch(hL){throw new Error(JSON.stringify({code:ec.INVALID_PARAMS,msg:"[".concat(tc,".callContainer] invalid data")}))}return[4,rc.call(this,Xs(Xs({},e),{data:o}),t)];case 1:return[2,i.sent()]}})})},e}()),oc={name:tc,entity:{callContainer:nc.callContainer}};try{cloudbase.registerComponent(oc)}catch(hL){}function ic(e){try{e.registerComponent(oc)}catch(hL){console.warn(hL)}}try{window.registerCloudrun=ic}catch(hL){}var ac=function(){return ac=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ac.apply(this,arguments)},sc=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},cc=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},lc=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},uc=O,dc=k,fc=C,pc=W,hc=de,mc="functions",yc=function(){function e(){}return e.prototype.callFunction=function(e,t,r){var n,o,i;return cc(this,void 0,void 0,function(){var a,s,c,l,u,d,f,p,h,m,y,v,g,b,w,E,_,S,x,N,I,T;return lc(this,function(O){switch(O.label){case 0:if(a=e.name,s=e.data,c=e.query,l=e.parse,u=e.search,d=e.type,f=e.path,p=void 0===f?"":f,h=e.method,m=e.header,y=void 0===m?{}:m,!a)throw new Error(JSON.stringify({code:dc.INVALID_PARAMS,msg:"[".concat(mc,".callFunction] invalid function name")}));try{v=s?JSON.stringify(s):""}catch(hL){throw new Error(JSON.stringify({code:dc.INVALID_PARAMS,msg:"[".concat(mc,".callFunction] invalid data")}))}return"cloudrun"!==d?[3,2]:(g=B(),[4,rc.call(this,{name:a,data:v,path:p,method:h,header:ac(ac({},y),{"X-Request-Id":g})})]);case 1:return[2,{result:I=O.sent(),requestId:g}];case 2:w=(b=this).request,E=b.config,_="functions.invokeFunction",S={inQuery:c,parse:l,search:u,function_name:a,request_data:v},x={},O.label=3;case 3:return O.trys.push([3,8,,9]),"GATEWAY"!==E.endPointMode?[3,5]:[4,w.gateWay(ac(ac({},e),{path:"functions"}),r)];case 4:return N=O.sent(),x=ac({requestId:N.requestId},(null===(n=N.data)||void 0===n?void 0:n.code)?N.data:{data:{response_data:N.data}}),[3,7];case 5:return[4,w.send(_,S,{defaultQuery:(null===(o=null==s?void 0:s.params)||void 0===o?void 0:o.action)?{action:null===(i=null==s?void 0:s.params)||void 0===i?void 0:i.action}:{}},r)];case 6:x=O.sent(),O.label=7;case 7:if(x.code)return[2,pc(t,null,x)];if(I=x.data.response_data,l||"GATEWAY"===E.endPointMode)return[2,pc(t,null,{result:I,requestId:x.requestId})];try{return I=JSON.parse(x.data.response_data),[2,pc(t,null,{result:I,requestId:x.requestId})]}catch(hL){pc(t,new Error("[".concat(uc(),"][").concat(dc.INVALID_PARAMS,"][").concat(mc,".callFunction] response data must be json")))}return[3,9];case 8:return T=O.sent(),pc(t,T),[3,9];case 9:return[2]}})})},function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);i>3&&a&&Object.defineProperty(t,r,a)}([hc({customInfo:{},title:"å‡½æ•°è°ƒç”¨å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ callFunction() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","  2 - å½“å‰ç¯å¢ƒä¸‹æ˜¯å¦å­˜åœ¨æ­¤å‡½æ•°","  3 - å‡½æ•°å®‰å…¨è§„åˆ™æ˜¯å¦é™åˆ¶äº†å½“å‰ç™»å½•çŠ¶æ€è®¿é—®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(fc)]}),sc("design:type",Function),sc("design:paramtypes",[Object,Function,Object]),sc("design:returntype",Promise)],e.prototype,"callFunction",null),e}(),vc=new yc,gc={name:mc,entity:{callFunction:vc.callFunction}};try{cloudbase.registerComponent(gc)}catch(hL){}var bc,wc,Ec=function(){return Ec=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ec.apply(this,arguments)},_c=function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a},Sc=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},xc=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},Nc=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};(wc=bc||(bc={})).put="put",wc.post="post";var Ic=O,Tc=k,Oc=C,Ac=j,Rc=M,Pc=function(e){return"[object Object]"===Object.prototype.toString.call(e)},Cc=W,kc=de,Vc="storage";function Lc(e){var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}var Uc=function(e,t,r){return xc(void 0,void 0,void 0,function(){var n,o,i;return Nc(this,function(a){switch(a.label){case 0:return[4,e.gateWay({path:"storages",name:"get-objects-upload-info",data:[Ec({objectId:t.path},t.headers?{signedHeader:t.headers}:{})]},r)];case 1:return n=a.sent(),o=(null===(i=n.data)||void 0===i?void 0:i[0])||{},[2,n=Ec(Ec({},n),{data:Ec(Ec({},o.code?Ec({},o):{}),{authorization:o.authorization,token:o.token,url:o.uploadUrl,fileId:o.cloudObjectId,cosFileId:o.cloudObjectMeta,download_url:o.downloadUrl})})]}})})},Dc=function(e,t,r){return xc(void 0,void 0,void 0,function(){var n,o;return Nc(this,function(i){switch(i.label){case 0:return[4,e.gateWay({path:"storages",name:"get-objects-download-info",data:t.convertedFileList.map(function(e){return{cloudObjectId:e.fileid}})},r)];case 1:return n=i.sent(),[2,n=Ec(Ec({},n),{data:{download_list:null===(o=n.data)||void 0===o?void 0:o.map(function(e){return{code:e.code||"SUCCESS",message:e.message,fileid:e.cloudObjectId,download_url:e.downloadUrl,fileID:e.cloudObjectId,tempFileURL:e.downloadUrl}})}})]}})})},jc=function(e,t,r){return xc(void 0,void 0,void 0,function(){var n,o;return Nc(this,function(i){switch(i.label){case 0:return[4,e.gateWay({path:"storages",name:"delete-objects",data:t.fileList.map(function(e){return{cloudObjectId:e}})},r)];case 1:return n=i.sent(),[2,n=Ec(Ec({},n),{data:{delete_list:null===(o=n.data)||void 0===o?void 0:o.map(function(e){return{code:e.code||"SUCCESS",fileID:e.cloudObjectId,message:e.message}})}})]}})})},Mc=function(e,t,r){return xc(void 0,void 0,void 0,function(){var n,o;return Nc(this,function(i){switch(i.label){case 0:return[4,e.gateWay({path:"storages",name:"copy-objects",data:t.convertedFileList.map(function(e){return{srcPath:e.src_path,dstPath:e.dst_path,overwrite:e.overwrite,removeOriginal:e.remove_original}})},r)];case 1:return n=i.sent(),[2,n=Ec(Ec({},n),{data:{copy_list:null===(o=n.data)||void 0===o?void 0:o.map(function(e){return{code:e.code||"SUCCESS",fileID:e.cloudObjectId,message:e.message}})}})]}})})},qc=new(function(){function e(){}return e.prototype.isGateWay=function(){return"GATEWAY"===(this.config.endPointMode||"CLOUD_API")},e.prototype.uploadFile=function(e,t){var r;return xc(this,void 0,void 0,function(){var n,o,i,a,s,c,l,u,d,f,p,h,m,y,v,g,b,w,E,_,S,x,N,I,T,O,A;return Nc(this,function(R){switch(R.label){case 0:if(n=e.cloudPath,o=e.filePath,i=e.onUploadProgress,a=e.method,s=void 0===a?"put":a,c=e.headers,l=void 0===c?{}:c,u=e.fileContent,!Rc(n)||!o&&!u)throw new Error(JSON.stringify({code:Tc.INVALID_PARAMS,msg:"[".concat(Vc,".uploadFile] invalid params")}));return d={put:bc.put,post:bc.post}[s.toLocaleLowerCase()]||bc.put,f="storage.getUploadMetadata",p=this.request,h={path:n,method:d},d===bc.put&&(h.headers=l),m={},this.isGateWay()?[4,Uc(p,h,e.customReqOpts)]:[3,2];case 1:return m=R.sent(),[3,4];case 2:return[4,p.send(f,h,e.customReqOpts)];case 3:m=R.sent(),R.label=4;case 4:return y=m.data,v=y.url,g=y.authorization,b=y.token,w=y.fileId,E=y.cosFileId,_=y.download_url,S=m.requestId,(null===(r=m.data)||void 0===r?void 0:r.code)?[2,Cc(t,new Error("[".concat(Ic(),"][").concat(Tc.OPERATION_FAIL,"][").concat(Vc,"]:").concat(m.data)))]:(N=Ec(Ec({},x={url:v,file:o,name:n,onUploadProgress:i,fileContent:u,fileId:w,requestId:S}),{method:bc.put,headers:Ec(Ec({},l),{authorization:g,"x-cos-meta-fileid":E,"x-cos-security-token":b})}),I=Ec(Ec({},x),{method:bc.post,data:{key:n,signature:g,"x-cos-meta-fileid":E,success_action_status:"201","x-cos-security-token":b}}),(A={})[bc.put]={params:N,isSuccess:function(e){return e>=200&&e<300}},A[bc.post]={params:I,isSuccess:function(e){return 201===e}},T=A,[4,p.upload(T[d].params)]);case 5:return O=R.sent(),T[d].isSuccess(O.statusCode)?[2,Cc(t,null,{fileID:w,download_url:_,requestId:S})]:[2,Cc(t,new Error("[".concat(Ic(),"][").concat(Tc.OPERATION_FAIL,"][").concat(Vc,"]:").concat(O.data)))]}})})},e.prototype.getUploadMetadata=function(e,t){return xc(this,void 0,void 0,function(){var r,n,o,i,a;return Nc(this,function(s){switch(s.label){case 0:if(r=e.cloudPath,!Rc(r))throw new Error(JSON.stringify({code:Tc.INVALID_PARAMS,msg:"[".concat(Vc,".getUploadMetadata] invalid cloudPath")}));n=this.request,o="storage.getUploadMetadata",s.label=1;case 1:return s.trys.push([1,6,,7]),i={},this.isGateWay()?[4,Uc(n,{path:r},e.customReqOpts)]:[3,3];case 2:return i=s.sent(),[3,5];case 3:return[4,n.send(o,{path:r},e.customReqOpts)];case 4:i=s.sent(),s.label=5;case 5:return[2,Cc(t,null,i)];case 6:return a=s.sent(),[2,Cc(t,a)];case 7:return[2]}})})},e.prototype.deleteFile=function(e,t){return xc(this,void 0,void 0,function(){var r,n,o,i,a,s,c,l;return Nc(this,function(u){switch(u.label){case 0:if(!(r=e.fileList)||!Ac(r)||0===r.length)throw new Error(JSON.stringify({code:Tc.INVALID_PARAMS,msg:"[".concat(Vc,".deleteFile] fileList must not be empty")}));for(n=0,o=r;n<o.length;n++)if(!(i=o[n])||!Rc(i))throw new Error(JSON.stringify({code:Tc.INVALID_PARAMS,msg:"[".concat(Vc,".deleteFile] fileID must be string")}));return a="storage.batchDeleteFile",s=this.request,c={},this.isGateWay()?[4,jc(s,{fileList:r},e.customReqOpts)]:[3,2];case 1:return c=u.sent(),[3,4];case 2:return[4,s.send(a,{fileid_list:r},e.customReqOpts)];case 3:c=u.sent(),u.label=4;case 4:return c.code?[2,Cc(t,null,c)]:(l={fileList:c.data.delete_list,requestId:c.requestId},[2,Cc(t,null,l)])}})})},e.prototype.getTempFileURL=function(e,t){return xc(this,void 0,void 0,function(){var r,n,o,i,a,s,c,l;return Nc(this,function(u){switch(u.label){case 0:if(!(r=e.fileList)||!Ac(r)||0===r.length)throw new Error(JSON.stringify({code:Tc.INVALID_PARAMS,msg:"[".concat(Vc,".getTempFileURL] fileList must not be empty")}));for(n=[],o=0,i=r;o<i.length;o++)if(a=i[o],Pc(a)){if(!Object.prototype.hasOwnProperty.call(a,"fileID")||!Object.prototype.hasOwnProperty.call(a,"maxAge"))throw new Error(JSON.stringify({code:Tc.INVALID_PARAMS,msg:"[".concat(Vc,".getTempFileURL] file info must include fileID and maxAge")}));n.push({fileid:a.fileID,max_age:a.maxAge})}else{if(!Rc(a))throw new Error(JSON.stringify({code:Tc.INVALID_PARAMS,msg:"[".concat(Vc,".getTempFileURL] invalid fileList")}));n.push({fileid:a})}return s="storage.batchGetDownloadUrl",c=this.request,l={},this.isGateWay()?[4,Dc(c,{convertedFileList:n},e.customReqOpts)]:[3,2];case 1:return l=u.sent(),[3,4];case 2:return[4,c.send(s,{file_list:n},e.customReqOpts)];case 3:l=u.sent(),u.label=4;case 4:return l.code?[2,Cc(t,null,l)]:[2,Cc(t,null,{fileList:l.data.download_list,requestId:l.requestId})]}})})},e.prototype.downloadFile=function(e,t){return xc(this,void 0,void 0,function(){var r,n,o,i,a,s;return Nc(this,function(c){switch(c.label){case 0:if(r=e.fileID,!Rc(r))throw new Error(JSON.stringify({code:Tc.INVALID_PARAMS,msg:"[".concat(Vc,".getTempFileURL] fileID must be string")}));return[4,this.getTempFileURL.call(this,{fileList:[{fileID:r,maxAge:600}],customReqOpts:e.customReqOpts})];case 1:return n=c.sent(),"SUCCESS"!==(o=n.fileList[0]).code?[2,Cc(t,o)]:(i=this.request,a=encodeURI(o.download_url),[4,i.download({url:a,tempFilePath:e.tempFilePath})]);case 2:return s=c.sent(),[2,Cc(t,null,s)]}})})},e.prototype.copyFile=function(e,t){return xc(this,void 0,void 0,function(){var r,n,o,i,a,s,c,l,u,d;return Nc(this,function(f){switch(f.label){case 0:if(!(r=e.fileList)||!Ac(r)||0===r.length)throw new Error(JSON.stringify({code:Tc.INVALID_PARAMS,msg:"[".concat(Vc,".copyFile] fileList must not be empty")}));for(n=[],o=0,i=r;o<i.length;o++){if(a=i[o],s=a.srcPath,c=a.dstPath,!s||!c||"string"!=typeof s||"string"!=typeof c)throw new Error(JSON.stringify({code:Tc.INVALID_PARAMS,msg:"[".concat(Vc,".copyFile] srcPath and dstPath may not be empty")}));if(s===c)throw new Error(JSON.stringify({code:Tc.INVALID_PARAMS,msg:"[".concat(Vc,".copyFile] srcPath and dstPath can not be the same")}));if(Lc(s)!==Lc(c))throw new Error(JSON.stringify({code:Tc.INVALID_PARAMS,msg:"[".concat(Vc,".copyFile] srcPath and dstPath file name must be the same")}));n.push({src_path:s,dst_path:c,overwrite:a.overwrite,remove_original:a.removeOriginal})}return l="storage.batchCopyFile",u=this.request,d={},this.isGateWay()?[4,Mc(u,{convertedFileList:n},e.customReqOpts)]:[3,2];case 1:return d=f.sent(),[3,4];case 2:return[4,u.send(l,{file_list:n},e.customReqOpts)];case 3:d=f.sent(),f.label=4;case 4:return d.code?[2,Cc(t,null,d)]:[2,Cc(t,null,{fileList:d.data.copy_list,requestId:d.requestId})]}})})},e.prototype.getFileInfo=function(e){var t;return xc(this,void 0,void 0,function(){var r,n=this;return Nc(this,function(o){switch(o.label){case 0:return[4,this.getTempFileURL(e)];case 1:return(null==(r=o.sent())?void 0:r.fileList)&&(null===(t=null==r?void 0:r.fileList)||void 0===t?void 0:t.length)>0?[4,Promise.all(r.fileList.map(function(e){return xc(n,void 0,void 0,function(){var t,r,n;return Nc(this,function(o){switch(o.label){case 0:if("SUCCESS"!==e.code)return[2,{code:e.code,fileID:e.fileID,tempFileURL:e.tempFileURL}];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.request.fetch({url:e.tempFileURL,method:"HEAD"})];case 2:return t=o.sent(),r=parseInt(t.headers["content-length"])||0,n=t.headers["content-type"]||"",[2,{code:e.code,fileID:e.fileID,tempFileURL:e.tempFileURL,cloudId:e.fileID,fileName:e.fileID.split("/").pop(),contentType:n,mime:n.split(";")[0].trim(),size:r}];case 3:return o.sent(),[2,{code:"FETCH_FILE_INFO_ERROR",fileID:e.fileID,tempFileURL:e.tempFileURL}];case 4:return[2]}})})}))]:[3,3];case 2:return[2,{fileList:o.sent(),requestId:r.requestId}];case 3:return[2,{fileList:[],requestId:r.requestId}]}})})},_c([kc({customInfo:{},title:"ä¸Šä¼ æ–‡ä»¶å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ uploadFile() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","  2 - å½“å‰åŸŸåæ˜¯å¦åœ¨å®‰å…¨åŸŸååˆ—è¡¨ä¸­ï¼šhttps://console.cloud.tencent.com/tcb/env/safety","  3 - äº‘å­˜å‚¨å®‰å…¨è§„åˆ™æ˜¯å¦é™åˆ¶äº†å½“å‰ç™»å½•çŠ¶æ€è®¿é—®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Oc)]}),Sc("design:type",Function),Sc("design:paramtypes",[Object,Function]),Sc("design:returntype",Promise)],e.prototype,"uploadFile",null),_c([kc({customInfo:{},title:"è·å–ä¸Šä¼ å…ƒä¿¡æ¯å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ getUploadMetadata() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","  2 - å½“å‰åŸŸåæ˜¯å¦åœ¨å®‰å…¨åŸŸååˆ—è¡¨ä¸­ï¼šhttps://console.cloud.tencent.com/tcb/env/safety","  3 - äº‘å­˜å‚¨å®‰å…¨è§„åˆ™æ˜¯å¦é™åˆ¶äº†å½“å‰ç™»å½•çŠ¶æ€è®¿é—®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Oc)]}),Sc("design:type",Function),Sc("design:paramtypes",[Object,Function]),Sc("design:returntype",Promise)],e.prototype,"getUploadMetadata",null),_c([kc({customInfo:{},title:"åˆ é™¤æ–‡ä»¶å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ deleteFile() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","  2 - å½“å‰åŸŸåæ˜¯å¦åœ¨å®‰å…¨åŸŸååˆ—è¡¨ä¸­ï¼šhttps://console.cloud.tencent.com/tcb/env/safety","  3 - äº‘å­˜å‚¨å®‰å…¨è§„åˆ™æ˜¯å¦é™åˆ¶äº†å½“å‰ç™»å½•çŠ¶æ€è®¿é—®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Oc)]}),Sc("design:type",Function),Sc("design:paramtypes",[Object,Function]),Sc("design:returntype",Promise)],e.prototype,"deleteFile",null),_c([kc({customInfo:{},title:"è·å–æ–‡ä»¶ä¸‹è½½é“¾æ¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ getTempFileURL() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","  2 - å½“å‰åŸŸåæ˜¯å¦åœ¨å®‰å…¨åŸŸååˆ—è¡¨ä¸­ï¼šhttps://console.cloud.tencent.com/tcb/env/safety","  3 - äº‘å­˜å‚¨å®‰å…¨è§„åˆ™æ˜¯å¦é™åˆ¶äº†å½“å‰ç™»å½•çŠ¶æ€è®¿é—®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Oc)]}),Sc("design:type",Function),Sc("design:paramtypes",[Object,Function]),Sc("design:returntype",Promise)],e.prototype,"getTempFileURL",null),_c([kc({customInfo:{},title:"ä¸‹è½½æ–‡ä»¶å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ downloadFile() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","  2 - å½“å‰åŸŸåæ˜¯å¦åœ¨å®‰å…¨åŸŸååˆ—è¡¨ä¸­ï¼šhttps://console.cloud.tencent.com/tcb/env/safety","  3 - äº‘å­˜å‚¨å®‰å…¨è§„åˆ™æ˜¯å¦é™åˆ¶äº†å½“å‰ç™»å½•çŠ¶æ€è®¿é—®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Oc)]}),Sc("design:type",Function),Sc("design:paramtypes",[Object,Function]),Sc("design:returntype",Promise)],e.prototype,"downloadFile",null),_c([kc({customInfo:{},title:"æ‰¹é‡å¤åˆ¶æ–‡ä»¶",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ copyFile() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","  2 - å½“å‰åŸŸåæ˜¯å¦åœ¨å®‰å…¨åŸŸååˆ—è¡¨ä¸­ï¼šhttps://console.cloud.tencent.com/tcb/env/safety","  3 - äº‘å­˜å‚¨å®‰å…¨è§„åˆ™æ˜¯å¦é™åˆ¶äº†å½“å‰ç™»å½•çŠ¶æ€è®¿é—®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Oc)]}),Sc("design:type",Function),Sc("design:paramtypes",[Object,Function]),Sc("design:returntype",Promise)],e.prototype,"copyFile",null),e}()),Bc={name:Vc,entity:{uploadFile:qc.uploadFile,deleteFile:qc.deleteFile,getTempFileURL:qc.getTempFileURL,downloadFile:qc.downloadFile,getUploadMetadata:qc.getUploadMetadata,copyFile:qc.copyFile,getFileInfo:qc.getFileInfo,isGateWay:qc.isGateWay}};try{cloudbase.registerComponent(Bc)}catch(hL){}function Fc(e){try{e.registerComponent(Bc)}catch(hL){console.warn(hL)}}try{window.registerStorage=Fc}catch(hL){}var Wc="object"==typeof xi&&xi&&xi.Object===Object&&xi,Hc=Wc,Gc="object"==typeof self&&self&&self.Object===Object&&self,$c=Hc||Gc||Function("return this")(),zc=$c.Symbol,Kc=zc,Jc=Object.prototype,Yc=Jc.hasOwnProperty,Xc=Jc.toString,Qc=Kc?Kc.toStringTag:void 0;var Zc=function(e){var t=Yc.call(e,Qc),r=e[Qc];try{e[Qc]=void 0;var n=!0}catch(hL){}var o=Xc.call(e);return n&&(t?e[Qc]=r:delete e[Qc]),o},el=Object.prototype.toString;var tl=Zc,rl=function(e){return el.call(e)},nl=zc?zc.toStringTag:void 0;var ol=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":nl&&nl in Object(e)?tl(e):rl(e)};var il=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},al=ol,sl=il;var cl,ll=function(e){if(!sl(e))return!1;var t=al(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},ul=$c["__core-js_shared__"],dl=(cl=/[^.]+$/.exec(ul&&ul.keys&&ul.keys.IE_PROTO||""))?"Symbol(src)_1."+cl:"";var fl=function(e){return!!dl&&dl in e},pl=Function.prototype.toString;var hl=function(e){if(null!=e){try{return pl.call(e)}catch(hL){}try{return e+""}catch(hL){}}return""},ml=ll,yl=fl,vl=il,gl=hl,bl=/^\[object .+?Constructor\]$/,wl=Function.prototype,El=Object.prototype,_l=wl.toString,Sl=El.hasOwnProperty,xl=RegExp("^"+_l.call(Sl).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Nl=function(e){return!(!vl(e)||yl(e))&&(ml(e)?xl:bl).test(gl(e))},Il=function(e,t){return null==e?void 0:e[t]};var Tl=function(e,t){var r=Il(e,t);return Nl(r)?r:void 0},Ol=Tl,Al=function(){try{var e=Ol(Object,"defineProperty");return e({},"",{}),e}catch(hL){}}();var Rl=function(e,t,r){"__proto__"==t&&Al?Al(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r};var Pl=function(e,t){return e===t||e!=e&&t!=t},Cl=Rl,kl=Pl,Vl=Object.prototype.hasOwnProperty;var Ll=function(e,t,r){var n=e[t];Vl.call(e,t)&&kl(n,r)&&(void 0!==r||t in e)||Cl(e,t,r)},Ul=Array.isArray;var Dl=function(e){return null!=e&&"object"==typeof e},jl=ol,Ml=Dl;var ql=function(e){return"symbol"==typeof e||Ml(e)&&"[object Symbol]"==jl(e)},Bl=Ul,Fl=ql,Wl=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Hl=/^\w*$/;var Gl=function(e,t){if(Bl(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!Fl(e))||(Hl.test(e)||!Wl.test(e)||null!=t&&e in Object(t))},$l=Tl(Object,"create"),zl=$l;var Kl=function(){this.__data__=zl?zl(null):{},this.size=0};var Jl=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Yl=$l,Xl=Object.prototype.hasOwnProperty;var Ql=function(e){var t=this.__data__;if(Yl){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return Xl.call(t,e)?t[e]:void 0},Zl=$l,eu=Object.prototype.hasOwnProperty;var tu=$l;var ru=Kl,nu=Jl,ou=Ql,iu=function(e){var t=this.__data__;return Zl?void 0!==t[e]:eu.call(t,e)},au=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=tu&&void 0===t?"__lodash_hash_undefined__":t,this};function su(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}su.prototype.clear=ru,su.prototype.delete=nu,su.prototype.get=ou,su.prototype.has=iu,su.prototype.set=au;var cu=su;var lu=function(){this.__data__=[],this.size=0},uu=Pl;var du=function(e,t){for(var r=e.length;r--;)if(uu(e[r][0],t))return r;return-1},fu=du,pu=Array.prototype.splice;var hu=du;var mu=du;var yu=du;var vu=lu,gu=function(e){var t=this.__data__,r=fu(t,e);return!(r<0)&&(r==t.length-1?t.pop():pu.call(t,r,1),--this.size,!0)},bu=function(e){var t=this.__data__,r=hu(t,e);return r<0?void 0:t[r][1]},wu=function(e){return mu(this.__data__,e)>-1},Eu=function(e,t){var r=this.__data__,n=yu(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function _u(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}_u.prototype.clear=vu,_u.prototype.delete=gu,_u.prototype.get=bu,_u.prototype.has=wu,_u.prototype.set=Eu;var Su=_u,xu=Tl($c,"Map"),Nu=cu,Iu=Su,Tu=xu;var Ou=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var Au=function(e,t){var r=e.__data__;return Ou(t)?r["string"==typeof t?"string":"hash"]:r.map},Ru=Au;var Pu=Au;var Cu=Au;var ku=Au;var Vu=function(){this.size=0,this.__data__={hash:new Nu,map:new(Tu||Iu),string:new Nu}},Lu=function(e){var t=Ru(this,e).delete(e);return this.size-=t?1:0,t},Uu=function(e){return Pu(this,e).get(e)},Du=function(e){return Cu(this,e).has(e)},ju=function(e,t){var r=ku(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function Mu(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Mu.prototype.clear=Vu,Mu.prototype.delete=Lu,Mu.prototype.get=Uu,Mu.prototype.has=Du,Mu.prototype.set=ju;var qu=Mu,Bu=qu;function Fu(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(Fu.Cache||Bu),r}Fu.Cache=Bu;var Wu=Fu;var Hu=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Gu=/\\(\\)?/g,$u=function(e){var t=Wu(e,function(e){return 500===r.size&&r.clear(),e}),r=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Hu,function(e,r,n,o){t.push(n?o.replace(Gu,"$1"):r||e)}),t});var zu=function(e,t){for(var r=-1,n=null==e?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o},Ku=Ul,Ju=ql,Yu=zc?zc.prototype:void 0,Xu=Yu?Yu.toString:void 0;var Qu=function e(t){if("string"==typeof t)return t;if(Ku(t))return zu(t,e)+"";if(Ju(t))return Xu?Xu.call(t):"";var r=t+"";return"0"==r&&1/t==-1/0?"-0":r},Zu=Qu;var ed=Ul,td=Gl,rd=$u,nd=function(e){return null==e?"":Zu(e)};var od=function(e,t){return ed(e)?e:td(e,t)?[e]:rd(nd(e))},id=/^(?:0|[1-9]\d*)$/;var ad=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&id.test(e))&&e>-1&&e%1==0&&e<t},sd=ql;var cd=function(e){if("string"==typeof e||sd(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t},ld=Ll,ud=od,dd=ad,fd=il,pd=cd;var hd=function(e,t,r,n){if(!fd(e))return e;for(var o=-1,i=(t=ud(t,e)).length,a=i-1,s=e;null!=s&&++o<i;){var c=pd(t[o]),l=r;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(o!=a){var u=s[c];void 0===(l=n?n(u,c,s):void 0)&&(l=fd(u)?u:dd(t[o+1])?[]:{})}ld(s,c,l),s=s[c]}return e};const md=Ni(function(e,t,r){return null==e?e:hd(e,t,r)});var yd=od,vd=cd;var gd=function(e,t){for(var r=0,n=(t=yd(t,e)).length;null!=e&&r<n;)e=e[vd(t[r++])];return r&&r==n?e:void 0},bd=function(e,t,r){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(r=r>o?o:r)<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(o);++n<o;)i[n]=e[n+t];return i};var wd=od,Ed=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0},_d=function(e,t){return t.length<2?e:gd(e,bd(t,0,-1))},Sd=cd;var xd=function(e,t){return t=wd(t,e),null==(e=_d(e,t))||delete e[Sd(Ed(t))]};const Nd=Ni(function(e,t){return null==e||xd(e,t)});var Id=Su;var Td=Su,Od=xu,Ad=qu;var Rd=Su,Pd=function(){this.__data__=new Id,this.size=0},Cd=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},kd=function(e){return this.__data__.get(e)},Vd=function(e){return this.__data__.has(e)},Ld=function(e,t){var r=this.__data__;if(r instanceof Td){var n=r.__data__;if(!Od||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Ad(n)}return r.set(e,t),this.size=r.size,this};function Ud(e){var t=this.__data__=new Rd(e);this.size=t.size}Ud.prototype.clear=Pd,Ud.prototype.delete=Cd,Ud.prototype.get=kd,Ud.prototype.has=Vd,Ud.prototype.set=Ld;var Dd=Ud;var jd=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e},Md=Ll,qd=Rl;var Bd=function(e,t,r,n){var o=!r;r||(r={});for(var i=-1,a=t.length;++i<a;){var s=t[i],c=n?n(r[s],e[s],s,r,e):void 0;void 0===c&&(c=e[s]),o?qd(r,s,c):Md(r,s,c)}return r};var Fd=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n},Wd=ol,Hd=Dl;var Gd=function(e){return Hd(e)&&"[object Arguments]"==Wd(e)},$d=Dl,zd=Object.prototype,Kd=zd.hasOwnProperty,Jd=zd.propertyIsEnumerable,Yd=Gd(function(){return arguments}())?Gd:function(e){return $d(e)&&Kd.call(e,"callee")&&!Jd.call(e,"callee")},Xd=Yd,Qd={exports:{}};var Zd=function(){return!1};!function(e,t){var r=$c,n=Zd,o=t&&!t.nodeType&&t,i=o&&e&&!e.nodeType&&e,a=i&&i.exports===o?r.Buffer:void 0,s=(a?a.isBuffer:void 0)||n;e.exports=s}(Qd,Qd.exports);var ef=Qd.exports;var tf=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},rf=ol,nf=tf,of=Dl,af={};af["[object Float32Array]"]=af["[object Float64Array]"]=af["[object Int8Array]"]=af["[object Int16Array]"]=af["[object Int32Array]"]=af["[object Uint8Array]"]=af["[object Uint8ClampedArray]"]=af["[object Uint16Array]"]=af["[object Uint32Array]"]=!0,af["[object Arguments]"]=af["[object Array]"]=af["[object ArrayBuffer]"]=af["[object Boolean]"]=af["[object DataView]"]=af["[object Date]"]=af["[object Error]"]=af["[object Function]"]=af["[object Map]"]=af["[object Number]"]=af["[object Object]"]=af["[object RegExp]"]=af["[object Set]"]=af["[object String]"]=af["[object WeakMap]"]=!1;var sf=function(e){return of(e)&&nf(e.length)&&!!af[rf(e)]};var cf=function(e){return function(t){return e(t)}},lf={exports:{}};!function(e,t){var r=Wc,n=t&&!t.nodeType&&t,o=n&&e&&!e.nodeType&&e,i=o&&o.exports===n&&r.process,a=function(){try{var e=o&&o.require&&o.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(hL){}}();e.exports=a}(lf,lf.exports);var uf=lf.exports,df=sf,ff=cf,pf=uf&&uf.isTypedArray,hf=pf?ff(pf):df,mf=Fd,yf=Xd,vf=Ul,gf=ef,bf=ad,wf=hf,Ef=Object.prototype.hasOwnProperty;var _f=function(e,t){var r=vf(e),n=!r&&yf(e),o=!r&&!n&&gf(e),i=!r&&!n&&!o&&wf(e),a=r||n||o||i,s=a?mf(e.length,String):[],c=s.length;for(var l in e)!t&&!Ef.call(e,l)||a&&("length"==l||o&&("offset"==l||"parent"==l)||i&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||bf(l,c))||s.push(l);return s},Sf=Object.prototype;var xf=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Sf)};var Nf=function(e,t){return function(r){return e(t(r))}},If=Nf(Object.keys,Object),Tf=xf,Of=If,Af=Object.prototype.hasOwnProperty;var Rf=ll,Pf=tf;var Cf=function(e){return null!=e&&Pf(e.length)&&!Rf(e)},kf=_f,Vf=function(e){if(!Tf(e))return Of(e);var t=[];for(var r in Object(e))Af.call(e,r)&&"constructor"!=r&&t.push(r);return t},Lf=Cf;var Uf=function(e){return Lf(e)?kf(e):Vf(e)},Df=Bd,jf=Uf;var Mf=function(e,t){return e&&Df(t,jf(t),e)};var qf=il,Bf=xf,Ff=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t},Wf=Object.prototype.hasOwnProperty;var Hf=_f,Gf=function(e){if(!qf(e))return Ff(e);var t=Bf(e),r=[];for(var n in e)("constructor"!=n||!t&&Wf.call(e,n))&&r.push(n);return r},$f=Cf;var zf=function(e){return $f(e)?Hf(e,!0):Gf(e)},Kf=Bd,Jf=zf;var Yf=function(e,t){return e&&Kf(t,Jf(t),e)},Xf={exports:{}};!function(e,t){var r=$c,n=t&&!t.nodeType&&t,o=n&&e&&!e.nodeType&&e,i=o&&o.exports===n?r.Buffer:void 0,a=i?i.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=a?a(r):new e.constructor(r);return e.copy(n),n}}(Xf,Xf.exports);var Qf=Xf.exports;var Zf=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t};var ep=function(){return[]},tp=function(e,t){for(var r=-1,n=null==e?0:e.length,o=0,i=[];++r<n;){var a=e[r];t(a,r,e)&&(i[o++]=a)}return i},rp=ep,np=Object.prototype.propertyIsEnumerable,op=Object.getOwnPropertySymbols,ip=op?function(e){return null==e?[]:(e=Object(e),tp(op(e),function(t){return np.call(e,t)}))}:rp,ap=Bd,sp=ip;var cp=function(e,t){return ap(e,sp(e),t)};var lp=function(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e},up=Nf(Object.getPrototypeOf,Object),dp=lp,fp=up,pp=ip,hp=ep,mp=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)dp(t,pp(e)),e=fp(e);return t}:hp,yp=Bd,vp=mp;var gp=function(e,t){return yp(e,vp(e),t)},bp=lp,wp=Ul;var Ep=function(e,t,r){var n=t(e);return wp(e)?n:bp(n,r(e))},_p=Ep,Sp=ip,xp=Uf;var Np=function(e){return _p(e,xp,Sp)},Ip=Ep,Tp=mp,Op=zf;var Ap=function(e){return Ip(e,Op,Tp)},Rp=Tl($c,"DataView"),Pp=xu,Cp=Tl($c,"Promise"),kp=Tl($c,"Set"),Vp=Tl($c,"WeakMap"),Lp=ol,Up=hl,Dp="[object Map]",jp="[object Promise]",Mp="[object Set]",qp="[object WeakMap]",Bp="[object DataView]",Fp=Up(Rp),Wp=Up(Pp),Hp=Up(Cp),Gp=Up(kp),$p=Up(Vp),zp=Lp;(Rp&&zp(new Rp(new ArrayBuffer(1)))!=Bp||Pp&&zp(new Pp)!=Dp||Cp&&zp(Cp.resolve())!=jp||kp&&zp(new kp)!=Mp||Vp&&zp(new Vp)!=qp)&&(zp=function(e){var t=Lp(e),r="[object Object]"==t?e.constructor:void 0,n=r?Up(r):"";if(n)switch(n){case Fp:return Bp;case Wp:return Dp;case Hp:return jp;case Gp:return Mp;case $p:return qp}return t});var Kp=zp,Jp=Object.prototype.hasOwnProperty;var Yp=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&Jp.call(e,"index")&&(r.index=e.index,r.input=e.input),r},Xp=$c.Uint8Array;var Qp=function(e){var t=new e.constructor(e.byteLength);return new Xp(t).set(new Xp(e)),t},Zp=Qp;var eh=function(e,t){var r=t?Zp(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)},th=/\w*$/;var rh=function(e){var t=new e.constructor(e.source,th.exec(e));return t.lastIndex=e.lastIndex,t},nh=zc?zc.prototype:void 0,oh=nh?nh.valueOf:void 0;var ih=Qp;var ah=Qp,sh=eh,ch=rh,lh=function(e){return oh?Object(oh.call(e)):{}},uh=function(e,t){var r=t?ih(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)};var dh=function(e,t,r){var n=e.constructor;switch(t){case"[object ArrayBuffer]":return ah(e);case"[object Boolean]":case"[object Date]":return new n(+e);case"[object DataView]":return sh(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return uh(e,r);case"[object Map]":case"[object Set]":return new n;case"[object Number]":case"[object String]":return new n(e);case"[object RegExp]":return ch(e);case"[object Symbol]":return lh(e)}},fh=il,ph=Object.create,hh=function(){function e(){}return function(t){if(!fh(t))return{};if(ph)return ph(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),mh=up,yh=xf;var vh=function(e){return"function"!=typeof e.constructor||yh(e)?{}:hh(mh(e))},gh=Kp,bh=Dl;var wh=function(e){return bh(e)&&"[object Map]"==gh(e)},Eh=cf,_h=uf&&uf.isMap,Sh=_h?Eh(_h):wh,xh=Kp,Nh=Dl;var Ih=function(e){return Nh(e)&&"[object Set]"==xh(e)},Th=cf,Oh=uf&&uf.isSet,Ah=Oh?Th(Oh):Ih,Rh=Dd,Ph=jd,Ch=Ll,kh=Mf,Vh=Yf,Lh=Qf,Uh=Zf,Dh=cp,jh=gp,Mh=Np,qh=Ap,Bh=Kp,Fh=Yp,Wh=dh,Hh=vh,Gh=Ul,$h=ef,zh=Sh,Kh=il,Jh=Ah,Yh=Uf,Xh=zf,Qh="[object Arguments]",Zh="[object Function]",em="[object Object]",tm={};tm[Qh]=tm["[object Array]"]=tm["[object ArrayBuffer]"]=tm["[object DataView]"]=tm["[object Boolean]"]=tm["[object Date]"]=tm["[object Float32Array]"]=tm["[object Float64Array]"]=tm["[object Int8Array]"]=tm["[object Int16Array]"]=tm["[object Int32Array]"]=tm["[object Map]"]=tm["[object Number]"]=tm[em]=tm["[object RegExp]"]=tm["[object Set]"]=tm["[object String]"]=tm["[object Symbol]"]=tm["[object Uint8Array]"]=tm["[object Uint8ClampedArray]"]=tm["[object Uint16Array]"]=tm["[object Uint32Array]"]=!0,tm["[object Error]"]=tm[Zh]=tm["[object WeakMap]"]=!1;var rm=function e(t,r,n,o,i,a){var s,c=1&r,l=2&r,u=4&r;if(n&&(s=i?n(t,o,i,a):n(t)),void 0!==s)return s;if(!Kh(t))return t;var d=Gh(t);if(d){if(s=Fh(t),!c)return Uh(t,s)}else{var f=Bh(t),p=f==Zh||"[object GeneratorFunction]"==f;if($h(t))return Lh(t,c);if(f==em||f==Qh||p&&!i){if(s=l||p?{}:Hh(t),!c)return l?jh(t,Vh(s,t)):Dh(t,kh(s,t))}else{if(!tm[f])return i?t:{};s=Wh(t,f,c)}}a||(a=new Rh);var h=a.get(t);if(h)return h;a.set(t,s),Jh(t)?t.forEach(function(o){s.add(e(o,r,n,o,t,a))}):zh(t)&&t.forEach(function(o,i){s.set(i,e(o,r,n,i,t,a))});var m=d?void 0:(u?l?qh:Mh:l?Xh:Yh)(t);return Ph(m||t,function(o,i){m&&(o=t[i=o]),Ch(s,i,e(o,r,n,i,t,a))}),s},nm=rm;const om=Ni(function(e){return nm(e,5)});function im(e){return void 0===e&&(e=""),"".concat(e?"".concat(e,"_"):"").concat(+new Date,"_").concat(Math.random())}var am,sm,cm=function(){return function(e){this.close=e.close,this.onChange=e.onChange,this.onError=e.onError,e.debug&&Object.defineProperty(this,"virtualClient",{get:function(){return e.virtualClient}})}}(),lm=function(){return function(e){var t,r,n=e.id,o=e.docChanges,i=e.docs,a=e.msgType,s=e.type;Object.defineProperties(this,{id:{get:function(){return n},enumerable:!0},docChanges:{get:function(){return t||(t=JSON.parse(JSON.stringify(o))),t},enumerable:!0},docs:{get:function(){return r||(r=JSON.parse(JSON.stringify(i))),r},enumerable:!0},msgType:{get:function(){return a},enumerable:!0},type:{get:function(){return s},enumerable:!0}})}}(),um=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),dm=function(e){function t(t){var r=e.call(this,"Watch Error ".concat(JSON.stringify(t.msgData)," (requestid: ").concat(t.requestId,")"))||this;return r.isRealtimeErrorMessageError=!0,r.payload=t,r}return um(t,e),t}(Error),fm=function(e){return null==e?void 0:e.isRealtimeErrorMessageError},pm=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="timeout",t.payload=null,t.generic=!0,t}return um(t,e),t}(Error),hm=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="cancelled",t.payload=null,t.generic=!0,t}return um(t,e),t}(Error),mm=function(e){function t(t){var r=e.call(this,t.errMsg)||this;return r.errCode="UNKNOWN_ERROR",Object.defineProperties(r,{message:{get:function(){return"errCode: ".concat(this.errCode," ").concat(ym[this.errCode]||""," | errMsg: ").concat(this.errMsg)},set:function(e){this.errMsg=e}}}),r.errCode=t.errCode||"UNKNOWN_ERROR",r.errMsg=t.errMsg,r}return um(t,e),Object.defineProperty(t.prototype,"message",{get:function(){return"errCode: ".concat(this.errCode," | errMsg: ").concat(this.errMsg)},set:function(e){this.errMsg=e},enumerable:!1,configurable:!0}),t}(Error),ym={UNKNOWN_ERROR:"UNKNOWN_ERROR",SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_RECONNECT_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_RECONNECT_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_CLOSE_WATCH_FAIL:"SDK_DATABASE_REALTIME_LISTENER_CLOSE_WATCH_FAIL",SDK_DATABASE_REALTIME_LISTENER_SERVER_ERROR_MSG:"SDK_DATABASE_REALTIME_LISTENER_SERVER_ERROR_MSG",SDK_DATABASE_REALTIME_LISTENER_RECEIVE_INVALID_SERVER_DATA:"SDK_DATABASE_REALTIME_LISTENER_RECEIVE_INVALID_SERVER_DATA",SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_ERROR:"SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_ERROR",SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_CLOSED:"SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_CLOSED",SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL:"SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL",SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR:"SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR"},vm=function(e){return void 0===e&&(e=0),new Promise(function(t){return setTimeout(t,e)})},gm=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},bm=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},wm=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};(sm=am||(am={})).LOGGINGIN="LOGGINGIN",sm.INITING="INITING",sm.REBUILDING="REBUILDING",sm.ACTIVE="ACTIVE",sm.ERRORED="ERRORED",sm.CLOSING="CLOSING",sm.CLOSED="CLOSED",sm.PAUSED="PAUSED",sm.RESUMING="RESUMING";var Em=function(){function e(e){var t=this;this.watchStatus=am.INITING,this.wsLogin=function(e,r){return gm(t,void 0,void 0,function(){var t;return bm(this,function(n){switch(n.label){case 0:return this.watchStatus=am.LOGGINGIN,[4,this.login(e,r)];case 1:return t=n.sent(),this.envId||(this.envId=t.envId),[2,t]}})})},this.initWatch=function(e){return gm(t,void 0,void 0,function(){var t,r=this;return bm(this,function(n){switch(n.label){case 0:if(null!==this.initWatchPromise&&void 0!==this.initWatchPromise)return[2,this.initWatchPromise];this.initWatchPromise=new Promise(function(t,n){gm(r,void 0,void 0,function(){var r,o,i,a,s,c,l,u,d,f;return bm(this,function(p){switch(p.label){case 0:return p.trys.push([0,3,,4]),this.watchStatus===am.PAUSED?(console.log("[realtime] initWatch cancelled on pause"),[2,t()]):[4,this.wsLogin(this.envId,e)];case 1:return r=p.sent().envId,this.watchStatus===am.PAUSED?(console.log("[realtime] initWatch cancelled on pause"),[2,t()]):(this.watchStatus=am.INITING,o={watchId:this.watchId,requestId:im(),msgType:"INIT_WATCH",msgData:{envId:r,collName:this.collectionName,query:this.query,limit:this.limit,orderBy:this.orderBy}},[4,this.send({msg:o,waitResponse:!0,skipOnMessage:!0,timeout:1e4})]);case 2:if(i=p.sent(),a=i.msgData,s=a.events,c=a.currEvent,this.sessionInfo={queryID:i.msgData.queryID,currentEventId:c-1,currentDocs:[]},s.length>0){for(l=0,u=s;l<u.length;l++)u[l].ID=c;this.handleServerEvents(i)}else this.sessionInfo.currentEventId=c,d=new lm({id:c,docChanges:[],docs:[],type:"init"}),this.listener.onChange(d),this.scheduleSendACK();return this.onWatchStart(this,this.sessionInfo.queryID),this.watchStatus=am.ACTIVE,this.availableRetries.INIT_WATCH=2,t(),[3,4];case 3:return f=p.sent(),this.handleWatchEstablishmentError(f,{operationName:"INIT_WATCH",resolve:t,reject:n}),[3,4];case 4:return[2]}})})}),t=!1,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this.initWatchPromise];case 2:return n.sent(),t=!0,[3,4];case 3:return this.initWatchPromise=void 0,[7];case 4:return console.log("[realtime] initWatch ".concat(t?"success":"fail")),[2]}})})},this.rebuildWatch=function(e){return gm(t,void 0,void 0,function(){var t,r=this;return bm(this,function(n){switch(n.label){case 0:if(null!==this.rebuildWatchPromise&&void 0!==this.rebuildWatchPromise)return[2,this.rebuildWatchPromise];this.rebuildWatchPromise=new Promise(function(t,n){gm(r,void 0,void 0,function(){var r,o,i,a;return bm(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),this.watchStatus===am.PAUSED?(console.log("[realtime] rebuildWatch cancelled on pause"),[2,t()]):[4,this.wsLogin(this.envId,e)];case 1:if(r=s.sent().envId,!this.sessionInfo)throw new Error("can not rebuildWatch without a successful initWatch (lack of sessionInfo)");return this.watchStatus===am.PAUSED?(console.log("[realtime] rebuildWatch cancelled on pause"),[2,t()]):(this.watchStatus=am.REBUILDING,o={watchId:this.watchId,requestId:im(),msgType:"REBUILD_WATCH",msgData:{envId:r,collName:this.collectionName,queryID:this.sessionInfo.queryID,eventID:this.sessionInfo.currentEventId}},[4,this.send({msg:o,waitResponse:!0,skipOnMessage:!1,timeout:1e4})]);case 2:return i=s.sent(),this.handleServerEvents(i),this.watchStatus=am.ACTIVE,this.availableRetries.REBUILD_WATCH=2,t(),[3,4];case 3:return a=s.sent(),this.handleWatchEstablishmentError(a,{operationName:"REBUILD_WATCH",resolve:t,reject:n}),[3,4];case 4:return[2]}})})}),t=!1,n.label=1;case 1:return n.trys.push([1,,3,4]),[4,this.rebuildWatchPromise];case 2:return n.sent(),t=!0,[3,4];case 3:return this.rebuildWatchPromise=void 0,[7];case 4:return console.log("[realtime] rebuildWatch ".concat(t?"success":"fail")),[2]}})})},this.handleWatchEstablishmentError=function(e,r){return gm(t,void 0,void 0,function(){var t,n,o,i=this;return bm(this,function(a){return t="INIT_WATCH"===r.operationName,n=function(){i.closeWithError(new mm({errCode:t?ym.SDK_DATABASE_REALTIME_LISTENER_INIT_WATCH_FAIL:ym.SDK_DATABASE_REALTIME_LISTENER_REBUILD_WATCH_FAIL,errMsg:e})),r.reject(e)},o=function(e){i.useRetryTicket(r.operationName)?t?(i.initWatchPromise=void 0,r.resolve(i.initWatch(e))):(i.rebuildWatchPromise=void 0,r.resolve(i.rebuildWatch(e))):n()},this.handleCommonError(e,{onSignError:function(){return o(!0)},onTimeoutError:function(){return o(!1)},onNotRetryableError:n,onCancelledError:r.reject,onUnknownError:function(){gm(i,void 0,void 0,function(){var e,t=this;return bm(this,function(n){switch(n.label){case 0:return n.trys.push([0,8,,9]),e=function(){return gm(t,void 0,void 0,function(){return bm(this,function(e){switch(e.label){case 0:return this.pause(),[4,this.onceWSConnected()];case 1:return e.sent(),o(!0),[2]}})})},this.isWSConnected()?[3,2]:[4,e()];case 1:return n.sent(),[3,7];case 2:return[4,vm(100)];case 3:return n.sent(),this.watchStatus!==am.PAUSED?[3,4]:(r.reject(new hm("".concat(r.operationName," cancelled due to pause after unknownError"))),[3,7]);case 4:return this.isWSConnected()?[3,6]:[4,e()];case 5:return n.sent(),[3,7];case 6:o(!1),n.label=7;case 7:return[3,9];case 8:return n.sent(),o(!0),[3,9];case 9:return[2]}})})}}),[2]})})},this.closeWatch=function(){return gm(t,void 0,void 0,function(){var e,t,r;return bm(this,function(n){switch(n.label){case 0:if(e=this.sessionInfo?this.sessionInfo.queryID:"",this.watchStatus!==am.ACTIVE)return this.watchStatus=am.CLOSED,this.onWatchClose(this,e),[2];n.label=1;case 1:return n.trys.push([1,3,4,5]),this.watchStatus=am.CLOSING,t={watchId:this.watchId,requestId:im(),msgType:"CLOSE_WATCH",msgData:null},[4,this.send({msg:t})];case 2:return n.sent(),this.sessionInfo=void 0,this.watchStatus=am.CLOSED,[3,5];case 3:return r=n.sent(),this.closeWithError(new mm({errCode:ym.SDK_DATABASE_REALTIME_LISTENER_CLOSE_WATCH_FAIL,errMsg:r})),[3,5];case 4:return this.onWatchClose(this,e),[7];case 5:return[2]}})})},this.scheduleSendACK=function(){t.clearACKSchedule(),t.ackTimeoutId=setTimeout(function(){t.waitExpectedTimeoutId?t.scheduleSendACK():t.sendACK()},1e4)},this.clearACKSchedule=function(){t.ackTimeoutId&&clearTimeout(t.ackTimeoutId)},this.sendACK=function(){return gm(t,void 0,void 0,function(){var e,t,r;return bm(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),this.watchStatus!==am.ACTIVE?(this.scheduleSendACK(),[2]):this.sessionInfo?(e={watchId:this.watchId,requestId:im(),msgType:"CHECK_LAST",msgData:{queryID:this.sessionInfo.queryID,eventID:this.sessionInfo.currentEventId}},[4,this.send({msg:e})]):(console.warn("[realtime listener] can not send ack without a successful initWatch (lack of sessionInfo)"),[2]);case 1:return n.sent(),this.scheduleSendACK(),[3,3];case 2:if(t=n.sent(),fm(t))switch((r=t.payload).msgData.code){case"CHECK_LOGIN_FAILED":case"SIGN_EXPIRED_ERROR":case"SIGN_INVALID_ERROR":case"SIGN_PARAM_INVALID":return this.rebuildWatch(),[2];case"QUERYID_INVALID_ERROR":case"SYS_ERR":case"INVALIID_ENV":case"COLLECTION_PERMISSION_DENIED":return this.closeWithError(new mm({errCode:ym.SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL,errMsg:r.msgData.code})),[2]}return this.availableRetries.CHECK_LAST&&this.availableRetries.CHECK_LAST>0?(this.availableRetries.CHECK_LAST-=1,this.scheduleSendACK()):this.closeWithError(new mm({errCode:ym.SDK_DATABASE_REALTIME_LISTENER_CHECK_LAST_FAIL,errMsg:t})),[3,3];case 3:return[2]}})})},this.handleCommonError=function(e,t){if(fm(e)){switch(e.payload.msgData.code){case"CHECK_LOGIN_FAILED":case"SIGN_EXPIRED_ERROR":case"SIGN_INVALID_ERROR":case"SIGN_PARAM_INVALID":return void t.onSignError(e);default:return void t.onNotRetryableError(e)}}else{if(function(e){return"timeout"===e.type}(e))return void t.onTimeoutError(e);if(function(e){return"cancelled"===e.type}(e))return void t.onCancelledError(e)}t.onUnknownError(e)},this.watchId="watchid_".concat(+new Date,"_").concat(Math.random()),this.envId=e.envId,this.collectionName=e.collectionName,this.query=e.query,this.limit=e.limit,this.orderBy=e.orderBy,this.send=e.send,this.login=e.login,this.isWSConnected=e.isWSConnected,this.onceWSConnected=e.onceWSConnected,this.getWaitExpectedTimeoutLength=e.getWaitExpectedTimeoutLength,this.onWatchStart=e.onWatchStart,this.onWatchClose=e.onWatchClose,this.debug=e.debug,this.availableRetries={INIT_WATCH:2,REBUILD_WATCH:2,CHECK_LAST:2},this.listener=new cm({close:function(){t.closeWatch()},onChange:e.onChange,onError:e.onError,debug:this.debug,virtualClient:this}),this.initWatch()}return e.prototype.onMessage=function(e){var t=this;switch(this.watchStatus){case am.PAUSED:if("ERROR"!==e.msgType)return;break;case am.LOGGINGIN:case am.INITING:case am.REBUILDING:return void console.warn("[realtime listener] internal non-fatal error: unexpected message received while ".concat(this.watchStatus));case am.CLOSED:return void console.warn("[realtime listener] internal non-fatal error: unexpected message received when the watch has closed");case am.ERRORED:return void console.warn("[realtime listener] internal non-fatal error: unexpected message received when the watch has ended with error")}if(this.sessionInfo)switch(this.scheduleSendACK(),e.msgType){case"NEXT_EVENT":console.warn("nextevent ".concat(e.msgData.currEvent," ignored"),e),this.handleServerEvents(e);break;case"CHECK_EVENT":this.sessionInfo.currentEventId<e.msgData.currEvent&&(this.sessionInfo.expectEventId=e.msgData.currEvent,this.clearWaitExpectedEvent(),this.waitExpectedTimeoutId=setTimeout(function(){t.rebuildWatch()},this.getWaitExpectedTimeoutLength()),console.log("[realtime] waitExpectedTimeoutLength ".concat(this.getWaitExpectedTimeoutLength())));break;case"ERROR":this.closeWithError(new mm({errCode:ym.SDK_DATABASE_REALTIME_LISTENER_SERVER_ERROR_MSG,errMsg:"".concat(e.msgData.code," - ").concat(e.msgData.message)}));break;default:console.warn("[realtime listener] virtual client receive unexpected msg ".concat(e.msgType,": "),e)}else console.warn("[realtime listener] internal non-fatal error: sessionInfo not found while message is received.")},e.prototype.closeWithError=function(e){var t;this.watchStatus=am.ERRORED,this.clearACKSchedule(),this.listener.onError(e),this.onWatchClose(this,(null===(t=this.sessionInfo)||void 0===t?void 0:t.queryID)||""),console.log("[realtime] client closed (".concat(this.collectionName," ").concat(this.query,") (watchId ").concat(this.watchId,")"))},e.prototype.pause=function(){this.watchStatus=am.PAUSED,console.log("[realtime] client paused (".concat(this.collectionName," ").concat(this.query,") (watchId ").concat(this.watchId,")"))},e.prototype.resume=function(){return gm(this,void 0,void 0,function(){var e;return bm(this,function(t){switch(t.label){case 0:this.watchStatus=am.RESUMING,console.log("[realtime] client resuming with ".concat(this.sessionInfo?"REBUILD_WATCH":"INIT_WATCH"," (").concat(this.collectionName," ").concat(this.query,") (").concat(this.watchId,")")),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.sessionInfo?this.rebuildWatch():this.initWatch()];case 2:return t.sent(),console.log("[realtime] client successfully resumed (".concat(this.collectionName," ").concat(this.query,") (").concat(this.watchId,")")),[3,4];case 3:return e=t.sent(),console.error("[realtime] client resume failed (".concat(this.collectionName," ").concat(this.query,") (").concat(this.watchId,")"),e),[3,4];case 4:return[2]}})})},e.prototype.useRetryTicket=function(e){return!!(this.availableRetries[e]&&this.availableRetries[e]>0)&&(this.availableRetries[e]-=1,console.log("[realtime] ".concat(e," use a retry ticket, now only ").concat(this.availableRetries[e]," retry left")),!0)},e.prototype.handleServerEvents=function(e){return gm(this,void 0,void 0,function(){var t;return bm(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),this.scheduleSendACK(),[4,this.handleServerEventsInternel(e)];case 1:return r.sent(),this.postHandleServerEventsValidityCheck(e),[3,3];case 2:throw t=r.sent(),console.error("[realtime listener] internal non-fatal error: handle server events failed with error: ",t),t;case 3:return[2]}})})},e.prototype.handleServerEventsInternel=function(e){return gm(this,void 0,void 0,function(){var t,r,n,o,i,a,s,c,l,u,d,f;return bm(this,function(p){switch(p.label){case 0:if(t=e.requestId,r=e.msgData.events,n=e.msgType,!r.length||!this.sessionInfo)return[2];o=this.sessionInfo;try{i=r.map(_m)}catch(hL){return this.closeWithError(new mm({errCode:ym.SDK_DATABASE_REALTIME_LISTENER_RECEIVE_INVALID_SERVER_DATA,errMsg:hL})),[2]}a=wm([],o.currentDocs,!0),s=!1,c=function(r,c){var u,d,f,p,h,m,y,v,g,b,w,E;return bm(this,function(_){switch(_.label){case 0:return u=i[r],o.currentEventId>=u.id?(!i[r-1]||u.id>i[r-1].id?console.warn("[realtime] duplicate event received, cur ".concat(o.currentEventId," but got ").concat(u.id)):console.error("[realtime listener] server non-fatal error: events out of order (the latter event's id is smaller than that of the former) (requestId ".concat(t,")")),[2,"continue"]):[3,1];case 1:if(o.currentEventId!==u.id-1)return[3,2];switch(u.dataType){case"update":if(!u.doc)switch(u.queueType){case"update":case"dequeue":if(d=a.find(function(e){return e._id===u.docId})){if(f=om(d),u.updatedFields&&Object.keys(u.updatedFields).forEach(function(e){md(f,e,u.updatedFields[e])}),u.removedFields)for(p=0,h=u.removedFields;p<h.length;p++)m=h[p],Nd(f,m);u.doc=f}else console.error("[realtime listener] internal non-fatal server error: unexpected update dataType event where no doc is associated.");break;case"enqueue":throw v=new mm({errCode:ym.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:'HandleServerEvents: full doc is not provided with dataType="update" and queueType="enqueue" (requestId '.concat(e.requestId,")")}),l.closeWithError(v),v}break;case"replace":if(!u.doc)throw v=new mm({errCode:ym.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:'HandleServerEvents: full doc is not provided with dataType="replace" (requestId '.concat(e.requestId,")")}),l.closeWithError(v),v;break;case"remove":(y=a.find(function(e){return e._id===u.docId}))?u.doc=y:console.error("[realtime listener] internal non-fatal server error: unexpected remove event where no doc is associated.");break;case"limit":if(!u.doc)switch(u.queueType){case"dequeue":(y=a.find(function(e){return e._id===u.docId}))?u.doc=y:console.error("[realtime listener] internal non-fatal server error: unexpected limit dataType event where no doc is associated.");break;case"enqueue":throw v=new mm({errCode:ym.SDK_DATABASE_REALTIME_LISTENER_UNEXPECTED_FATAL_ERROR,errMsg:'HandleServerEvents: full doc is not provided with dataType="limit" and queueType="enqueue" (requestId '.concat(e.requestId,")")}),l.closeWithError(v),v}}switch(u.queueType){case"init":s?a.push(u.doc):(s=!0,a=[u.doc]);break;case"enqueue":a.push(u.doc);break;case"dequeue":(g=a.findIndex(function(e){return e._id===u.docId}))>-1?a.splice(g,1):console.error("[realtime listener] internal non-fatal server error: unexpected dequeue event where no doc is associated.");break;case"update":(g=a.findIndex(function(e){return e._id===u.docId}))>-1?a[g]=u.doc:console.error("[realtime listener] internal non-fatal server error: unexpected queueType update event where no doc is associated.")}return(r===c-1||i[r+1]&&i[r+1].id!==u.id)&&(b=wm([],a,!0),w=i.slice(0,r+1).filter(function(e){return e.id===u.id}),l.sessionInfo.currentEventId=u.id,l.sessionInfo.currentDocs=a,E=new lm({id:u.id,docChanges:w,docs:b,msgType:n}),l.listener.onChange(E)),[3,4];case 2:return console.warn("[realtime listener] event received is out of order, cur ".concat(l.sessionInfo.currentEventId," but got ").concat(u.id)),[4,l.rebuildWatch()];case 3:return _.sent(),[2,{value:void 0}];case 4:return[2]}})},l=this,u=0,d=i.length,p.label=1;case 1:return u<d?[5,c(u,d)]:[3,4];case 2:if("object"==typeof(f=p.sent()))return[2,f.value];p.label=3;case 3:return u++,[3,1];case 4:return[2]}})})},e.prototype.postHandleServerEventsValidityCheck=function(e){this.sessionInfo?(this.sessionInfo.expectEventId&&this.sessionInfo.currentEventId>=this.sessionInfo.expectEventId&&this.clearWaitExpectedEvent(),this.sessionInfo.currentEventId<e.msgData.currEvent&&console.warn("[realtime listener] internal non-fatal error: client eventId does not match with server event id after server event handling")):console.error("[realtime listener] internal non-fatal error: sessionInfo lost after server event handling, this should never occur")},e.prototype.clearWaitExpectedEvent=function(){this.waitExpectedTimeoutId&&(clearTimeout(this.waitExpectedTimeoutId),this.waitExpectedTimeoutId=void 0)},e}();function _m(e){var t={id:e.ID,dataType:e.DataType,queueType:e.QueueType,docId:e.DocID,doc:e.Doc&&"{}"!==e.Doc?JSON.parse(e.Doc):void 0};return"update"===e.DataType&&(e.UpdatedFields&&(t.updatedFields=JSON.parse(e.UpdatedFields)),(e.removedFields||e.RemovedFields)&&(t.removedFields=JSON.parse(e.removedFields))),t}var Sm,xm,Nm={1e3:{code:1e3,name:"Normal Closure",description:"Normal closure; the connection successfully completed whatever purpose for which it was created."},1001:{code:1001,name:"Going Away",description:"The endpoint is going away, either because of a server failure or because the browser is navigating away from the page that opened the connection."},1002:{code:1002,name:"Protocol Error",description:"The endpoint is terminating the connection due to a protocol error."},1003:{code:1003,name:"Unsupported Data",description:"The connection is being terminated because the endpoint received data of a type it cannot accept (for example, a text-only endpoint received binary data)."},1005:{code:1005,name:"No Status Received",description:"Indicates that no status code was provided even though one was expected."},1006:{code:1006,name:"Abnormal Closure",description:"Used to indicate that a connection was closed abnormally (that is, with no close frame being sent) when a status code is expected."},1007:{code:1007,name:"Invalid frame payload data",description:"The endpoint is terminating the connection because a message was received that contained inconsistent data (e.g., non-UTF-8 data within a text message)."},1008:{code:1008,name:"Policy Violation",description:"The endpoint is terminating the connection because it received a message that violates its policy. This is a generic status code, used when codes 1003 and 1009 are not suitable."},1009:{code:1009,name:"Message too big",description:"The endpoint is terminating the connection because a data frame was received that is too large."},1010:{code:1010,name:"Missing Extension",description:"The client is terminating the connection because it expected the server to negotiate one or more extension, but the server didn't."},1011:{code:1011,name:"Internal Error",description:"The server is terminating the connection because it encountered an unexpected condition that prevented it from fulfilling the request."},1012:{code:1012,name:"Service Restart",description:"The server is terminating the connection because it is restarting."},1013:{code:1013,name:"Try Again Later",description:"The server is terminating the connection due to a temporary condition, e.g. it is overloaded and is casting off some of its clients."},1014:{code:1014,name:"Bad Gateway",description:"The server was acting as a gateway or proxy and received an invalid response from the upstream server. This is similar to 502 HTTP Status Code."},1015:{code:1015,name:"TLS Handshake",description:"Indicates that the connection was closed due to a failure to perform a TLS handshake (e.g., the server certificate can't be verified)."},3e3:{code:3e3,name:"Reconnect WebSocket",description:"The client is terminating the connection because it wants to reconnect"},3001:{code:3001,name:"No Realtime Listeners",description:"The client is terminating the connection because no more realtime listeners exist"},3002:{code:3002,name:"Heartbeat Ping Error",description:"The client is terminating the connection due to its failure in sending heartbeat messages"},3003:{code:3003,name:"Heartbeat Pong Timeout Error",description:"The client is terminating the connection because no heartbeat response is received from the server"},3050:{code:3050,name:"Server Close",description:"The client is terminating the connection because no heartbeat response is received from the server"}};(xm=Sm||(Sm={}))[xm.NormalClosure=1e3]="NormalClosure",xm[xm.GoingAway=1001]="GoingAway",xm[xm.ProtocolError=1002]="ProtocolError",xm[xm.UnsupportedData=1003]="UnsupportedData",xm[xm.NoStatusReceived=1005]="NoStatusReceived",xm[xm.AbnormalClosure=1006]="AbnormalClosure",xm[xm.InvalidFramePayloadData=1007]="InvalidFramePayloadData",xm[xm.PolicyViolation=1008]="PolicyViolation",xm[xm.MessageTooBig=1009]="MessageTooBig",xm[xm.MissingExtension=1010]="MissingExtension",xm[xm.InternalError=1011]="InternalError",xm[xm.ServiceRestart=1012]="ServiceRestart",xm[xm.TryAgainLater=1013]="TryAgainLater",xm[xm.BadGateway=1014]="BadGateway",xm[xm.TLSHandshake=1015]="TLSHandshake",xm[xm.ReconnectWebSocket=3e3]="ReconnectWebSocket",xm[xm.NoRealtimeListeners=3001]="NoRealtimeListeners",xm[xm.HeartbeatPingError=3002]="HeartbeatPingError",xm[xm.HeartbeatPongTimeoutError=3003]="HeartbeatPongTimeoutError",xm[xm.NoAuthentication=3050]="NoAuthentication";var Im=function(e,t){var r=Nm[e],n=r?"".concat(r.name,", code ").concat(e,", reason ").concat(t||r.description):"code ".concat(e);return new mm({errCode:ym.SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_CLOSED,errMsg:n})},Tm=null,Om="web";function Am(){return Om}var Rm=function(){return Rm=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Rm.apply(this,arguments)},Pm=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},Cm=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},km=1,Vm=function(){function e(e){var t=this;this.virtualWSClient=new Set,this.queryIdClientMap=new Map,this.watchIdClientMap=new Map,this.pingFailed=0,this.pongMissed=0,this.logins=new Map,this.wsReadySubsribers=[],this.wsResponseWait=new Map,this.rttObserved=[],this.send=function(e){return Pm(t,void 0,void 0,function(){var t=this;return Cm(this,function(r){return[2,new Promise(function(r,n){Pm(t,void 0,void 0,function(){var t,o,i,a,s,c,l,u,d=this;return Cm(this,function(f){switch(f.label){case 0:o=!1,i=!1,a=function(e){o=!0,t&&clearTimeout(t),r(e)},s=function(e){i=!0,t&&clearTimeout(t),n(e)},e.timeout&&(t=setTimeout(function(){Pm(d,void 0,void 0,function(){return Cm(this,function(e){switch(e.label){case 0:return o&&i?[3,2]:[4,vm(0)];case 1:e.sent(),o&&i||s(new pm("wsclient.send timedout")),e.label=2;case 2:return[2]}})})},e.timeout)),f.label=1;case 1:return f.trys.push([1,8,,9]),void 0===this.wsInitPromise&&null===this.wsInitPromise?[3,3]:[4,this.wsInitPromise];case 2:f.sent(),f.label=3;case 3:if(!this.ws)return s(new Error("invalid state: ws connection not exists, can not send message")),[2];if(this.ws.readyState!==km)return s(new Error("ws readyState invalid: ".concat(this.ws.readyState,", can not send message"))),[2];e.waitResponse&&(c={resolve:a,reject:s,skipOnMessage:e.skipOnMessage},this.wsResponseWait.set(e.msg.requestId,c)),f.label=4;case 4:return f.trys.push([4,6,,7]),[4,this.ws.send(JSON.stringify(e.msg))];case 5:return f.sent(),e.waitResponse||a(void 0),[3,7];case 6:return(l=f.sent())&&(s(l),e.waitResponse&&this.wsResponseWait.delete(e.msg.requestId)),[3,7];case 7:return[3,9];case 8:return u=f.sent(),s(u),[3,9];case 9:return[2]}})})})]})})},this.closeAllClients=function(e){t.virtualWSClient.forEach(function(t){t.closeWithError(e)})},this.pauseClients=function(e){(e||t.virtualWSClient).forEach(function(e){e.pause()})},this.resumeClients=function(e){(e||t.virtualWSClient).forEach(function(e){e.resume()})},this.initWebSocketConnection=function(e,r){return void 0===r&&(r=t.maxReconnect),Pm(t,void 0,void 0,function(){var t=this;return Cm(this,function(n){switch(n.label){case 0:if(e&&this.reconnectState)return[2];if(e&&(this.reconnectState=!0),void 0!==this.wsInitPromise&&null!==this.wsInitPromise)return[2,this.wsInitPromise];e&&this.pauseClients(),this.close(Sm.ReconnectWebSocket),this.wsInitPromise=new Promise(function(n,o){Pm(t,void 0,void 0,function(){var t,i,a=this;return Cm(this,function(s){switch(s.label){case 0:return s.trys.push([0,6,,11]),[4,this.getWsSign()];case 1:return t=s.sent(),[4,new Promise(function(e){var r=t.wsUrl||"wss://tcb-ws.tencentcloudapi.com",n=Tm;a.ws=n?new n(r):new WebSocket(r),e(void 0)})];case 2:return s.sent(),this.ws.connect?[4,this.ws.connect()]:[3,4];case 3:s.sent(),s.label=4;case 4:return[4,this.initWebSocketEvent()];case 5:return s.sent(),n(),e&&(this.resumeClients(),this.reconnectState=!1),[3,11];case 6:return i=s.sent(),console.error("[realtime] initWebSocketConnection connect fail",i),r>0?(this.wsInitPromise=void 0,[4,vm(this.reconnectInterval)]):[3,9];case 7:s.sent(),e&&(this.reconnectState=!1),s.label=8;case 8:return n(this.initWebSocketConnection(e,r-1)),[3,10];case 9:o(i),e&&this.closeAllClients(new mm({errCode:ym.SDK_DATABASE_REALTIME_LISTENER_RECONNECT_WATCH_FAIL,errMsg:i})),s.label=10;case 10:return[3,11];case 11:return[2]}})})}),n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,this.wsInitPromise];case 2:return n.sent(),this.wsReadySubsribers.forEach(function(e){return(0,e.resolve)()}),[3,5];case 3:return n.sent(),this.wsReadySubsribers.forEach(function(e){return(0,e.reject)()}),[3,5];case 4:return this.wsInitPromise=void 0,this.wsReadySubsribers=[],[7];case 5:return[2]}})})},this.initWebSocketEvent=function(){return new Promise(function(e,r){if(!t.ws)throw new Error("can not initWebSocketEvent, ws not exists");var n=!1;t.ws.onopen=function(t){console.warn("[realtime] ws event: open",t),n=!0,e()},t.ws.onerror=function(e){t.logins=new Map,n?(console.error("[realtime] ws event: error",e),t.clearHeartbeat(),t.virtualWSClient.forEach(function(t){return t.closeWithError(new mm({errCode:ym.SDK_DATABASE_REALTIME_LISTENER_WEBSOCKET_CONNECTION_ERROR,errMsg:e}))})):(console.error("[realtime] ws open failed with ws event: error",e),r(e))},t.ws.onclose=function(e){switch(console.warn("[realtime] ws event: close",e),t.logins=new Map,t.clearHeartbeat(),e.code){case Sm.ReconnectWebSocket:case Sm.NoRealtimeListeners:break;case Sm.HeartbeatPingError:case Sm.HeartbeatPongTimeoutError:case Sm.NormalClosure:case Sm.AbnormalClosure:t.maxReconnect>0?t.initWebSocketConnection(!0,t.maxReconnect):t.closeAllClients(Im(e.code));break;case Sm.NoAuthentication:t.closeAllClients(Im(e.code,e.reason));break;default:t.maxReconnect>0?t.initWebSocketConnection(!0,t.maxReconnect):t.closeAllClients(Im(e.code))}},t.ws.onmessage=function(e){var r,n,o=(null===(r=e.data)||void 0===r?void 0:r.data)||e.data;t.heartbeat();try{n="string"==typeof o?JSON.parse(o):o}catch(hL){throw new Error("[realtime] onMessage parse res.data error: ".concat(hL))}if("ERROR"===n.msgType){var i=null;t.virtualWSClient.forEach(function(e){e.watchId===n.watchId&&(i=e)}),i&&i.listener.onError(n)}var a=t.wsResponseWait.get(n.requestId);if(a){try{"ERROR"===n.msgType?a.reject(new dm(n)):a.resolve(n)}catch(hL){console.error("ws onMessage responseWaitSpec.resolve(msg) errored:",hL)}finally{t.wsResponseWait.delete(n.requestId)}if(a.skipOnMessage)return}if("PONG"!==n.msgType){var s=n.watchId&&t.watchIdClientMap.get(n.watchId);if(s)s.onMessage(n);else switch(console.error("[realtime] no realtime listener found responsible for watchId ".concat(n.watchId,": "),n),n.msgType){case"INIT_EVENT":case"NEXT_EVENT":case"CHECK_EVENT":(s=t.queryIdClientMap.get(n.msgData.queryID))&&s.onMessage(n);break;default:for(var c=0,l=Array.from(t.watchIdClientMap.entries());c<l.length;c++){l[c][1].onMessage(n);break}}}else if(t.lastPingSendTS){var u=Date.now()-t.lastPingSendTS;if(u>1e4)return void console.warn("[realtime] untrusted rtt observed: ".concat(u));t.rttObserved.length>=3&&t.rttObserved.splice(0,t.rttObserved.length-3+1),t.rttObserved.push(u)}},t.heartbeat()})},this.isWSConnected=function(){return Boolean(t.ws&&t.ws.readyState===km)},this.onceWSConnected=function(){return Pm(t,void 0,void 0,function(){var e=this;return Cm(this,function(t){return this.isWSConnected()?[2]:null!==this.wsInitPromise&&void 0!==this.wsInitPromise?[2,this.wsInitPromise]:[2,new Promise(function(t,r){e.wsReadySubsribers.push({resolve:t,reject:r})})]})})},this.webLogin=function(e,r){return Pm(t,void 0,void 0,function(){var t,n,o,i,a,s,c,l,u=this;return Cm(this,function(d){switch(d.label){case 0:if(!r)if(e){if(t=this.logins.get(e)){if(t.loggedIn&&t.loginResult)return[2,t.loginResult];if(null!==t.loggingInPromise&&void 0!==t.loggingInPromise)return[2,t.loggingInPromise]}}else if(null!==(null==(n=this.logins.get(""))?void 0:n.loggingInPromise)&&void 0!==(null==n?void 0:n.loggingInPromise))return[2,n.loggingInPromise];o=new Promise(function(e,t){Pm(u,void 0,void 0,function(){var r,n,o,i,a;return Cm(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,,4]),[4,this.getWsSign()];case 1:return r=s.sent(),n={envId:r.envId||"",accessToken:"",referrer:"web",sdkVersion:"",dataVersion:""},o={watchId:void 0,requestId:im(),msgType:"LOGIN",msgData:n,exMsgData:{runtime:Am(),signStr:r.signStr,secretVersion:r.secretVersion}},[4,this.send({msg:o,waitResponse:!0,skipOnMessage:!0,timeout:5e3})];case 2:return(i=s.sent()).msgData.code?t(new Error("".concat(i.msgData.code," ").concat(i.msgData.message))):e({envId:r.envId}),[3,4];case 3:return a=s.sent(),t(a),[3,4];case 4:return[2]}})})}),i=e&&this.logins.get(e),a=Date.now(),i?(i.loggedIn=!1,i.loggingInPromise=o,i.loginStartTS=a):(i={loggedIn:!1,loggingInPromise:o,loginStartTS:a},this.logins.set(e||"",i)),d.label=1;case 1:return d.trys.push([1,3,,4]),[4,o];case 2:if(s=d.sent(),(c=e&&this.logins.get(e))&&c===i&&c.loginStartTS===a)return i.loggedIn=!0,i.loggingInPromise=void 0,i.loginStartTS=void 0,i.loginResult=s,[2,s];if(c){if(c.loggedIn&&c.loginResult)return[2,c.loginResult];if(null!==c.loggingInPromise&&void 0!==c.loggingInPromise)return[2,c.loggingInPromise];throw new Error("ws unexpected login info")}throw new Error("ws login info reset");case 3:throw l=d.sent(),i.loggedIn=!1,i.loggingInPromise=void 0,i.loginStartTS=void 0,i.loginResult=void 0,l;case 4:return[2]}})})},this.getWsSign=function(){return Pm(t,void 0,void 0,function(){var e,t,r,n,o,i,a;return Cm(this,function(s){switch(s.label){case 0:return this.wsSign&&this.wsSign.expiredTs>Date.now()?[2,this.wsSign]:(e=Date.now()+6e4,[4,this.context.appConfig.request.send("auth.wsWebSign",{runtime:Am()})]);case 1:if((t=s.sent()).code)throw new Error("[tcb-js-sdk] è·å–å®æ—¶æ•°æ®æ¨é€ç™»å½•ç¥¨æ®å¤±è´¥: ".concat(t.code));if(t.data)return r=t.data,n=r.signStr,o=r.wsUrl,i=r.secretVersion,a=r.envId,[2,{signStr:n,wsUrl:o,secretVersion:i,envId:a,expiredTs:e}];throw new Error("[tcb-js-sdk] è·å–å®æ—¶æ•°æ®æ¨é€ç™»å½•ç¥¨æ®å¤±è´¥")}})})},this.getWaitExpectedTimeoutLength=function(){return t.rttObserved.length?t.rttObserved.reduce(function(e,t){return e+t})/t.rttObserved.length*1.5:5e3},this.ping=function(){return Pm(t,void 0,void 0,function(){var e;return Cm(this,function(t){switch(t.label){case 0:return e={watchId:void 0,requestId:im(),msgType:"PING",msgData:null},[4,this.send({msg:e})];case 1:return t.sent(),[2]}})})},this.onWatchStart=function(e,r){t.queryIdClientMap.set(r,e)},this.onWatchClose=function(e,r){r&&t.queryIdClientMap.delete(r),t.watchIdClientMap.delete(e.watchId),t.virtualWSClient.delete(e),t.virtualWSClient.size||t.close(Sm.NoRealtimeListeners)},this.maxReconnect=e.maxReconnect||5,this.reconnectInterval=e.reconnectInterval||1e4,this.context=e.context}return e.prototype.clearHeartbeat=function(){this.pingTimeoutId&&clearTimeout(this.pingTimeoutId),this.pongTimeoutId&&clearTimeout(this.pongTimeoutId)},e.prototype.close=function(e){this.clearHeartbeat(),this.ws&&(this.ws.close(e,Nm[e].name),this.ws=void 0)},e.prototype.watch=function(e){this.ws||void 0!==this.wsInitPromise&&null!==this.wsInitPromise||this.initWebSocketConnection(!1);var t=new Em(Rm(Rm({},e),{send:this.send,login:this.webLogin,isWSConnected:this.isWSConnected,onceWSConnected:this.onceWSConnected,getWaitExpectedTimeoutLength:this.getWaitExpectedTimeoutLength,onWatchStart:this.onWatchStart,onWatchClose:this.onWatchClose,debug:!0}));return this.virtualWSClient.add(t),this.watchIdClientMap.set(t.watchId,t),t.listener},e.prototype.heartbeat=function(e){var t=this;this.clearHeartbeat(),this.pingTimeoutId=setTimeout(function(){Pm(t,void 0,void 0,function(){var e=this;return Cm(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),this.ws&&this.ws.readyState===km?(this.lastPingSendTS=Date.now(),[4,this.ping()]):[2];case 1:return t.sent(),this.pingFailed=0,this.pongTimeoutId=setTimeout(function(){console.error("pong timed out"),e.pongMissed<2?(e.pongMissed+=1,e.heartbeat(!0)):e.initWebSocketConnection(!0)},this.context.appConfig.realtimePongWaitTimeout),[3,3];case 2:return t.sent(),this.pingFailed<2?(this.pingFailed+=1,this.heartbeat()):this.close(Sm.HeartbeatPingError),[3,3];case 3:return[2]}})})},e?0:this.context.appConfig.realtimePingInterval)},e}(),Lm={target:"database",entity:function(){var e,t=this.platform,r=t.adapter,n=t.runtime;e=r.wsClass,Tm=e,function(e){Om=e}(n)}},Um={name:"realtime",IIFE:!0,entity:function(){this.prototype.wsClientClass=Vm}};try{cloudbase.registerComponent(Um),cloudbase.registerHook(Lm)}catch(hL){}var Dm=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},jm=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},Mm=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},qm=k,Bm=C,Fm=de,Wm="analytics",Hm=["mall"];var Gm=function(){function e(){}return e.prototype.analytics=function(e){return jm(this,void 0,void 0,function(){var t,r,n;return Mm(this,function(o){if(!function(e){if("Object"!==Object.prototype.toString.call(e).slice(8,-1))return!1;var t=e.report_data,r=e.report_type;return!1!==Hm.includes(r)&&"Object"===Object.prototype.toString.call(t).slice(8,-1)&&!(void 0!==t.action_time&&!Number.isInteger(t.action_time))&&"string"==typeof t.action_type}(e))throw new Error(JSON.stringify({code:qm.INVALID_PARAMS,msg:"[".concat(Wm,".analytics] invalid report data")}));return t=void 0===e.report_data.action_time?Math.floor(Date.now()/1e3):e.report_data.action_time,r={analytics_scene:e.report_type,analytics_data:Object.assign({},e.report_data,{action_time:t})},n={requestData:r},this.request.send("analytics.report",n),[2]})})},function(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);i>3&&a&&Object.defineProperty(t,r,a)}([Fm({customInfo:{},title:"ä¸ŠæŠ¥è°ƒç”¨å¤±è´¥",messages:["è¯·ç¡®è®¤ä»¥ä¸‹å„é¡¹ï¼š","  1 - è°ƒç”¨ analytics() çš„è¯­æ³•æˆ–å‚æ•°æ˜¯å¦æ­£ç¡®","å¦‚æœé—®é¢˜ä¾ç„¶å­˜åœ¨ï¼Œå»ºè®®åˆ°å®˜æ–¹é—®ç­”ç¤¾åŒºæé—®æˆ–å¯»æ‰¾å¸®åŠ©ï¼š".concat(Bm)]}),Dm("design:type",Function),Dm("design:paramtypes",[Object]),Dm("design:returntype",Promise)],e.prototype,"analytics",null),e}(),$m=new Gm,zm={name:Wm,entity:{analytics:$m.analytics}};try{cloudbase.registerComponent(zm)}catch(hL){}var Km=function(e,t){return(Km=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function Jm(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}Km(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var Ym=function(){return Ym=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ym.apply(this,arguments)};function Xm(e,t,r,n){return new(r||(r=Promise))(function(t,o){function i(e){try{s(n.next(e))}catch(hL){o(hL)}}function a(e){try{s(n.throw(e))}catch(hL){o(hL)}}function s(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r(function(e){e(n)})).then(i,a)}s((n=n.apply(e,[])).next())})}function Qm(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(hL){i=[6,hL],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var Zm=function(e){function t(t,r){var n=e.call(this,t)||this;return n.name="WxCloudSDKError",n.code=null==r?void 0:r.code,n.requestId=null==r?void 0:r.requestId,n.originError=null==r?void 0:r.originError,n}return Jm(t,e),t}(Error);function ey(){return"undefined"!=typeof window&&window||"undefined"!=typeof globalThis&&globalThis}function ty(){try{var e=ey();if(!e)return;return"undefined"==typeof wx?ey().location.href:e.__wxRoute}catch(t){}}var ry=function(e){var t=e.dataSourceName,r=e.methodName,n=e.params,o=e.realMethodName,i=e.callFunction,a=e.envType,s=void 0===a?"prod":a,c=e.mode;return Xm(void 0,0,void 0,function(){var e,a,l,u,d,f;return Qm(this,function(p){switch(p.label){case 0:e={data:{},requestId:""},p.label=1;case 1:return p.trys.push([1,3,,4]),[4,i({name:"lowcode-datasource",data:{dataSourceName:t,methodName:r,params:n,userAgent:(m=ey(),(null==m?void 0:m.navigator)?m.navigator.userAgent:"undefined"!=typeof wx&&wx.getSystemInfo?(wx.getSystemInfo({success:function(e){e&&(h=["brand","model","version","system","platform","SDKVersion","language"].map(function(t){return"".concat(t,": ").concat(e[t])}).join(", "))}}),h):void 0),referrer:ty(),"x-sdk-version":"1.7.2",envType:s,mode:c}})];case 2:if(a=p.sent(),l=(null===(d=null==a?void 0:a.result)||void 0===d?void 0:d.requestId)||(null==a?void 0:a.requestId)||(null==a?void 0:a.requestID),null==a?void 0:a.result.code)throw new Zm("ã€é”™è¯¯ã€‘".concat(null==a?void 0:a.result.message,"\nã€æ“ä½œã€‘è°ƒç”¨ models.").concat(t?"".concat(t,"."):"").concat(o,"\nã€é”™è¯¯ç ã€‘").concat(null==a?void 0:a.result.code,"\nã€è¯·æ±‚IDã€‘").concat(l||"N/A"),{code:null==a?void 0:a.result.code,requestId:l});return e.data=(null===(f=null==a?void 0:a.result)||void 0===f?void 0:f.data)||{},e.requestId=l,[3,4];case 3:throw"WxCloudSDKError"===(u=p.sent()).name?u:(console.log(u),new Zm("ã€é”™è¯¯ã€‘".concat(u.message,"\n      ã€æ“ä½œã€‘è°ƒç”¨ models.").concat(t?"".concat(t,"."):"").concat(o,"\n      ã€è¯·æ±‚IDã€‘N/A"),{code:"UnknownError",originError:u}));case 4:return[2,e]}var h,m})})},ny=function(e){var t=e.sql,r=e.params,n=e.config,o=e.callFunction,i=e.unsafe,a=void 0!==i&&i;return Xm(void 0,0,void 0,function(){return Qm(this,function(e){return[2,ry({realMethodName:"$runSQL",methodName:"callWedaApi",params:{action:"RunMysqlCommand",data:{sqlTemplate:t,config:n,parameter:a?"":Object.entries(r||{}).reduce(function(e,t){var r=t[0],n=t[1];if(void 0!==n){var o="OBJECT";switch(typeof n){case"boolean":o="BOOLEAN";break;case"number":o="NUMBER";break;case"string":o="STRING";break;default:o=Array.isArray(n)?"ARRAY":"OBJECT"}e.push({key:r,type:o,value:"STRING"===o?n:JSON.stringify(n)})}return e},[])||[]}},callFunction:o,mode:"sdk"})]})})},oy={filter:{where:{}},select:{$master:!0}};function iy(e){return{getUrl:function(t){return"".concat(t,"/").concat(e)},method:"post"}}var ay={get:Ym(Ym({},iy("get")),{defaultParams:Ym({},oy)}),list:Ym(Ym({},iy("list")),{defaultParams:Ym({},oy)}),create:iy("create"),createMany:iy("createMany"),update:Ym(Ym({},iy("update")),{method:"put"}),updateMany:Ym(Ym({},iy("updateMany")),{method:"put"}),upsert:iy("upsert"),delete:iy("delete"),deleteMany:iy("deleteMany")},sy="Unknown error occurred",cy="NotSupported",ly=function(e,t,r,n){var o=function(e){return{$runSQL:function(t,r,n){return Xm(this,0,void 0,function(){return Qm(this,function(o){switch(o.label){case 0:return[4,ny({sql:t,params:r,config:Ym(Ym({},n),{preparedStatements:!0}),callFunction:e})];case 1:return[2,o.sent()]}})})},$runSQLRaw:function(t,r){return Xm(this,0,void 0,function(){return Qm(this,function(n){switch(n.label){case 0:return[4,ny({sql:t,params:[],config:Ym(Ym({},r),{preparedStatements:!1}),callFunction:e})];case 1:return[2,n.sent()]}})})}}}(e);return new Proxy({},{get:function(e,i){if("string"==typeof i)return Object.prototype.hasOwnProperty.call(o,i)?o[i]:dy(r,i,t,n)}})},uy=function(e,t,r,n,o){return new Zm("ã€é”™è¯¯ã€‘".concat(e,"\nã€æ“ä½œã€‘è°ƒç”¨ models.").concat(t,".").concat(r,"\nã€é”™è¯¯ç ã€‘").concat(n,"\nã€è¯·æ±‚IDã€‘").concat(o),{code:n,requestId:o})},dy=function(e,t,r,n){return new Proxy({},{get:function(o,i){if("runSQLTemplate"!==i){var a=ay[i];if(!a){var s=new Error("ä¸æ”¯æŒçš„æ“ä½œ: ".concat(i));throw new Zm(s.message||sy,{originError:s,code:cy,requestId:"N/A"})}return function(n){return void 0===n&&(n={}),Xm(void 0,0,void 0,function(){var o,s,c,l,u,d,f,p,h,m;return Qm(this,function(y){switch(y.label){case 0:o=a.getUrl,s=a.method,c=a.defaultParams,l=void 0===c?{}:c,u=Object.assign({},l,n),d="pre"===u.envType?"pre":"prod",f=[e,d,o(t)].join("/"),y.label=1;case 1:return y.trys.push([1,3,,4]),[4,r({url:f,body:JSON.stringify(u),method:s})];case 2:if((p=y.sent()).code)throw uy(null==p?void 0:p.message,t,i,null==p?void 0:p.code,null==p?void 0:p.requestId);return"get"===i&&Object.assign(p,{data:null!==(m=p.data.record)&&void 0!==m?m:p.data}),[2,p];case 3:throw h=y.sent(),new Zm((null==h?void 0:h.message)||sy,{originError:h});case 4:return[2]}})})}}if(!(null==n?void 0:n.sqlBaseUrl)){s=new Error("ä¸æ”¯æŒçš„æ“ä½œ: ".concat(i));throw new Zm(s.message||sy,{originError:s,code:cy,requestId:"N/A"})}return function(e){return Xm(void 0,0,void 0,function(){var o,a,s,c,l,u,d,f,p,h,m,y,v,g,b,w;return Qm(this,function(E){switch(E.label){case 0:o=e.params,a=e.templateName,s=e.envType,c="pre"===s?"pre":"prod",l=[n.sqlBaseUrl,c,a,"run"].join("/"),u=Object.entries(o||{}).reduce(function(e,t){var r=t[0],n=t[1];if(void 0!==n){var o="OBJECT";switch(typeof n){case"boolean":o="BOOLEAN";break;case"number":o="NUMBER";break;case"string":o="STRING";break;default:o=Array.isArray(n)?"ARRAY":"OBJECT"}e.push({key:r,type:o,value:"STRING"===o?n:JSON.stringify(n)})}return e},[]),E.label=1;case 1:return E.trys.push([1,3,,4]),[4,r({url:l,body:JSON.stringify({parameter:u}),method:"POST"})];case 2:if(d=E.sent(),null===(p=null==d?void 0:d.Response)||void 0===p?void 0:p.Error)throw uy(null===(m=null===(h=null==d?void 0:d.Response)||void 0===h?void 0:h.Error)||void 0===m?void 0:m.Message,t,i,null===(v=null===(y=null==d?void 0:d.Response)||void 0===y?void 0:y.Error)||void 0===v?void 0:v.Code,null===(g=null==d?void 0:d.Response)||void 0===g?void 0:g.RequestId);return[2,Ym(Ym({},null!==(b=null==d?void 0:d.Response)&&void 0!==b?b:{}),{data:null===(w=null==d?void 0:d.Response)||void 0===w?void 0:w.Data})];case 3:throw f=E.sent(),new Zm((null==f?void 0:f.message)||sy,{originError:f});case 4:return[2]}})})}}})},fy=function(){function e(e){var t=this;this.map=new Map,e&&(e instanceof Headers?e.forEach(function(e,r){t.append(r,e)}):Array.isArray(e)?e.forEach(function(e){var r=e[0],n=e[1];t.append(r,n)}):"object"==typeof e&&Object.keys(e).forEach(function(r){t.append(r,e[r])}))}return e.prototype.append=function(e,t){var r=e.toLowerCase(),n=this.map.get(r);n?this.map.set(r,"".concat(n,", ").concat(t)):this.map.set(r,String(t))},e.prototype.delete=function(e){this.map.delete(e.toLowerCase())},e.prototype.forEach=function(e,t){var r=this;this.map.forEach(function(n,o){e.call(t,n,o,r)})},e.prototype.get=function(e){return this.map.get(e.toLowerCase())||null},e.prototype.has=function(e){return this.map.has(e.toLowerCase())},e.prototype.set=function(e,t){this.map.set(e.toLowerCase(),String(t))},e.prototype.entries=function(){return this.map.entries()},e.prototype.keys=function(){return this.map.keys()},e.prototype.values=function(){return this.map.values()},e.prototype.getSetCookie=function(){var e=[];return this.map.forEach(function(t,r){"set-cookie"===r&&e.push(t)}),e},e.prototype.toJSON=function(){var e={};return this.map.forEach(function(t,r){e[r]=t}),e},e.prototype[Symbol.iterator]=function(){return this.entries()},e}();"object"!=typeof globalThis||globalThis.Headers||(globalThis.Headers=fy);var py="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function hy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var my,yy,vy=function(e){try{return!!e()}catch(t){return!0}},gy=!vy(function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}),by=gy,wy=Function.prototype,Ey=wy.call,_y=by&&wy.bind.bind(Ey,Ey),Sy=by?_y:function(e){return function(){return Ey.apply(e,arguments)}},xy=Sy,Ny=xy({}.toString),Iy=xy("".slice),Ty=function(e){return Iy(Ny(e),8,-1)},Oy=vy,Ay=Ty,Ry=Object,Py=Sy("".split),Cy=Oy(function(){return!Ry("z").propertyIsEnumerable(0)})?function(e){return"String"===Ay(e)?Py(e,""):Ry(e)}:Ry,ky=function(e){return null==e},Vy=ky,Ly=TypeError,Uy=function(e){if(Vy(e))throw new Ly("Can't call method on "+e);return e},Dy=Cy,jy=Uy,My=function(e){return Dy(jy(e))},qy={},By=function(e){return e&&e.Math===Math&&e},Fy=By("object"==typeof globalThis&&globalThis)||By("object"==typeof window&&window)||By("object"==typeof self&&self)||By("object"==typeof py&&py)||By("object"==typeof py&&py)||function(){return this}()||Function("return this")(),Wy="object"==typeof document&&document.all,Hy=void 0===Wy&&void 0!==Wy?function(e){return"function"==typeof e||e===Wy}:function(e){return"function"==typeof e},Gy=Hy,$y=Fy.WeakMap,zy=Gy($y)&&/native code/.test(String($y)),Ky=Hy,Jy=function(e){return"object"==typeof e?null!==e:Ky(e)},Yy=!vy(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}),Xy={},Qy=Jy,Zy=Fy.document,ev=Qy(Zy)&&Qy(Zy.createElement),tv=function(e){return ev?Zy.createElement(e):{}},rv=tv,nv=!Yy&&!vy(function(){return 7!==Object.defineProperty(rv("div"),"a",{get:function(){return 7}}).a}),ov=Yy&&vy(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype}),iv=Jy,av=String,sv=TypeError,cv=function(e){if(iv(e))return e;throw new sv(av(e)+" is not an object")},lv=gy,uv=Function.prototype.call,dv=lv?uv.bind(uv):function(){return uv.apply(uv,arguments)},fv={},pv=fv,hv=Fy,mv=Hy,yv=function(e){return mv(e)?e:void 0},vv=function(e,t){return arguments.length<2?yv(pv[e])||yv(hv[e]):pv[e]&&pv[e][t]||hv[e]&&hv[e][t]},gv=Sy({}.isPrototypeOf),bv=Fy.navigator,wv=bv&&bv.userAgent,Ev=Fy,_v=wv?String(wv):"",Sv=Ev.process,xv=Ev.Deno,Nv=Sv&&Sv.versions||xv&&xv.version,Iv=Nv&&Nv.v8;Iv&&(yy=(my=Iv.split("."))[0]>0&&my[0]<4?1:+(my[0]+my[1])),!yy&&_v&&(!(my=_v.match(/Edge\/(\d+)/))||my[1]>=74)&&(my=_v.match(/Chrome\/(\d+)/))&&(yy=+my[1]);var Tv=yy,Ov=vy,Av=Fy.String,Rv=!!Object.getOwnPropertySymbols&&!Ov(function(){var e=Symbol("symbol detection");return!Av(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Tv&&Tv<41}),Pv=Rv&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Cv=vv,kv=Hy,Vv=gv,Lv=Object,Uv=Pv?function(e){return"symbol"==typeof e}:function(e){var t=Cv("Symbol");return kv(t)&&Vv(t.prototype,Lv(e))},Dv=String,jv=function(e){try{return Dv(e)}catch(t){return"Object"}},Mv=Hy,qv=jv,Bv=TypeError,Fv=function(e){if(Mv(e))return e;throw new Bv(qv(e)+" is not a function")},Wv=Fv,Hv=ky,Gv=function(e,t){var r=e[t];return Hv(r)?void 0:Wv(r)},$v=dv,zv=Hy,Kv=Jy,Jv=TypeError,Yv={exports:{}},Xv=Fy,Qv=Object.defineProperty,Zv=Fy,eg=function(e,t){try{Qv(Xv,e,{value:t,configurable:!0,writable:!0})}catch(r){Xv[e]=t}return t},tg="__core-js_shared__",rg=Yv.exports=Zv[tg]||eg(tg,{});(rg.versions||(rg.versions=[])).push({version:"3.45.0",mode:"pure",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.45.0/LICENSE",source:"https://github.com/zloirock/core-js"});var ng=Yv.exports,og=ng,ig=function(e,t){return og[e]||(og[e]=t||{})},ag=Uy,sg=Object,cg=function(e){return sg(ag(e))},lg=cg,ug=Sy({}.hasOwnProperty),dg=Object.hasOwn||function(e,t){return ug(lg(e),t)},fg=Sy,pg=0,hg=Math.random(),mg=fg(1.1.toString),yg=function(e){return"Symbol("+(void 0===e?"":e)+")_"+mg(++pg+hg,36)},vg=ig,gg=dg,bg=yg,wg=Rv,Eg=Pv,_g=Fy.Symbol,Sg=vg("wks"),xg=Eg?_g.for||_g:_g&&_g.withoutSetter||bg,Ng=function(e){return gg(Sg,e)||(Sg[e]=wg&&gg(_g,e)?_g[e]:xg("Symbol."+e)),Sg[e]},Ig=dv,Tg=Jy,Og=Uv,Ag=Gv,Rg=function(e,t){var r,n;if("string"===t&&zv(r=e.toString)&&!Kv(n=$v(r,e)))return n;if(zv(r=e.valueOf)&&!Kv(n=$v(r,e)))return n;if("string"!==t&&zv(r=e.toString)&&!Kv(n=$v(r,e)))return n;throw new Jv("Can't convert object to primitive value")},Pg=TypeError,Cg=Ng("toPrimitive"),kg=function(e,t){if(!Tg(e)||Og(e))return e;var r,n=Ag(e,Cg);if(n){if(void 0===t&&(t="default"),r=Ig(n,e,t),!Tg(r)||Og(r))return r;throw new Pg("Can't convert object to primitive value")}return void 0===t&&(t="number"),Rg(e,t)},Vg=Uv,Lg=function(e){var t=kg(e,"string");return Vg(t)?t:t+""},Ug=Yy,Dg=nv,jg=ov,Mg=cv,qg=Lg,Bg=TypeError,Fg=Object.defineProperty,Wg=Object.getOwnPropertyDescriptor,Hg="enumerable",Gg="configurable",$g="writable";Xy.f=Ug?jg?function(e,t,r){if(Mg(e),t=qg(t),Mg(r),"function"==typeof e&&"prototype"===t&&"value"in r&&$g in r&&!r[$g]){var n=Wg(e,t);n&&n[$g]&&(e[t]=r.value,r={configurable:Gg in r?r[Gg]:n[Gg],enumerable:Hg in r?r[Hg]:n[Hg],writable:!1})}return Fg(e,t,r)}:Fg:function(e,t,r){if(Mg(e),t=qg(t),Mg(r),Dg)try{return Fg(e,t,r)}catch(n){}if("get"in r||"set"in r)throw new Bg("Accessors not supported");return"value"in r&&(e[t]=r.value),e};var zg,Kg,Jg,Yg=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},Xg=Xy,Qg=Yg,Zg=Yy?function(e,t,r){return Xg.f(e,t,Qg(1,r))}:function(e,t,r){return e[t]=r,e},eb=yg,tb=ig("keys"),rb=function(e){return tb[e]||(tb[e]=eb(e))},nb={},ob=zy,ib=Fy,ab=Jy,sb=Zg,cb=dg,lb=ng,ub=rb,db=nb,fb="Object already initialized",pb=ib.TypeError,hb=ib.WeakMap;if(ob||lb.state){var mb=lb.state||(lb.state=new hb);mb.get=mb.get,mb.has=mb.has,mb.set=mb.set,zg=function(e,t){if(mb.has(e))throw new pb(fb);return t.facade=e,mb.set(e,t),t},Kg=function(e){return mb.get(e)||{}},Jg=function(e){return mb.has(e)}}else{var yb=ub("state");db[yb]=!0,zg=function(e,t){if(cb(e,yb))throw new pb(fb);return t.facade=e,sb(e,yb,t),t},Kg=function(e){return cb(e,yb)?e[yb]:{}},Jg=function(e){return cb(e,yb)}}var vb={set:zg,get:Kg,has:Jg,enforce:function(e){return Jg(e)?Kg(e):zg(e,{})},getterFor:function(e){return function(t){var r;if(!ab(t)||(r=Kg(t)).type!==e)throw new pb("Incompatible receiver, "+e+" required");return r}}},gb=gy,bb=Function.prototype,wb=bb.apply,Eb=bb.call,_b="object"==typeof Reflect&&Reflect.apply||(gb?Eb.bind(wb):function(){return Eb.apply(wb,arguments)}),Sb=Ty,xb=Sy,Nb=function(e){if("Function"===Sb(e))return xb(e)},Ib={},Tb={},Ob={}.propertyIsEnumerable,Ab=Object.getOwnPropertyDescriptor,Rb=Ab&&!Ob.call({1:2},1);Tb.f=Rb?function(e){var t=Ab(this,e);return!!t&&t.enumerable}:Ob;var Pb=Yy,Cb=dv,kb=Tb,Vb=Yg,Lb=My,Ub=Lg,Db=dg,jb=nv,Mb=Object.getOwnPropertyDescriptor;Ib.f=Pb?Mb:function(e,t){if(e=Lb(e),t=Ub(t),jb)try{return Mb(e,t)}catch(r){}if(Db(e,t))return Vb(!Cb(kb.f,e,t),e[t])};var qb=vy,Bb=Hy,Fb=/#|\.prototype\./,Wb=function(e,t){var r=Gb[Hb(e)];return r===zb||r!==$b&&(Bb(t)?qb(t):!!t)},Hb=Wb.normalize=function(e){return String(e).replace(Fb,".").toLowerCase()},Gb=Wb.data={},$b=Wb.NATIVE="N",zb=Wb.POLYFILL="P",Kb=Wb,Jb=Fv,Yb=gy,Xb=Nb(Nb.bind),Qb=function(e,t){return Jb(e),void 0===t?e:Yb?Xb(e,t):function(){return e.apply(t,arguments)}},Zb=Fy,ew=_b,tw=Nb,rw=Hy,nw=Ib.f,ow=Kb,iw=fv,aw=Qb,sw=Zg,cw=dg,lw=function(e){var t=function(r,n,o){if(this instanceof t){switch(arguments.length){case 0:return new e;case 1:return new e(r);case 2:return new e(r,n)}return new e(r,n,o)}return ew(e,this,arguments)};return t.prototype=e.prototype,t},uw=function(e,t){var r,n,o,i,a,s,c,l,u,d=e.target,f=e.global,p=e.stat,h=e.proto,m=f?Zb:p?Zb[d]:Zb[d]&&Zb[d].prototype,y=f?iw:iw[d]||sw(iw,d,{})[d],v=y.prototype;for(i in t)n=!(r=ow(f?i:d+(p?".":"#")+i,e.forced))&&m&&cw(m,i),s=y[i],n&&(c=e.dontCallGetSet?(u=nw(m,i))&&u.value:m[i]),a=n&&c?c:t[i],(r||h||typeof s!=typeof a)&&(l=e.bind&&n?aw(a,Zb):e.wrap&&n?lw(a):h&&rw(a)?tw(a):a,(e.sham||a&&a.sham||s&&s.sham)&&sw(l,"sham",!0),sw(y,i,l),h&&(cw(iw,o=d+"Prototype")||sw(iw,o,{}),sw(iw[o],i,a),e.real&&v&&(r||!v[i])&&sw(v,i,a)))},dw=Yy,fw=dg,pw=Function.prototype,hw=dw&&Object.getOwnPropertyDescriptor,mw=fw(pw,"name"),yw=mw&&"something"===function(){}.name;mw&&(!dw||dw&&hw(pw,"name").configurable);var vw,gw={PROPER:yw},bw={},ww=Math.ceil,Ew=Math.floor,_w=Math.trunc||function(e){var t=+e;return(t>0?Ew:ww)(t)},Sw=function(e){var t=+e;return t!=t||0===t?0:_w(t)},xw=Sw,Nw=Math.max,Iw=Math.min,Tw=function(e,t){var r=xw(e);return r<0?Nw(r+t,0):Iw(r,t)},Ow=Sw,Aw=Math.min,Rw=function(e){var t=Ow(e);return t>0?Aw(t,9007199254740991):0},Pw=function(e){return Rw(e.length)},Cw=My,kw=Tw,Vw=Pw,Lw={indexOf:(vw=!1,function(e,t,r){var n=Cw(e),o=Vw(n);if(0===o)return!vw&&-1;var i,a=kw(r,o);if(vw&&t!=t){for(;o>a;)if((i=n[a++])!=i)return!0}else for(;o>a;a++)if((vw||a in n)&&n[a]===t)return vw||a||0;return!vw&&-1})},Uw=dg,Dw=My,jw=Lw.indexOf,Mw=nb,qw=Sy([].push),Bw=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Fw=function(e,t){var r,n=Dw(e),o=0,i=[];for(r in n)!Uw(Mw,r)&&Uw(n,r)&&qw(i,r);for(;t.length>o;)Uw(n,r=t[o++])&&(~jw(i,r)||qw(i,r));return i},Ww=Bw,Hw=Object.keys||function(e){return Fw(e,Ww)},Gw=Yy,$w=ov,zw=Xy,Kw=cv,Jw=My,Yw=Hw;bw.f=Gw&&!$w?Object.defineProperties:function(e,t){Kw(e);for(var r,n=Jw(t),o=Yw(t),i=o.length,a=0;i>a;)zw.f(e,r=o[a++],n[r]);return e};var Xw,Qw=vv("document","documentElement"),Zw=cv,eE=bw,tE=Bw,rE=nb,nE=Qw,oE=tv,iE="prototype",aE="script",sE=rb("IE_PROTO"),cE=function(){},lE=function(e){return"<"+aE+">"+e+"</"+aE+">"},uE=function(e){e.write(lE("")),e.close();var t=e.parentWindow.Object;return e=null,t},dE=function(){try{Xw=new ActiveXObject("htmlfile")}catch(o){}var e,t,r;dE="undefined"!=typeof document?document.domain&&Xw?uE(Xw):(t=oE("iframe"),r="java"+aE+":",t.style.display="none",nE.appendChild(t),t.src=String(r),(e=t.contentWindow.document).open(),e.write(lE("document.F=Object")),e.close(),e.F):uE(Xw);for(var n=tE.length;n--;)delete dE[iE][tE[n]];return dE()};rE[sE]=!0;var fE,pE,hE,mE=Object.create||function(e,t){var r;return null!==e?(cE[iE]=Zw(e),r=new cE,cE[iE]=null,r[sE]=e):r=dE(),void 0===t?r:eE.f(r,t)},yE=!vy(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),vE=dg,gE=Hy,bE=cg,wE=yE,EE=rb("IE_PROTO"),_E=Object,SE=_E.prototype,xE=wE?_E.getPrototypeOf:function(e){var t=bE(e);if(vE(t,EE))return t[EE];var r=t.constructor;return gE(r)&&t instanceof r?r.prototype:t instanceof _E?SE:null},NE=Zg,IE=function(e,t,r,n){return n&&n.enumerable?e[t]=r:NE(e,t,r),e},TE=vy,OE=Hy,AE=Jy,RE=mE,PE=xE,CE=IE,kE=Ng("iterator"),VE=!1;[].keys&&("next"in(hE=[].keys())?(pE=PE(PE(hE)))!==Object.prototype&&(fE=pE):VE=!0);var LE=!AE(fE)||TE(function(){var e={};return fE[kE].call(e)!==e});OE((fE=LE?{}:RE(fE))[kE])||CE(fE,kE,function(){return this});var UE={IteratorPrototype:fE,BUGGY_SAFARI_ITERATORS:VE},DE={};DE[Ng("toStringTag")]="z";var jE="[object z]"===String(DE),ME=jE,qE=Hy,BE=Ty,FE=Ng("toStringTag"),WE=Object,HE="Arguments"===BE(function(){return arguments}()),GE=ME?BE:function(e){var t,r,n;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(r=function(e,t){try{return e[t]}catch(r){}}(t=WE(e),FE))?r:HE?BE(t):"Object"===(n=BE(t))&&qE(t.callee)?"Arguments":n},$E=GE,zE=jE?{}.toString:function(){return"[object "+$E(this)+"]"},KE=jE,JE=Xy.f,YE=Zg,XE=dg,QE=zE,ZE=Ng("toStringTag"),e_=function(e,t,r,n){var o=r?e:e&&e.prototype;o&&(XE(o,ZE)||JE(o,ZE,{configurable:!0,value:t}),n&&!KE&&YE(o,"toString",QE))},t_=UE.IteratorPrototype,r_=mE,n_=Yg,o_=e_,i_=qy,a_=function(){return this},s_=function(e,t,r,n){var o=t+" Iterator";return e.prototype=r_(t_,{next:n_(+!n,r)}),o_(e,o,!1,!0),i_[o]=a_,e},c_=uw,l_=dv,u_=s_,d_=xE,f_=e_,p_=IE,h_=qy,m_=gw.PROPER,y_=UE.BUGGY_SAFARI_ITERATORS,v_=Ng("iterator"),g_="keys",b_="values",w_="entries",E_=function(){return this},__=function(e,t,r,n,o,i,a){u_(r,t,n);var s,c,l,u=function(e){if(e===o&&m)return m;if(!y_&&e&&e in p)return p[e];switch(e){case g_:case b_:case w_:return function(){return new r(this,e)}}return function(){return new r(this)}},d=t+" Iterator",f=!1,p=e.prototype,h=p[v_]||p["@@iterator"]||o&&p[o],m=!y_&&h||u(o),y="Array"===t&&p.entries||h;if(y&&(s=d_(y.call(new e)))!==Object.prototype&&s.next&&(f_(s,d,!0,!0),h_[d]=E_),m_&&o===b_&&h&&h.name!==b_&&(f=!0,m=function(){return l_(h,this)}),o)if(c={values:u(b_),keys:i?m:u(g_),entries:u(w_)},a)for(l in c)(y_||f||!(l in p))&&p_(p,l,c[l]);else c_({target:t,proto:!0,forced:y_||f},c);return a&&p[v_]!==m&&p_(p,v_,m,{}),h_[t]=m,c},S_=function(e,t){return{value:e,done:t}},x_=My,N_=qy,I_=vb;Xy.f;var T_=__,O_=S_,A_="Array Iterator",R_=I_.set,P_=I_.getterFor(A_);T_(Array,"Array",function(e,t){R_(this,{type:A_,target:x_(e),index:0,kind:t})},function(){var e=P_(this),t=e.target,r=e.index++;if(!t||r>=t.length)return e.target=null,O_(void 0,!0);switch(e.kind){case"keys":return O_(r,!1);case"values":return O_(t[r],!1)}return O_([r,t[r]],!1)},"values"),N_.Arguments=N_.Array;var C_=uw,k_=Sy,V_=Tw,L_=RangeError,U_=String.fromCharCode,D_=String.fromCodePoint,j_=k_([].join);C_({target:"String",stat:!0,forced:!!D_&&1!==D_.length},{fromCodePoint:function(e){for(var t,r=[],n=arguments.length,o=0;n>o;){if(t=+arguments[o++],V_(t,1114111)!==t)throw new L_(t+" is not a valid code point");r[o]=t<65536?U_(t):U_(55296+((t-=65536)>>10),t%1024+56320)}return j_(r,"")}});var M_=Fy,q_=Yy,B_=Object.getOwnPropertyDescriptor,F_=vy,W_=!0,H_=Ng("iterator"),G_=!F_(function(){var e=new URL("b?a=1&b=2&c=3","https://a"),t=e.searchParams,r=new URLSearchParams("a=1&a=2&b=3"),n="";return e.pathname="c%20d",t.forEach(function(e,r){t.delete("b"),n+=r+e}),r.delete("a",2),r.delete("b",void 0),!e.toJSON||!r.has("a",1)||r.has("a",2)||!r.has("a",void 0)||r.has("b")||!t.size&&W_||!t.sort||"https://a/c%20d?a=1&c=3"!==e.href||"3"!==t.get("c")||"a=1"!==String(new URLSearchParams("?a=1"))||!t[H_]||"a"!==new URL("https://a@b").username||"b"!==new URLSearchParams(new URLSearchParams("a=b")).get("a")||"xn--e1aybc"!==new URL("https://Ñ‚ĞµÑÑ‚").host||"#%D0%B1"!==new URL("https://a#Ğ±").hash||"a1c3"!==n||"x"!==new URL("https://x",void 0).host}),$_=Xy,z_=function(e,t,r){return $_.f(e,t,r)},K_=IE,J_=gv,Y_=TypeError,X_=function(e,t){if(J_(t,e))return e;throw new Y_("Incorrect invocation")},Q_=GE,Z_=String,eS=function(e){if("Symbol"===Q_(e))throw new TypeError("Cannot convert a Symbol value to a string");return Z_(e)},tS=GE,rS=Gv,nS=ky,oS=qy,iS=Ng("iterator"),aS=function(e){if(!nS(e))return rS(e,iS)||rS(e,"@@iterator")||oS[tS(e)]},sS=dv,cS=Fv,lS=cv,uS=jv,dS=aS,fS=TypeError,pS=function(e,t){var r=arguments.length<2?dS(e):t;if(cS(r))return lS(sS(r,e));throw new fS(uS(e)+" is not iterable")},hS=TypeError,mS=function(e,t){if(e<t)throw new hS("Not enough arguments");return e},yS=Sy([].slice),vS=yS,gS=Math.floor,bS=function(e,t){var r=e.length;if(r<8)for(var n,o,i=1;i<r;){for(o=i,n=e[i];o&&t(e[o-1],n)>0;)e[o]=e[--o];o!==i++&&(e[o]=n)}else for(var a=gS(r/2),s=bS(vS(e,0,a),t),c=bS(vS(e,a),t),l=s.length,u=c.length,d=0,f=0;d<l||f<u;)e[d+f]=d<l&&f<u?t(s[d],c[f])<=0?s[d++]:c[f++]:d<l?s[d++]:c[f++];return e},wS=uw,ES=Fy,_S=function(e){if(!q_)return M_[e];var t=B_(M_,e);return t&&t.value},SS=vv,xS=dv,NS=Sy,IS=Yy,TS=G_,OS=IE,AS=z_,RS=function(e,t,r){for(var n in t)r&&r.unsafe&&e[n]?e[n]=t[n]:K_(e,n,t[n],r);return e},PS=e_,CS=s_,kS=vb,VS=X_,LS=Hy,US=dg,DS=Qb,jS=GE,MS=cv,qS=Jy,BS=eS,FS=mE,WS=Yg,HS=pS,GS=aS,$S=S_,zS=mS,KS=bS,JS=Ng("iterator"),YS="URLSearchParams",XS=YS+"Iterator",QS=kS.set,ZS=kS.getterFor(YS),ex=kS.getterFor(XS),tx=_S("fetch"),rx=_S("Request"),nx=_S("Headers"),ox=rx&&rx.prototype,ix=nx&&nx.prototype,ax=ES.TypeError,sx=ES.encodeURIComponent,cx=String.fromCharCode,lx=SS("String","fromCodePoint"),ux=parseInt,dx=NS("".charAt),fx=NS([].join),px=NS([].push),hx=NS("".replace),mx=NS([].shift),yx=NS([].splice),vx=NS("".split),gx=NS("".slice),bx=NS(/./.exec),Ex=/\+/g,_x=/^[0-9a-f]+$/i,Sx=function(e,t){var r=gx(e,t,t+2);return bx(_x,r)?ux(r,16):NaN},xx=function(e){for(var t=0,r=128;r>0&&0!==(e&r);r>>=1)t++;return t},Nx=function(e){var t=null;switch(e.length){case 1:t=e[0];break;case 2:t=(31&e[0])<<6|63&e[1];break;case 3:t=(15&e[0])<<12|(63&e[1])<<6|63&e[2];break;case 4:t=(7&e[0])<<18|(63&e[1])<<12|(63&e[2])<<6|63&e[3]}return t>1114111?null:t},Ix=function(e){for(var t=(e=hx(e,Ex," ")).length,r="",n=0;n<t;){var o=dx(e,n);if("%"===o){if("%"===dx(e,n+1)||n+3>t){r+="%",n++;continue}var i=Sx(e,n+1);if(i!=i){r+=o,n++;continue}n+=2;var a=xx(i);if(0===a)o=cx(i);else{if(1===a||a>4){r+="ï¿½",n++;continue}for(var s=[i],c=1;c<a&&!(++n+3>t||"%"!==dx(e,n));){var l=Sx(e,n+1);if(l!=l){n+=3;break}if(l>191||l<128)break;px(s,l),n+=2,c++}if(s.length!==a){r+="ï¿½";continue}var u=Nx(s);null===u?r+="ï¿½":o=lx(u)}}r+=o,n++}return r},Tx=/[!'()~]|%20/g,Ox={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},Ax=function(e){return Ox[e]},Rx=function(e){return hx(sx(e),Tx,Ax)},Px=CS(function(e,t){QS(this,{type:XS,target:ZS(e).entries,index:0,kind:t})},YS,function(){var e=ex(this),t=e.target,r=e.index++;if(!t||r>=t.length)return e.target=null,$S(void 0,!0);var n=t[r];switch(e.kind){case"keys":return $S(n.key,!1);case"values":return $S(n.value,!1)}return $S([n.key,n.value],!1)},!0),Cx=function(e){this.entries=[],this.url=null,void 0!==e&&(qS(e)?this.parseObject(e):this.parseQuery("string"==typeof e?"?"===dx(e,0)?gx(e,1):e:BS(e)))};Cx.prototype={type:YS,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t,r,n,o,i,a,s,c=this.entries,l=GS(e);if(l)for(r=(t=HS(e,l)).next;!(n=xS(r,t)).done;){if(i=(o=HS(MS(n.value))).next,(a=xS(i,o)).done||(s=xS(i,o)).done||!xS(i,o).done)throw new ax("Expected sequence with length 2");px(c,{key:BS(a.value),value:BS(s.value)})}else for(var u in e)US(e,u)&&px(c,{key:u,value:BS(e[u])})},parseQuery:function(e){if(e)for(var t,r,n=this.entries,o=vx(e,"&"),i=0;i<o.length;)(t=o[i++]).length&&(r=vx(t,"="),px(n,{key:Ix(mx(r)),value:Ix(fx(r,"="))}))},serialize:function(){for(var e,t=this.entries,r=[],n=0;n<t.length;)e=t[n++],px(r,Rx(e.key)+"="+Rx(e.value));return fx(r,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var kx=function(){VS(this,Vx);var e=QS(this,new Cx(arguments.length>0?arguments[0]:void 0));IS||(this.size=e.entries.length)},Vx=kx.prototype;if(RS(Vx,{append:function(e,t){var r=ZS(this);zS(arguments.length,2),px(r.entries,{key:BS(e),value:BS(t)}),IS||this.length++,r.updateURL()},delete:function(e){for(var t=ZS(this),r=zS(arguments.length,1),n=t.entries,o=BS(e),i=r<2?void 0:arguments[1],a=void 0===i?i:BS(i),s=0;s<n.length;){var c=n[s];if(c.key!==o||void 0!==a&&c.value!==a)s++;else if(yx(n,s,1),void 0!==a)break}IS||(this.size=n.length),t.updateURL()},get:function(e){var t=ZS(this).entries;zS(arguments.length,1);for(var r=BS(e),n=0;n<t.length;n++)if(t[n].key===r)return t[n].value;return null},getAll:function(e){var t=ZS(this).entries;zS(arguments.length,1);for(var r=BS(e),n=[],o=0;o<t.length;o++)t[o].key===r&&px(n,t[o].value);return n},has:function(e){for(var t=ZS(this).entries,r=zS(arguments.length,1),n=BS(e),o=r<2?void 0:arguments[1],i=void 0===o?o:BS(o),a=0;a<t.length;){var s=t[a++];if(s.key===n&&(void 0===i||s.value===i))return!0}return!1},set:function(e,t){var r=ZS(this);zS(arguments.length,1);for(var n,o=r.entries,i=!1,a=BS(e),s=BS(t),c=0;c<o.length;c++)(n=o[c]).key===a&&(i?yx(o,c--,1):(i=!0,n.value=s));i||px(o,{key:a,value:s}),IS||(this.size=o.length),r.updateURL()},sort:function(){var e=ZS(this);KS(e.entries,function(e,t){return e.key>t.key?1:-1}),e.updateURL()},forEach:function(e){for(var t,r=ZS(this).entries,n=DS(e,arguments.length>1?arguments[1]:void 0),o=0;o<r.length;)n((t=r[o++]).value,t.key,this)},keys:function(){return new Px(this,"keys")},values:function(){return new Px(this,"values")},entries:function(){return new Px(this,"entries")}},{enumerable:!0}),OS(Vx,JS,Vx.entries,{}),OS(Vx,"toString",function(){return ZS(this).serialize()},{enumerable:!0}),IS&&AS(Vx,"size",{get:function(){return ZS(this).entries.length},configurable:!0,enumerable:!0}),PS(kx,YS),wS({global:!0,forced:!TS},{URLSearchParams:kx}),!TS&&LS(nx)){var Lx=NS(ix.has),Ux=NS(ix.set),Dx=function(e){if(qS(e)){var t,r=e.body;if(jS(r)===YS)return t=e.headers?new nx(e.headers):new nx,Lx(t,"content-type")||Ux(t,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),FS(e,{body:WS(0,BS(r)),headers:WS(0,t)})}return e};if(LS(tx)&&wS({global:!0,dontCallGetSet:!0,forced:!0},{fetch:function(e){return tx(e,arguments.length>1?Dx(arguments[1]):{})}}),LS(rx)){var jx=function(e){return VS(this,ox),new rx(e,arguments.length>1?Dx(arguments[1]):{})};ox.constructor=jx,jx.prototype=ox,wS({global:!0,dontCallGetSet:!0,forced:!0},{Request:jx})}}var Mx={URLSearchParams:kx,getState:ZS},qx=Sy,Bx=Sw,Fx=eS,Wx=Uy,Hx=qx("".charAt),Gx=qx("".charCodeAt),$x=qx("".slice),zx=function(e){return function(t,r){var n,o,i=Fx(Wx(t)),a=Bx(r),s=i.length;return a<0||a>=s?e?"":void 0:(n=Gx(i,a))<55296||n>56319||a+1===s||(o=Gx(i,a+1))<56320||o>57343?e?Hx(i,a):n:e?$x(i,a,a+2):o-56320+(n-55296<<10)+65536}},Kx={codeAt:zx(!1),charAt:zx(!0)},Jx=Kx.charAt,Yx=eS,Xx=vb,Qx=__,Zx=S_,eN="String Iterator",tN=Xx.set,rN=Xx.getterFor(eN);Qx(String,"String",function(e){tN(this,{type:eN,string:Yx(e),index:0})},function(){var e,t=rN(this),r=t.string,n=t.index;return n>=r.length?Zx(void 0,!0):(e=Jx(r,n),t.index+=e.length,Zx(e,!1))});var nN={};nN.f=Object.getOwnPropertySymbols;var oN=Yy,iN=Sy,aN=dv,sN=vy,cN=Hw,lN=nN,uN=Tb,dN=cg,fN=Cy,pN=Object.assign,hN=Object.defineProperty,mN=iN([].concat),yN=!pN||sN(function(){if(oN&&1!==pN({b:1},pN(hN({},"a",{enumerable:!0,get:function(){hN(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var e={},t={},r=Symbol("assign detection"),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(e){t[e]=e}),7!==pN({},e)[r]||cN(pN({},t)).join("")!==n})?function(e,t){for(var r=dN(e),n=arguments.length,o=1,i=lN.f,a=uN.f;n>o;)for(var s,c=fN(arguments[o++]),l=i?mN(cN(c),i(c)):cN(c),u=l.length,d=0;u>d;)s=l[d++],oN&&!aN(a,c,s)||(r[s]=c[s]);return r}:pN,vN=dv,gN=cv,bN=Gv,wN=cv,EN=function(e,t,r){var n,o;gN(e);try{if(!(n=bN(e,"return"))){if("throw"===t)throw r;return r}n=vN(n,e)}catch(i){o=!0,n=i}if("throw"===t)throw r;if(o)throw n;return gN(n),r},_N=qy,SN=Ng("iterator"),xN=Array.prototype,NN=Hy,IN=ng,TN=Sy(Function.toString);NN(IN.inspectSource)||(IN.inspectSource=function(e){return TN(e)});var ON=IN.inspectSource,AN=Sy,RN=vy,PN=Hy,CN=GE,kN=ON,VN=function(){},LN=vv("Reflect","construct"),UN=/^\s*(?:class|function)\b/,DN=AN(UN.exec),jN=!UN.test(VN),MN=function(e){if(!PN(e))return!1;try{return LN(VN,[],e),!0}catch(t){return!1}},qN=function(e){if(!PN(e))return!1;switch(CN(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return jN||!!DN(UN,kN(e))}catch(t){return!0}};qN.sham=!0;var BN,FN=!LN||RN(function(){var e;return MN(MN.call)||!MN(Object)||!MN(function(){e=!0})||e})?qN:MN,WN=Yy,HN=Xy,GN=Yg,$N=Qb,zN=dv,KN=cg,JN=function(e,t,r,n){try{return n?t(wN(r)[0],r[1]):t(r)}catch(o){EN(e,"throw",o)}},YN=function(e){return void 0!==e&&(_N.Array===e||xN[SN]===e)},XN=FN,QN=Pw,ZN=function(e,t,r){WN?HN.f(e,t,GN(0,r)):e[t]=r},eI=pS,tI=aS,rI=Array,nI=Sy,oI=2147483647,iI=/[^\0-\u007E]/,aI=/[.\u3002\uFF0E\uFF61]/g,sI="Overflow: input needs wider integers to process",cI=RangeError,lI=nI(aI.exec),uI=Math.floor,dI=String.fromCharCode,fI=nI("".charCodeAt),pI=nI([].join),hI=nI([].push),mI=nI("".replace),yI=nI("".split),vI=nI("".toLowerCase),gI=function(e){return e+22+75*(e<26)},bI=function(e,t,r){var n=0;for(e=r?uI(e/700):e>>1,e+=uI(e/t);e>455;)e=uI(e/35),n+=36;return uI(n+36*e/(e+38))},wI=function(e){var t=[];e=function(e){for(var t=[],r=0,n=e.length;r<n;){var o=fI(e,r++);if(o>=55296&&o<=56319&&r<n){var i=fI(e,r++);56320==(64512&i)?hI(t,((1023&o)<<10)+(1023&i)+65536):(hI(t,o),r--)}else hI(t,o)}return t}(e);var r,n,o=e.length,i=128,a=0,s=72;for(r=0;r<e.length;r++)(n=e[r])<128&&hI(t,dI(n));var c=t.length,l=c;for(c&&hI(t,"-");l<o;){var u=oI;for(r=0;r<e.length;r++)(n=e[r])>=i&&n<u&&(u=n);var d=l+1;if(u-i>uI((oI-a)/d))throw new cI(sI);for(a+=(u-i)*d,i=u,r=0;r<e.length;r++){if((n=e[r])<i&&++a>oI)throw new cI(sI);if(n===i){for(var f=a,p=36;;){var h=p<=s?1:p>=s+26?26:p-s;if(f<h)break;var m=f-h,y=36-h;hI(t,dI(gI(h+m%y))),f=uI(m/y),p+=36}hI(t,dI(gI(f))),s=bI(a,d,l===c),a=0,l++}}a++,i++}return pI(t,"")},EI=uw,_I=Yy,SI=G_,xI=Fy,NI=Qb,II=Sy,TI=IE,OI=z_,AI=X_,RI=dg,PI=yN,CI=function(e){var t=KN(e),r=XN(this),n=arguments.length,o=n>1?arguments[1]:void 0,i=void 0!==o;i&&(o=$N(o,n>2?arguments[2]:void 0));var a,s,c,l,u,d,f=tI(t),p=0;if(!f||this===rI&&YN(f))for(a=QN(t),s=r?new this(a):rI(a);a>p;p++)d=i?o(t[p],p):t[p],ZN(s,p,d);else for(s=r?new this:[],u=(l=eI(t,f)).next;!(c=zN(u,l)).done;p++)d=i?JN(l,o,[c.value,p],!0):c.value,ZN(s,p,d);return s.length=p,s},kI=yS,VI=Kx.codeAt,LI=function(e){var t,r,n=[],o=yI(mI(vI(e),aI,"."),".");for(t=0;t<o.length;t++)r=o[t],hI(n,lI(iI,r)?"xn--"+wI(r):r);return pI(n,".")},UI=eS,DI=e_,jI=mS,MI=Mx,qI=vb,BI=qI.set,FI=qI.getterFor("URL"),WI=MI.URLSearchParams,HI=MI.getState,GI=xI.URL,$I=xI.TypeError,zI=xI.parseInt,KI=Math.floor,JI=Math.pow,YI=II("".charAt),XI=II(/./.exec),QI=II([].join),ZI=II(1.1.toString),eT=II([].pop),tT=II([].push),rT=II("".replace),nT=II([].shift),oT=II("".split),iT=II("".slice),aT=II("".toLowerCase),sT=II([].unshift),cT="Invalid scheme",lT="Invalid host",uT="Invalid port",dT=/[a-z]/i,fT=/[\d+-.a-z]/i,pT=/\d/,hT=/^0x/i,mT=/^[0-7]+$/,yT=/^\d+$/,vT=/^[\da-f]+$/i,gT=/[\0\t\n\r #%/:<>?@[\\\]^|]/,bT=/[\0\t\n\r #/:<>?@[\\\]^|]/,wT=/^[\u0000-\u0020]+/,ET=/(^|[^\u0000-\u0020])[\u0000-\u0020]+$/,_T=/[\t\n\r]/g,ST=function(e){var t,r,n,o;if("number"==typeof e){for(t=[],r=0;r<4;r++)sT(t,e%256),e=KI(e/256);return QI(t,".")}if("object"==typeof e){for(t="",n=function(e){for(var t=null,r=1,n=null,o=0,i=0;i<8;i++)0!==e[i]?(o>r&&(t=n,r=o),n=null,o=0):(null===n&&(n=i),++o);return o>r?n:t}(e),r=0;r<8;r++)o&&0===e[r]||(o&&(o=!1),n===r?(t+=r?":":"::",o=!0):(t+=ZI(e[r],16),r<7&&(t+=":")));return"["+t+"]"}return e},xT={},NT=PI({},xT,{" ":1,'"':1,"<":1,">":1,"`":1}),IT=PI({},NT,{"#":1,"?":1,"{":1,"}":1}),TT=PI({},IT,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),OT=function(e,t){var r=VI(e,0);return r>32&&r<127&&!RI(t,e)?e:encodeURIComponent(e)},AT={ftp:21,file:null,http:80,https:443,ws:80,wss:443},RT=function(e,t){var r;return 2===e.length&&XI(dT,YI(e,0))&&(":"===(r=YI(e,1))||!t&&"|"===r)},PT=function(e){var t;return e.length>1&&RT(iT(e,0,2))&&(2===e.length||"/"===(t=YI(e,2))||"\\"===t||"?"===t||"#"===t)},CT=function(e){return"."===e||"%2e"===aT(e)},kT=function(e){return".."===(e=aT(e))||"%2e."===e||".%2e"===e||"%2e%2e"===e},VT={},LT={},UT={},DT={},jT={},MT={},qT={},BT={},FT={},WT={},HT={},GT={},$T={},zT={},KT={},JT={},YT={},XT={},QT={},ZT={},eO={},tO=function(e,t,r){var n,o,i,a=UI(e);if(t){if(o=this.parse(a))throw new $I(o);this.searchParams=null}else{if(void 0!==r&&(n=new tO(r,!0)),o=this.parse(a,null,n))throw new $I(o);(i=HI(new WI)).bindURL(this),this.searchParams=i}};tO.prototype={type:"URL",parse:function(e,t,r){var n,o,i,a,s=this,c=t||VT,l=0,u="",d=!1,f=!1,p=!1;for(e=UI(e),t||(s.scheme="",s.username="",s.password="",s.host=null,s.port=null,s.path=[],s.query=null,s.fragment=null,s.cannotBeABaseURL=!1,e=rT(e,wT,""),e=rT(e,ET,"$1")),e=rT(e,_T,""),n=CI(e);l<=n.length;){switch(o=n[l],c){case VT:if(!o||!XI(dT,o)){if(t)return cT;c=UT;continue}u+=aT(o),c=LT;break;case LT:if(o&&(XI(fT,o)||"+"===o||"-"===o||"."===o))u+=aT(o);else{if(":"!==o){if(t)return cT;u="",c=UT,l=0;continue}if(t&&(s.isSpecial()!==RI(AT,u)||"file"===u&&(s.includesCredentials()||null!==s.port)||"file"===s.scheme&&!s.host))return;if(s.scheme=u,t)return void(s.isSpecial()&&AT[s.scheme]===s.port&&(s.port=null));u="","file"===s.scheme?c=zT:s.isSpecial()&&r&&r.scheme===s.scheme?c=DT:s.isSpecial()?c=BT:"/"===n[l+1]?(c=jT,l++):(s.cannotBeABaseURL=!0,tT(s.path,""),c=QT)}break;case UT:if(!r||r.cannotBeABaseURL&&"#"!==o)return cT;if(r.cannotBeABaseURL&&"#"===o){s.scheme=r.scheme,s.path=kI(r.path),s.query=r.query,s.fragment="",s.cannotBeABaseURL=!0,c=eO;break}c="file"===r.scheme?zT:MT;continue;case DT:if("/"!==o||"/"!==n[l+1]){c=MT;continue}c=FT,l++;break;case jT:if("/"===o){c=WT;break}c=XT;continue;case MT:if(s.scheme=r.scheme,o===BN)s.username=r.username,s.password=r.password,s.host=r.host,s.port=r.port,s.path=kI(r.path),s.query=r.query;else if("/"===o||"\\"===o&&s.isSpecial())c=qT;else if("?"===o)s.username=r.username,s.password=r.password,s.host=r.host,s.port=r.port,s.path=kI(r.path),s.query="",c=ZT;else{if("#"!==o){s.username=r.username,s.password=r.password,s.host=r.host,s.port=r.port,s.path=kI(r.path),s.path.length--,c=XT;continue}s.username=r.username,s.password=r.password,s.host=r.host,s.port=r.port,s.path=kI(r.path),s.query=r.query,s.fragment="",c=eO}break;case qT:if(!s.isSpecial()||"/"!==o&&"\\"!==o){if("/"!==o){s.username=r.username,s.password=r.password,s.host=r.host,s.port=r.port,c=XT;continue}c=WT}else c=FT;break;case BT:if(c=FT,"/"!==o||"/"!==YI(u,l+1))continue;l++;break;case FT:if("/"!==o&&"\\"!==o){c=WT;continue}break;case WT:if("@"===o){d&&(u="%40"+u),d=!0,i=CI(u);for(var h=0;h<i.length;h++){var m=i[h];if(":"!==m||p){var y=OT(m,TT);p?s.password+=y:s.username+=y}else p=!0}u=""}else if(o===BN||"/"===o||"?"===o||"#"===o||"\\"===o&&s.isSpecial()){if(d&&""===u)return"Invalid authority";l-=CI(u).length+1,u="",c=HT}else u+=o;break;case HT:case GT:if(t&&"file"===s.scheme){c=JT;continue}if(":"!==o||f){if(o===BN||"/"===o||"?"===o||"#"===o||"\\"===o&&s.isSpecial()){if(s.isSpecial()&&""===u)return lT;if(t&&""===u&&(s.includesCredentials()||null!==s.port))return;if(a=s.parseHost(u))return a;if(u="",c=YT,t)return;continue}"["===o?f=!0:"]"===o&&(f=!1),u+=o}else{if(""===u)return lT;if(a=s.parseHost(u))return a;if(u="",c=$T,t===GT)return}break;case $T:if(!XI(pT,o)){if(o===BN||"/"===o||"?"===o||"#"===o||"\\"===o&&s.isSpecial()||t){if(""!==u){var v=zI(u,10);if(v>65535)return uT;s.port=s.isSpecial()&&v===AT[s.scheme]?null:v,u=""}if(t)return;c=YT;continue}return uT}u+=o;break;case zT:if(s.scheme="file","/"===o||"\\"===o)c=KT;else{if(!r||"file"!==r.scheme){c=XT;continue}switch(o){case BN:s.host=r.host,s.path=kI(r.path),s.query=r.query;break;case"?":s.host=r.host,s.path=kI(r.path),s.query="",c=ZT;break;case"#":s.host=r.host,s.path=kI(r.path),s.query=r.query,s.fragment="",c=eO;break;default:PT(QI(kI(n,l),""))||(s.host=r.host,s.path=kI(r.path),s.shortenPath()),c=XT;continue}}break;case KT:if("/"===o||"\\"===o){c=JT;break}r&&"file"===r.scheme&&!PT(QI(kI(n,l),""))&&(RT(r.path[0],!0)?tT(s.path,r.path[0]):s.host=r.host),c=XT;continue;case JT:if(o===BN||"/"===o||"\\"===o||"?"===o||"#"===o){if(!t&&RT(u))c=XT;else if(""===u){if(s.host="",t)return;c=YT}else{if(a=s.parseHost(u))return a;if("localhost"===s.host&&(s.host=""),t)return;u="",c=YT}continue}u+=o;break;case YT:if(s.isSpecial()){if(c=XT,"/"!==o&&"\\"!==o)continue}else if(t||"?"!==o)if(t||"#"!==o){if(o!==BN&&(c=XT,"/"!==o))continue}else s.fragment="",c=eO;else s.query="",c=ZT;break;case XT:if(o===BN||"/"===o||"\\"===o&&s.isSpecial()||!t&&("?"===o||"#"===o)){if(kT(u)?(s.shortenPath(),"/"===o||"\\"===o&&s.isSpecial()||tT(s.path,"")):CT(u)?"/"===o||"\\"===o&&s.isSpecial()||tT(s.path,""):("file"===s.scheme&&!s.path.length&&RT(u)&&(s.host&&(s.host=""),u=YI(u,0)+":"),tT(s.path,u)),u="","file"===s.scheme&&(o===BN||"?"===o||"#"===o))for(;s.path.length>1&&""===s.path[0];)nT(s.path);"?"===o?(s.query="",c=ZT):"#"===o&&(s.fragment="",c=eO)}else u+=OT(o,IT);break;case QT:"?"===o?(s.query="",c=ZT):"#"===o?(s.fragment="",c=eO):o!==BN&&(s.path[0]+=OT(o,xT));break;case ZT:t||"#"!==o?o!==BN&&("'"===o&&s.isSpecial()?s.query+="%27":s.query+="#"===o?"%23":OT(o,xT)):(s.fragment="",c=eO);break;case eO:o!==BN&&(s.fragment+=OT(o,NT))}l++}},parseHost:function(e){var t,r,n;if("["===YI(e,0)){if("]"!==YI(e,e.length-1))return lT;if(t=function(e){var t,r,n,o,i,a,s,c=[0,0,0,0,0,0,0,0],l=0,u=null,d=0,f=function(){return YI(e,d)};if(":"===f()){if(":"!==YI(e,1))return;d+=2,u=++l}for(;f();){if(8===l)return;if(":"!==f()){for(t=r=0;r<4&&XI(vT,f());)t=16*t+zI(f(),16),d++,r++;if("."===f()){if(0===r)return;if(d-=r,l>6)return;for(n=0;f();){if(o=null,n>0){if(!("."===f()&&n<4))return;d++}if(!XI(pT,f()))return;for(;XI(pT,f());){if(i=zI(f(),10),null===o)o=i;else{if(0===o)return;o=10*o+i}if(o>255)return;d++}c[l]=256*c[l]+o,2!==++n&&4!==n||l++}if(4!==n)return;break}if(":"===f()){if(d++,!f())return}else if(f())return;c[l++]=t}else{if(null!==u)return;d++,u=++l}}if(null!==u)for(a=l-u,l=7;0!==l&&a>0;)s=c[l],c[l--]=c[u+a-1],c[u+--a]=s;else if(8!==l)return;return c}(iT(e,1,-1)),!t)return lT;this.host=t}else if(this.isSpecial()){if(e=LI(e),XI(gT,e))return lT;if(t=function(e){var t,r,n,o,i,a,s,c=oT(e,".");if(c.length&&""===c[c.length-1]&&c.length--,(t=c.length)>4)return e;for(r=[],n=0;n<t;n++){if(""===(o=c[n]))return e;if(i=10,o.length>1&&"0"===YI(o,0)&&(i=XI(hT,o)?16:8,o=iT(o,8===i?1:2)),""===o)a=0;else{if(!XI(10===i?yT:8===i?mT:vT,o))return e;a=zI(o,i)}tT(r,a)}for(n=0;n<t;n++)if(a=r[n],n===t-1){if(a>=JI(256,5-t))return null}else if(a>255)return null;for(s=eT(r),n=0;n<r.length;n++)s+=r[n]*JI(256,3-n);return s}(e),null===t)return lT;this.host=t}else{if(XI(bT,e))return lT;for(t="",r=CI(e),n=0;n<r.length;n++)t+=OT(r[n],xT);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||"file"===this.scheme},includesCredentials:function(){return""!==this.username||""!==this.password},isSpecial:function(){return RI(AT,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;!t||"file"===this.scheme&&1===t&&RT(e[0],!0)||e.length--},serialize:function(){var e=this,t=e.scheme,r=e.username,n=e.password,o=e.host,i=e.port,a=e.path,s=e.query,c=e.fragment,l=t+":";return null!==o?(l+="//",e.includesCredentials()&&(l+=r+(n?":"+n:"")+"@"),l+=ST(o),null!==i&&(l+=":"+i)):"file"===t&&(l+="//"),l+=e.cannotBeABaseURL?a[0]:a.length?"/"+QI(a,"/"):"",null!==s&&(l+="?"+s),null!==c&&(l+="#"+c),l},setHref:function(e){var t=this.parse(e);if(t)throw new $I(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if("blob"===e)try{return new rO(e.path[0]).origin}catch(r){return"null"}return"file"!==e&&this.isSpecial()?e+"://"+ST(this.host)+(null!==t?":"+t:""):"null"},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(UI(e)+":",VT)},getUsername:function(){return this.username},setUsername:function(e){var t=CI(UI(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<t.length;r++)this.username+=OT(t[r],TT)}},getPassword:function(){return this.password},setPassword:function(e){var t=CI(UI(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<t.length;r++)this.password+=OT(t[r],TT)}},getHost:function(){var e=this.host,t=this.port;return null===e?"":null===t?ST(e):ST(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,HT)},getHostname:function(){var e=this.host;return null===e?"":ST(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,GT)},getPort:function(){var e=this.port;return null===e?"":UI(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(""===(e=UI(e))?this.port=null:this.parse(e,$T))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+QI(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,YT))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){""===(e=UI(e))?this.query=null:("?"===YI(e,0)&&(e=iT(e,1)),this.query="",this.parse(e,ZT)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){""!==(e=UI(e))?("#"===YI(e,0)&&(e=iT(e,1)),this.fragment="",this.parse(e,eO)):this.fragment=null},update:function(){this.query=this.searchParams.serialize()||null}};var rO=function(e){var t=AI(this,nO),r=jI(arguments.length,1)>1?arguments[1]:void 0,n=BI(t,new tO(e,!1,r));_I||(t.href=n.serialize(),t.origin=n.getOrigin(),t.protocol=n.getProtocol(),t.username=n.getUsername(),t.password=n.getPassword(),t.host=n.getHost(),t.hostname=n.getHostname(),t.port=n.getPort(),t.pathname=n.getPathname(),t.search=n.getSearch(),t.searchParams=n.getSearchParams(),t.hash=n.getHash())},nO=rO.prototype,oO=function(e,t){return{get:function(){return FI(this)[e]()},set:t&&function(e){return FI(this)[t](e)},configurable:!0,enumerable:!0}};if(_I&&(OI(nO,"href",oO("serialize","setHref")),OI(nO,"origin",oO("getOrigin")),OI(nO,"protocol",oO("getProtocol","setProtocol")),OI(nO,"username",oO("getUsername","setUsername")),OI(nO,"password",oO("getPassword","setPassword")),OI(nO,"host",oO("getHost","setHost")),OI(nO,"hostname",oO("getHostname","setHostname")),OI(nO,"port",oO("getPort","setPort")),OI(nO,"pathname",oO("getPathname","setPathname")),OI(nO,"search",oO("getSearch","setSearch")),OI(nO,"searchParams",oO("getSearchParams")),OI(nO,"hash",oO("getHash","setHash"))),TI(nO,"toJSON",function(){return FI(this).serialize()},{enumerable:!0}),TI(nO,"toString",function(){return FI(this).serialize()},{enumerable:!0}),GI){var iO=GI.createObjectURL,aO=GI.revokeObjectURL;iO&&TI(rO,"createObjectURL",NI(iO,GI)),aO&&TI(rO,"revokeObjectURL",NI(aO,GI))}DI(rO,"URL"),EI({global:!0,forced:!SI,sham:!_I},{URL:rO});var sO=uw,cO=vy,lO=mS,uO=eS,dO=G_,fO=vv("URL"),pO=dO&&cO(function(){fO.canParse()}),hO=cO(function(){return 1!==fO.canParse.length});sO({target:"URL",stat:!0,forced:!pO||hO},{canParse:function(e){var t=lO(arguments.length,1),r=uO(e),n=t<2||void 0===arguments[1]?void 0:uO(arguments[1]);try{return!!new fO(r,n)}catch(o){return!1}}});var mO=uw,yO=mS,vO=eS,gO=G_,bO=vv("URL");mO({target:"URL",stat:!0,forced:!gO},{parse:function(e){var t=yO(arguments.length,1),r=vO(e),n=t<2||void 0===arguments[1]?void 0:vO(arguments[1]);try{return new bO(r,n)}catch(o){return null}}});var wO=hy(fv.URL),EO=function(e){function t(t){var r=e.call(this,t.message)||this;return r.name="PostgrestError",r.details=t.details,r.hint=t.hint,r.code=t.code,r}return Jm(t,e),t}(Error),_O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Jm(t,e),t.prototype.select=function(e){var t=!1,r=(null!=e?e:"*").split("").map(function(e){return/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)}).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this},t.prototype.order=function(e,t){var r=void 0===t?{}:t,n=r.ascending,o=void 0===n||n,i=r.nullsFirst,a=r.foreignTable,s=r.referencedTable,c=void 0===s?a:s,l=c?"".concat(c,".order"):"order",u=this.url.searchParams.get(l);return this.url.searchParams.set(l,"".concat(u?"".concat(u,","):"").concat(e,".").concat(o?"asc":"desc").concat(void 0===i?"":i?".nullsfirst":".nullslast")),this},t.prototype.limit=function(e,t){var r=void 0===t?{}:t,n=r.foreignTable,o=r.referencedTable,i=void 0===o?n:o,a=void 0===i?"limit":"".concat(i,".limit");return this.url.searchParams.set(a,"".concat(e)),this},t.prototype.range=function(e,t,r){var n=void 0===r?{}:r,o=n.foreignTable,i=n.referencedTable,a=void 0===i?o:i,s=void 0===a?"offset":"".concat(a,".offset"),c=void 0===a?"limit":"".concat(a,".limit");return this.url.searchParams.set(s,"".concat(e)),this.url.searchParams.set(c,"".concat(t-e+1)),this},t.prototype.abortSignal=function(e){return this.signal=e,this},t.prototype.single=function(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this},t.prototype.maybeSingle=function(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this},t.prototype.csv=function(){return this.headers.set("Accept","text/csv"),this},t.prototype.geojson=function(){return this.headers.set("Accept","application/geo+json"),this},t.prototype.explain=function(e){var t,r=void 0===e?{}:e,n=r.analyze,o=void 0!==n&&n,i=r.verbose,a=void 0!==i&&i,s=r.settings,c=void 0!==s&&s,l=r.buffers,u=void 0!==l&&l,d=r.wal,f=void 0!==d&&d,p=r.format,h=void 0===p?"text":p,m=[o?"analyze":null,a?"verbose":null,c?"settings":null,u?"buffers":null,f?"wal":null].filter(Boolean).join("|"),y=null!==(t=this.headers.get("Accept"))&&void 0!==t?t:"application/json";return this.headers.set("Accept","application/vnd.pgrst.plan+".concat(h,'; for="').concat(y,'"; options=').concat(m,";")),this},t.prototype.rollback=function(){return this.headers.append("Prefer","tx=rollback"),this},t.prototype.returns=function(){return this},t.prototype.maxAffected=function(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer","max-affected=".concat(e)),this},t}(function(){function e(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!==(t=e.shouldThrowOnError)&&void 0!==t&&t,this.signal=e.signal,this.isMaybeSingle=null!==(r=e.isMaybeSingle)&&void 0!==r&&r,e.fetch?this.fetch=e.fetch:this.fetch=fetch}return e.prototype.throwOnError=function(){return this.shouldThrowOnError=!0,this},e.prototype.setHeader=function(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this},e.prototype.then=function(e,t){var r=this;void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");var n=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(function(e){return Xm(r,0,void 0,function(){var t,r,n,o,i,a,s,c,l,u,d,f;return Qm(this,function(p){switch(p.label){case 0:return t=null,r=null,n=null,o=e.status,i=e.statusText,e.ok?"HEAD"===this.method?[3,2]:[4,e.text()]:[3,3];case 1:""===(c=p.sent())||(r="text/csv"===this.headers.get("Accept")||this.headers.get("Accept")&&(null===(l=this.headers.get("Accept"))||void 0===l?void 0:l.includes("application/vnd.pgrst.plan+text"))?c:JSON.parse(c)),p.label=2;case 2:return a=null===(u=this.headers.get("Prefer"))||void 0===u?void 0:u.match(/count=(exact|planned|estimated)/),s=null===(d=e.headers.get("content-range"))||void 0===d?void 0:d.split("/"),a&&s&&s.length>1&&(n=parseInt(s[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(r)&&(r.length>1?(t={code:"PGRST116",details:"Results contain ".concat(r.length," rows, application/vnd.pgrst.object+json requires 1 row"),hint:null,message:"JSON object requested, multiple (or no) rows returned"},r=null,n=null,o=406,i="Not Acceptable"):r=1===r.length?r[0]:null),[3,5];case 3:return[4,e.text()];case 4:c=p.sent();try{t=JSON.parse(c),Array.isArray(t)&&404===e.status&&(r=[],t=null,o=200,i="OK")}catch(h){404===e.status&&""===c?(o=204,i="No Content"):t={message:c}}if(t&&this.isMaybeSingle&&(null===(f=null==t?void 0:t.details)||void 0===f?void 0:f.includes("0 rows"))&&(t=null,o=200,i="OK"),t&&this.shouldThrowOnError)throw new EO(t);p.label=5;case 5:return[2,{error:t,data:r,count:n,status:o,statusText:i}]}})})});return this.shouldThrowOnError||(n=n.catch(function(e){var t,r,n;return{error:{message:"".concat(null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError",": ").concat(null==e?void 0:e.message),details:"".concat(null!==(r=null==e?void 0:e.stack)&&void 0!==r?r:""),hint:"",code:"".concat(null!==(n=null==e?void 0:e.code)&&void 0!==n?n:"")},data:null,count:null,status:0,statusText:""}})),n.then(e,t)},e.prototype.returns=function(){return this},e.prototype.overrideTypes=function(){return this},e}()),SO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Jm(t,e),t.prototype.eq=function(e,t){return this.url.searchParams.append(e,"eq.".concat(t)),this},t.prototype.neq=function(e,t){return this.url.searchParams.append(e,"neq.".concat(t)),this},t.prototype.gt=function(e,t){return this.url.searchParams.append(e,"gt.".concat(t)),this},t.prototype.gte=function(e,t){return this.url.searchParams.append(e,"gte.".concat(t)),this},t.prototype.lt=function(e,t){return this.url.searchParams.append(e,"lt.".concat(t)),this},t.prototype.lte=function(e,t){return this.url.searchParams.append(e,"lte.".concat(t)),this},t.prototype.like=function(e,t){return this.url.searchParams.append(e,"like.".concat(t)),this},t.prototype.likeAllOf=function(e,t){return this.url.searchParams.append(e,"like(all).{".concat(t.join(","),"}")),this},t.prototype.likeAnyOf=function(e,t){return this.url.searchParams.append(e,"like(any).{".concat(t.join(","),"}")),this},t.prototype.ilike=function(e,t){return this.url.searchParams.append(e,"ilike.".concat(t)),this},t.prototype.ilikeAllOf=function(e,t){return this.url.searchParams.append(e,"ilike(all).{".concat(t.join(","),"}")),this},t.prototype.ilikeAnyOf=function(e,t){return this.url.searchParams.append(e,"ilike(any).{".concat(t.join(","),"}")),this},t.prototype.is=function(e,t){return this.url.searchParams.append(e,"is.".concat(t)),this},t.prototype.in=function(e,t){var r=Array.from(new Set(t)).map(function(e){return"string"==typeof e&&new RegExp("[,()]").test(e)?'"'.concat(e,'"'):"".concat(e)}).join(",");return this.url.searchParams.append(e,"in.(".concat(r,")")),this},t.prototype.contains=function(e,t){return"string"==typeof t?this.url.searchParams.append(e,"cs.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cs.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cs.".concat(JSON.stringify(t))),this},t.prototype.containedBy=function(e,t){return"string"==typeof t?this.url.searchParams.append(e,"cd.".concat(t)):Array.isArray(t)?this.url.searchParams.append(e,"cd.{".concat(t.join(","),"}")):this.url.searchParams.append(e,"cd.".concat(JSON.stringify(t))),this},t.prototype.rangeGt=function(e,t){return this.url.searchParams.append(e,"sr.".concat(t)),this},t.prototype.rangeGte=function(e,t){return this.url.searchParams.append(e,"nxl.".concat(t)),this},t.prototype.rangeLt=function(e,t){return this.url.searchParams.append(e,"sl.".concat(t)),this},t.prototype.rangeLte=function(e,t){return this.url.searchParams.append(e,"nxr.".concat(t)),this},t.prototype.rangeAdjacent=function(e,t){return this.url.searchParams.append(e,"adj.".concat(t)),this},t.prototype.overlaps=function(e,t){return"string"==typeof t?this.url.searchParams.append(e,"ov.".concat(t)):this.url.searchParams.append(e,"ov.{".concat(t.join(","),"}")),this},t.prototype.textSearch=function(e,t,r){var n=void 0===r?{}:r,o=n.config,i=n.type,a="";"plain"===i?a="pl":"phrase"===i?a="ph":"websearch"===i&&(a="w");var s=void 0===o?"":"(".concat(o,")");return this.url.searchParams.append(e,"".concat(a,"fts").concat(s,".").concat(t)),this},t.prototype.match=function(e){var t=this;return Object.entries(e).forEach(function(e){var r=e[0],n=e[1];t.url.searchParams.append(r,"eq.".concat(n))}),this},t.prototype.not=function(e,t,r){return this.url.searchParams.append(e,"not.".concat(t,".").concat(r)),this},t.prototype.or=function(e,t){var r=void 0===t?{}:t,n=r.foreignTable,o=r.referencedTable,i=void 0===o?n:o,a=i?"".concat(i,".or"):"or";return this.url.searchParams.append(a,"(".concat(e,")")),this},t.prototype.filter=function(e,t,r){return this.url.searchParams.append(e,"".concat(t,".").concat(r)),this},t}(_O),xO=function(e){function t(t,r){var n=r.headers,o=void 0===n?{}:n,i=r.fetch;return e.call(this,t,{headers:o,schema:void 0,fetch:i})||this}return Jm(t,e),t}(function(){function e(e,t){var r=t.headers,n=void 0===r?{}:r,o=t.schema,i=t.fetch;this.url=e,this.headers=new Headers(n),this.schema=o,this.fetch=i}return e.prototype.select=function(e,t){var r=void 0===t?{}:t,n=r.head,o=void 0!==n&&n,i=r.count,a=o?"HEAD":"GET",s=!1,c=(null!=e?e:"*").split("").map(function(e){return/\s/.test(e)&&!s?"":('"'===e&&(s=!s),e)}).join("");return this.url.searchParams.set("select",c),i&&this.headers.append("Prefer","count=".concat(i)),new SO({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})},e.prototype.insert=function(e,t){var r,n=void 0===t?{}:t,o=n.count,i=n.defaultToNull,a=void 0===i||i;if(o&&this.headers.append("Prefer","count=".concat(o)),a||this.headers.append("Prefer","missing=default"),Array.isArray(e)){var s=e.reduce(function(e,t){return e.concat(Object.keys(t))},[]);if(s.length>0){var c=Array.from(new Set(s)).map(function(e){return'"'.concat(e,'"')});this.url.searchParams.set("columns",c.join(","))}}return new SO({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(r=this.fetch)&&void 0!==r?r:fetch})},e.prototype.upsert=function(e,t){var r,n=void 0===t?{}:t,o=n.onConflict,i=n.ignoreDuplicates,a=void 0!==i&&i,s=n.count,c=n.defaultToNull,l=void 0===c||c;if(this.headers.append("Prefer","resolution=".concat(a?"ignore":"merge","-duplicates")),void 0!==o&&this.url.searchParams.set("on_conflict",o),s&&this.headers.append("Prefer","count=".concat(s)),l||this.headers.append("Prefer","missing=default"),Array.isArray(e)){var u=e.reduce(function(e,t){return e.concat(Object.keys(t))},[]);if(u.length>0){var d=Array.from(new Set(u)).map(function(e){return'"'.concat(e,'"')});this.url.searchParams.set("columns",d.join(","))}}return new SO({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(r=this.fetch)&&void 0!==r?r:fetch})},e.prototype.update=function(e,t){var r,n=(void 0===t?{}:t).count;return n&&this.headers.append("Prefer","count=".concat(n)),new SO({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:null!==(r=this.fetch)&&void 0!==r?r:fetch})},e.prototype.delete=function(e){var t,r=(void 0===e?{}:e).count;return r&&this.headers.append("Prefer","count=".concat(r)),new SO({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:null!==(t=this.fetch)&&void 0!==t?t:fetch})},e}()),NO=function(){function e(e,t){var r=void 0===t?{}:t,n=r.headers,o=void 0===n?{}:n,i=r.fetch;this.url=e,this.headers=new Headers(o),this.fetch=i}return e.prototype.from=function(e){var t=new wO("".concat(this.url,"/").concat(e));return new xO(t,{headers:this.headers,fetch:this.fetch})},e}();function IO(e,t){var r=null==t?void 0:t.envId,n=(null==t?void 0:t.mysqlBaseUrl)||function(e,t){var r,n,o,i,a=t||(null===(n=null===(r=null==e?void 0:e.extend)||void 0===r?void 0:r.AI)||void 0===n?void 0:n.env);"string"==typeof a&&a.trim()||(a=null===(o=null==e?void 0:e.config)||void 0===o?void 0:o.env);"string"==typeof a&&a.trim()||(a=null===(i=null==e?void 0:e.config)||void 0===i?void 0:i.envName);if("string"!=typeof a||!a.trim())throw new Error("Generating default gateway base url failed: env not found");return a=a.trim(),{model:"https://".concat(a,".api.tcloudbasegateway.com/v1/model"),sql:"https://".concat(a,".api.tcloudbasegateway.com/v1/sql"),mysql:"https://".concat(a,".api.tcloudbasegateway.com/v1/rdb/rest")}}(e,null==t?void 0:t.envId).mysql,o=null==t?void 0:t.fetch;return function(t){var i=this;return new NO(n,{fetch:o||function(n,o){return Xm(i,0,void 0,function(){var i,a,s;return Qm(this,function(c){return i=(null==t?void 0:t.instance)||"default",a=(null==t?void 0:t.database)||r,s={},(null==o?void 0:o.headers)instanceof Headers?o.headers.forEach(function(e,t){s[t]=e}):s=(null==o?void 0:o.headers)||{},[2,e.callFunction({name:"httpOverCallFunction",data:{url:n.toString(),method:(null==o?void 0:o.method)||"GET",headers:Ym(Ym({},s||{}),{"Content-Type":"application/json","X-Db-Instance":i,"Accept-Profile":a,"Content-Profile":a}),body:null==o?void 0:o.body}}).then(function(e){var t=null==e?void 0:e.result;return{ok:(null==t?void 0:t.statusCode)>=200&&(null==t?void 0:t.statusCode)<300,status:(null==t?void 0:t.statusCode)||200,statusText:(null==t?void 0:t.statusMessage)||"OK",json:function(){return Promise.resolve((null==t?void 0:t.body)||{})},text:function(){return Promise.resolve("string"==typeof(null==t?void 0:t.body)?t.body:JSON.stringify((null==t?void 0:t.body)||{}))},headers:new Headers((null==t?void 0:t.headers)||{})}})]})})}})}}var TO=function(){return TO=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},TO.apply(this,arguments)},OO=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},AO=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},RO=ce,PO="models";var CO=new WeakMap;function kO(e){return new Proxy({},{get:function(t,r){var n=e.getEndPointWithKey("GATEWAY"),o=n.BASE_URL,i=n.PROTOCOL,a=TO(TO({},e),{BASE_URL:o,PROTOCOL:i}),s=CO.get(a);return s||(s=function(e){var t=this,r=e.callFunction.bind(e),n=e.request.fetch.bind(e.request),o=e.getEndPointWithKey("GATEWAY"),i=o.BASE_URL,a=o.PROTOCOL,s="".concat(a).concat(i,"/model"),c="".concat(a).concat(i,"/sql");return ly(r,function(e){return OO(t,void 0,void 0,function(){return AO(this,function(t){switch(t.label){case 0:return[4,n(TO(TO({},e),{headers:TO({"Content-Type":"application/json"},e.headers)}))];case 1:return[4,t.sent().data];case 2:return[2,t.sent()]}})})},s,{sqlBaseUrl:c})}(e),CO.set(a,s)),s[r]}})}var VO="cloudbase_init",LO=new RO;LO.on(VO,function(e){var t=e.data;Object.assign(t,{models:kO(t)})});var UO={name:PO,namespace:PO,entity:new Proxy({},{get:function(e,t){console.warn("ã€deprecatedã€‘Accessing Cloudbase.prototype.models.".concat(t,"."))}}),injectEvents:{bus:LO,events:[VO]}};try{cloudbase.registerComponent(UO)}catch(hL){}function DO(e){try{e.registerComponent(UO)}catch(hL){console.warn(hL)}}try{window.registerModel=DO}catch(hL){}
/*! *****************************************************************************
      Copyright (c) Microsoft Corporation.
  
      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.
  
      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** */var jO=function(e,t){return(jO=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function MO(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}jO(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function qO(e){if(!e)throw new TypeError("Assertion failed")}function BO(){}function FO(e){return("object"==typeof(t=e)&&null!==t||"function"==typeof t)&&"function"==typeof e.getReader;var t}function WO(e){try{return e.getReader({mode:"byob"}).releaseLock(),!0}catch(t){return!1}}function HO(e,t){var r=(void 0===t?{}:t).type;return qO(FO(e)),qO(!1===e.locked),"bytes"===(r=GO(r))?new JO(e):new zO(e)}function GO(e){var t=String(e);if("bytes"===t)return t;if(void 0===e)return e;throw new RangeError("Invalid type is specified")}var $O=function(){function e(e){this._underlyingReader=void 0,this._readerMode=void 0,this._readableStreamController=void 0,this._pendingRead=void 0,this._underlyingStream=e,this._attachDefaultReader()}return e.prototype.start=function(e){this._readableStreamController=e},e.prototype.cancel=function(e){return qO(void 0!==this._underlyingReader),this._underlyingReader.cancel(e)},e.prototype._attachDefaultReader=function(){if("default"!==this._readerMode){this._detachReader();var e=this._underlyingStream.getReader();this._readerMode="default",this._attachReader(e)}},e.prototype._attachReader=function(e){var t=this;qO(void 0===this._underlyingReader),this._underlyingReader=e;var r=this._underlyingReader.closed;r&&r.then(function(){return t._finishPendingRead()}).then(function(){e===t._underlyingReader&&t._readableStreamController.close()},function(r){e===t._underlyingReader&&t._readableStreamController.error(r)}).catch(BO)},e.prototype._detachReader=function(){void 0!==this._underlyingReader&&(this._underlyingReader.releaseLock(),this._underlyingReader=void 0,this._readerMode=void 0)},e.prototype._pullWithDefaultReader=function(){var e=this;this._attachDefaultReader();var t=this._underlyingReader.read().then(function(t){var r=e._readableStreamController;t.done?e._tryClose():r.enqueue(t.value)});return this._setPendingRead(t),t},e.prototype._tryClose=function(){try{this._readableStreamController.close()}catch(e){}},e.prototype._setPendingRead=function(e){var t,r=this,n=function(){r._pendingRead===t&&(r._pendingRead=void 0)};this._pendingRead=t=e.then(n,n)},e.prototype._finishPendingRead=function(){var e=this;if(this._pendingRead){var t=function(){return e._finishPendingRead()};return this._pendingRead.then(t,t)}},e}(),zO=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return MO(t,e),t.prototype.pull=function(){return this._pullWithDefaultReader()},t}($O);function KO(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}var JO=function(e){function t(t){var r=this,n=WO(t);return(r=e.call(this,t)||this)._supportsByob=n,r}return MO(t,e),Object.defineProperty(t.prototype,"type",{get:function(){return"bytes"},enumerable:!1,configurable:!0}),t.prototype._attachByobReader=function(){if("byob"!==this._readerMode){qO(this._supportsByob),this._detachReader();var e=this._underlyingStream.getReader({mode:"byob"});this._readerMode="byob",this._attachReader(e)}},t.prototype.pull=function(){if(this._supportsByob){var e=this._readableStreamController.byobRequest;if(e)return this._pullWithByobRequest(e)}return this._pullWithDefaultReader()},t.prototype._pullWithByobRequest=function(e){var t=this;this._attachByobReader();var r=new Uint8Array(e.view.byteLength),n=this._underlyingReader.read(r).then(function(r){var n,o,i;t._readableStreamController,r.done?(t._tryClose(),e.respond(0)):(n=r.value,o=e.view,i=KO(n),KO(o).set(i,0),e.respond(r.value.byteLength))});return this._setPendingRead(n),n},t}($O);var YO=[239,187,191];var XO={exports:{}};XO.exports=function(){var e=void 0!==xi?xi:self;if(void 0!==e.TextEncoder&&void 0!==e.TextDecoder)return{TextEncoder:e.TextEncoder,TextDecoder:e.TextDecoder};var t=["utf8","utf-8","unicode-1-1-utf-8"];return{TextEncoder:function(e){if(t.indexOf(e)<0&&null!=e)throw new RangeError("Invalid encoding type. Only utf-8 is supported");this.encoding="utf-8",this.encode=function(e){if("string"!=typeof e)throw new TypeError("passed argument must be of type string");var t=unescape(encodeURIComponent(e)),r=new Uint8Array(t.length);return t.split("").forEach(function(e,t){r[t]=e.charCodeAt(0)}),r}},TextDecoder:function(e,r){if(t.indexOf(e)<0&&null!=e)throw new RangeError("Invalid encoding type. Only utf-8 is supported");if(this.encoding="utf-8",this.ignoreBOM=!1,this.fatal=void 0!==r&&"fatal"in r&&r.fatal,"boolean"!=typeof this.fatal)throw new TypeError("fatal flag must be boolean");this.decode=function(e,t){if(void 0===e)return"";if("boolean"!=typeof(void 0!==t&&"stream"in t&&t.stream))throw new TypeError("stream option must be boolean");if(ArrayBuffer.isView(e)){var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=new Array(r.length);return r.forEach(function(e,t){n[t]=String.fromCharCode(e)}),decodeURIComponent(escape(n.join("")))}throw new TypeError("passed argument must be an array buffer view")}}}}();var QO=XO.exports,ZO=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},eA=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},tA=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,o){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,o,(t=e[r](t)).done,t.value)})}}},rA=uo,nA=function(){var e;return new rA({start:function(t){e=function(e){var t,r,n,o,i,a,s;return c(),{feed:function(e){r=r?r+e:e,t&&function(e){return YO.every(function(t,r){return e.charCodeAt(r)===t})}(r)&&(r=r.slice(YO.length)),t=!1;for(var i=r.length,a=0,s=!1;a<i;){s&&("\n"===r[a]&&(a+=1),s=!1);for(var c=-1,u=o,d=void 0,f=n;c<0&&f<i;f++)":"===(d=r[f])&&u<0?u=f-a:"\r"===d?(s=!0,c=f-a):"\n"===d&&(c=f-a);if(c<0){n=i-a,o=u;break}n=0,o=-1,l(r,a,u,c),a+=c+1}a===i?r="":a>0&&(r=r.slice(a))},reset:c};function c(){t=!0,r="",n=0,o=-1,i=void 0,a=void 0,s=""}function l(t,r,n,o){if(0===o)return s.length>0&&(e({type:"event",id:i,event:a||void 0,data:s.slice(0,-1)}),s="",i=void 0),void(a=void 0);var c=n<0,l=t.slice(r,r+(c?o:n)),u=0,d=r+(u=c?o:" "===t[r+n+1]?n+2:n+1),f=o-u,p=t.slice(d,d+f).toString();if("data"===l)s+=p?"".concat(p,"\n"):"\n";else if("event"===l)a=p;else if("id"!==l||p.includes("\0")){if("retry"===l){var h=parseInt(p,10);Number.isNaN(h)||e({type:"reconnect-interval",value:h})}}else i=p}}(function(e){"event"===e.type&&t.enqueue(e)})},transform:function(t){e.feed(t)}})},oA=function(e){qO(function(e){return!!function(e){if("function"!=typeof e)return!1;var t=!1;try{new e({start:function(){t=!0}})}catch(hL){}return t}(e)&&!!FO(new e)}(e));var t=function(e){try{return new e({type:"bytes"}),!0}catch(t){return!1}}(e);return function(r,n){var o=(void 0===n?{}:n).type;if("bytes"!==(o=GO(o))||t||(o=void 0),r.constructor===e&&("bytes"!==o||WO(r)))return r;if("bytes"===o){var i=HO(r,{type:o});return new e(i)}i=HO(r);return new e(i)}}(Yn),iA=function(){function e(e,t){void 0===e&&(e="utf-8"),void 0===t&&(t={});var r=this;this.transform=new rA({transform:function(e,t){var n=r.handle.decode(new Uint8Array(e),{stream:!0});n&&t.enqueue(n)},flush:function(e){var t=r.handle.decode();t&&e.enqueue(t),e.terminate()}}),this.handle=new QO.TextDecoder(e,t)}return Object.defineProperty(e.prototype,"encoding",{get:function(){return this.handle.encoding},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fatal",{get:function(){return this.handle.fatal},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ignoreBOM",{get:function(){return this.handle.ignoreBOM},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"readable",{get:function(){return this.transform.readable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"writable",{get:function(){return this.transform.writable},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,Symbol.toStringTag,{get:function(){return"TextDecoderStream"},enumerable:!1,configurable:!0}),e}();function aA(e){var t=e;return t[Symbol.asyncIterator]=function(){var t=e.getReader();return{next:function(){return ZO(this,void 0,void 0,function(){var e,r,n;return eA(this,function(o){switch(o.label){case 0:return[4,t.read()];case 1:return e=o.sent(),r=e.done,n=e.value,[2,r?{done:!0,value:void 0}:{done:!1,value:n}]}})})}}},t}function sA(e){return aA(e.pipeThrough(new iA).pipeThrough(nA()).pipeThrough(new rA({transform:function(e,t){try{var r=JSON.parse(e.data);t.enqueue(r)}catch(hL){"[DONE]"!==e.data?console.warn("Error when transforming event source data to json",hL,e):t.terminate()}}})))}function cA(e){var t,r,n,o;return ZO(this,void 0,void 0,function(){var i,a,s,c,l,u;return eA(this,function(d){switch(d.label){case 0:i=function(e){return aA(oA(e).pipeThrough(new iA))}(e),a="",d.label=1;case 1:d.trys.push([1,6,7,12]),s=!0,c=tA(i),d.label=2;case 2:return[4,c.next()];case 3:if(l=d.sent(),t=l.done)return[3,5];o=l.value,s=!1;try{a+=o}finally{s=!0}d.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return u=d.sent(),r={error:u},[3,12];case 7:return d.trys.push([7,,10,11]),s||t||!(n=c.return)?[3,9]:[4,n.call(c)];case 8:d.sent(),d.label=9;case 9:return[3,11];case 10:if(r)throw r.error;return[7];case 11:return[7];case 12:return[2,JSON.parse(a)]}})})}function lA(){var e,t;return{promise:new Promise(function(r,n){e=r,t=n}),res:e,rej:t}}function uA(e){var t;return"assistant"===e.role&&"tool_calls"in e&&null!=(null===(t=e.tool_calls)||void 0===t?void 0:t[0])}var dA=function(){return dA=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},dA.apply(this,arguments)},fA=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},pA=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},hA=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r},mA=function(){function e(e,t){this.baseUrl=t;var r=arguments[2];this.req="string"==typeof r?function(t){var n=t.headers,o=void 0===n?{}:n,i=hA(t,["headers"]);return e(dA(dA({},i),{headers:dA(dA({},o),{Authorization:"Bearer ".concat(r)})}))}:e}return e.prototype.list=function(e,t){return this.req({method:"get",url:this.join("bots"),data:e,timeout:null==t?void 0:t.timeout})},e.prototype.create=function(e,t){var r=e.botInfo;return this.req({method:"post",url:this.join("bots"),data:r,timeout:null==t?void 0:t.timeout})},e.prototype.get=function(e,t){var r=e.botId;return this.req({method:"get",url:this.join("bots/".concat(r)),timeout:null==t?void 0:t.timeout})},e.prototype.update=function(e,t){var r=e.botId,n=e.botInfo;return this.req({method:"PATCH",url:this.join("bots/".concat(r)),data:n,timeout:null==t?void 0:t.timeout})},e.prototype.delete=function(e,t){var r=e.botId;return this.req({method:"delete",url:this.join("bots/".concat(r)),timeout:null==t?void 0:t.timeout})},e.prototype.getChatRecords=function(e,t){return this.req({method:"get",url:this.join("bots/".concat(e.botId,"/records")),data:e,timeout:null==t?void 0:t.timeout})},e.prototype.sendFeedback=function(e,t){var r=e.userFeedback;return this.req({method:"post",url:this.join("bots/".concat(r.botId,"/feedback")),data:r,timeout:null==t?void 0:t.timeout})},e.prototype.getFeedback=function(e,t){return this.req({method:"get",url:this.join("bots/".concat(e.botId,"/feedback")),data:e,timeout:null==t?void 0:t.timeout})},e.prototype.uploadFiles=function(e,t){return fA(this,void 0,void 0,function(){return pA(this,function(r){return[2,this.req({method:"post",url:this.join("bots/".concat(e.botId,"/files")),data:e,timeout:null==t?void 0:t.timeout})]})})},e.prototype.createConversation=function(e,t){var r=e.botId,n=hA(e,["botId"]);return fA(this,void 0,void 0,function(){return pA(this,function(e){return[2,this.req({method:"post",url:this.join("bots/".concat(r,"/conversation")),data:n,timeout:null==t?void 0:t.timeout})]})})},e.prototype.getConversation=function(e,t){var r=e.pageSize,n=void 0===r?10:r,o=e.pageNumber,i=void 0===o?1:o,a=e.botId,s=hA(e,["pageSize","pageNumber","botId"]);return fA(this,void 0,void 0,function(){var e,r;return pA(this,function(o){if(i<1)throw new Error("pageNumber must be greater than 0");return e=n*(i-1),r=n,[2,this.req({method:"get",url:this.join("bots/".concat(a,"/conversation")),data:dA(dA({},s),{offset:e,limit:r}),timeout:null==t?void 0:t.timeout})]})})},e.prototype.deleteConversation=function(e,t){var r=e.botId,n=e.conversationId,o=hA(e,["botId","conversationId"]);return fA(this,void 0,void 0,function(){return pA(this,function(e){return[2,this.req({method:"delete",url:this.join("bots/".concat(r,"/conversation/").concat(n)),data:o,timeout:null==t?void 0:t.timeout})]})})},e.prototype.speechToText=function(e,t){return fA(this,void 0,void 0,function(){return pA(this,function(r){return[2,this.req({method:"post",url:this.join("bots/".concat(e.botId,"/speech-to-text")),data:e,timeout:null==t?void 0:t.timeout})]})})},e.prototype.textToSpeech=function(e,t){return fA(this,void 0,void 0,function(){return pA(this,function(r){return[2,this.req({method:"post",url:this.join("bots/".concat(e.botId,"/text-to-speech")),data:e,timeout:null==t?void 0:t.timeout})]})})},e.prototype.getTextToSpeechResult=function(e,t){return fA(this,void 0,void 0,function(){return pA(this,function(r){return[2,this.req({method:"get",url:this.join("bots/".concat(e.botId,"/text-to-speech")),data:e,timeout:null==t?void 0:t.timeout})]})})},e.prototype.getRecommendQuestions=function(e,t){return fA(this,void 0,void 0,function(){var r;return pA(this,function(n){switch(n.label){case 0:return[4,this.req({method:"post",url:this.join("bots/".concat(e.botId,"/recommend-questions")),data:e,stream:!0,timeout:null==t?void 0:t.timeout})];case 1:return r=n.sent(),[2,new yA(r)]}})})},e.prototype.generateBot=function(e,t){return fA(this,void 0,void 0,function(){var r;return pA(this,function(n){switch(n.label){case 0:return[4,this.req({method:"post",url:this.join("generate-bot"),data:e,stream:!0,timeout:null==t?void 0:t.timeout})];case 1:return r=n.sent(),[2,new yA(r)]}})})},e.prototype.getPreview=function(e,t){return fA(this,void 0,void 0,function(){var r;return pA(this,function(n){switch(n.label){case 0:return[4,this.req({method:"post",url:this.join("preview"),data:e,stream:!0,timeout:null==t?void 0:t.timeout})];case 1:return r=n.sent(),[2,new yA(r)]}})})},e.prototype.generateImage=function(e,t){return this.req({method:"post",url:this.join("generate-image"),data:e,timeout:null==t?void 0:t.timeout})},e.prototype.sendMessage=function(e,t){return fA(this,void 0,void 0,function(){var r;return pA(this,function(n){switch(n.label){case 0:return[4,this.req({method:"post",url:this.join("bots/".concat(e.botId,"/send-message")),data:e,stream:!0,timeout:null==t?void 0:t.timeout})];case 1:return r=n.sent(),[2,new yA(r)]}})})},e.prototype.join=function(e){return"".concat(this.baseUrl,"/").concat(e)},e}(),yA=function(){function e(e){var t=oA(e);this._eventSourceStream=t.pipeThrough(new iA).pipeThrough(nA())}return Object.defineProperty(e.prototype,"teeedStream",{get:function(){var e=this._eventSourceStream.tee(),t=e[0],r=e[1];return this._eventSourceStream=r,t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"eventSourceStream",{get:function(){return aA(this.teeedStream)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataStream",{get:function(){return aA(this.eventSourceStream.pipeThrough(new rA({transform:function(e,t){try{var r=JSON.parse(e.data);t.enqueue(r)}catch(hL){"[DONE]"!==e.data?console.warn("Error when transforming event source data to json",hL,e):t.terminate()}}})))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"textStream",{get:function(){return aA(this.dataStream.pipeThrough(new rA({transform:function(e,t){var r;t.enqueue(null!==(r=null==e?void 0:e.content)&&void 0!==r?r:"")}})))},enumerable:!1,configurable:!0}),e}(),vA=function(){return vA=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},vA.apply(this,arguments)},gA=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},bA=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};function wA(e){var t=e.messages,r=e.model,n=e.temperature,o=e.tool_choice,i=e.tools,a=e.top_p;return vA(vA({},e),{messages:t,model:r,temperature:n,tool_choice:(o&&"auto"!==o&&console.warn("`tool_choice` is not 'auto'"),o),tools:i,top_p:a})}var EA=function(){function e(e,t,r){this.req=e,this.baseUrl=t,this.subUrl="zhipu/api/paas/v4/chat/completions",null!=r&&(this.subUrl=r)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(e,t){return gA(this,void 0,void 0,function(){var r,n;return bA(this,function(o){switch(o.label){case 0:return r=wA(e),[4,this.req({url:this.url,data:vA(vA({},r),{stream:!1}),stream:!1,timeout:null==t?void 0:t.timeout})];case 1:return n=o.sent(),[2,vA(vA({},n),{rawResponse:n})]}})})},e.prototype.doStream=function(e,t){return gA(this,void 0,void 0,function(){var r,n,o,i,a;return bA(this,function(s){switch(s.label){case 0:return r=wA(e),n=null,[4,this.req({url:this.url,data:vA(vA({},r),{stream:!0}),stream:!0,timeout:null==t?void 0:t.timeout})];case 1:return o=s.sent(),i=oA(o),a=sA(i),[2,aA(a.pipeThrough(new rA({transform:function(e,t){var r=e.choices.map(function(e){var t=e.delta;return null==n&&(n=uA(t)),n?vA(vA({},e),{finish_reason:"tool_calls",delta:t}):e}),o=vA(vA({},e),{choices:r});t.enqueue(vA(vA({},o),{rawResponse:e}))}})))]}})})},e}(),_A=function(){return _A=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},_A.apply(this,arguments)};function SA(e){var t=e.messages,r=e.model,n=e.temperature,o=e.tool_choice,i=e.tools,a=e.top_p;return _A(_A({},e),{messages:(t.forEach(function(e){"tool_calls"in e&&e.tool_calls.filter(function(e){return"function"!==e.type}).forEach(function(t){return console.warn("`type` in tool_call is not 'function'",t,e)})}),t),model:r,tools:function(){if(i)return i.forEach(function(e){"function"!==e.type&&console.warn("`type` in tool is not 'function'",e)}),i}(),top_p:a,tool_choice:o,temperature:n})}function xA(e){return"object"!=typeof e||null==e?e:Array.isArray(e)?e.map(function(e){return xA(e)}):Object.entries(e).reduce(function(e,t){var r,n=t[0],o=t[1];return e["_"===(r=n.replace(/[A-Z]/g,function(e){return"_".concat(e.toLowerCase())})).charAt(0)?r.slice(1):r]="object"==typeof o?xA(o):o,e},{})}var NA=function(){return NA=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},NA.apply(this,arguments)},IA=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},TA=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},OA=function(){function e(e,t,r){this.req=e,this.baseUrl=t,this.subUrl="hunyuan-beta/openapi/v1/chat/completions",null!=r&&(this.subUrl=r)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(e,t){return IA(this,void 0,void 0,function(){var r;return TA(this,function(n){switch(n.label){case 0:return[4,this.req({url:this.url,data:NA(NA({},SA(e)),{stream:!1}),stream:!1,timeout:null==t?void 0:t.timeout})];case 1:return r=n.sent(),[2,NA(NA({},r),{rawResponse:r})]}})})},e.prototype.doStream=function(e,t){return IA(this,void 0,void 0,function(){var r,n,o,i;return TA(this,function(a){switch(a.label){case 0:return r=null,[4,this.req({url:this.url,data:NA(NA({},SA(e)),{stream:!0}),stream:!0,timeout:null==t?void 0:t.timeout})];case 1:return n=a.sent(),o=oA(n),i=sA(o),[2,aA(i.pipeThrough(new rA({transform:function(e,t){var n=e.choices.map(function(e){var t=e.delta;return null==r&&(r=uA(t)),r?NA(NA({},e),{finish_reason:"tool_calls",delta:t}):e}),o=NA(NA({},e),{choices:n});t.enqueue(NA(NA({},o),{rawResponse:e}))}})))]}})})},e}(),AA=function(){return AA=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},AA.apply(this,arguments)},RA=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},PA=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},CA=function(){function e(e,t,r){this.req=e,this.baseUrl=t,this.subUrl="hunyuan",null!=r&&(this.subUrl=r)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(e,t){return RA(this,void 0,void 0,function(){var r,n;return PA(this,function(o){switch(o.label){case 0:return[4,this.req({url:this.url,headers:{"X-Tc-Action":"ChatCompletions"},data:AA(AA({},SA(e)),{stream:!1}),stream:!1,timeout:null==t?void 0:t.timeout})];case 1:return r=o.sent(),n=xA(r.Response),[2,AA(AA({},n),{rawResponse:r})]}})})},e.prototype.doStream=function(e,t){return RA(this,void 0,void 0,function(){var r,n,o,i;return PA(this,function(a){switch(a.label){case 0:return r=null,[4,this.req({url:this.url,headers:{"X-Tc-Action":"ChatCompletions"},data:AA(AA({},e),{stream:!0}),stream:!0,timeout:null==t?void 0:t.timeout})];case 1:return n=a.sent(),o=oA(n),i=sA(o),[2,aA(i.pipeThrough(new rA({transform:function(e,t){var n=xA(e),o=n.choices.map(function(e){var t=e.delta;return null==r&&(r=uA(t)),r?AA(AA({},e),{finish_reason:"tool_calls",delta:t}):e}),i=AA(AA({},n),{choices:o});t.enqueue(AA(AA({},i),{rawResponse:e}))}})))]}})})},e}(),kA=function(){return kA=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},kA.apply(this,arguments)},VA=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},LA=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};function UA(e){var t=e.messages,r=e.model,n=e.temperature,o=e.tools,i=e.top_p;return kA(kA({},e),{messages:t,model:r,tools:o,top_p:i,temperature:n})}var DA=function(){function e(e,t,r){this.req=e,this.baseUrl=t,this.subUrl="ark/api/v3/chat/completions",null!=r&&(this.subUrl=r)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(e,t){return VA(this,void 0,void 0,function(){var r;return LA(this,function(n){switch(n.label){case 0:return[4,this.req({url:this.url,data:kA(kA({},UA(e)),{stream:!1}),stream:!1,timeout:null==t?void 0:t.timeout})];case 1:return r=n.sent(),[2,kA(kA({},r),{rawResponse:r})]}})})},e.prototype.doStream=function(e,t){return VA(this,void 0,void 0,function(){var r,n,o,i;return LA(this,function(a){switch(a.label){case 0:return r=null,[4,this.req({url:this.url,data:kA(kA({},UA(e)),{stream:!0}),stream:!0,timeout:null==t?void 0:t.timeout})];case 1:return n=a.sent(),o=oA(n),i=sA(o),[2,aA(i.pipeThrough(new rA({transform:function(e,t){var n=e.choices.map(function(e){var t=e.delta;return null==r&&(r=uA(t)),r?kA(kA({},e),{finish_reason:"tool_calls",delta:t}):e}),o=kA(kA({},e),{choices:n});t.enqueue(kA(kA({},o),{rawResponse:e}))}})))]}})})},e}(),jA=function(){return jA=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},jA.apply(this,arguments)},MA=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},qA=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};function BA(e){var t=e.messages,r=e.model,n=e.temperature,o=e.tools,i=e.top_p;return jA(jA({},e),{messages:t,model:r,tools:o,top_p:i,temperature:n})}var FA=function(){function e(e,t,r){this.req=e,this.baseUrl=t,this.subUrl="dashscope/compatible-mode/v1/chat/completions",null!=r&&(this.subUrl=r)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(e,t){return MA(this,void 0,void 0,function(){var r;return qA(this,function(n){switch(n.label){case 0:return[4,this.req({url:this.url,data:jA(jA({},BA(e)),{stream:!1}),stream:!1,timeout:null==t?void 0:t.timeout})];case 1:return r=n.sent(),[2,jA(jA({},r),{rawResponse:r})]}})})},e.prototype.doStream=function(e,t){return MA(this,void 0,void 0,function(){var r,n,o,i;return qA(this,function(a){switch(a.label){case 0:return r=null,[4,this.req({url:this.url,data:jA(jA({},BA(e)),{stream:!0}),stream:!0,timeout:null==t?void 0:t.timeout})];case 1:return n=a.sent(),o=oA(n),i=sA(o),[2,aA(i.pipeThrough(new rA({transform:function(e,t){var n=e.choices.map(function(e){var t=Object.assign(e.delta,{role:"assistant"});return null==r&&(r=uA(t)),jA(jA({},e),r?{finish_reason:"tool_calls",delta:t}:{delta:t})}),o=jA(jA({},e),{choices:n});t.enqueue(jA(jA({},o),{rawResponse:e}))}})))]}})})},e}(),WA=function(){return WA=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},WA.apply(this,arguments)},HA=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},GA=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};function $A(e){var t=e.messages,r=e.model,n=e.temperature,o=e.tools,i=e.top_p;return WA(WA({},e),{messages:t,model:r,tools:o,top_p:i,temperature:n})}var zA=function(){function e(e,t,r){this.req=e,this.baseUrl=t,this.subUrl="01-ai/v1/chat/completions",null!=r&&(this.subUrl=r)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(e,t){return HA(this,void 0,void 0,function(){var r;return GA(this,function(n){switch(n.label){case 0:return[4,this.req({url:this.url,data:WA(WA({},$A(e)),{stream:!1}),stream:!1,timeout:null==t?void 0:t.timeout})];case 1:return r=n.sent(),[2,WA(WA({},r),{rawResponse:r})]}})})},e.prototype.doStream=function(e,t){return HA(this,void 0,void 0,function(){var r,n,o,i;return GA(this,function(a){switch(a.label){case 0:return r=null,[4,this.req({url:this.url,data:WA(WA({},$A(e)),{stream:!0}),stream:!0,timeout:null==t?void 0:t.timeout})];case 1:return n=a.sent(),o=oA(n),i=sA(o),[2,aA(i.pipeThrough(new rA({transform:function(e,t){var n,o,i,a,s,c;if((null===(i=null===(o=null===(n=null==e?void 0:e.choices)||void 0===n?void 0:n[0])||void 0===o?void 0:o.delta)||void 0===i?void 0:i.content)||(null===(c=null===(s=null===(a=null==e?void 0:e.choices)||void 0===a?void 0:a[0])||void 0===s?void 0:s.delta)||void 0===c?void 0:c.tool_calls)){var l=e.choices.map(function(e){var t=Object.assign(e.delta,{role:"assistant"});return null==r&&(r=uA(t)),WA(WA({},e),r?{finish_reason:"tool_calls",delta:t}:{delta:t})}),u=WA(WA({},e),{choices:l});t.enqueue(WA(WA({},u),{rawResponse:e}))}}})))]}})})},e}(),KA=function(){return KA=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},KA.apply(this,arguments)},JA=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},YA=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};function XA(e){var t=e.messages,r=e.model,n=e.temperature,o=e.tools,i=e.top_p;return KA(KA({},e),{messages:t,model:r,tools:o,top_p:i,temperature:n})}var QA=function(){function e(e,t,r){this.req=e,this.baseUrl=t,this.subUrl="moonshot/v1/chat/completions",null!=r&&(this.subUrl=r)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(e,t){return JA(this,void 0,void 0,function(){var r;return YA(this,function(n){switch(n.label){case 0:return[4,this.req({url:this.url,data:KA(KA({},XA(e)),{stream:!1}),stream:!1,timeout:null==t?void 0:t.timeout})];case 1:return r=n.sent(),[2,KA(KA({},r),{rawResponse:r})]}})})},e.prototype.doStream=function(e,t){return JA(this,void 0,void 0,function(){var r,n,o,i;return YA(this,function(a){switch(a.label){case 0:return r=null,[4,this.req({url:this.url,data:KA(KA({},XA(e)),{stream:!0}),stream:!0,timeout:null==t?void 0:t.timeout})];case 1:return n=a.sent(),o=oA(n),i=sA(o),[2,aA(i.pipeThrough(new rA({transform:function(e,t){var n=e.choices.map(function(e){var t=e.delta;return null==r&&(r=uA(t)),r?KA(KA({},e),{finish_reason:"tool_calls",delta:t}):e}),o=KA(KA({},e),{choices:n});t.enqueue(KA(KA({},o),{rawResponse:e}))}})))]}})})},e}(),ZA=function(){return ZA=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},ZA.apply(this,arguments)},eR=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},tR=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},rR=function(){function e(e,t,r){this.req=e,this.baseUrl=t,this.subUrl="hunyuan-exp/chat/completions",null!=r&&(this.subUrl=r)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(e){return eR(this,void 0,void 0,function(){var t;return tR(this,function(r){switch(r.label){case 0:return[4,this.req({url:this.url,data:ZA(ZA({},SA(e)),{stream:!1}),stream:!1})];case 1:return t=r.sent(),[2,ZA(ZA({},t),{rawResponse:t})]}})})},e.prototype.doStream=function(e){return eR(this,void 0,void 0,function(){var t,r,n,o;return tR(this,function(i){switch(i.label){case 0:return t=null,[4,this.req({url:this.url,data:ZA(ZA({},SA(e)),{stream:!0}),stream:!0})];case 1:return r=i.sent(),n=oA(r),o=sA(n),[2,aA(o.pipeThrough(new rA({transform:function(e,r){var n=e.choices.map(function(e){var r=e.delta;return null==t&&(t=uA(r)),t?ZA(ZA({},e),{finish_reason:"tool_calls",delta:r}):e}),o=ZA(ZA({},e),{choices:n});r.enqueue(ZA(ZA({},o),{rawResponse:e}))}})))]}})})},e}(),nR=function(){return nR=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},nR.apply(this,arguments)},oR=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},iR=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},aR=function(){function e(e,t,r){this.req=e,this.baseUrl=t,this.subUrl="hunyuan-open/v1/chat/completions",null!=r&&(this.subUrl=r)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(e,t){return oR(this,void 0,void 0,function(){var r;return iR(this,function(n){switch(n.label){case 0:return[4,this.req({url:this.url,data:nR(nR({},SA(e)),{stream:!1}),stream:!1,timeout:null==t?void 0:t.timeout})];case 1:return r=n.sent(),[2,nR(nR({},r),{rawResponse:r})]}})})},e.prototype.doStream=function(e,t){return oR(this,void 0,void 0,function(){var r,n,o,i;return iR(this,function(a){switch(a.label){case 0:return r=null,[4,this.req({url:this.url,data:nR(nR({},SA(e)),{stream:!0}),stream:!0,timeout:null==t?void 0:t.timeout})];case 1:return n=a.sent(),o=oA(n),i=sA(o),[2,aA(i.pipeThrough(new rA({transform:function(e,t){var n=e.choices.map(function(e){var t=e.delta;return null==r&&(r=uA(t)),r?nR(nR({},e),{finish_reason:"tool_calls",delta:t}):e}),o=nR(nR({},e),{choices:n});t.enqueue(nR(nR({},o),{rawResponse:e}))}})))]}})})},e}(),sR=function(){return sR=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},sR.apply(this,arguments)},cR=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},lR=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},uR=function(){function e(e,t,r){this.req=e,this.baseUrl=t,this.subUrl="deepseek/chat/completions",null!=r&&(this.subUrl=r)}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(e,t){return cR(this,void 0,void 0,function(){var r;return lR(this,function(n){switch(n.label){case 0:return[4,this.req({url:this.url,data:sR(sR({},e),{stream:!1}),stream:!1,timeout:null==t?void 0:t.timeout})];case 1:return r=n.sent(),[2,sR(sR({},r),{rawResponse:r})]}})})},e.prototype.doStream=function(e,t){return cR(this,void 0,void 0,function(){var r,n,o,i;return lR(this,function(a){switch(a.label){case 0:return r=null,[4,this.req({url:this.url,data:sR(sR({},e),{stream:!0}),stream:!0,timeout:null==t?void 0:t.timeout})];case 1:return n=a.sent(),o=oA(n),i=sA(o),[2,aA(i.pipeThrough(new rA({transform:function(e,t){var n=e.choices.map(function(e){var t=e.delta;return null==r&&(r=uA(t)),r?sR(sR({},e),{finish_reason:"tool_calls",delta:t}):e}),o=sR(sR({},e),{choices:n});t.enqueue(sR(sR({},o),{rawResponse:e}))}})))]}})})},e}(),dR=function(){return dR=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},dR.apply(this,arguments)},fR=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},pR=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},hR=function(){function e(e,t,r){void 0===r&&(r=""),this.req=e,this.baseUrl=t,this.subUrl=r}return Object.defineProperty(e.prototype,"url",{get:function(){return"".concat(this.baseUrl,"/").concat(this.subUrl)},enumerable:!1,configurable:!0}),e.prototype.doGenerate=function(e){return fR(this,void 0,void 0,function(){var t;return pR(this,function(r){switch(r.label){case 0:return[4,this.req({url:this.url,data:dR(dR({},e),{stream:!1}),stream:!1})];case 1:return t=r.sent(),[2,dR(dR({},t),{rawResponse:t})]}})})},e.prototype.doStream=function(e){return fR(this,void 0,void 0,function(){var t,r,n,o;return pR(this,function(i){switch(i.label){case 0:return t=null,[4,this.req({url:this.url,data:dR(dR({},e),{stream:!0}),stream:!0})];case 1:return r=i.sent(),n=oA(r),o=sA(n),[2,aA(o.pipeThrough(new rA({transform:function(e,r){var n=e.choices.map(function(e){var r=e.delta;return null==t&&(t=uA(r)),t?dR(dR({},e),{finish_reason:"tool_calls",delta:r}):e}),o=dR(dR({},e),{choices:n});r.enqueue(dR(dR({},o),{rawResponse:e}))}})))]}})})},e}(),mR=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},yR=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},vR=function(){function e(e,t,r){this.req=e,this.baseUrl=t,this.provider=r,this.generateImageSubUrl="images/generations",this.editImageSubUrl="images/edits"}return e.prototype.generateImage=function(e){return mR(this,void 0,void 0,function(){return yR(this,function(t){switch(t.label){case 0:return[4,this.req({url:this.getGenerateUrl(),data:e,stream:!1})];case 1:return[2,t.sent()]}})})},e.prototype.editImage=function(e){return mR(this,void 0,void 0,function(){return yR(this,function(t){switch(t.label){case 0:return[4,this.req({url:this.getEditUrl(),data:e,stream:!1})];case 1:return[2,t.sent()]}})})},e.prototype.getGenerateUrl=function(){return"".concat(this.baseUrl,"/").concat(this.provider,"/").concat(this.generateImageSubUrl)},e.prototype.getEditUrl=function(){return"".concat(this.baseUrl,"/").concat(this.provider,"/").concat(this.editImageSubUrl)},e}(),gR=function(){return gR=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},gR.apply(this,arguments)},bR=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},wR=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},ER=function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise(function(n,o){(function(e,t,r,n){Promise.resolve(n).then(function(t){e({value:t,done:r})},t)})(n,o,(t=e[r](t)).done,t.value)})}}},_R=function(e,t,r){if(r||2===arguments.length)for(var n,o=0,i=t.length;o<i;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))};function SR(e){var t,r=e.onStepFinish,n=e.abortSignal,o=e.maxSteps,i=e.topP,a=e.toolChoice,s=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,["onStepFinish","abortSignal","maxSteps","topP","toolChoice"]);if(null!=o&&o<1)throw new Error("`maxSteps` muse be greater than 0.");return[{onStepFinish:r,abortSignal:n,maxSteps:o},gR(gR({},s),{tools:null===(t=s.tools)||void 0===t?void 0:t.map(function(e){return"fn"in e?function(e){return{type:"function",function:{description:e.description,name:e.name,parameters:e.parameters}}}(e):e}),top_p:null!=i?i:s.top_p,tool_choice:null!=a?a:s.tool_choice})]}var xR=function(){function e(e){this.model=e}return e.prototype.generateText=function(e,t){var r,n;return bR(this,void 0,void 0,function(){var o,i,a,s,c,l,u,d,f,p,h,m,y,v,g,b,w,E,_,S,x,N=this;return wR(this,function(I){switch(I.label){case 0:return o=[],i={completion_tokens:0,prompt_tokens:0,total_tokens:0},a=SR(e),s=a[0],c=s.onStepFinish,l=s.maxSteps,u=void 0===l?10:l,d=a[1],[4,(f=function(){return N.model.doGenerate(d,t)})()];case 1:p=I.sent(),h=1,p.rawResponse&&o.push(p.rawResponse),m=null,I.label=2;case 2:if(!(h<u&&null!=(m=NR(p))))return[3,9];y=AR(p.usage),RR(i,y),I.label=3;case 3:return I.trys.push([3,7,,8]),[4,OR(m)];case 4:return v=I.sent(),g=p.choices[0],[4,null==c?void 0:c({finishReason:g.finish_reason,messages:d.messages.slice(),text:g.message.content,toolCall:m,toolResult:v,stepUsage:y,totalUsage:Object.assign({},i)})];case 5:return I.sent(),IR(d.messages,g.message,v),[4,f()];case 6:return(p=I.sent()).rawResponse&&o.push(p.rawResponse),h+=1,[3,8];case 7:return b=I.sent(),[2,{text:"",messages:d.messages,usage:i,error:b,rawResponses:o}];case 8:return[3,2];case 9:return w=null===(r=null==p?void 0:p.choices)||void 0===r?void 0:r[0],E=null==w?void 0:w.message,_=null!==(n=null==E?void 0:E.content)&&void 0!==n?n:"",S=E?_R(_R([],d.messages,!0),[E],!1):d.messages,x=AR(p.usage),RR(i,x),[4,null==c?void 0:c({finishReason:w.finish_reason,messages:S.slice(),text:_,toolCall:NR(p),toolResult:null,stepUsage:x,totalUsage:Object.assign({},i)})];case 10:return I.sent(),[2,{text:_,messages:S,usage:i,rawResponses:o}]}})})},e.prototype.streamText=function(e,t){var r;return bR(this,void 0,void 0,function(){var n,o,i,a,s,c,l,u,d,f,p,h,m,y,v,g,b,w,E,_,S,x,N,I,T,O,A,R,P,C,k,V,L,U,D,j,M=this;return wR(this,function(q){switch(q.label){case 0:return n={completion_tokens:0,prompt_tokens:0,total_tokens:0},o=SR(e),i=o[0],a=i.onStepFinish,s=i.maxSteps,c=void 0===s?10:s,l=o[1],[4,(u=function(){return M.model.doStream(l,t)})()];case 1:d=q.sent(),f=1,p=null,h=function(){var e=d.tee(),t=e[0],r=e[1];return d=aA(t),function(e){var t,r,n,o,i,a,s,c,l,u;return bR(this,void 0,void 0,function(){var d,f,p,h,m,y,v,g,b,w,E,_,S;return wR(this,function(x){switch(x.label){case 0:d={completion_tokens:0,prompt_tokens:0,total_tokens:0},f=aA(e),h={role:"assistant",content:"",tool_calls:[p={id:"",function:{name:"",arguments:""},type:""}]},x.label=1;case 1:x.trys.push([1,6,7,12]),m=!0,y=ER(f),x.label=2;case 2:return[4,y.next()];case 3:if(v=x.sent(),t=v.done)return[3,5];o=v.value,m=!1;try{if(!(b=null==(g=o)?void 0:g.choices[0]))return[2,null];if(w=b.finish_reason,E=b.delta,"tool_calls"!==w)return[2,null];if(!E)return[3,4];if(E.content&&(h.content+=E.content),!("tool_calls"in E))return[3,4];(null==(_=null===(i=null==E?void 0:E.tool_calls)||void 0===i?void 0:i[0])?void 0:_.id)&&(p.id=_.id),(null==_?void 0:_.type)&&(p.type=_.type),(null===(a=null==_?void 0:_.function)||void 0===a?void 0:a.name)&&(p.function.name=_.function.name),(null===(s=null==_?void 0:_.function)||void 0===s?void 0:s.arguments)&&(p.function.arguments+=_.function.arguments),(null===(c=null==g?void 0:g.usage)||void 0===c?void 0:c.completion_tokens)&&(d.completion_tokens=g.usage.completion_tokens),(null===(l=null==g?void 0:g.usage)||void 0===l?void 0:l.prompt_tokens)&&(d.prompt_tokens=g.usage.prompt_tokens),(null===(u=null==g?void 0:g.usage)||void 0===u?void 0:u.total_tokens)&&(d.total_tokens=g.usage.total_tokens)}finally{m=!0}x.label=4;case 4:return[3,2];case 5:return[3,12];case 6:return S=x.sent(),r={error:S},[3,12];case 7:return x.trys.push([7,,10,11]),m||t||!(n=y.return)?[3,9]:[4,n.call(y)];case 8:x.sent(),x.label=9;case 9:return[3,11];case 10:if(r)throw r.error;return[7];case 11:return[7];case 12:return[2,{message:h,usage:d}]}})})}(r)},q.label=2;case 2:return(m=f<c)?[4,h()]:[3,4];case 3:m=null!=(p=q.sent()),q.label=4;case 4:if(!m)return[3,11];y=p.message,v=p.usage,RR(n,v),g=null===(r=y.tool_calls)||void 0===r?void 0:r[0],q.label=5;case 5:return q.trys.push([5,9,,10]),[4,OR(g)];case 6:return b=q.sent(),[4,null==a?void 0:a({finishReason:"tool_calls",messages:l.messages.slice(),text:y.content,toolCall:g,toolResult:b,stepUsage:v,totalUsage:Object.assign({},n)})];case 7:return q.sent(),IR(l.messages,y,b),[4,u()];case 8:return d=q.sent(),[3,10];case 9:return w=q.sent(),E=d.tee(),_=E[0],S=E[1],[2,{messages:Promise.resolve(l.messages),dataStream:aA(_),textStream:aA(S.pipeThrough(new rA({transform:function(e,t){var r,n,o,i=null===(o=null===(n=null===(r=null==e?void 0:e.choices)||void 0===r?void 0:r[0])||void 0===n?void 0:n.delta)||void 0===o?void 0:o.content;"string"==typeof i&&t.enqueue(i)}}))),usage:Promise.resolve(n),error:w}];case 10:return[3,2];case 11:return[4,h()];case 12:return(p=q.sent())?(x=p.message,N=p.usage,RR(n,N),I=_R(_R([],l.messages,!0),[x],!1),a({messages:I.slice(),finishReason:"tool_call",stepUsage:N,text:x.content,toolCall:x.tool_calls[0],totalUsage:Object.assign({},n)}),T=d.tee(),O=T[0],A=T[1],[2,{messages:Promise.resolve(_R(_R([],l.messages,!0),[x],!1)),dataStream:aA(O),textStream:aA(A.pipeThrough(new rA({transform:function(e,t){var r,n,o,i=null===(o=null===(n=null===(r=null==e?void 0:e.choices)||void 0===r?void 0:r[0])||void 0===n?void 0:n.delta)||void 0===o?void 0:o.content;"string"==typeof i&&t.enqueue(i)}}))),usage:Promise.resolve(n)}]):(R=lA(),P=lA(),C={role:"assistant",content:""},k="",V={completion_tokens:0,prompt_tokens:0,total_tokens:0},L=d.pipeThrough(new rA({transform:function(e,t){var r,n,o,i,a,s,c,l,u=null===(o=null===(n=null===(r=null==e?void 0:e.choices)||void 0===r?void 0:r[0])||void 0===n?void 0:n.delta)||void 0===o?void 0:o.content;"string"==typeof u&&(C.content+=u);var d=null===(a=null===(i=null==e?void 0:e.choices)||void 0===i?void 0:i[0])||void 0===a?void 0:a.finish_reason;d&&(k=d),(null===(s=null==e?void 0:e.usage)||void 0===s?void 0:s.completion_tokens)&&(V.completion_tokens=e.usage.completion_tokens),(null===(c=null==e?void 0:e.usage)||void 0===c?void 0:c.prompt_tokens)&&(V.prompt_tokens=e.usage.prompt_tokens),(null===(l=null==e?void 0:e.usage)||void 0===l?void 0:l.total_tokens)&&(V.total_tokens=e.usage.total_tokens),t.enqueue(e)},flush:function(){R.res(_R(_R([],l.messages,!0),[C],!1)),RR(n,V),P.res(Object.assign({},n)),null==a||a({messages:_R(_R([],l.messages,!0),[C],!1),finishReason:k,text:C.content,stepUsage:V,totalUsage:Object.assign({},n)})}})),U=L.tee(),D=U[0],j=U[1],[2,{messages:R.promise,dataStream:aA(D),textStream:aA(j.pipeThrough(new rA({transform:function(e,t){var r,n,o,i=null===(o=null===(n=null===(r=null==e?void 0:e.choices)||void 0===r?void 0:r[0])||void 0===n?void 0:n.delta)||void 0===o?void 0:o.content;"string"==typeof i&&t.enqueue(i)}}))),usage:P.promise}])}})})},e}();function NR(e){var t,r=null===(t=null==e?void 0:e.choices)||void 0===t?void 0:t[0];if(!r)return null;var n=r.finish_reason,o=r.message;return"tool_calls"!==n?null:o&&uA(o)?o.tool_calls[0]:null}function IR(e,t,r){e.push(t,{role:"tool",tool_call_id:t.tool_calls[0].id,content:JSON.stringify(r)})}var TR=new Map;function OR(e){return TR.get(e.function.name)(JSON.parse(e.function.arguments))}function AR(e){var t,r,n;return{completion_tokens:null!==(t=null==e?void 0:e.completion_tokens)&&void 0!==t?t:0,prompt_tokens:null!==(r=null==e?void 0:e.prompt_tokens)&&void 0!==r?r:0,total_tokens:null!==(n=null==e?void 0:e.total_tokens)&&void 0!==n?n:0}}function RR(e,t){e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens}var PR={hunyuan:CA,"hunyuan-beta":OA,ark:DA,dashscope:FA,"01-ai":zA,moonshot:QA,zhipu:EA,"hunyuan-exp":rR,"hunyuan-open":aR,deepseek:uR};const CR=Object.freeze(Object.defineProperty({__proto__:null,ArkSimpleModel:DA,DSSimpleModel:FA,DefaultImageModel:vR,DefaultSimpleModel:hR,HunYuanBetaSimpleModel:OA,HunYuanExpSimpleModel:rR,HunYuanOpenSimpleModel:aR,HunYuanSimpleModel:CA,MODELS:PR,MoonshotSimpleModel:QA,ReactModel:xR,YiSimpleModel:zA,ZhiPuSimpleModel:EA,toolMap:TR},Symbol.toStringTag,{value:"Module"}));var kR=function(){return kR=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},kR.apply(this,arguments)},VR=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},LR=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},UR=PR,DR=function(){function e(e,t,r){var n=this;this.req=e,this.baseUrl=t,this.modelRequest=function(e){var t=e.url,r=e.data,o=e.headers,i=e.stream,a=e.timeout;return VR(n,void 0,void 0,function(){var e,n,s,c,l,u,d;return LR(this,function(f){switch(f.label){case 0:return e={"Content-Type":"application/json"},i&&Object.assign(e,{Accept:"text/event-stream"}),[4,this.req.fetch({method:"post",headers:kR(kR((l={},l[null===(u=this.i18n)||void 0===u?void 0:u.LANG_HEADER_KEY]=null===(d=this.i18n)||void 0===d?void 0:d.lang,l),e),o),body:JSON.stringify(r),url:t,stream:i,timeout:a})];case 1:return n=f.sent(),s=n.data,c=n.header,[2,this.handleResponseData(s,c)]}})})},this.botRequest=function(e){var t=e.method,r=e.url,o=e.data,i=void 0===o?{}:o,a=e.headers,s=e.stream,c=e.timeout;return VR(n,void 0,void 0,function(){var e,n,o,l,u,d,f,p;return LR(this,function(h){switch(h.label){case 0:return"get"!==t?[3,2]:(e=this.handleResponseData,[4,this.req.fetch({url:"".concat(r,"?").concat((m=i,Object.entries(m).map(function(e){var t=e[0],r=e[1];return"".concat(t,"=").concat(r)}).join("&"))),method:t,headers:a,stream:s,timeout:c})]);case 1:return[2,e.apply(this,[h.sent().data])];case 2:return n={"Content-Type":"application/json"},s&&Object.assign(n,{Accept:"text/event-stream"}),[4,this.req.fetch({url:r,body:JSON.stringify(i),headers:kR(kR((d={},d[null===(f=this.i18n)||void 0===f?void 0:f.LANG_HEADER_KEY]=null===(p=this.i18n)||void 0===p?void 0:p.lang,d),n),a),stream:s,method:t,timeout:c})];case 3:return o=h.sent(),l=o.data,u=o.header,[2,this.handleResponseData(l,u)]}var m})})},this.aiBaseUrl="".concat(t,"/ai"),this.aiBotBaseUrl="".concat(t,"/aibot"),this.bot=new mA(this.botRequest,this.aiBotBaseUrl),this.i18n=r,le.on(ue,function(e){var t;n.i18n=(null===(t=e.data)||void 0===t?void 0:t.i18n)||n.i18n})}return e.prototype.handleResponseData=function(e,t){var r,n;return VR(this,void 0,void 0,function(){var o,i;return LR(this,function(a){switch(a.label){case 0:return o="".concat(this.i18n.t("è¯·æ£€æŸ¥è°ƒç”¨æ–¹å¼ï¼Œæˆ–å‰å¾€äº‘å¼€å‘ AI+ é¦–é¡µæŸ¥çœ‹æ–‡æ¡£"),"ï¼šhttps://tcb.cloud.tencent.com/dev#/ai"),"object"==typeof e&&e&&"then"in e?[4,e]:[3,2];case 1:if("object"==typeof(i=a.sent())&&i&&"code"in i&&"NORMAL"!==i.code)throw new Error("".concat(this.i18n.t("AI+ è¯·æ±‚å‡ºé”™ï¼Œé”™è¯¯ç "),"ï¼š").concat(i.code,"ï¼Œ").concat(this.i18n.t("é”™è¯¯ä¿¡æ¯"),"ï¼š").concat(i.message,"\n").concat(o,"\n").concat(JSON.stringify(i,null,2)));return[2,e];case 2:return(null===(n=null===(r=null==t?void 0:t.get)||void 0===r?void 0:r.call(t,"content-type"))||void 0===n?void 0:n.includes("application/json"))?[4,cA(e)]:[3,4];case 3:if("object"==typeof(i=a.sent())&&i&&"code"in i&&"NORMAL"!==i.code)throw new Error("".concat(this.i18n.t("AI+ è¯·æ±‚å‡ºé”™ï¼Œé”™è¯¯ç "),"ï¼š").concat(i.code,"ï¼Œ").concat(this.i18n.t("é”™è¯¯ä¿¡æ¯"),"ï¼š").concat(i.message,"\n").concat(o,"\n").concat(JSON.stringify(i,null,2)));a.label=4;case 4:return[2,e]}})})},e.prototype.createModel=function(e,t){var r,n=UR[e];if(n)r=new n(this.modelRequest,this.aiBaseUrl);else{var o="string"==typeof(null==t?void 0:t.defaultModelSubUrl)?t.defaultModelSubUrl:"/chat/completions";r=new hR(this.modelRequest,this.aiBaseUrl,"".concat(e).concat(o))}return new xR(r)},e.prototype.registerModel=function(e,t){null==UR[e]?UR[e]=t:console.warn("AI model ".concat(e," already exists!"))},e.prototype.createImageModel=function(e){return new vR(this.modelRequest,this.aiBaseUrl,e)},e.prototype.registerFunctionTool=function(e){TR.has(e.name)&&console.warn("AI function tool ".concat(e.name," already exists and will be overwritten!")),TR.set(e.name,e.fn)},e}(),jR=function(){return jR=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},jR.apply(this,arguments)},MR=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},qR=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},BR=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};BR(CR,["MODELS"]);function FR(e){var t=e.env,r=e.baseUrl,n=e.req,o=e.getAccessToken,i=e.handleReqInstance,a=e.i18n;return new DR(function(){if(null==i){if(null==o)throw new Error("`getAccessToken` is required when `handleReqInstance` is not provided!");return function(e){var t=e.getAccessToken,r=e.req;return{download:r.download,post:r.post,upload:r.upload,fetch:function(e){return MR(void 0,void 0,void 0,function(){var n,o,i,a,s;return qR(this,function(c){switch(c.label){case 0:if("function"!=typeof r.fetch)throw new Error("req.fetch is not a function");return n=e.token,o=e.headers,i=void 0===o?{}:o,a=BR(e,["token","headers"]),null==n?[3,1]:(s=n,[3,3]);case 1:return[4,t()];case 2:s=c.sent().accessToken,c.label=3;case 3:return[2,r.fetch(jR({headers:jR({Authorization:"Bearer ".concat(s)},i)},a))]}})})}}}({req:n,getAccessToken:o})}return i({req:n})}(),function(){if(null!=r)return r;if(null==t)throw new Error("`env` is required when `baseUrl` is not provided!");return"https://".concat(t,".api.tcloudbasegateway.com/v1")}(),a)}var WR={name:"ai",entity:{ai:function(e){var t,r,n,o,i=this,a=this.request;if(null==a.fetch)throw new Error("cloudbase.request.fetch() unimplemented!");return FR({req:a,baseUrl:null!==(t=null==e?void 0:e.baseUrl)&&void 0!==t?t:(r=i.getEndPointWithKey("GATEWAY"),n=r.BASE_URL,o=r.PROTOCOL,"".concat(o).concat(n)),handleReqInstance:function(e){return e.req},i18n:this.config.i18n})}}};function HR(e){try{e.registerComponent(WR)}catch(hL){console.warn(hL)}}try{window.registerAi=HR}catch(hL){}var GR=function(){return GR=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},GR.apply(this,arguments)},$R=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},zR=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(o=2&s[0]?n.return:s[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,s[1])).done)return o;switch(n=0,o&&(s=[2&s[0],o.value]),s[0]){case 0:case 1:o=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!o||s[1]>o[0]&&s[1]<o[3])){a.label=s[1];break}if(6===s[0]&&a.label<o[1]){a.label=o[1],o=s;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(s);break}o[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(hL){s=[6,hL],n=0}finally{r=o=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};function KR(e,t){var r=this,n=e.request.fetch.bind(e.request),o=t||{},i=o.instance,a=void 0===i?"default":i,s=o.database,c=void 0===s?e.config.env:s,l=e.getEndPointWithKey("GATEWAY"),u=l.BASE_URL,d=l.PROTOCOL;return IO(e,{mysqlBaseUrl:"".concat(d).concat(u,"/rdb/rest"),fetch:function(e,t){return $R(r,void 0,void 0,function(){var r,o,i,s;return zR(this,function(l){switch(l.label){case 0:return r={},t.headers instanceof Headers?t.headers.forEach(function(e,t){r[t]=e}):r=t.headers||{},[4,n(GR(GR({url:e.toString()},t),{headers:GR({"Content-Type":"application/json","X-Db-Instance":a,"Accept-Profile":c,"Content-Profile":c},r),shouldThrowOnError:!1}))];case 1:o=l.sent(),i={},l.label=2;case 2:return l.trys.push([2,4,,5]),[4,o.data];case 3:return i=l.sent(),[3,5];case 4:if(!(s=l.sent()).message.includes("Unexpected end of JSON input"))throw s;return[3,5];case 5:return[2,{ok:(null==o?void 0:o.statusCode)>=200&&(null==o?void 0:o.statusCode)<300,status:(null==o?void 0:o.statusCode)||200,statusText:(null==o?void 0:o.statusMessage)||"OK",json:function(){return Promise.resolve(i||{})},text:function(){return Promise.resolve("string"==typeof i?i:JSON.stringify(i||{}))},headers:null==o?void 0:o.header}]}})})}})}var JR,YR,XR,QR={name:"mysql",entity:{mysql:function(e){return KR(this,e)(e)}}},ZR={name:"rdb",entity:{rdb:function(e){return KR(this,e)(e)}}};try{cloudbase.registerComponent(QR),cloudbase.registerComponent(ZR)}catch(hL){}function eP(e){try{e.registerComponent(QR),e.registerComponent(ZR)}catch(hL){console.warn(hL)}}try{window.registerMySQL=eP}catch(hL){}(XR=YR||(YR={})).DocIDError="æ–‡æ¡£IDä¸åˆæ³•",XR.CollNameError="é›†åˆåç§°ä¸åˆæ³•",XR.OpStrError="æ“ä½œç¬¦ä¸åˆæ³•",XR.DirectionError="æ’åºå­—ç¬¦ä¸åˆæ³•",XR.IntergerError="must be integer",XR.QueryParamTypeError="æŸ¥è¯¢å‚æ•°å¿…é¡»ä¸ºå¯¹è±¡",XR.QueryParamValueError="æŸ¥è¯¢å‚æ•°å¯¹è±¡å€¼ä¸èƒ½å‡ä¸ºundefined";var tP,rP,nP,oP,iP="Number",aP="Object",sP="Array",cP="GeoPoint",lP="GeoLineString",uP="GeoPolygon",dP="GeoMultiPoint",fP="GeoMultiLineString",pP="GeoMultiPolygon",hP="Date",mP="ServerDate",yP="BsonDate",vP=["desc","asc"],gP=["<","<=","==",">=",">"];(rP=tP||(tP={})).lt="<",rP.gt=">",rP.lte="<=",rP.gte=">=",rP.eq="==",(JR={})[tP.eq]="$eq",JR[tP.lt]="$lt",JR[tP.lte]="$lte",JR[tP.gt]="$gt",JR[tP.gte]="$gte",(oP=nP||(nP={})).WHERE="WHERE",oP.DOC="DOC";var bP=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),wP=[],EP={},_P=function(e){function t(t,r){if(r!==EP)throw new TypeError("InternalSymbol cannot be constructed with new operator");return e.call(this,t)||this}return bP(t,e),t.for=function(e){for(var r=0,n=wP.length;r<n;r++)if(wP[r].target===e)return wP[r].instance;var o=new t(e,EP);return wP.push({target:e,instance:o}),o},t}(function(){return function(e){Object.defineProperties(this,{target:{enumerable:!1,writable:!1,configurable:!1,value:e}})}}()),SP=_P.for("UNSET_FIELD_NAME"),xP=_P.for("UPDATE_COMMAND"),NP=_P.for("QUERY_COMMAND"),IP=_P.for("LOGIC_COMMAND"),TP=_P.for("GEO_POINT"),OP=_P.for("SYMBOL_GEO_LINE_STRING"),AP=_P.for("SYMBOL_GEO_POLYGON"),RP=_P.for("SYMBOL_GEO_MULTI_POINT"),PP=_P.for("SYMBOL_GEO_MULTI_LINE_STRING"),CP=_P.for("SYMBOL_GEO_MULTI_POLYGON"),kP=_P.for("SERVER_DATE"),VP=_P.for("REGEXP"),LP=function(){function e(e){var t=(void 0===e?{}:e).offset,r=void 0===t?0:t;this.offset=r}return Object.defineProperty(e.prototype,"_internalType",{get:function(){return kP},enumerable:!0,configurable:!0}),e.prototype.parse=function(){return{$date:{offset:this.offset}}},e}();function UP(e){return new LP(e)}var DP=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){o={error:s}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},jP=function(){function e(){}return e.formatResDocumentData=function(t){return t.map(function(t){return e.formatField(t)})},e.formatField=function(t){var r=Object.keys(t),n={};return Array.isArray(t)&&(n=[]),r.forEach(function(r){var o,i=t[r];switch(e.whichType(i)){case cP:o=new zP(i.coordinates[0],i.coordinates[1]);break;case lP:o=new KP(i.coordinates.map(function(e){return new zP(e[0],e[1])}));break;case uP:o=new YP(i.coordinates.map(function(e){return new KP(e.map(function(e){var t=DP(e,2),r=t[0],n=t[1];return new zP(r,n)}))}));break;case dP:o=new XP(i.coordinates.map(function(e){return new zP(e[0],e[1])}));break;case fP:o=new ZP(i.coordinates.map(function(e){return new KP(e.map(function(e){var t=DP(e,2),r=t[0],n=t[1];return new zP(r,n)}))}));break;case pP:o=new tC(i.coordinates.map(function(e){return new YP(e.map(function(e){return new KP(e.map(function(e){var t=DP(e,2),r=t[0],n=t[1];return new zP(r,n)}))}))}));break;case hP:o=new Date(1e3*i.$timestamp);break;case aP:case sP:o=e.formatField(i);break;case mP:o=new Date(i.$date);break;default:o=i}Array.isArray(n)?n.push(o):n[r]=o}),n},e.whichType=function(e){var t=Object.prototype.toString.call(e).slice(8,-1);if(t===hP)return yP;if(t===aP){if(e instanceof zP)return cP;if(e instanceof Date)return hP;if(e instanceof LP)return mP;e.$timestamp?t=hP:e.$date?t=mP:zP.validate(e)?t=cP:KP.validate(e)?t=lP:YP.validate(e)?t=uP:XP.validate(e)?t=dP:ZP.validate(e)?t=fP:tC.validate(e)&&(t=pP)}return t},e.generateDocId=function(){for(var e="ABCDEFabcdef0123456789",t="",r=0;r<24;r++)t+=e.charAt(Math.floor(22*Math.random()));return t},e}(),MP=function(){function e(){}return e.isGeopoint=function(e,t){if(jP.whichType(t)!==iP)throw new Error("Geo Point must be number type");var r=Math.abs(t);if("latitude"===e&&r>90)throw new Error("latitude should be a number ranges from -90 to 90");if("longitude"===e&&r>180)throw new Error("longitude should be a number ranges from -180 to 180");return!0},e.isInteger=function(e,t){if(!Number.isInteger(t))throw new Error(e+YR.IntergerError);return!0},e.isFieldOrder=function(e){if(-1===vP.indexOf(e))throw new Error(YR.DirectionError);return!0},e.isFieldPath=function(e){if(!/^[a-zA-Z0-9-_\.]/.test(e))throw new Error;return!0},e.isOperator=function(e){if(-1===gP.indexOf(e))throw new Error(YR.OpStrError);return!0},e.isCollName=function(e){if(!/^[a-zA-Z0-9]([a-zA-Z0-9-_]){1,32}$/.test(e))throw new Error(YR.CollNameError);return!0},e.isDocID=function(e){if(!/^([a-fA-F0-9]){24}$/.test(e))throw new Error(YR.DocIDError);return!0},e}(),qP=function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},BP=function(e){return"object"===qP(e)},FP=function(e){return"number"===qP(e)},WP=function(e){return Array.isArray(e)},HP=function(e){return"date"===qP(e)},GP=function(e){return"regexp"===qP(e)},$P=function(e){return e&&e._internalType instanceof _P},zP=function(){function e(e,t){MP.isGeopoint("longitude",e),MP.isGeopoint("latitude",t),this.longitude=e,this.latitude=t}return e.prototype.parse=function(e){var t;return(t={})[e]={type:"Point",coordinates:[this.longitude,this.latitude]},t},e.prototype.toJSON=function(){return{type:"Point",coordinates:[this.longitude,this.latitude]}},e.prototype.toReadableString=function(){return"["+this.longitude+","+this.latitude+"]"},e.validate=function(e){return"Point"===e.type&&WP(e.coordinates)&&MP.isGeopoint("longitude",e.coordinates[0])&&MP.isGeopoint("latitude",e.coordinates[1])},Object.defineProperty(e.prototype,"_internalType",{get:function(){return TP},enumerable:!0,configurable:!0}),e}(),KP=function(){function e(e){if(!WP(e))throw new TypeError('"points" must be of type Point[]. Received type '+typeof e);if(e.length<2)throw new Error('"points" must contain 2 points at least');e.forEach(function(e){if(!(e instanceof zP))throw new TypeError('"points" must be of type Point[]. Received type '+typeof e+"[]")}),this.points=e}return e.prototype.parse=function(e){var t;return(t={})[e]={type:"LineString",coordinates:this.points.map(function(e){return e.toJSON().coordinates})},t},e.prototype.toJSON=function(){return{type:"LineString",coordinates:this.points.map(function(e){return e.toJSON().coordinates})}},e.validate=function(e){var t,r;if("LineString"!==e.type||!WP(e.coordinates))return!1;try{for(var n=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e.coordinates),o=n.next();!o.done;o=n.next()){var i=o.value;if(!FP(i[0])||!FP(i[1]))return!1}}catch(a){t={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return!0},e.isClosed=function(e){var t=e.points[0],r=e.points[e.points.length-1];if(t.latitude===r.latitude&&t.longitude===r.longitude)return!0},Object.defineProperty(e.prototype,"_internalType",{get:function(){return OP},enumerable:!0,configurable:!0}),e}(),JP=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},YP=function(){function e(e){if(!WP(e))throw new TypeError('"lines" must be of type LineString[]. Received type '+typeof e);if(0===e.length)throw new Error("Polygon must contain 1 linestring at least");e.forEach(function(e){if(!(e instanceof KP))throw new TypeError('"lines" must be of type LineString[]. Received type '+typeof e+"[]");if(!KP.isClosed(e))throw new Error("LineString "+e.points.map(function(e){return e.toReadableString()})+" is not a closed cycle")}),this.lines=e}return e.prototype.parse=function(e){var t;return(t={})[e]={type:"Polygon",coordinates:this.lines.map(function(e){return e.points.map(function(e){return[e.longitude,e.latitude]})})},t},e.prototype.toJSON=function(){return{type:"Polygon",coordinates:this.lines.map(function(e){return e.points.map(function(e){return[e.longitude,e.latitude]})})}},e.validate=function(e){var t,r,n,o;if("Polygon"!==e.type||!WP(e.coordinates))return!1;try{for(var i=JP(e.coordinates),a=i.next();!a.done;a=i.next()){var s=a.value;if(!this.isCloseLineString(s))return!1;try{for(var c=(n=void 0,JP(s)),l=c.next();!l.done;l=c.next()){var u=l.value;if(!FP(u[0])||!FP(u[1]))return!1}}catch(d){n={error:d}}finally{try{l&&!l.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}}}catch(f){t={error:f}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return!0},e.isCloseLineString=function(e){var t=e[0],r=e[e.length-1];return t[0]===r[0]&&t[1]===r[1]},Object.defineProperty(e.prototype,"_internalType",{get:function(){return CP},enumerable:!0,configurable:!0}),e}(),XP=function(){function e(e){if(!WP(e))throw new TypeError('"points" must be of type Point[]. Received type '+typeof e);if(0===e.length)throw new Error('"points" must contain 1 point at least');e.forEach(function(e){if(!(e instanceof zP))throw new TypeError('"points" must be of type Point[]. Received type '+typeof e+"[]")}),this.points=e}return e.prototype.parse=function(e){var t;return(t={})[e]={type:"MultiPoint",coordinates:this.points.map(function(e){return e.toJSON().coordinates})},t},e.prototype.toJSON=function(){return{type:"MultiPoint",coordinates:this.points.map(function(e){return e.toJSON().coordinates})}},e.validate=function(e){var t,r;if("MultiPoint"!==e.type||!WP(e.coordinates))return!1;try{for(var n=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e.coordinates),o=n.next();!o.done;o=n.next()){var i=o.value;if(!FP(i[0])||!FP(i[1]))return!1}}catch(a){t={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return!0},Object.defineProperty(e.prototype,"_internalType",{get:function(){return RP},enumerable:!0,configurable:!0}),e}(),QP=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},ZP=function(){function e(e){if(!WP(e))throw new TypeError('"lines" must be of type LineString[]. Received type '+typeof e);if(0===e.length)throw new Error("Polygon must contain 1 linestring at least");e.forEach(function(e){if(!(e instanceof KP))throw new TypeError('"lines" must be of type LineString[]. Received type '+typeof e+"[]")}),this.lines=e}return e.prototype.parse=function(e){var t;return(t={})[e]={type:"MultiLineString",coordinates:this.lines.map(function(e){return e.points.map(function(e){return[e.longitude,e.latitude]})})},t},e.prototype.toJSON=function(){return{type:"MultiLineString",coordinates:this.lines.map(function(e){return e.points.map(function(e){return[e.longitude,e.latitude]})})}},e.validate=function(e){var t,r,n,o;if("MultiLineString"!==e.type||!WP(e.coordinates))return!1;try{for(var i=QP(e.coordinates),a=i.next();!a.done;a=i.next()){var s=a.value;try{for(var c=(n=void 0,QP(s)),l=c.next();!l.done;l=c.next()){var u=l.value;if(!FP(u[0])||!FP(u[1]))return!1}}catch(d){n={error:d}}finally{try{l&&!l.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}}}catch(f){t={error:f}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return!0},Object.defineProperty(e.prototype,"_internalType",{get:function(){return PP},enumerable:!0,configurable:!0}),e}(),eC=function(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},tC=function(){function e(e){var t,r;if(!WP(e))throw new TypeError('"polygons" must be of type Polygon[]. Received type '+typeof e);if(0===e.length)throw new Error("MultiPolygon must contain 1 polygon at least");try{for(var n=eC(e),o=n.next();!o.done;o=n.next()){var i=o.value;if(!(i instanceof YP))throw new TypeError('"polygon" must be of type Polygon[]. Received type '+typeof i+"[]")}}catch(a){t={error:a}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}this.polygons=e}return e.prototype.parse=function(e){var t;return(t={})[e]={type:"MultiPolygon",coordinates:this.polygons.map(function(e){return e.lines.map(function(e){return e.points.map(function(e){return[e.longitude,e.latitude]})})})},t},e.prototype.toJSON=function(){return{type:"MultiPolygon",coordinates:this.polygons.map(function(e){return e.lines.map(function(e){return e.points.map(function(e){return[e.longitude,e.latitude]})})})}},e.validate=function(e){var t,r,n,o,i,a;if("MultiPolygon"!==e.type||!WP(e.coordinates))return!1;try{for(var s=eC(e.coordinates),c=s.next();!c.done;c=s.next()){var l=c.value;try{for(var u=(n=void 0,eC(l)),d=u.next();!d.done;d=u.next()){var f=d.value;try{for(var p=(i=void 0,eC(f)),h=p.next();!h.done;h=p.next()){var m=h.value;if(!FP(m[0])||!FP(m[1]))return!1}}catch(y){i={error:y}}finally{try{h&&!h.done&&(a=p.return)&&a.call(p)}finally{if(i)throw i.error}}}}catch(v){n={error:v}}finally{try{d&&!d.done&&(o=u.return)&&o.call(u)}finally{if(n)throw n.error}}}}catch(g){t={error:g}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return!0},Object.defineProperty(e.prototype,"_internalType",{get:function(){return AP},enumerable:!0,configurable:!0}),e}();const rC=Object.freeze(Object.defineProperty({__proto__:null,LineString:KP,MultiLineString:ZP,MultiPoint:XP,MultiPolygon:tC,Point:zP,Polygon:YP},Symbol.toStringTag,{value:"Module"}));var nC,oC,iC=function(){var e;if(!Promise){(e=function(){}).promise={};var t=function(){throw new Error('Your Node runtime does support ES6 Promises. Set "global.Promise" to your preferred implementation of promises.')};return Object.defineProperty(e.promise,"then",{get:t}),Object.defineProperty(e.promise,"catch",{get:t}),e}var r=new Promise(function(t,r){e=function(e,n){return e?r(e):t(n)}});return e.promise=r,e};(oC=nC||(nC={})).SET="set",oC.REMOVE="remove",oC.INC="inc",oC.MUL="mul",oC.PUSH="push",oC.PULL="pull",oC.PULL_ALL="pullAll",oC.POP="pop",oC.SHIFT="shift",oC.UNSHIFT="unshift",oC.ADD_TO_SET="addToSet",oC.BIT="bit",oC.RENAME="rename",oC.MAX="max",oC.MIN="min";var aC,sC,cC=function(){function e(e,t,r){this._internalType=xP,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}}),this.operator=e,this.operands=t,this.fieldName=r||SP}return e.prototype._setFieldName=function(t){return new e(this.operator,this.operands,t)},e}();function lC(e){return e&&e instanceof cC&&e._internalType===xP}(sC=aC||(aC={})).AND="and",sC.OR="or",sC.NOT="not",sC.NOR="nor";var uC=function(){function e(e,t,r){if(this._internalType=IP,Object.defineProperties(this,{_internalType:{enumerable:!1,configurable:!1}}),this.operator=e,this.operands=t,this.fieldName=r||SP,this.fieldName!==SP)if(Array.isArray(t)){t=t.slice(),this.operands=t;for(var n=0,o=t.length;n<o;n++){(dC(i=t[n])||yC(i))&&(t[n]=i._setFieldName(this.fieldName))}}else{var i;(dC(i=t)||yC(i))&&(t=i._setFieldName(this.fieldName))}}return e.prototype._setFieldName=function(t){var r=this.operands.map(function(r){return r instanceof e?r._setFieldName(t):r});return new e(this.operator,r,t)},e.prototype.and=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.from(arguments);return t.unshift(this),new e(aC.AND,t,this.fieldName)},e.prototype.or=function(){var t=Array.isArray(arguments[0])?arguments[0]:Array.from(arguments);return t.unshift(this),new e(aC.OR,t,this.fieldName)},e}();function dC(e){return e&&e instanceof uC&&e._internalType===IP}var fC,pC,hC=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();(pC=fC||(fC={})).EQ="eq",pC.NEQ="neq",pC.GT="gt",pC.GTE="gte",pC.LT="lt",pC.LTE="lte",pC.IN="in",pC.NIN="nin",pC.ALL="all",pC.ELEM_MATCH="elemMatch",pC.EXISTS="exists",pC.SIZE="size",pC.MOD="mod",pC.GEO_NEAR="geoNear",pC.GEO_WITHIN="geoWithin",pC.GEO_INTERSECTS="geoIntersects";var mC=function(e){function t(t,r,n){var o=e.call(this,t,r,n)||this;return o.operator=t,o._internalType=NP,o}return hC(t,e),t.prototype.toJSON=function(){var e,t;switch(this.operator){case fC.IN:case fC.NIN:return(e={})["$"+this.operator]=this.operands,e;default:return(t={})["$"+this.operator]=this.operands[0],t}},t.prototype._setFieldName=function(e){return new t(this.operator,this.operands,e)},t.prototype.eq=function(e){var r=new t(fC.EQ,[e],this.fieldName);return this.and(r)},t.prototype.neq=function(e){var r=new t(fC.NEQ,[e],this.fieldName);return this.and(r)},t.prototype.gt=function(e){var r=new t(fC.GT,[e],this.fieldName);return this.and(r)},t.prototype.gte=function(e){var r=new t(fC.GTE,[e],this.fieldName);return this.and(r)},t.prototype.lt=function(e){var r=new t(fC.LT,[e],this.fieldName);return this.and(r)},t.prototype.lte=function(e){var r=new t(fC.LTE,[e],this.fieldName);return this.and(r)},t.prototype.in=function(e){var r=new t(fC.IN,e,this.fieldName);return this.and(r)},t.prototype.nin=function(e){var r=new t(fC.NIN,e,this.fieldName);return this.and(r)},t.prototype.geoNear=function(e){if(!(e.geometry instanceof zP))throw new TypeError('"geometry" must be of type Point. Received type '+typeof e.geometry);if(void 0!==e.maxDistance&&!FP(e.maxDistance))throw new TypeError('"maxDistance" must be of type Number. Received type '+typeof e.maxDistance);if(void 0!==e.minDistance&&!FP(e.minDistance))throw new TypeError('"minDistance" must be of type Number. Received type '+typeof e.minDistance);var r=new t(fC.GEO_NEAR,[e],this.fieldName);return this.and(r)},t.prototype.geoWithin=function(e){if(!(e.geometry instanceof tC||e.geometry instanceof YP))throw new TypeError('"geometry" must be of type Polygon or MultiPolygon. Received type '+typeof e.geometry);var r=new t(fC.GEO_WITHIN,[e],this.fieldName);return this.and(r)},t.prototype.geoIntersects=function(e){if(!(e.geometry instanceof zP||e.geometry instanceof KP||e.geometry instanceof YP||e.geometry instanceof XP||e.geometry instanceof ZP||e.geometry instanceof tC))throw new TypeError('"geometry" must be of type Point, LineString, Polygon, MultiPoint, MultiLineString or MultiPolygon. Received type '+typeof e.geometry);var r=new t(fC.GEO_INTERSECTS,[e],this.fieldName);return this.and(r)},t}(uC);function yC(e){return e&&e instanceof mC&&e._internalType===NP}function vC(e){return yC(e)}var gC={};for(var bC in fC)gC[bC]="$"+bC;for(var bC in aC)gC[bC]="$"+bC;for(var bC in nC)gC[bC]="$"+bC;function wC(e){return gC[e]||"$"+e}gC[fC.NEQ]="$ne",gC[nC.REMOVE]="$unset",gC[nC.SHIFT]="$pop",gC[nC.UNSHIFT]="$push";var EC=function(){return EC=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},EC.apply(this,arguments)},_C=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){o={error:s}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},SC=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(_C(arguments[t]));return e};function xC(e){return NC(e,[e])}function NC(e,t){if(!$P(e)){if(HP(e))return{$date:+e};if(GP(e))return{$regex:e.source,$options:e.flags};if(WP(e))return e.map(function(e){if(t.indexOf(e)>-1)throw new Error("Cannot convert circular structure to JSON");return NC(e,SC(t,[e]))});if(BP(e)){var r=EC({},e);for(var n in r){if(t.indexOf(r[n])>-1)throw new Error("Cannot convert circular structure to JSON");r[n]=NC(r[n],SC(t,[r[n]]))}return r}return e}switch(e._internalType){case TP:return e.toJSON();case kP:case VP:return e.parse();default:return e.toJSON?e.toJSON():e}}var IC=function(){return IC=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},IC.apply(this,arguments)},TC=function(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){o={error:s}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a},OC=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(TC(arguments[t]));return e};function AC(e,t,r,n){var o=IC({},e);for(var i in e)if(!/^\$/.test(i)){var a=e[i];if(a&&BP(a)&&!t(a)){if(n.indexOf(a)>-1)throw new Error("Cannot convert circular structure to JSON");var s=AC(a,t,OC(r,[i]),OC(n,[a]));o[i]=s;var c=!1;for(var l in s)/^\$/.test(l)?c=!0:(o[i+"."+l]=s[l],delete o[i][l]);c||delete o[i]}}return o}function RC(e){return AC(e,CC,[],[e])}function PC(e,t,r){for(var n in t[r]||delete e[r],t)e[n]?WP(e[n])?e[n].push(t[n]):BP(e[n])?BP(t[n])?Object.assign(e[n],t[n]):(console.warn("unmergable condition, query is object but condition is "+qP(t)+", can only overwrite",t,r),e[n]=t[n]):(console.warn("to-merge query is of type "+qP(e)+", can only overwrite",e,t,r),e[n]=t[n]):e[n]=t[n]}function CC(e){return $P(e)||HP(e)||GP(e)}function kC(e){return xC(e)}var VC=function(){function e(){}return e.encode=function(t){return(new e).encodeUpdate(t)},e.prototype.encodeUpdate=function(e){return lC(e)?this.encodeUpdateCommand(e):"object"===qP(e)?this.encodeUpdateObject(e):e},e.prototype.encodeUpdateCommand=function(e){if(e.fieldName===SP)throw new Error("Cannot encode a comparison command with unset field name");switch(e.operator){case nC.PUSH:case nC.PULL:case nC.PULL_ALL:case nC.POP:case nC.SHIFT:case nC.UNSHIFT:case nC.ADD_TO_SET:return this.encodeArrayUpdateCommand(e);default:return this.encodeFieldUpdateCommand(e)}},e.prototype.encodeFieldUpdateCommand=function(e){var t,r,n,o,i=wC(e.operator);return e.operator===nC.REMOVE?((t={})[i]=((r={})[e.fieldName]="",r),t):((n={})[i]=((o={})[e.fieldName]=e.operands[0],o),n)},e.prototype.encodeArrayUpdateCommand=function(e){var t,r,n,o,i,a,s,c,l,u,d=wC(e.operator);switch(e.operator){case nC.PUSH:var f=void 0;return f=WP(e.operands)?{$each:e.operands.map(kC)}:e.operands,(t={})[d]=((r={})[e.fieldName]=f,r),t;case nC.UNSHIFT:f={$each:e.operands.map(kC),$position:0};return(n={})[d]=((o={})[e.fieldName]=f,o),n;case nC.POP:return(i={})[d]=((a={})[e.fieldName]=1,a),i;case nC.SHIFT:return(s={})[d]=((c={})[e.fieldName]=-1,c),s;default:return(l={})[d]=((u={})[e.fieldName]=kC(e.operands),u),l}},e.prototype.encodeUpdateObject=function(e){var t=RC(e);for(var r in t)if(!/^\$/.test(r)){var n=t[r];if(lC(n)){t[r]=n._setFieldName(r),PC(t,this.encodeUpdateCommand(t[r]),r)}else{t[r]=n=kC(n);var o=new cC(nC.SET,[n],r);PC(t,this.encodeUpdateCommand(o),r)}}return t},e}(),LC={};function UC(e){if(!WV.wsClientClass)throw new Error("to use realtime you must import realtime module first");var t=e.config.env;return LC[t]||(LC[t]=new WV.wsClientClass({context:{appConfig:{docSizeLimit:1e3,realtimePingInterval:1e4,realtimePongWaitTimeout:5e3,request:new WV.reqClass(e.config)}}})),LC[t]}var DC=function(){return DC=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},DC.apply(this,arguments)},jC=function(){function e(e,t,r,n){var o=this;void 0===n&&(n={}),this.watch=function(e){return UC(o._db).watch(DC(DC({},e),{envId:o._db.config.env,collectionName:o._coll,query:JSON.stringify({_id:o.id})}))},this._db=e,this._coll=t,this.id=r,this.request=new WV.reqClass(this._db.config),this.projection=n}return e.prototype.create=function(e,t){t=t||iC();var r={collectionName:this._coll,data:xC(e)};return this.id&&(r._id=this.id),this.request.send("database.addDocument",r).then(function(e){e.code?t(0,e):t(0,{id:e.data._id,requestId:e.requestId})}).catch(function(e){t(e)}),t.promise},e.prototype.set=function(e,t){if(t=t||iC(),!this.id)return Promise.resolve({code:"INVALID_PARAM",message:"docIdä¸èƒ½ä¸ºç©º"});if(!e||"object"!=typeof e)return Promise.resolve({code:"INVALID_PARAM",message:"å‚æ•°å¿…éœ€æ˜¯éç©ºå¯¹è±¡"});if(e.hasOwnProperty("_id"))return Promise.resolve({code:"INVALID_PARAM",message:"ä¸èƒ½æ›´æ–°_idçš„å€¼"});var r=!1,n=function(e){if("object"==typeof e)for(var t in e)e[t]instanceof cC?r=!0:"object"==typeof e[t]&&n(e[t])};if(n(e),r)return Promise.resolve({code:"DATABASE_REQUEST_FAILED",message:"update operator complicit"});var o={collectionName:this._coll,queryType:nP.DOC,data:xC(e),multi:!1,merge:!1,upsert:!0};return this.id&&(o.query={_id:this.id}),this.request.send("database.updateDocument",o).then(function(e){e.code?t(0,e):t(0,{updated:e.data.updated,upsertedId:e.data.upserted_id,requestId:e.requestId})}).catch(function(e){t(e)}),t.promise},e.prototype.update=function(e,t){if(t=t||iC(),!e||"object"!=typeof e)return Promise.resolve({code:"INVALID_PARAM",message:"å‚æ•°å¿…éœ€æ˜¯éç©ºå¯¹è±¡"});if(e.hasOwnProperty("_id"))return Promise.resolve({code:"INVALID_PARAM",message:"ä¸èƒ½æ›´æ–°_idçš„å€¼"});var r={_id:this.id},n={collectionName:this._coll,data:VC.encode(e),query:r,queryType:nP.DOC,multi:!1,merge:!0,upsert:!1};return this.request.send("database.updateDocument",n).then(function(e){e.code?t(0,e):t(0,{updated:e.data.updated,upsertedId:e.data.upserted_id,requestId:e.requestId})}).catch(function(e){t(e)}),t.promise},e.prototype.remove=function(e){e=e||iC();var t={_id:this.id},r={collectionName:this._coll,query:t,queryType:nP.DOC,multi:!1};return this.request.send("database.deleteDocument",r).then(function(t){t.code?e(0,t):e(0,{deleted:t.data.deleted,requestId:t.requestId})}).catch(function(t){e(t)}),e.promise},e.prototype.get=function(e){e=e||iC();var t={_id:this.id},r={collectionName:this._coll,query:t,queryType:nP.DOC,multi:!1,projection:this.projection};return this.request.send("database.queryDocument",r).then(function(t){if(t.code)e(0,t);else{var r=jP.formatResDocumentData(t.data.list);e(0,{data:r,requestId:t.requestId})}}).catch(function(t){e(t)}),e.promise},e.prototype.field=function(t){for(var r in t)t[r]?t[r]=1:t[r]=0;return new e(this._db,this._coll,this.id,t)},e}(),MC=function(){function e(){}return e.encode=function(e){return(new qC).encodeQuery(e)},e}(),qC=function(){function e(){}return e.prototype.encodeQuery=function(e,t){var r;return CC(e)?dC(e)?this.encodeLogicCommand(e):yC(e)?this.encodeQueryCommand(e):((r={})[t]=this.encodeQueryObject(e),r):BP(e)?this.encodeQueryObject(e):e},e.prototype.encodeRegExp=function(e){return{$regex:e.source,$options:e.flags}},e.prototype.encodeLogicCommand=function(e){var t,r,n,o,i,a,s,c=this;switch(e.operator){case aC.NOR:case aC.AND:case aC.OR:var l=wC(e.operator),u=e.operands.map(function(t){return c.encodeQuery(t,e.fieldName)});return(t={})[l]=u,t;case aC.NOT:l=wC(e.operator);var d=e.operands[0];if(GP(d))return(r={})[e.fieldName]=((n={})[l]=this.encodeRegExp(d),n),r;u=this.encodeQuery(d)[e.fieldName];return(o={})[e.fieldName]=((i={})[l]=u,i),o;default:l=wC(e.operator);if(1===e.operands.length){var f=this.encodeQuery(e.operands[0]);return(a={})[l]=f,a}u=e.operands.map(this.encodeQuery.bind(this));return(s={})[l]=u,s}},e.prototype.encodeQueryCommand=function(e){return vC(e),this.encodeComparisonCommand(e)},e.prototype.encodeComparisonCommand=function(e){var t,r,n,o,i,a,s,c,l;if(e.fieldName===SP)throw new Error("Cannot encode a comparison command with unset field name");var u=wC(e.operator);switch(e.operator){case fC.EQ:case fC.NEQ:case fC.LT:case fC.LTE:case fC.GT:case fC.GTE:case fC.ELEM_MATCH:case fC.EXISTS:case fC.SIZE:case fC.MOD:return(t={})[e.fieldName]=((r={})[u]=kC(e.operands[0]),r),t;case fC.IN:case fC.NIN:case fC.ALL:return(n={})[e.fieldName]=((o={})[u]=kC(e.operands),o),n;case fC.GEO_NEAR:var d=e.operands[0];return(i={})[e.fieldName]={$nearSphere:{$geometry:d.geometry.toJSON(),$maxDistance:d.maxDistance,$minDistance:d.minDistance}},i;case fC.GEO_WITHIN:d=e.operands[0];return(a={})[e.fieldName]={$geoWithin:{$geometry:d.geometry.toJSON()}},a;case fC.GEO_INTERSECTS:d=e.operands[0];return(s={})[e.fieldName]={$geoIntersects:{$geometry:d.geometry.toJSON()}},s;default:return(c={})[e.fieldName]=((l={})[u]=kC(e.operands[0]),l),c}},e.prototype.encodeQueryObject=function(e){var t=RC(e);for(var r in t){var n=t[r];if(dC(n)){t[r]=n._setFieldName(r);var o=this.encodeLogicCommand(t[r]);this.mergeConditionAfterEncode(t,o,r)}else if(vC(n)){t[r]=n._setFieldName(r);o=this.encodeComparisonCommand(t[r]);this.mergeConditionAfterEncode(t,o,r)}else CC(n)&&(t[r]=kC(n))}return t},e.prototype.mergeConditionAfterEncode=function(e,t,r){for(var n in t[r]||delete e[r],t)e[n]?WP(e[n])?e[n]=e[n].concat(t[n]):BP(e[n])?BP(t[n])?Object.assign(e,t):(console.warn("unmergable condition, query is object but condition is "+qP(t)+", can only overwrite",t,r),e[n]=t[n]):(console.warn("to-merge query is of type "+qP(e)+", can only overwrite",e,t,r),e[n]=t[n]):e[n]=t[n]},e}(),BC=function(){return BC=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},BC.apply(this,arguments)},FC=function(){function e(e,t,r,n,o){var i=this;this.watch=function(e){return UC(i._db).watch(BC(BC({},e),{envId:i._db.config.env,collectionName:i._coll,query:JSON.stringify(i._fieldFilters||{}),limit:i._queryOptions.limit,orderBy:i._fieldOrders?i._fieldOrders.reduce(function(e,t){return e[t.field]=t.direction,e},{}):void 0}))},this._db=e,this._coll=t,this._fieldFilters=r,this._fieldOrders=n||[],this._queryOptions=o||{},this._request=new WV.reqClass(this._db.config)}return e.prototype.get=function(e){e=e||iC();var t=[];this._fieldOrders&&this._fieldOrders.forEach(function(e){t.push(e)});var r={collectionName:this._coll,queryType:nP.WHERE};return this._fieldFilters&&(r.query=this._fieldFilters),t.length>0&&(r.order=t),this._queryOptions.offset&&(r.offset=this._queryOptions.offset),this._queryOptions.limit?r.limit=this._queryOptions.limit<1e3?this._queryOptions.limit:1e3:r.limit=100,this._queryOptions.projection&&(r.projection=this._queryOptions.projection),this._request.send("database.queryDocument",r).then(function(t){if(t.code)e(0,t);else{var r={data:jP.formatResDocumentData(t.data.list),requestId:t.requestId};t.total&&(r.total=t.total),t.limit&&(r.limit=t.limit),t.offset&&(r.offset=t.offset),e(0,r)}}).catch(function(t){e(t)}),e.promise},e.prototype.count=function(e){e=e||iC();var t={collectionName:this._coll,queryType:nP.WHERE};return this._fieldFilters&&(t.query=this._fieldFilters),this._request.send("database.countDocument",t).then(function(t){t.code?e(0,t):e(0,{requestId:t.requestId,total:t.data.total})}).catch(function(t){e(t)}),e.promise},e.prototype.where=function(t){if("Object"!==Object.prototype.toString.call(t).slice(8,-1))throw Error(YR.QueryParamTypeError);var r=Object.keys(t),n=r.some(function(e){return void 0!==t[e]});if(r.length&&!n)throw Error(YR.QueryParamValueError);return new e(this._db,this._coll,MC.encode(t),this._fieldOrders,this._queryOptions)},e.prototype.orderBy=function(t,r){MP.isFieldPath(t),MP.isFieldOrder(r);var n={field:t,direction:r},o=this._fieldOrders.concat(n);return new e(this._db,this._coll,this._fieldFilters,o,this._queryOptions)},e.prototype.limit=function(t){MP.isInteger("limit",t);var r=BC({},this._queryOptions);return r.limit=t,new e(this._db,this._coll,this._fieldFilters,this._fieldOrders,r)},e.prototype.skip=function(t){MP.isInteger("offset",t);var r=BC({},this._queryOptions);return r.offset=t,new e(this._db,this._coll,this._fieldFilters,this._fieldOrders,r)},e.prototype.update=function(e,t){if(t=t||iC(),!e||"object"!=typeof e)return Promise.resolve({code:"INVALID_PARAM",message:"å‚æ•°å¿…éœ€æ˜¯éç©ºå¯¹è±¡"});if(e.hasOwnProperty("_id"))return Promise.resolve({code:"INVALID_PARAM",message:"ä¸èƒ½æ›´æ–°_idçš„å€¼"});var r={collectionName:this._coll,query:this._fieldFilters,queryType:nP.WHERE,multi:!0,merge:!0,upsert:!1,data:VC.encode(e)};return this._request.send("database.updateDocument",r).then(function(e){e.code?t(0,e):t(0,{requestId:e.requestId,updated:e.data.updated,upsertId:e.data.upsert_id})}).catch(function(e){t(e)}),t.promise},e.prototype.field=function(t){for(var r in t)t[r]?"object"!=typeof t[r]&&(t[r]=1):t[r]=0;var n=BC({},this._queryOptions);return n.projection=t,new e(this._db,this._coll,this._fieldFilters,this._fieldOrders,n)},e.prototype.remove=function(e){e=e||iC(),Object.keys(this._queryOptions).length>0&&console.warn("`offset`, `limit` and `projection` are not supported in remove() operation"),this._fieldOrders.length>0&&console.warn("`orderBy` is not supported in remove() operation");var t={collectionName:this._coll,query:MC.encode(this._fieldFilters),queryType:nP.WHERE,multi:!0};return this._request.send("database.deleteDocument",t).then(function(t){t.code?e(0,t):e(0,{requestId:t.requestId,deleted:t.data.deleted})}).catch(function(t){e(t)}),e.promise},e}(),WC=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,62,0,62,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,63,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];const HC={getRandomValues(e){if(!(e instanceof Int8Array||e instanceof Uint8Array||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8ClampedArray))throw new Error("Expected an integer array");if(e.byteLength>65536)throw new Error("Can only request a maximum of 65536 bytes");var t;return function(e,t){for(var r,n=e.length,o="="===e[n-2]?2:"="===e[n-1]?1:0,i=0,a=n-o&4294967292,s=0;s<a;s+=4)r=WC[e.charCodeAt(s)]<<18|WC[e.charCodeAt(s+1)]<<12|WC[e.charCodeAt(s+2)]<<6|WC[e.charCodeAt(s+3)],t[i++]=r>>16&255,t[i++]=r>>8&255,t[i++]=255&r;1===o&&(r=WC[e.charCodeAt(s)]<<10|WC[e.charCodeAt(s+1)]<<4|WC[e.charCodeAt(s+2)]>>2,t[i++]=r>>8&255,t[i++]=255&r),2===o&&(r=WC[e.charCodeAt(s)]<<2|WC[e.charCodeAt(s+1)]>>4,t[i++]=255&r)}((t="DCloud-Crypto",weex.requireModule(t)).getRandomValues(e.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e}};for(var GC=function(e){var t=ZC(e),r=t[0],n=t[1];return 3*(r+n)/4-n},$C=function(e){var t,r,n=ZC(e),o=n[0],i=n[1],a=new YC(function(e,t,r){return 3*(t+r)/4-r}(0,o,i)),s=0,c=i>0?o-4:o;for(r=0;r<c;r+=4)t=JC[e.charCodeAt(r)]<<18|JC[e.charCodeAt(r+1)]<<12|JC[e.charCodeAt(r+2)]<<6|JC[e.charCodeAt(r+3)],a[s++]=t>>16&255,a[s++]=t>>8&255,a[s++]=255&t;2===i&&(t=JC[e.charCodeAt(r)]<<2|JC[e.charCodeAt(r+1)]>>4,a[s++]=255&t);1===i&&(t=JC[e.charCodeAt(r)]<<10|JC[e.charCodeAt(r+1)]<<4|JC[e.charCodeAt(r+2)]>>2,a[s++]=t>>8&255,a[s++]=255&t);return a},zC=function(e){for(var t,r=e.length,n=r%3,o=[],i=16383,a=0,s=r-n;a<s;a+=i)o.push(tk(e,a,a+i>s?s:a+i));1===n?(t=e[r-1],o.push(KC[t>>2]+KC[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],o.push(KC[t>>10]+KC[t>>4&63]+KC[t<<2&63]+"="));return o.join("")},KC=[],JC=[],YC="undefined"!=typeof Uint8Array?Uint8Array:Array,XC="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",QC=0;QC<64;++QC)KC[QC]=XC[QC],JC[XC.charCodeAt(QC)]=QC;function ZC(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function ek(e){return KC[e>>18&63]+KC[e>>12&63]+KC[e>>6&63]+KC[63&e]}function tk(e,t,r){for(var n,o=[],i=t;i<r;i+=3)n=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),o.push(ek(n));return o.join("")}JC["-".charCodeAt(0)]=62,JC["_".charCodeAt(0)]=63;var rk={byteLength:GC,toByteArray:$C,fromByteArray:zC},nk=function(e,t,r,n,o){var i,a,s=8*o-n-1,c=(1<<s)-1,l=c>>1,u=-7,d=r?o-1:0,f=r?-1:1,p=e[t+d];for(d+=f,i=p&(1<<-u)-1,p>>=-u,u+=s;u>0;i=256*i+e[t+d],d+=f,u-=8);for(a=i&(1<<-u)-1,i>>=-u,u+=n;u>0;a=256*a+e[t+d],d+=f,u-=8);if(0===i)i=1-l;else{if(i===c)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,n),i-=l}return(p?-1:1)*a*Math.pow(2,i-n)},ok=function(e,t,r,n,o,i){var a,s,c,l=8*i-o-1,u=(1<<l)-1,d=u>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:i-1,h=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+d>=1?f/c:f*Math.pow(2,1-d))*c>=2&&(a++,c/=2),a+d>=u?(s=0,a=u):a+d>=1?(s=(t*c-1)*Math.pow(2,o),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,o),a=0));o>=8;e[r+p]=255&s,p+=h,s/=256,o-=8);for(a=a<<o|s,l+=o;l>0;e[r+p]=255&a,p+=h,a/=256,l-=8);e[r+p-h]|=128*m},ik=function(e,t){return e(t={exports:{}},t.exports),t.exports}(function(e,t){var r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=i,t.SlowBuffer=function(e){+e!=e&&(e=0);return i.alloc(+e)},t.INSPECT_MAX_BYTES=50;var n=2147483647;function o(e){if(e>n)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,i.prototype),t}function i(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return c(e)}return a(e,t,r)}function a(e,t,r){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!i.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|f(e,t),n=o(r),a=n.write(e,t);a!==r&&(n=n.slice(0,a));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(j(e,Uint8Array)){var t=new Uint8Array(e);return u(t.buffer,t.byteOffset,t.byteLength)}return l(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+babelHelpers.typeof(e));if(j(e,ArrayBuffer)||e&&j(e.buffer,ArrayBuffer))return u(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(j(e,SharedArrayBuffer)||e&&j(e.buffer,SharedArrayBuffer)))return u(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return i.from(n,t,r);var a=function(e){if(i.isBuffer(e)){var t=0|d(e.length),r=o(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!=typeof e.length||M(e.length)?o(0):l(e);if("Buffer"===e.type&&Array.isArray(e.data))return l(e.data)}(e);if(a)return a;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return i.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+babelHelpers.typeof(e))}function s(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function c(e){return s(e),o(e<0?0:0|d(e))}function l(e){for(var t=e.length<0?0:0|d(e.length),r=o(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function u(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,i.prototype),n}function d(e){if(e>=n)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n.toString(16)+" bytes");return 0|e}function f(e,t){if(i.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||j(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+babelHelpers.typeof(e));var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var o=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return L(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return U(e).length;default:if(o)return n?-1:L(e).length;t=(""+t).toLowerCase(),o=!0}}function p(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return T(this,t,r);case"utf8":case"utf-8":return S(this,t,r);case"ascii":return N(this,t,r);case"latin1":case"binary":return I(this,t,r);case"base64":return _(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function h(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function m(e,t,r,n,o){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),M(r=+r)&&(r=o?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(o)return-1;r=e.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof t&&(t=i.from(t,n)),i.isBuffer(t))return 0===t.length?-1:y(e,t,r,n,o);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):y(e,[t],r,n,o);throw new TypeError("val must be string, number or Buffer")}function y(e,t,r,n,o){var i,a=1,s=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,c/=2,r/=2}function l(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(o){var u=-1;for(i=r;i<s;i++)if(l(e,i)===l(t,-1===u?0:i-u)){if(-1===u&&(u=i),i-u+1===c)return u*a}else-1!==u&&(i-=i-u),u=-1}else for(r+c>s&&(r=s-c),i=r;i>=0;i--){for(var d=!0,f=0;f<c;f++)if(l(e,i+f)!==l(t,f)){d=!1;break}if(d)return i}return-1}function v(e,t,r,n){r=Number(r)||0;var o=e.length-r;n?(n=Number(n))>o&&(n=o):n=o;var i=t.length;n>i/2&&(n=i/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(M(s))return a;e[r+a]=s}return a}function g(e,t,r,n){return D(L(t,e.length-r),e,r,n)}function b(e,t,r,n){return D(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function w(e,t,r,n){return D(U(t),e,r,n)}function E(e,t,r,n){return D(function(e,t){for(var r,n,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)n=(r=e.charCodeAt(a))>>8,o=r%256,i.push(o),i.push(n);return i}(t,e.length-r),e,r,n)}function _(e,t,r){return 0===t&&r===e.length?rk.fromByteArray(e):rk.fromByteArray(e.slice(t,r))}function S(e,t,r){r=Math.min(e.length,r);for(var n=[],o=t;o<r;){var i,a,s,c,l=e[o],u=null,d=l>239?4:l>223?3:l>191?2:1;if(o+d<=r)switch(d){case 1:l<128&&(u=l);break;case 2:128==(192&(i=e[o+1]))&&(c=(31&l)<<6|63&i)>127&&(u=c);break;case 3:i=e[o+1],a=e[o+2],128==(192&i)&&128==(192&a)&&(c=(15&l)<<12|(63&i)<<6|63&a)>2047&&(c<55296||c>57343)&&(u=c);break;case 4:i=e[o+1],a=e[o+2],s=e[o+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&(c=(15&l)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(u=c)}null===u?(u=65533,d=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),o+=d}return function(e){var t=e.length;if(t<=x)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=x));return r}(n)}t.kMaxLength=n,i.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(hL){return!1}}(),i.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(i.prototype,"parent",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.buffer}}),Object.defineProperty(i.prototype,"offset",{enumerable:!0,get:function(){if(i.isBuffer(this))return this.byteOffset}}),i.poolSize=8192,i.from=function(e,t,r){return a(e,t,r)},Object.setPrototypeOf(i.prototype,Uint8Array.prototype),Object.setPrototypeOf(i,Uint8Array),i.alloc=function(e,t,r){return function(e,t,r){return s(e),e<=0?o(e):void 0!==t?"string"==typeof r?o(e).fill(t,r):o(e).fill(t):o(e)}(e,t,r)},i.allocUnsafe=function(e){return c(e)},i.allocUnsafeSlow=function(e){return c(e)},i.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==i.prototype},i.compare=function(e,t){if(j(e,Uint8Array)&&(e=i.from(e,e.offset,e.byteLength)),j(t,Uint8Array)&&(t=i.from(t,t.offset,t.byteLength)),!i.isBuffer(e)||!i.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,o=0,a=Math.min(r,n);o<a;++o)if(e[o]!==t[o]){r=e[o],n=t[o];break}return r<n?-1:n<r?1:0},i.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},i.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return i.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=i.allocUnsafe(t),o=0;for(r=0;r<e.length;++r){var a=e[r];if(j(a,Uint8Array))o+a.length>n.length?i.from(a).copy(n,o):Uint8Array.prototype.set.call(n,a,o);else{if(!i.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(n,o)}o+=a.length}return n},i.byteLength=f,i.prototype._isBuffer=!0,i.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)h(this,t,t+1);return this},i.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)h(this,t,t+3),h(this,t+1,t+2);return this},i.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)h(this,t,t+7),h(this,t+1,t+6),h(this,t+2,t+5),h(this,t+3,t+4);return this},i.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?S(this,0,e):p.apply(this,arguments)},i.prototype.toLocaleString=i.prototype.toString,i.prototype.equals=function(e){if(!i.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===i.compare(this,e)},i.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},r&&(i.prototype[r]=i.prototype.inspect),i.prototype.compare=function(e,t,r,n,o){if(j(e,Uint8Array)&&(e=i.from(e,e.offset,e.byteLength)),!i.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+babelHelpers.typeof(e));if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),t<0||r>e.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&t>=r)return 0;if(n>=o)return-1;if(t>=r)return 1;if(this===e)return 0;for(var a=(o>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0),c=Math.min(a,s),l=this.slice(n,o),u=e.slice(t,r),d=0;d<c;++d)if(l[d]!==u[d]){a=l[d],s=u[d];break}return a<s?-1:s<a?1:0},i.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},i.prototype.indexOf=function(e,t,r){return m(this,e,t,r,!0)},i.prototype.lastIndexOf=function(e,t,r){return m(this,e,t,r,!1)},i.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o=this.length-t;if((void 0===r||r>o)&&(r=o),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return v(this,e,t,r);case"utf8":case"utf-8":return g(this,e,t,r);case"ascii":case"latin1":case"binary":return b(this,e,t,r);case"base64":return w(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},i.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var x=4096;function N(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(127&e[o]);return n}function I(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(e[o]);return n}function T(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var o="",i=t;i<r;++i)o+=q[e[i]];return o}function O(e,t,r){for(var n=e.slice(t,r),o="",i=0;i<n.length-1;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function A(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function R(e,t,r,n,o,a){if(!i.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<a)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function P(e,t,r,n,o,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function C(e,t,r,n,o){return t=+t,r>>>=0,o||P(e,0,r,4),ok(e,t,r,n,23,4),r+4}function k(e,t,r,n,o){return t=+t,r>>>=0,o||P(e,0,r,8),ok(e,t,r,n,52,8),r+8}i.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,i.prototype),n},i.prototype.readUintLE=i.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||A(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n},i.prototype.readUintBE=i.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||A(e,t,this.length);for(var n=this[e+--t],o=1;t>0&&(o*=256);)n+=this[e+--t]*o;return n},i.prototype.readUint8=i.prototype.readUInt8=function(e,t){return e>>>=0,t||A(e,1,this.length),this[e]},i.prototype.readUint16LE=i.prototype.readUInt16LE=function(e,t){return e>>>=0,t||A(e,2,this.length),this[e]|this[e+1]<<8},i.prototype.readUint16BE=i.prototype.readUInt16BE=function(e,t){return e>>>=0,t||A(e,2,this.length),this[e]<<8|this[e+1]},i.prototype.readUint32LE=i.prototype.readUInt32LE=function(e,t){return e>>>=0,t||A(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},i.prototype.readUint32BE=i.prototype.readUInt32BE=function(e,t){return e>>>=0,t||A(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},i.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||A(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*t)),n},i.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||A(e,t,this.length);for(var n=t,o=1,i=this[e+--n];n>0&&(o*=256);)i+=this[e+--n]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},i.prototype.readInt8=function(e,t){return e>>>=0,t||A(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},i.prototype.readInt16LE=function(e,t){e>>>=0,t||A(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},i.prototype.readInt16BE=function(e,t){e>>>=0,t||A(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},i.prototype.readInt32LE=function(e,t){return e>>>=0,t||A(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},i.prototype.readInt32BE=function(e,t){return e>>>=0,t||A(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},i.prototype.readFloatLE=function(e,t){return e>>>=0,t||A(e,4,this.length),nk(this,e,!0,23,4)},i.prototype.readFloatBE=function(e,t){return e>>>=0,t||A(e,4,this.length),nk(this,e,!1,23,4)},i.prototype.readDoubleLE=function(e,t){return e>>>=0,t||A(e,8,this.length),nk(this,e,!0,52,8)},i.prototype.readDoubleBE=function(e,t){return e>>>=0,t||A(e,8,this.length),nk(this,e,!1,52,8)},i.prototype.writeUintLE=i.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||R(this,e,t,r,Math.pow(2,8*r)-1,0);var o=1,i=0;for(this[t]=255&e;++i<r&&(o*=256);)this[t+i]=e/o&255;return t+r},i.prototype.writeUintBE=i.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||R(this,e,t,r,Math.pow(2,8*r)-1,0);var o=r-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+r},i.prototype.writeUint8=i.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,1,255,0),this[t]=255&e,t+1},i.prototype.writeUint16LE=i.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},i.prototype.writeUint16BE=i.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},i.prototype.writeUint32LE=i.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},i.prototype.writeUint32BE=i.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},i.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var o=Math.pow(2,8*r-1);R(this,e,t,r,o-1,-o)}var i=0,a=1,s=0;for(this[t]=255&e;++i<r&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a|0)-s&255;return t+r},i.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var o=Math.pow(2,8*r-1);R(this,e,t,r,o-1,-o)}var i=r-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a|0)-s&255;return t+r},i.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},i.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},i.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},i.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},i.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||R(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},i.prototype.writeFloatLE=function(e,t,r){return C(this,e,t,!0,r)},i.prototype.writeFloatBE=function(e,t,r){return C(this,e,t,!1,r)},i.prototype.writeDoubleLE=function(e,t,r){return k(this,e,t,!0,r)},i.prototype.writeDoubleBE=function(e,t,r){return k(this,e,t,!1,r)},i.prototype.copy=function(e,t,r,n){if(!i.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var o=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),o},i.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!i.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var o=e.charCodeAt(0);("utf8"===n&&o<128||"latin1"===n)&&(e=o)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var a;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(a=t;a<r;++a)this[a]=e;else{var s=i.isBuffer(e)?e:i.from(e,n),c=s.length;if(0===c)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<r-t;++a)this[a+t]=s[a%c]}return this};var V=/[^+/0-9A-Za-z-_]/g;function L(e,t){var r;t=t||1/0;for(var n=e.length,o=null,i=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!o){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function U(e){return rk.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(V,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function D(e,t,r,n){for(var o=0;o<n&&!(o+r>=t.length||o>=e.length);++o)t[o+r]=e[o];return o}function j(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function M(e){return e!=e}var q=function(){for(var e="0123456789abcdef",t=new Array(256),r=0;r<16;++r)for(var n=16*r,o=0;o<16;++o)t[n+o]=e[r]+e[o];return t}()}),ak=ik.Buffer;
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ik.SlowBuffer,ik.INSPECT_MAX_BYTES,ik.kMaxLength;
/*! *****************************************************************************
      Copyright (c) Microsoft Corporation.
  
      Permission to use, copy, modify, and/or distribute this software for any
      purpose with or without fee is hereby granted.
  
      THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
      REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
      AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
      INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
      LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
      OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
      PERFORMANCE OF THIS SOFTWARE.
      ***************************************************************************** */
var sk=function(e,t){return(sk=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function ck(e,t){function r(){this.constructor=e}sk(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var lk=function(e){function t(r){var n=e.call(this,r)||this;return Object.setPrototypeOf(n,t.prototype),n}return ck(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"BSONError"},enumerable:!1,configurable:!0}),t}(Error),uk=function(e){function t(r){var n=e.call(this,r)||this;return Object.setPrototypeOf(n,t.prototype),n}return ck(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"BSONTypeError"},enumerable:!1,configurable:!0}),t}(TypeError);function dk(e){return e&&e.Math==Math&&e}function fk(){return dk("object"==typeof globalThis&&globalThis)||dk("object"==typeof window&&window)||dk("object"==typeof self&&self)||dk("object"==typeof global&&global)||Function("return this")()}var pk=function(e){var t,r="object"==typeof(t=fk()).navigator&&"ReactNative"===t.navigator.product?"BSON: For React Native please polyfill crypto.getRandomValues, e.g. using: https://www.npmjs.com/package/react-native-get-random-values.":"BSON: No cryptographic implementation for random bytes present, falling back to a less secure implementation.";console.warn(r);for(var n=ak.alloc(e),o=0;o<e;++o)n[o]=Math.floor(256*Math.random());return n},hk=function(){if("undefined"!=typeof window){var e=HC||window.msCrypto;if(e&&e.getRandomValues)return function(t){return e.getRandomValues(ak.alloc(t))}}return"undefined"!=typeof global&&HC&&HC.getRandomValues?function(e){return HC.getRandomValues(ak.alloc(e))}:pk}();function mk(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)}function yk(e){return"object"==typeof e&&null!==e}function vk(e,t){var r=!1;return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return r||(console.warn(t),r=!0),e.apply(this,n)}}function gk(e){if(ArrayBuffer.isView(e))return ak.from(e.buffer,e.byteOffset,e.byteLength);if(t=e,["[object ArrayBuffer]","[object SharedArrayBuffer]"].includes(Object.prototype.toString.call(t)))return ak.from(e);var t;throw new uk("Must use either Buffer or TypedArray")}var bk=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|[0-9a-f]{12}4[0-9a-f]{3}[89ab][0-9a-f]{15})$/i,wk=function(e){return"string"==typeof e&&bk.test(e)},Ek=function(e){if(!wk(e))throw new uk('UUID string representations must be a 32 or 36 character hex string (dashes excluded/included). Format: "xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" or "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx".');var t=e.replace(/-/g,"");return ak.from(t,"hex")},_k=function(e,t){return void 0===t&&(t=!0),t?e.toString("hex",0,4)+"-"+e.toString("hex",4,6)+"-"+e.toString("hex",6,8)+"-"+e.toString("hex",8,10)+"-"+e.toString("hex",10,16):e.toString("hex")},Sk=Math.pow(2,53),xk=-Math.pow(2,53),Nk=function(){function e(t,r){if(!(this instanceof e))return new e(t,r);if(!(null==t||"string"==typeof t||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||Array.isArray(t)))throw new uk("Binary can only be constructed from string, Buffer, TypedArray, or Array<number>");this.sub_type=null!=r?r:e.BSON_BINARY_SUBTYPE_DEFAULT,null==t?(this.buffer=ak.alloc(e.BUFFER_SIZE),this.position=0):("string"==typeof t?this.buffer=ak.from(t,"binary"):Array.isArray(t)?this.buffer=ak.from(t):this.buffer=gk(t),this.position=this.buffer.byteLength)}return e.prototype.put=function(t){if("string"==typeof t&&1!==t.length)throw new uk("only accepts single character String");if("number"!=typeof t&&1!==t.length)throw new uk("only accepts single character Uint8Array or Array");var r;if((r="string"==typeof t?t.charCodeAt(0):"number"==typeof t?t:t[0])<0||r>255)throw new uk("only accepts number in a valid unsigned byte range 0-255");if(this.buffer.length>this.position)this.buffer[this.position++]=r;else{var n=ak.alloc(e.BUFFER_SIZE+this.buffer.length);this.buffer.copy(n,0,0,this.buffer.length),this.buffer=n,this.buffer[this.position++]=r}},e.prototype.write=function(e,t){if(t="number"==typeof t?t:this.position,this.buffer.length<t+e.length){var r=ak.alloc(this.buffer.length+e.length);this.buffer.copy(r,0,0,this.buffer.length),this.buffer=r}ArrayBuffer.isView(e)?(this.buffer.set(gk(e),t),this.position=t+e.byteLength>this.position?t+e.length:this.position):"string"==typeof e&&(this.buffer.write(e,t,e.length,"binary"),this.position=t+e.length>this.position?t+e.length:this.position)},e.prototype.read=function(e,t){return t=t&&t>0?t:this.position,this.buffer.slice(e,e+t)},e.prototype.value=function(e){return(e=!!e)&&this.buffer.length===this.position?this.buffer:e?this.buffer.slice(0,this.position):this.buffer.toString("binary",0,this.position)},e.prototype.length=function(){return this.position},e.prototype.toJSON=function(){return this.buffer.toString("base64")},e.prototype.toString=function(e){return this.buffer.toString(e)},e.prototype.toExtendedJSON=function(e){e=e||{};var t=this.buffer.toString("base64"),r=Number(this.sub_type).toString(16);return e.legacy?{$binary:t,$type:1===r.length?"0"+r:r}:{$binary:{base64:t,subType:1===r.length?"0"+r:r}}},e.prototype.toUUID=function(){if(this.sub_type===e.SUBTYPE_UUID)return new Ik(this.buffer.slice(0,this.position));throw new lk('Binary sub_type "'.concat(this.sub_type,'" is not supported for converting to UUID. Only "').concat(e.SUBTYPE_UUID,'" is currently supported.'))},e.fromExtendedJSON=function(t,r){var n,o;if(r=r||{},"$binary"in t?r.legacy&&"string"==typeof t.$binary&&"$type"in t?(o=t.$type?parseInt(t.$type,16):0,n=ak.from(t.$binary,"base64")):"string"!=typeof t.$binary&&(o=t.$binary.subType?parseInt(t.$binary.subType,16):0,n=ak.from(t.$binary.base64,"base64")):"$uuid"in t&&(o=4,n=Ek(t.$uuid)),!n)throw new uk("Unexpected Binary Extended JSON format ".concat(JSON.stringify(t)));return 4===o?new Ik(n):new e(n,o)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var e=this.value(!0);return'new Binary(Buffer.from("'.concat(e.toString("hex"),'", "hex"), ').concat(this.sub_type,")")},e.BSON_BINARY_SUBTYPE_DEFAULT=0,e.BUFFER_SIZE=256,e.SUBTYPE_DEFAULT=0,e.SUBTYPE_FUNCTION=1,e.SUBTYPE_BYTE_ARRAY=2,e.SUBTYPE_UUID_OLD=3,e.SUBTYPE_UUID=4,e.SUBTYPE_MD5=5,e.SUBTYPE_ENCRYPTED=6,e.SUBTYPE_COLUMN=7,e.SUBTYPE_USER_DEFINED=128,e}();Object.defineProperty(Nk.prototype,"_bsontype",{value:"Binary"});var Ik=function(e){function t(r){var n,o,i=this;if(null==r)n=t.generate();else if(r instanceof t)n=ak.from(r.buffer),o=r.__id;else if(ArrayBuffer.isView(r)&&16===r.byteLength)n=gk(r);else{if("string"!=typeof r)throw new uk("Argument passed in UUID constructor must be a UUID, a 16 byte Buffer or a 32/36 character hex string (dashes excluded/included, format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx).");n=Ek(r)}return(i=e.call(this,n,4)||this).__id=o,i}return ck(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this.buffer},set:function(e){this.buffer=e,t.cacheHexString&&(this.__id=_k(e))},enumerable:!1,configurable:!0}),t.prototype.toHexString=function(e){if(void 0===e&&(e=!0),t.cacheHexString&&this.__id)return this.__id;var r=_k(this.id,e);return t.cacheHexString&&(this.__id=r),r},t.prototype.toString=function(e){return e?this.id.toString(e):this.toHexString()},t.prototype.toJSON=function(){return this.toHexString()},t.prototype.equals=function(e){if(!e)return!1;if(e instanceof t)return e.id.equals(this.id);try{return new t(e).id.equals(this.id)}catch(r){return!1}},t.prototype.toBinary=function(){return new Nk(this.id,Nk.SUBTYPE_UUID)},t.generate=function(){var e=hk(16);return e[6]=15&e[6]|64,e[8]=63&e[8]|128,ak.from(e)},t.isValid=function(e){return!!e&&(e instanceof t||("string"==typeof e?wk(e):!!mk(e)&&(16===e.length&&(64==(240&e[6])&&!(128&~e[8])))))},t.createFromHexString=function(e){return new t(Ek(e))},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return'new UUID("'.concat(this.toHexString(),'")')},t}(Nk),Tk=function(){function e(t,r){if(!(this instanceof e))return new e(t,r);this.code=t,this.scope=r}return e.prototype.toJSON=function(){return{code:this.code,scope:this.scope}},e.prototype.toExtendedJSON=function(){return this.scope?{$code:this.code,$scope:this.scope}:{$code:this.code}},e.fromExtendedJSON=function(t){return new e(t.$code,t.$scope)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var e=this.toJSON();return'new Code("'.concat(String(e.code),'"').concat(e.scope?", ".concat(JSON.stringify(e.scope)):"",")")},e}();Object.defineProperty(Tk.prototype,"_bsontype",{value:"Code"});var Ok=function(){function e(t,r,n,o){if(!(this instanceof e))return new e(t,r,n,o);var i=t.split(".");2===i.length&&(n=i.shift(),t=i.shift()),this.collection=t,this.oid=r,this.db=n,this.fields=o||{}}return Object.defineProperty(e.prototype,"namespace",{get:function(){return this.collection},set:function(e){this.collection=e},enumerable:!1,configurable:!0}),e.prototype.toJSON=function(){var e=Object.assign({$ref:this.collection,$id:this.oid},this.fields);return null!=this.db&&(e.$db=this.db),e},e.prototype.toExtendedJSON=function(e){e=e||{};var t={$ref:this.collection,$id:this.oid};return e.legacy?t:(this.db&&(t.$db=this.db),t=Object.assign(t,this.fields))},e.fromExtendedJSON=function(t){var r=Object.assign({},t);return delete r.$ref,delete r.$id,delete r.$db,new e(t.$ref,t.$id,t.$db,r)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var e=void 0===this.oid||void 0===this.oid.toString?this.oid:this.oid.toString();return'new DBRef("'.concat(this.namespace,'", new ObjectId("').concat(String(e),'")').concat(this.db?', "'.concat(this.db,'"'):"",")")},e}();Object.defineProperty(Ok.prototype,"_bsontype",{value:"DBRef"});var Ak=void 0;try{Ak=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(mL){}var Rk=4294967296,Pk=0x10000000000000000,Ck=Pk/2,kk={},Vk={},Lk=function(){function e(t,r,n){if(void 0===t&&(t=0),!(this instanceof e))return new e(t,r,n);"bigint"==typeof t?Object.assign(this,e.fromBigInt(t,!!r)):"string"==typeof t?Object.assign(this,e.fromString(t,!!r)):(this.low=0|t,this.high=0|r,this.unsigned=!!n),Object.defineProperty(this,"__isLong__",{value:!0,configurable:!1,writable:!1,enumerable:!1})}return e.fromBits=function(t,r,n){return new e(t,r,n)},e.fromInt=function(t,r){var n,o,i;return r?(i=0<=(t>>>=0)&&t<256)&&(o=Vk[t])?o:(n=e.fromBits(t,(0|t)<0?-1:0,!0),i&&(Vk[t]=n),n):(i=-128<=(t|=0)&&t<128)&&(o=kk[t])?o:(n=e.fromBits(t,t<0?-1:0,!1),i&&(kk[t]=n),n)},e.fromNumber=function(t,r){if(isNaN(t))return r?e.UZERO:e.ZERO;if(r){if(t<0)return e.UZERO;if(t>=Pk)return e.MAX_UNSIGNED_VALUE}else{if(t<=-Ck)return e.MIN_VALUE;if(t+1>=Ck)return e.MAX_VALUE}return t<0?e.fromNumber(-t,r).neg():e.fromBits(t%Rk|0,t/Rk|0,r)},e.fromBigInt=function(t,r){return e.fromString(t.toString(),r)},e.fromString=function(t,r,n){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return e.ZERO;if("number"==typeof r?(n=r,r=!1):r=!!r,(n=n||10)<2||36<n)throw RangeError("radix");var o;if((o=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===o)return e.fromString(t.substring(1),r,n).neg();for(var i=e.fromNumber(Math.pow(n,8)),a=e.ZERO,s=0;s<t.length;s+=8){var c=Math.min(8,t.length-s),l=parseInt(t.substring(s,s+c),n);if(c<8){var u=e.fromNumber(Math.pow(n,c));a=a.mul(u).add(e.fromNumber(l))}else a=(a=a.mul(i)).add(e.fromNumber(l))}return a.unsigned=r,a},e.fromBytes=function(t,r,n){return n?e.fromBytesLE(t,r):e.fromBytesBE(t,r)},e.fromBytesLE=function(t,r){return new e(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,r)},e.fromBytesBE=function(t,r){return new e(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],r)},e.isLong=function(e){return yk(e)&&!0===e.__isLong__},e.fromValue=function(t,r){return"number"==typeof t?e.fromNumber(t,r):"string"==typeof t?e.fromString(t,r):e.fromBits(t.low,t.high,"boolean"==typeof r?r:t.unsigned)},e.prototype.add=function(t){e.isLong(t)||(t=e.fromValue(t));var r=this.high>>>16,n=65535&this.high,o=this.low>>>16,i=65535&this.low,a=t.high>>>16,s=65535&t.high,c=t.low>>>16,l=0,u=0,d=0,f=0;return d+=(f+=i+(65535&t.low))>>>16,f&=65535,u+=(d+=o+c)>>>16,d&=65535,l+=(u+=n+s)>>>16,u&=65535,l+=r+a,l&=65535,e.fromBits(d<<16|f,l<<16|u,this.unsigned)},e.prototype.and=function(t){return e.isLong(t)||(t=e.fromValue(t)),e.fromBits(this.low&t.low,this.high&t.high,this.unsigned)},e.prototype.compare=function(t){if(e.isLong(t)||(t=e.fromValue(t)),this.eq(t))return 0;var r=this.isNegative(),n=t.isNegative();return r&&!n?-1:!r&&n?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},e.prototype.comp=function(e){return this.compare(e)},e.prototype.divide=function(t){if(e.isLong(t)||(t=e.fromValue(t)),t.isZero())throw Error("division by zero");if(Ak){if(!this.unsigned&&-2147483648===this.high&&-1===t.low&&-1===t.high)return this;var r=(this.unsigned?Ak.div_u:Ak.div_s)(this.low,this.high,t.low,t.high);return e.fromBits(r,Ak.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?e.UZERO:e.ZERO;var n,o,i;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return e.UZERO;if(t.gt(this.shru(1)))return e.UONE;i=e.UZERO}else{if(this.eq(e.MIN_VALUE))return t.eq(e.ONE)||t.eq(e.NEG_ONE)?e.MIN_VALUE:t.eq(e.MIN_VALUE)?e.ONE:(n=this.shr(1).div(t).shl(1)).eq(e.ZERO)?t.isNegative()?e.ONE:e.NEG_ONE:(o=this.sub(t.mul(n)),i=n.add(o.div(t)));if(t.eq(e.MIN_VALUE))return this.unsigned?e.UZERO:e.ZERO;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();i=e.ZERO}for(o=this;o.gte(t);){n=Math.max(1,Math.floor(o.toNumber()/t.toNumber()));for(var a=Math.ceil(Math.log(n)/Math.LN2),s=a<=48?1:Math.pow(2,a-48),c=e.fromNumber(n),l=c.mul(t);l.isNegative()||l.gt(o);)n-=s,l=(c=e.fromNumber(n,this.unsigned)).mul(t);c.isZero()&&(c=e.ONE),i=i.add(c),o=o.sub(l)}return i},e.prototype.div=function(e){return this.divide(e)},e.prototype.equals=function(t){return e.isLong(t)||(t=e.fromValue(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&(this.high===t.high&&this.low===t.low)},e.prototype.eq=function(e){return this.equals(e)},e.prototype.getHighBits=function(){return this.high},e.prototype.getHighBitsUnsigned=function(){return this.high>>>0},e.prototype.getLowBits=function(){return this.low},e.prototype.getLowBitsUnsigned=function(){return this.low>>>0},e.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.eq(e.MIN_VALUE)?64:this.neg().getNumBitsAbs();var t,r=0!==this.high?this.high:this.low;for(t=31;t>0&&!(r&1<<t);t--);return 0!==this.high?t+33:t+1},e.prototype.greaterThan=function(e){return this.comp(e)>0},e.prototype.gt=function(e){return this.greaterThan(e)},e.prototype.greaterThanOrEqual=function(e){return this.comp(e)>=0},e.prototype.gte=function(e){return this.greaterThanOrEqual(e)},e.prototype.ge=function(e){return this.greaterThanOrEqual(e)},e.prototype.isEven=function(){return!(1&this.low)},e.prototype.isNegative=function(){return!this.unsigned&&this.high<0},e.prototype.isOdd=function(){return!(1&~this.low)},e.prototype.isPositive=function(){return this.unsigned||this.high>=0},e.prototype.isZero=function(){return 0===this.high&&0===this.low},e.prototype.lessThan=function(e){return this.comp(e)<0},e.prototype.lt=function(e){return this.lessThan(e)},e.prototype.lessThanOrEqual=function(e){return this.comp(e)<=0},e.prototype.lte=function(e){return this.lessThanOrEqual(e)},e.prototype.modulo=function(t){if(e.isLong(t)||(t=e.fromValue(t)),Ak){var r=(this.unsigned?Ak.rem_u:Ak.rem_s)(this.low,this.high,t.low,t.high);return e.fromBits(r,Ak.get_high(),this.unsigned)}return this.sub(this.div(t).mul(t))},e.prototype.mod=function(e){return this.modulo(e)},e.prototype.rem=function(e){return this.modulo(e)},e.prototype.multiply=function(t){if(this.isZero())return e.ZERO;if(e.isLong(t)||(t=e.fromValue(t)),Ak){var r=Ak.mul(this.low,this.high,t.low,t.high);return e.fromBits(r,Ak.get_high(),this.unsigned)}if(t.isZero())return e.ZERO;if(this.eq(e.MIN_VALUE))return t.isOdd()?e.MIN_VALUE:e.ZERO;if(t.eq(e.MIN_VALUE))return this.isOdd()?e.MIN_VALUE:e.ZERO;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(e.TWO_PWR_24)&&t.lt(e.TWO_PWR_24))return e.fromNumber(this.toNumber()*t.toNumber(),this.unsigned);var n=this.high>>>16,o=65535&this.high,i=this.low>>>16,a=65535&this.low,s=t.high>>>16,c=65535&t.high,l=t.low>>>16,u=65535&t.low,d=0,f=0,p=0,h=0;return p+=(h+=a*u)>>>16,h&=65535,f+=(p+=i*u)>>>16,p&=65535,f+=(p+=a*l)>>>16,p&=65535,d+=(f+=o*u)>>>16,f&=65535,d+=(f+=i*l)>>>16,f&=65535,d+=(f+=a*c)>>>16,f&=65535,d+=n*u+o*l+i*c+a*s,d&=65535,e.fromBits(p<<16|h,d<<16|f,this.unsigned)},e.prototype.mul=function(e){return this.multiply(e)},e.prototype.negate=function(){return!this.unsigned&&this.eq(e.MIN_VALUE)?e.MIN_VALUE:this.not().add(e.ONE)},e.prototype.neg=function(){return this.negate()},e.prototype.not=function(){return e.fromBits(~this.low,~this.high,this.unsigned)},e.prototype.notEquals=function(e){return!this.equals(e)},e.prototype.neq=function(e){return this.notEquals(e)},e.prototype.ne=function(e){return this.notEquals(e)},e.prototype.or=function(t){return e.isLong(t)||(t=e.fromValue(t)),e.fromBits(this.low|t.low,this.high|t.high,this.unsigned)},e.prototype.shiftLeft=function(t){return e.isLong(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?e.fromBits(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):e.fromBits(0,this.low<<t-32,this.unsigned)},e.prototype.shl=function(e){return this.shiftLeft(e)},e.prototype.shiftRight=function(t){return e.isLong(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?e.fromBits(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):e.fromBits(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},e.prototype.shr=function(e){return this.shiftRight(e)},e.prototype.shiftRightUnsigned=function(t){if(e.isLong(t)&&(t=t.toInt()),0===(t&=63))return this;var r=this.high;if(t<32){var n=this.low;return e.fromBits(n>>>t|r<<32-t,r>>>t,this.unsigned)}return 32===t?e.fromBits(r,0,this.unsigned):e.fromBits(r>>>t-32,0,this.unsigned)},e.prototype.shr_u=function(e){return this.shiftRightUnsigned(e)},e.prototype.shru=function(e){return this.shiftRightUnsigned(e)},e.prototype.subtract=function(t){return e.isLong(t)||(t=e.fromValue(t)),this.add(t.neg())},e.prototype.sub=function(e){return this.subtract(e)},e.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low},e.prototype.toNumber=function(){return this.unsigned?(this.high>>>0)*Rk+(this.low>>>0):this.high*Rk+(this.low>>>0)},e.prototype.toBigInt=function(){return BigInt(this.toString())},e.prototype.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},e.prototype.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},e.prototype.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},e.prototype.toSigned=function(){return this.unsigned?e.fromBits(this.low,this.high,!1):this},e.prototype.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(e.MIN_VALUE)){var r=e.fromNumber(t),n=this.div(r),o=n.mul(r).sub(this);return n.toString(t)+o.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var i=e.fromNumber(Math.pow(t,6),this.unsigned),a=this,s="";;){var c=a.div(i),l=(a.sub(c.mul(i)).toInt()>>>0).toString(t);if((a=c).isZero())return l+s;for(;l.length<6;)l="0"+l;s=""+l+s}},e.prototype.toUnsigned=function(){return this.unsigned?this:e.fromBits(this.low,this.high,!0)},e.prototype.xor=function(t){return e.isLong(t)||(t=e.fromValue(t)),e.fromBits(this.low^t.low,this.high^t.high,this.unsigned)},e.prototype.eqz=function(){return this.isZero()},e.prototype.le=function(e){return this.lessThanOrEqual(e)},e.prototype.toExtendedJSON=function(e){return e&&e.relaxed?this.toNumber():{$numberLong:this.toString()}},e.fromExtendedJSON=function(t,r){var n=e.fromString(t.$numberLong);return r&&r.relaxed?n.toNumber():n},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return'new Long("'.concat(this.toString(),'"').concat(this.unsigned?", true":"",")")},e.TWO_PWR_24=e.fromInt(16777216),e.MAX_UNSIGNED_VALUE=e.fromBits(-1,-1,!0),e.ZERO=e.fromInt(0),e.UZERO=e.fromInt(0,!0),e.ONE=e.fromInt(1),e.UONE=e.fromInt(1,!0),e.NEG_ONE=e.fromInt(-1),e.MAX_VALUE=e.fromBits(-1,2147483647,!1),e.MIN_VALUE=e.fromBits(0,-2147483648,!1),e}();Object.defineProperty(Lk.prototype,"__isLong__",{value:!0}),Object.defineProperty(Lk.prototype,"_bsontype",{value:"Long"});var Uk=/^(\+|-)?(\d+|(\d*\.\d*))?(E|e)?([-+])?(\d+)?$/,Dk=/^(\+|-)?(Infinity|inf)$/i,jk=/^(\+|-)?NaN$/i,Mk=6111,qk=-6176,Bk=[124,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),Fk=[248,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),Wk=[120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0].reverse(),Hk=/^([-+])?(\d+)?$/;function Gk(e){return!isNaN(parseInt(e,10))}function $k(e){var t=Lk.fromNumber(1e9),r=Lk.fromNumber(0);if(!(e.parts[0]||e.parts[1]||e.parts[2]||e.parts[3]))return{quotient:e,rem:r};for(var n=0;n<=3;n++)r=(r=r.shiftLeft(32)).add(new Lk(e.parts[n],0)),e.parts[n]=r.div(t).low,r=r.modulo(t);return{quotient:e,rem:r}}function zk(e,t){throw new uk('"'.concat(e,'" is not a valid Decimal128 string - ').concat(t))}var Kk=function(){function e(t){if(!(this instanceof e))return new e(t);if("string"==typeof t)this.bytes=e.fromString(t).bytes;else{if(!mk(t))throw new uk("Decimal128 must take a Buffer or string");if(16!==t.byteLength)throw new uk("Decimal128 must take a Buffer of 16 bytes");this.bytes=t}}return e.fromString=function(t){var r,n=!1,o=!1,i=!1,a=0,s=0,c=0,l=0,u=0,d=[0],f=0,p=0,h=0,m=0,y=0,v=0,g=new Lk(0,0),b=new Lk(0,0),w=0;if(t.length>=7e3)throw new uk(t+" not a valid Decimal128 string");var E=t.match(Uk),_=t.match(Dk),S=t.match(jk);if(!E&&!_&&!S||0===t.length)throw new uk(t+" not a valid Decimal128 string");if(E){var x=E[2],N=E[4],I=E[5],T=E[6];N&&void 0===T&&zk(t,"missing exponent power"),N&&void 0===x&&zk(t,"missing exponent base"),void 0===N&&(I||T)&&zk(t,"missing e before exponent")}if("+"!==t[w]&&"-"!==t[w]||(n="-"===t[w++]),!Gk(t[w])&&"."!==t[w]){if("i"===t[w]||"I"===t[w])return new e(ak.from(n?Fk:Wk));if("N"===t[w])return new e(ak.from(Bk))}for(;Gk(t[w])||"."===t[w];)"."!==t[w]?(f<34&&("0"!==t[w]||i)&&(i||(u=s),i=!0,d[p++]=parseInt(t[w],10),f+=1),i&&(c+=1),o&&(l+=1),s+=1,w+=1):(o&&zk(t,"contains multiple periods"),o=!0,w+=1);if(o&&!s)throw new uk(t+" not a valid Decimal128 string");if("e"===t[w]||"E"===t[w]){var O=t.substr(++w).match(Hk);if(!O||!O[2])return new e(ak.from(Bk));y=parseInt(O[0],10),w+=O[0].length}if(t[w])return new e(ak.from(Bk));if(h=0,f){if(m=f-1,1!==(a=c))for(;0===d[u+a-1];)a-=1}else h=0,m=0,d[0]=0,c=1,f=1,a=0;for(y<=l&&l-y>16384?y=qk:y-=l;y>Mk;){if((m+=1)-h>34){if(d.join("").match(/^0+$/)){y=Mk;break}zk(t,"overflow")}y-=1}for(;y<qk||f<c;){if(0===m&&a<f){y=qk,a=0;break}if(f<c?c-=1:m-=1,y<Mk)y+=1;else{if(d.join("").match(/^0+$/)){y=Mk;break}zk(t,"overflow")}}if(m-h+1<a){var A=s;o&&(u+=1,A+=1),n&&(u+=1,A+=1);var R=parseInt(t[u+m+1],10),P=0;if(R>=5&&(P=1,5===R))for(P=d[m]%2==1?1:0,v=u+m+2;v<A;v++)if(parseInt(t[v],10)){P=1;break}if(P)for(var C=m;C>=0;C--)if(++d[C]>9&&(d[C]=0,0===C)){if(!(y<Mk))return new e(ak.from(n?Fk:Wk));y+=1,d[C]=1}}if(g=Lk.fromNumber(0),b=Lk.fromNumber(0),0===a)g=Lk.fromNumber(0),b=Lk.fromNumber(0);else if(m-h<17){C=h;for(b=Lk.fromNumber(d[C++]),g=new Lk(0,0);C<=m;C++)b=(b=b.multiply(Lk.fromNumber(10))).add(Lk.fromNumber(d[C]))}else{C=h;for(g=Lk.fromNumber(d[C++]);C<=m-17;C++)g=(g=g.multiply(Lk.fromNumber(10))).add(Lk.fromNumber(d[C]));for(b=Lk.fromNumber(d[C++]);C<=m;C++)b=(b=b.multiply(Lk.fromNumber(10))).add(Lk.fromNumber(d[C]))}var k,V,L,U,D=function(e,t){if(!e&&!t)return{high:Lk.fromNumber(0),low:Lk.fromNumber(0)};var r=e.shiftRightUnsigned(32),n=new Lk(e.getLowBits(),0),o=t.shiftRightUnsigned(32),i=new Lk(t.getLowBits(),0),a=r.multiply(o),s=r.multiply(i),c=n.multiply(o),l=n.multiply(i);return a=a.add(s.shiftRightUnsigned(32)),s=new Lk(s.getLowBits(),0).add(c).add(l.shiftRightUnsigned(32)),{high:a=a.add(s.shiftRightUnsigned(32)),low:l=s.shiftLeft(32).add(new Lk(l.getLowBits(),0))}}(g,Lk.fromString("100000000000000000"));D.low=D.low.add(b),k=D.low,V=b,L=k.high>>>0,U=V.high>>>0,(L<U||L===U&&k.low>>>0<V.low>>>0)&&(D.high=D.high.add(Lk.fromNumber(1))),r=y+6176;var j={low:Lk.fromNumber(0),high:Lk.fromNumber(0)};D.high.shiftRightUnsigned(49).and(Lk.fromNumber(1)).equals(Lk.fromNumber(1))?(j.high=j.high.or(Lk.fromNumber(3).shiftLeft(61)),j.high=j.high.or(Lk.fromNumber(r).and(Lk.fromNumber(16383).shiftLeft(47))),j.high=j.high.or(D.high.and(Lk.fromNumber(0x7fffffffffff)))):(j.high=j.high.or(Lk.fromNumber(16383&r).shiftLeft(49)),j.high=j.high.or(D.high.and(Lk.fromNumber(562949953421311)))),j.low=D.low,n&&(j.high=j.high.or(Lk.fromString("9223372036854775808")));var M=ak.alloc(16);return w=0,M[w++]=255&j.low.low,M[w++]=j.low.low>>8&255,M[w++]=j.low.low>>16&255,M[w++]=j.low.low>>24&255,M[w++]=255&j.low.high,M[w++]=j.low.high>>8&255,M[w++]=j.low.high>>16&255,M[w++]=j.low.high>>24&255,M[w++]=255&j.high.low,M[w++]=j.high.low>>8&255,M[w++]=j.high.low>>16&255,M[w++]=j.high.low>>24&255,M[w++]=255&j.high.high,M[w++]=j.high.high>>8&255,M[w++]=j.high.high>>16&255,M[w++]=j.high.high>>24&255,new e(M)},e.prototype.toString=function(){for(var e,t=0,r=new Array(36),n=0;n<r.length;n++)r[n]=0;var o,i,a,s=0,c=!1,l={parts:[0,0,0,0]},u=[];s=0;var d=this.bytes,f=d[s++]|d[s++]<<8|d[s++]<<16|d[s++]<<24,p=d[s++]|d[s++]<<8|d[s++]<<16|d[s++]<<24,h=d[s++]|d[s++]<<8|d[s++]<<16|d[s++]<<24,m=d[s++]|d[s++]<<8|d[s++]<<16|d[s++]<<24;s=0,{low:new Lk(f,p),high:new Lk(h,m)}.high.lessThan(Lk.ZERO)&&u.push("-");var y=m>>26&31;if(y>>3==3){if(30===y)return u.join("")+"Infinity";if(31===y)return"NaN";e=m>>15&16383,o=8+(m>>14&1)}else o=m>>14&7,e=m>>17&16383;var v=e-6176;if(l.parts[0]=(16383&m)+((15&o)<<14),l.parts[1]=h,l.parts[2]=p,l.parts[3]=f,0===l.parts[0]&&0===l.parts[1]&&0===l.parts[2]&&0===l.parts[3])c=!0;else for(a=3;a>=0;a--){var g=0,b=$k(l);if(l=b.quotient,g=b.rem.low)for(i=8;i>=0;i--)r[9*a+i]=g%10,g=Math.floor(g/10)}if(c)t=1,r[s]=0;else for(t=36;!r[s];)t-=1,s+=1;var w=t-1+v;if(w>=34||w<=-7||v>0){if(t>34)return u.push("".concat(0)),v>0?u.push("E+".concat(v)):v<0&&u.push("E".concat(v)),u.join("");u.push("".concat(r[s++])),(t-=1)&&u.push(".");for(n=0;n<t;n++)u.push("".concat(r[s++]));u.push("E"),w>0?u.push("+".concat(w)):u.push("".concat(w))}else if(v>=0)for(n=0;n<t;n++)u.push("".concat(r[s++]));else{var E=t+v;if(E>0)for(n=0;n<E;n++)u.push("".concat(r[s++]));else u.push("0");for(u.push(".");E++<0;)u.push("0");for(n=0;n<t-Math.max(E-1,0);n++)u.push("".concat(r[s++]))}return u.join("")},e.prototype.toJSON=function(){return{$numberDecimal:this.toString()}},e.prototype.toExtendedJSON=function(){return{$numberDecimal:this.toString()}},e.fromExtendedJSON=function(t){return e.fromString(t.$numberDecimal)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return'new Decimal128("'.concat(this.toString(),'")')},e}();Object.defineProperty(Kk.prototype,"_bsontype",{value:"Decimal128"});var Jk=function(){function e(t){if(!(this instanceof e))return new e(t);t instanceof Number&&(t=t.valueOf()),this.value=+t}return e.prototype.valueOf=function(){return this.value},e.prototype.toJSON=function(){return this.value},e.prototype.toString=function(e){return this.value.toString(e)},e.prototype.toExtendedJSON=function(e){return e&&(e.legacy||e.relaxed&&isFinite(this.value))?this.value:Object.is(Math.sign(this.value),-0)?{$numberDouble:"-".concat(this.value.toFixed(1))}:{$numberDouble:Number.isInteger(this.value)?this.value.toFixed(1):this.value.toString()}},e.fromExtendedJSON=function(t,r){var n=parseFloat(t.$numberDouble);return r&&r.relaxed?n:new e(n)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){var e=this.toExtendedJSON();return"new Double(".concat(e.$numberDouble,")")},e}();Object.defineProperty(Jk.prototype,"_bsontype",{value:"Double"});var Yk=function(){function e(t){if(!(this instanceof e))return new e(t);t instanceof Number&&(t=t.valueOf()),this.value=0|+t}return e.prototype.valueOf=function(){return this.value},e.prototype.toString=function(e){return this.value.toString(e)},e.prototype.toJSON=function(){return this.value},e.prototype.toExtendedJSON=function(e){return e&&(e.relaxed||e.legacy)?this.value:{$numberInt:this.value.toString()}},e.fromExtendedJSON=function(t,r){return r&&r.relaxed?parseInt(t.$numberInt,10):new e(t.$numberInt)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return"new Int32(".concat(this.valueOf(),")")},e}();Object.defineProperty(Yk.prototype,"_bsontype",{value:"Int32"});var Xk=function(){function e(){if(!(this instanceof e))return new e}return e.prototype.toExtendedJSON=function(){return{$maxKey:1}},e.fromExtendedJSON=function(){return new e},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return"new MaxKey()"},e}();Object.defineProperty(Xk.prototype,"_bsontype",{value:"MaxKey"});var Qk=function(){function e(){if(!(this instanceof e))return new e}return e.prototype.toExtendedJSON=function(){return{$minKey:1}},e.fromExtendedJSON=function(){return new e},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return"new MinKey()"},e}();Object.defineProperty(Qk.prototype,"_bsontype",{value:"MinKey"});var Zk=new RegExp("^[0-9a-fA-F]{24}$"),eV=null,tV=Symbol("id"),rV=function(){function e(t){if(!(this instanceof e))return new e(t);var r;if("object"==typeof t&&t&&"id"in t){if("string"!=typeof t.id&&!ArrayBuffer.isView(t.id))throw new uk("Argument passed in must have an id that is of type string or Buffer");r="toHexString"in t&&"function"==typeof t.toHexString?ak.from(t.toHexString(),"hex"):t.id}else r=t;if(null==r||"number"==typeof r)this[tV]=e.generate("number"==typeof r?r:void 0);else if(ArrayBuffer.isView(r)&&12===r.byteLength)this[tV]=r instanceof ak?r:gk(r);else{if("string"!=typeof r)throw new uk("Argument passed in does not match the accepted types");if(12===r.length){var n=ak.from(r);if(12!==n.byteLength)throw new uk("Argument passed in must be a string of 12 bytes");this[tV]=n}else{if(24!==r.length||!Zk.test(r))throw new uk("Argument passed in must be a string of 12 bytes or a string of 24 hex characters or an integer");this[tV]=ak.from(r,"hex")}}e.cacheHexString&&(this.__id=this.id.toString("hex"))}return Object.defineProperty(e.prototype,"id",{get:function(){return this[tV]},set:function(t){this[tV]=t,e.cacheHexString&&(this.__id=t.toString("hex"))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"generationTime",{get:function(){return this.id.readInt32BE(0)},set:function(e){this.id.writeUInt32BE(e,0)},enumerable:!1,configurable:!0}),e.prototype.toHexString=function(){if(e.cacheHexString&&this.__id)return this.__id;var t=this.id.toString("hex");return e.cacheHexString&&!this.__id&&(this.__id=t),t},e.getInc=function(){return e.index=(e.index+1)%16777215},e.generate=function(t){"number"!=typeof t&&(t=Math.floor(Date.now()/1e3));var r=e.getInc(),n=ak.alloc(12);return n.writeUInt32BE(t,0),null===eV&&(eV=hk(5)),n[4]=eV[0],n[5]=eV[1],n[6]=eV[2],n[7]=eV[3],n[8]=eV[4],n[11]=255&r,n[10]=r>>8&255,n[9]=r>>16&255,n},e.prototype.toString=function(e){return e?this.id.toString(e):this.toHexString()},e.prototype.toJSON=function(){return this.toHexString()},e.prototype.equals=function(t){if(null==t)return!1;if(t instanceof e)return this[tV][11]===t[tV][11]&&this[tV].equals(t[tV]);if("string"==typeof t&&e.isValid(t)&&12===t.length&&mk(this.id))return t===ak.prototype.toString.call(this.id,"latin1");if("string"==typeof t&&e.isValid(t)&&24===t.length)return t.toLowerCase()===this.toHexString();if("string"==typeof t&&e.isValid(t)&&12===t.length)return ak.from(t).equals(this.id);if("object"==typeof t&&"toHexString"in t&&"function"==typeof t.toHexString){var r=t.toHexString(),n=this.toHexString().toLowerCase();return"string"==typeof r&&r.toLowerCase()===n}return!1},e.prototype.getTimestamp=function(){var e=new Date,t=this.id.readUInt32BE(0);return e.setTime(1e3*Math.floor(t)),e},e.createPk=function(){return new e},e.createFromTime=function(t){var r=ak.from([0,0,0,0,0,0,0,0,0,0,0,0]);return r.writeUInt32BE(t,0),new e(r)},e.createFromHexString=function(t){if(void 0===t||null!=t&&24!==t.length)throw new uk("Argument passed in must be a single String of 12 bytes or a string of 24 hex characters");return new e(ak.from(t,"hex"))},e.isValid=function(t){if(null==t)return!1;try{return new e(t),!0}catch(mL){return!1}},e.prototype.toExtendedJSON=function(){return this.toHexString?{$oid:this.toHexString()}:{$oid:this.toString("hex")}},e.fromExtendedJSON=function(t){return new e(t.$oid)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e.prototype.inspect=function(){return'new ObjectId("'.concat(this.toHexString(),'")')},e.index=Math.floor(16777215*Math.random()),e}();Object.defineProperty(rV.prototype,"generate",{value:vk(function(e){return rV.generate(e)},"Please use the static `ObjectId.generate(time)` instead")}),Object.defineProperty(rV.prototype,"getInc",{value:vk(function(){return rV.getInc()},"Please use the static `ObjectId.getInc()` instead")}),Object.defineProperty(rV.prototype,"get_inc",{value:vk(function(){return rV.getInc()},"Please use the static `ObjectId.getInc()` instead")}),Object.defineProperty(rV,"get_inc",{value:vk(function(){return rV.getInc()},"Please use the static `ObjectId.getInc()` instead")}),Object.defineProperty(rV.prototype,"_bsontype",{value:"ObjectID"});var nV=function(){function e(t,r){if(!(this instanceof e))return new e(t,r);if(this.pattern=t,this.options=(null!=r?r:"").split("").sort().join(""),-1!==this.pattern.indexOf("\0"))throw new lk("BSON Regex patterns cannot contain null bytes, found: ".concat(JSON.stringify(this.pattern)));if(-1!==this.options.indexOf("\0"))throw new lk("BSON Regex options cannot contain null bytes, found: ".concat(JSON.stringify(this.options)));for(var n=0;n<this.options.length;n++)if("i"!==this.options[n]&&"m"!==this.options[n]&&"x"!==this.options[n]&&"l"!==this.options[n]&&"s"!==this.options[n]&&"u"!==this.options[n])throw new lk("The regular expression option [".concat(this.options[n],"] is not supported"))}return e.parseOptions=function(e){return e?e.split("").sort().join(""):""},e.prototype.toExtendedJSON=function(e){return(e=e||{}).legacy?{$regex:this.pattern,$options:this.options}:{$regularExpression:{pattern:this.pattern,options:this.options}}},e.fromExtendedJSON=function(t){if("$regex"in t){if("string"==typeof t.$regex)return new e(t.$regex,e.parseOptions(t.$options));if("BSONRegExp"===t.$regex._bsontype)return t}if("$regularExpression"in t)return new e(t.$regularExpression.pattern,e.parseOptions(t.$regularExpression.options));throw new uk("Unexpected BSONRegExp EJSON object form: ".concat(JSON.stringify(t)))},e}();Object.defineProperty(nV.prototype,"_bsontype",{value:"BSONRegExp"});var oV=function(){function e(t){if(!(this instanceof e))return new e(t);this.value=t}return e.prototype.valueOf=function(){return this.value},e.prototype.toString=function(){return this.value},e.prototype.inspect=function(){return'new BSONSymbol("'.concat(this.value,'")')},e.prototype.toJSON=function(){return this.value},e.prototype.toExtendedJSON=function(){return{$symbol:this.value}},e.fromExtendedJSON=function(t){return new e(t.$symbol)},e.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},e}();Object.defineProperty(oV.prototype,"_bsontype",{value:"Symbol"});var iV=function(e){function t(r,n){var o=this;return o instanceof t?(o=Lk.isLong(r)?e.call(this,r.low,r.high,!0)||this:yk(r)&&void 0!==r.t&&void 0!==r.i?e.call(this,r.i,r.t,!0)||this:e.call(this,r,n,!0)||this,Object.defineProperty(o,"_bsontype",{value:"Timestamp",writable:!1,configurable:!1,enumerable:!1}),o):new t(r,n)}return ck(t,e),t.prototype.toJSON=function(){return{$timestamp:this.toString()}},t.fromInt=function(e){return new t(Lk.fromInt(e,!0))},t.fromNumber=function(e){return new t(Lk.fromNumber(e,!0))},t.fromBits=function(e,r){return new t(e,r)},t.fromString=function(e,r){return new t(Lk.fromString(e,!0,r))},t.prototype.toExtendedJSON=function(){return{$timestamp:{t:this.high>>>0,i:this.low>>>0}}},t.fromExtendedJSON=function(e){return new t(e.$timestamp)},t.prototype[Symbol.for("nodejs.util.inspect.custom")]=function(){return this.inspect()},t.prototype.inspect=function(){return"new Timestamp({ t: ".concat(this.getHighBits(),", i: ").concat(this.getLowBits()," })")},t.MAX_VALUE=Lk.MAX_UNSIGNED_VALUE,t}(Lk);var aV=2147483647,sV=-2147483648,cV=0x8000000000000000,lV=-0x8000000000000000,uV={$oid:rV,$binary:Nk,$uuid:Nk,$symbol:oV,$numberInt:Yk,$numberDecimal:Kk,$numberDouble:Jk,$numberLong:Lk,$minKey:Qk,$maxKey:Xk,$regex:nV,$regularExpression:nV,$timestamp:iV};function dV(e,t){if(void 0===t&&(t={}),"number"==typeof e){if(t.relaxed||t.legacy)return e;if(Math.floor(e)===e){if(e>=sV&&e<=aV)return new Yk(e);if(e>=lV&&e<=cV)return Lk.fromNumber(e)}return new Jk(e)}if(null==e||"object"!=typeof e)return e;if(e.$undefined)return null;for(var r=Object.keys(e).filter(function(t){return t.startsWith("$")&&null!=e[t]}),n=0;n<r.length;n++){var o=uV[r[n]];if(o)return o.fromExtendedJSON(e,t)}if(null!=e.$date){var i=e.$date,a=new Date;return t.legacy?"number"==typeof i?a.setTime(i):"string"==typeof i&&a.setTime(Date.parse(i)):"string"==typeof i?a.setTime(Date.parse(i)):Lk.isLong(i)?a.setTime(i.toNumber()):"number"==typeof i&&t.relaxed&&a.setTime(i),a}if(null!=e.$code){var s=Object.assign({},e);return e.$scope&&(s.$scope=dV(e.$scope)),Tk.fromExtendedJSON(e)}if(function(e){return yk(e)&&null!=e.$id&&"string"==typeof e.$ref&&(null==e.$db||"string"==typeof e.$db)}(e)||e.$dbPointer){var c=e.$ref?e:e.$dbPointer;if(c instanceof Ok)return c;var l=Object.keys(c).filter(function(e){return e.startsWith("$")}),u=!0;if(l.forEach(function(e){-1===["$ref","$id","$db"].indexOf(e)&&(u=!1)}),u)return Ok.fromExtendedJSON(c)}return e}function fV(e){var t=e.toISOString();return 0!==e.getUTCMilliseconds()?t:t.slice(0,-5)+"Z"}function pV(e,t){if(("object"==typeof e||"function"==typeof e)&&null!==e){var r=t.seenObjects.findIndex(function(t){return t.obj===e});if(-1!==r){var n=t.seenObjects.map(function(e){return e.propertyName}),o=n.slice(0,r).map(function(e){return"".concat(e," -> ")}).join(""),i=n[r],a=" -> "+n.slice(r+1,n.length-1).map(function(e){return"".concat(e," -> ")}).join(""),s=n[n.length-1],c=" ".repeat(o.length+i.length/2),l="-".repeat(a.length+(i.length+s.length)/2-1);throw new uk("Converting circular structure to EJSON:\n"+"    ".concat(o).concat(i).concat(a).concat(s,"\n")+"    ".concat(c,"\\").concat(l,"/"))}t.seenObjects[t.seenObjects.length-1].obj=e}if(Array.isArray(e))return function(e,t){return e.map(function(e,r){t.seenObjects.push({propertyName:"index ".concat(r),obj:null});try{return pV(e,t)}finally{t.seenObjects.pop()}})}(e,t);if(void 0===e)return null;if(e instanceof Date||yk(f=e)&&"[object Date]"===Object.prototype.toString.call(f)){var u=e.getTime(),d=u>-1&&u<2534023188e5;return t.legacy?t.relaxed&&d?{$date:e.getTime()}:{$date:fV(e)}:t.relaxed&&d?{$date:fV(e)}:{$date:{$numberLong:e.getTime().toString()}}}var f;if(!("number"!=typeof e||t.relaxed&&isFinite(e))){if(Math.floor(e)===e){var p=e>=lV&&e<=cV;if(e>=sV&&e<=aV)return{$numberInt:e.toString()};if(p)return{$numberLong:e.toString()}}return{$numberDouble:e.toString()}}if(e instanceof RegExp||function(e){return"[object RegExp]"===Object.prototype.toString.call(e)}(e)){var h=e.flags;if(void 0===h){var m=e.toString().match(/[gimuy]*$/);m&&(h=m[0])}return new nV(e.source,h).toExtendedJSON(t)}return null!=e&&"object"==typeof e?function(e,t){if(null==e||"object"!=typeof e)throw new lk("not an object instance");var r=e._bsontype;if(void 0===r){var n={};for(var o in e){t.seenObjects.push({propertyName:o,obj:null});try{var i=pV(e[o],t);"__proto__"===o?Object.defineProperty(n,o,{value:i,writable:!0,enumerable:!0,configurable:!0}):n[o]=i}finally{t.seenObjects.pop()}}return n}if(function(e){return yk(e)&&Reflect.has(e,"_bsontype")&&"string"==typeof e._bsontype}(e)){var a=e;if("function"!=typeof a.toExtendedJSON){var s=mV[e._bsontype];if(!s)throw new uk("Unrecognized or invalid _bsontype: "+e._bsontype);a=s(a)}return"Code"===r&&a.scope?a=new Tk(a.code,pV(a.scope,t)):"DBRef"===r&&a.oid&&(a=new Ok(pV(a.collection,t),pV(a.oid,t),pV(a.db,t),pV(a.fields,t))),a.toExtendedJSON(t)}throw new lk("_bsontype must be a string, but was: "+typeof r)}(e,t):e}var hV,mV={Binary:function(e){return new Nk(e.value(),e.sub_type)},Code:function(e){return new Tk(e.code,e.scope)},DBRef:function(e){return new Ok(e.collection||e.namespace,e.oid,e.db,e.fields)},Decimal128:function(e){return new Kk(e.bytes)},Double:function(e){return new Jk(e.value)},Int32:function(e){return new Yk(e.value)},Long:function(e){return Lk.fromBits(null!=e.low?e.low:e.low_,null!=e.low?e.high:e.high_,null!=e.low?e.unsigned:e.unsigned_)},MaxKey:function(){return new Xk},MinKey:function(){return new Qk},ObjectID:function(e){return new rV(e)},ObjectId:function(e){return new rV(e)},BSONRegExp:function(e){return new nV(e.pattern,e.options)},Symbol:function(e){return new oV(e.value)},Timestamp:function(e){return iV.fromBits(e.low,e.high)}};!function(e){function t(e,t){var r=Object.assign({},{relaxed:!0,legacy:!1},t);return"boolean"==typeof r.relaxed&&(r.strict=!r.relaxed),"boolean"==typeof r.strict&&(r.relaxed=!r.strict),JSON.parse(e,function(e,t){if(-1!==e.indexOf("\0"))throw new lk("BSON Document field names cannot contain null bytes, found: ".concat(JSON.stringify(e)));return dV(t,r)})}function r(e,t,r,n){null!=r&&"object"==typeof r&&(n=r,r=0),null==t||"object"!=typeof t||Array.isArray(t)||(n=t,t=void 0,r=0);var o=pV(e,Object.assign({relaxed:!0,legacy:!1},n,{seenObjects:[{propertyName:"(root)",obj:null}]}));return JSON.stringify(o,t,r)}e.parse=t,e.stringify=r,e.serialize=function(e,t){return t=t||{},JSON.parse(r(e,t))},e.deserialize=function(e,r){return r=r||{},t(JSON.stringify(e),r)}}(hV||(hV={}));var yV=fk();yV.Map?yV.Map:function(){function e(e){void 0===e&&(e=[]),this._keys=[],this._values={};for(var t=0;t<e.length;t++)if(null!=e[t]){var r=e[t],n=r[0],o=r[1];this._keys.push(n),this._values[n]={v:o,i:this._keys.length-1}}}e.prototype.clear=function(){this._keys=[],this._values={}},e.prototype.delete=function(e){var t=this._values[e];return null!=t&&(delete this._values[e],this._keys.splice(t.i,1),!0)},e.prototype.entries=function(){var e=this,t=0;return{next:function(){var r=e._keys[t++];return{value:void 0!==r?[r,e._values[r].v]:void 0,done:void 0===r}}}},e.prototype.forEach=function(e,t){t=t||this;for(var r=0;r<this._keys.length;r++){var n=this._keys[r];e.call(t,this._values[n].v,n,t)}},e.prototype.get=function(e){return this._values[e]?this._values[e].v:void 0},e.prototype.has=function(e){return null!=this._values[e]},e.prototype.keys=function(){var e=this,t=0;return{next:function(){var r=e._keys[t++];return{value:void 0!==r?r:void 0,done:void 0===r}}}},e.prototype.set=function(e,t){return this._values[e]?(this._values[e].v=t,this):(this._keys.push(e),this._values[e]={v:t,i:this._keys.length-1},this)},e.prototype.values=function(){var e=this,t=0;return{next:function(){var r=e._keys[t++];return{value:void 0!==r?e._values[r].v:void 0,done:void 0===r}}}},Object.defineProperty(e.prototype,"size",{get:function(){return this._keys.length},enumerable:!1,configurable:!0})}(),Lk.fromNumber(Sk),Lk.fromNumber(xk);var vV=new Uint8Array(8);new DataView(vV.buffer,vV.byteOffset,vV.byteLength);ak.alloc(17825792);var gV=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},bV=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(hL){i=[6,hL],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},wV=function(){function e(e,t){this._stages=[],e&&t&&(this._db=e,this._request=new WV.reqClass(this._db.config),this._collectionName=t)}return e.prototype.end=function(){return gV(this,void 0,void 0,function(){var e;return bV(this,function(t){switch(t.label){case 0:if(!this._collectionName||!this._db)throw new Error("Aggregation pipeline cannot send request");return[4,this._request.send("database.aggregate",{collectionName:this._collectionName,stages:this._stages})];case 1:return(e=t.sent())&&e.data&&e.data.list?[2,{requestId:e.requestId,data:JSON.parse(e.data.list).map(hV.parse)}]:[2,e]}})})},e.prototype.unwrap=function(){return this._stages},e.prototype.done=function(){return this._stages.map(function(e){var t,r=e.stageKey,n=e.stageValue;return(t={})[r]=JSON.parse(n),t})},e.prototype._pipe=function(e,t){return this._stages.push({stageKey:"$"+e,stageValue:JSON.stringify(t)}),this},e.prototype.addFields=function(e){return this._pipe("addFields",e)},e.prototype.bucket=function(e){return this._pipe("bucket",e)},e.prototype.bucketAuto=function(e){return this._pipe("bucketAuto",e)},e.prototype.count=function(e){return this._pipe("count",e)},e.prototype.geoNear=function(e){return e.query&&(e.query=MC.encode(e.query)),e.distanceMultiplier&&"number"==typeof e.distanceMultiplier&&(e.distanceMultiplier=e.distanceMultiplier),e.near&&(e.near=new zP(e.near.longitude,e.near.latitude).toJSON()),this._pipe("geoNear",e)},e.prototype.group=function(e){return this._pipe("group",e)},e.prototype.limit=function(e){return this._pipe("limit",e)},e.prototype.match=function(e){return this._pipe("match",MC.encode(e))},e.prototype.project=function(e){return this._pipe("project",e)},e.prototype.lookup=function(e){return this._pipe("lookup",e)},e.prototype.replaceRoot=function(e){return this._pipe("replaceRoot",e)},e.prototype.sample=function(e){return this._pipe("sample",e)},e.prototype.skip=function(e){return this._pipe("skip",e)},e.prototype.sort=function(e){return this._pipe("sort",e)},e.prototype.sortByCount=function(e){return this._pipe("sortByCount",e)},e.prototype.unwind=function(e){return this._pipe("unwind",e)},e}(),EV=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),_V=function(e){function t(t,r){return e.call(this,t,r)||this}return EV(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return this._coll},enumerable:!0,configurable:!0}),t.prototype.doc=function(e){if("string"!=typeof e&&"number"!=typeof e)throw new Error("docIdå¿…é¡»ä¸ºå­—ç¬¦ä¸²æˆ–æ•°å­—");return new jC(this._db,this._coll,e)},t.prototype.add=function(e,t){return new jC(this._db,this._coll,void 0).create(e,t)},t.prototype.aggregate=function(){return new wV(this._db,this._coll)},t}(FC),SV={eq:function(e){return new mC(fC.EQ,[e])},neq:function(e){return new mC(fC.NEQ,[e])},lt:function(e){return new mC(fC.LT,[e])},lte:function(e){return new mC(fC.LTE,[e])},gt:function(e){return new mC(fC.GT,[e])},gte:function(e){return new mC(fC.GTE,[e])},in:function(e){return new mC(fC.IN,e)},nin:function(e){return new mC(fC.NIN,e)},all:function(e){return new mC(fC.ALL,e)},elemMatch:function(e){return new mC(fC.ELEM_MATCH,[e])},exists:function(e){return new mC(fC.EXISTS,[e])},size:function(e){return new mC(fC.SIZE,[e])},mod:function(e){return new mC(fC.MOD,[e])},geoNear:function(e){return new mC(fC.GEO_NEAR,[e])},geoWithin:function(e){return new mC(fC.GEO_WITHIN,[e])},geoIntersects:function(e){return new mC(fC.GEO_INTERSECTS,[e])},and:function(){var e=WP(arguments[0])?arguments[0]:Array.from(arguments);return new uC(aC.AND,e)},nor:function(){var e=WP(arguments[0])?arguments[0]:Array.from(arguments);return new uC(aC.NOR,e)},or:function(){var e=WP(arguments[0])?arguments[0]:Array.from(arguments);return new uC(aC.OR,e)},not:function(){var e=WP(arguments[0])?arguments[0]:Array.from(arguments);return new uC(aC.NOT,e)},set:function(e){return new cC(nC.SET,[e])},remove:function(){return new cC(nC.REMOVE,[])},inc:function(e){return new cC(nC.INC,[e])},mul:function(e){return new cC(nC.MUL,[e])},push:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(BP(t[0])&&t[0].hasOwnProperty("each")){var n=t[0];e={$each:n.each,$position:n.position,$sort:n.sort,$slice:n.slice}}else e=WP(t[0])?t[0]:Array.from(t);return new cC(nC.PUSH,e)},pull:function(e){return new cC(nC.PULL,e)},pullAll:function(e){return new cC(nC.PULL_ALL,e)},pop:function(){return new cC(nC.POP,[])},shift:function(){return new cC(nC.SHIFT,[])},unshift:function(){var e=WP(arguments[0])?arguments[0]:Array.from(arguments);return new cC(nC.UNSHIFT,e)},addToSet:function(e){return new cC(nC.ADD_TO_SET,e)},rename:function(e){return new cC(nC.RENAME,[e])},bit:function(e){return new cC(nC.BIT,[e])},max:function(e){return new cC(nC.MAX,[e])},min:function(e){return new cC(nC.MIN,[e])},expr:function(e){return{$expr:e}},jsonSchema:function(e){return{$jsonSchema:e}},text:function(e){return"string"===qP(e)?{$search:e.search}:{$search:e.search,$language:e.language,$caseSensitive:e.caseSensitive,$diacriticSensitive:e.diacriticSensitive}},aggregate:{pipeline:function(){return new wV},abs:function(e){return new xV("abs",e)},add:function(e){return new xV("add",e)},ceil:function(e){return new xV("ceil",e)},divide:function(e){return new xV("divide",e)},exp:function(e){return new xV("exp",e)},floor:function(e){return new xV("floor",e)},ln:function(e){return new xV("ln",e)},log:function(e){return new xV("log",e)},log10:function(e){return new xV("log10",e)},mod:function(e){return new xV("mod",e)},multiply:function(e){return new xV("multiply",e)},pow:function(e){return new xV("pow",e)},sqrt:function(e){return new xV("sqrt",e)},subtract:function(e){return new xV("subtract",e)},trunc:function(e){return new xV("trunc",e)},arrayElemAt:function(e){return new xV("arrayElemAt",e)},arrayToObject:function(e){return new xV("arrayToObject",e)},concatArrays:function(e){return new xV("concatArrays",e)},filter:function(e){return new xV("filter",e)},in:function(e){return new xV("in",e)},indexOfArray:function(e){return new xV("indexOfArray",e)},isArray:function(e){return new xV("isArray",e)},map:function(e){return new xV("map",e)},range:function(e){return new xV("range",e)},reduce:function(e){return new xV("reduce",e)},reverseArray:function(e){return new xV("reverseArray",e)},size:function(e){return new xV("size",e)},slice:function(e){return new xV("slice",e)},zip:function(e){return new xV("zip",e)},and:function(e){return new xV("and",e)},not:function(e){return new xV("not",e)},or:function(e){return new xV("or",e)},cmp:function(e){return new xV("cmp",e)},eq:function(e){return new xV("eq",e)},gt:function(e){return new xV("gt",e)},gte:function(e){return new xV("gte",e)},lt:function(e){return new xV("lt",e)},lte:function(e){return new xV("lte",e)},neq:function(e){return new xV("ne",e)},cond:function(e){return new xV("cond",e)},ifNull:function(e){return new xV("ifNull",e)},switch:function(e){return new xV("switch",e)},dateFromParts:function(e){return new xV("dateFromParts",e)},dateFromString:function(e){return new xV("dateFromString",e)},dayOfMonth:function(e){return new xV("dayOfMonth",e)},dayOfWeek:function(e){return new xV("dayOfWeek",e)},dayOfYear:function(e){return new xV("dayOfYear",e)},isoDayOfWeek:function(e){return new xV("isoDayOfWeek",e)},isoWeek:function(e){return new xV("isoWeek",e)},isoWeekYear:function(e){return new xV("isoWeekYear",e)},millisecond:function(e){return new xV("millisecond",e)},minute:function(e){return new xV("minute",e)},month:function(e){return new xV("month",e)},second:function(e){return new xV("second",e)},hour:function(e){return new xV("hour",e)},week:function(e){return new xV("week",e)},year:function(e){return new xV("year",e)},literal:function(e){return new xV("literal",e)},mergeObjects:function(e){return new xV("mergeObjects",e)},objectToArray:function(e){return new xV("objectToArray",e)},allElementsTrue:function(e){return new xV("allElementsTrue",e)},anyElementTrue:function(e){return new xV("anyElementTrue",e)},setDifference:function(e){return new xV("setDifference",e)},setEquals:function(e){return new xV("setEquals",e)},setIntersection:function(e){return new xV("setIntersection",e)},setIsSubset:function(e){return new xV("setIsSubset",e)},setUnion:function(e){return new xV("setUnion",e)},concat:function(e){return new xV("concat",e)},dateToString:function(e){return new xV("dateToString",e)},indexOfBytes:function(e){return new xV("indexOfBytes",e)},indexOfCP:function(e){return new xV("indexOfCP",e)},split:function(e){return new xV("split",e)},strLenBytes:function(e){return new xV("strLenBytes",e)},strLenCP:function(e){return new xV("strLenCP",e)},strcasecmp:function(e){return new xV("strcasecmp",e)},substr:function(e){return new xV("substr",e)},substrBytes:function(e){return new xV("substrBytes",e)},substrCP:function(e){return new xV("substrCP",e)},toLower:function(e){return new xV("toLower",e)},toUpper:function(e){return new xV("toUpper",e)},meta:function(e){return new xV("meta",e)},addToSet:function(e){return new xV("addToSet",e)},avg:function(e){return new xV("avg",e)},first:function(e){return new xV("first",e)},last:function(e){return new xV("last",e)},max:function(e){return new xV("max",e)},min:function(e){return new xV("min",e)},push:function(e){return new xV("push",e)},stdDevPop:function(e){return new xV("stdDevPop",e)},stdDevSamp:function(e){return new xV("stdDevSamp",e)},sum:function(e){return new xV("sum",e)},let:function(e){return new xV("let",e)}},project:{slice:function(e){return new NV("slice",e)},elemMatch:function(e){return new NV("elemMatch",e)}}},xV=function(){return function(e,t){this["$"+e]=t}}(),NV=function(){return function(e,t){this["$"+e]=t}}(),IV=function(){function e(e){var t=e.regexp,r=e.options;if(!t)throw new TypeError("regexp must be a string");this.$regex=t,this.$options=r}return e.prototype.parse=function(){return{$regex:this.$regex,$options:this.$options}},Object.defineProperty(e.prototype,"_internalType",{get:function(){return VP},enumerable:!0,configurable:!0}),e}();function TV(e){return new IV(e)}var OV={message:"insert document failed"},AV={code:"DATABASE_TRANSACTION_CONFLICT"},RV=function(){return RV=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},RV.apply(this,arguments)},PV=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},CV=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(hL){i=[6,hL],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},kV="database.updateDocInTransaction",VV=function(){function e(e,t,r){this._coll=t,this.id=r,this._transaction=e,this._request=this._transaction.getRequestMethod(),this._transactionId=this._transaction.getTransactionId()}return e.prototype.create=function(e){return PV(this,void 0,void 0,function(){var t,r,n,o;return CV(this,function(i){switch(i.label){case 0:return t={collectionName:this._coll,transactionId:this._transactionId,data:hV.stringify(xC(e),{relaxed:!1})},this.id&&(t._id=this.id),[4,this._request.send("database.insertDocInTransaction",t)];case 1:if((r=i.sent()).code)throw r;if(n=hV.parse(r.inserted),1==(o=hV.parse(r.ok))&&1==n)return[2,RV(RV({},r),{ok:o,inserted:n})];throw new Error(OV.message)}})})},e.prototype.get=function(){return PV(this,void 0,void 0,function(){var e,t;return CV(this,function(r){switch(r.label){case 0:return e={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}}},[4,this._request.send("database.getInTransaction",e)];case 1:if((t=r.sent()).code)throw t;return[2,{data:"null"!==t.data?jP.formatField(hV.parse(t.data)):hV.parse(t.data),requestId:t.requestId}]}})})},e.prototype.set=function(e){return PV(this,void 0,void 0,function(){var t,r;return CV(this,function(n){switch(n.label){case 0:return t={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}},data:hV.stringify(xC(e),{relaxed:!1}),upsert:!0},[4,this._request.send(kV,t)];case 1:if((r=n.sent()).code)throw r;return[2,RV(RV({},r),{updated:hV.parse(r.updated),upserted:r.upserted?JSON.parse(r.upserted):null})]}})})},e.prototype.update=function(e){return PV(this,void 0,void 0,function(){var t,r;return CV(this,function(n){switch(n.label){case 0:return t={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}},data:hV.stringify(VC.encode(e),{relaxed:!1})},[4,this._request.send(kV,t)];case 1:if((r=n.sent()).code)throw r;return[2,RV(RV({},r),{updated:hV.parse(r.updated)})]}})})},e.prototype.delete=function(){return PV(this,void 0,void 0,function(){var e,t;return CV(this,function(r){switch(r.label){case 0:return e={collectionName:this._coll,transactionId:this._transactionId,query:{_id:{$eq:this.id}}},[4,this._request.send("database.deleteDocInTransaction",e)];case 1:if((t=r.sent()).code)throw t;return[2,RV(RV({},t),{deleted:hV.parse(t.deleted)})]}})})},e}(),LV=function(){return function(e,t){this._coll=t,this._transaction=e}}(),UV=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),DV=function(e){function t(t,r){return e.call(this,t,r)||this}return UV(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return this._coll},enumerable:!0,configurable:!0}),t.prototype.doc=function(e){if("string"!=typeof e&&"number"!=typeof e)throw new Error("docIdå¿…é¡»ä¸ºå­—ç¬¦ä¸²æˆ–æ•°å­—");return new VV(this._transaction,this._coll,e)},t.prototype.add=function(e){var t;return void 0!==e._id&&(t=e._id),new VV(this._transaction,this._coll,t).create(e)},t}(LV),jV=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},MV=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(hL){i=[6,hL],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},qV=function(){function e(e){this._db=e,this._request=new WV.reqClass(this._db.config),this.aborted=!1,this.commited=!1,this.inited=!1}return e.prototype.init=function(){return jV(this,void 0,void 0,function(){var e;return MV(this,function(t){switch(t.label){case 0:return[4,this._request.send("database.startTransaction")];case 1:if((e=t.sent()).code)throw e;return this.inited=!0,this._id=e.transactionId,[2]}})})},e.prototype.collection=function(e){if(!e)throw new Error("Collection name is required");return new DV(this,e)},e.prototype.getTransactionId=function(){return this._id},e.prototype.getRequestMethod=function(){return this._request},e.prototype.commit=function(){return jV(this,void 0,void 0,function(){var e,t;return MV(this,function(r){switch(r.label){case 0:return e={transactionId:this._id},[4,this._request.send("database.commitTransaction",e)];case 1:if((t=r.sent()).code)throw t;return this.commited=!0,[2,t]}})})},e.prototype.rollback=function(e){return jV(this,void 0,void 0,function(){var t,r;return MV(this,function(n){switch(n.label){case 0:return t={transactionId:this._id},[4,this._request.send("database.abortTransaction",t)];case 1:if((r=n.sent()).code)throw r;return this.aborted=!0,this.abortReason=e,[2,r]}})})},e}();function BV(){return jV(this,void 0,void 0,function(){var e;return MV(this,function(t){switch(t.label){case 0:return[4,(e=new qV(this)).init()];case 1:return t.sent(),[2,e]}})})}function FV(e,t){return void 0===t&&(t=3),jV(this,void 0,void 0,function(){var r,n,o,i,a=this;return MV(this,function(s){switch(s.label){case 0:return s.trys.push([0,4,,10]),[4,(r=new qV(this)).init()];case 1:return s.sent(),[4,e(r)];case 2:if(n=s.sent(),!0===r.aborted)throw r.abortReason;return[4,r.commit()];case 3:return s.sent(),[2,n];case 4:if(o=s.sent(),!1===r.inited)throw o;return i=function(e){return jV(a,void 0,void 0,function(){return MV(this,function(t){switch(t.label){case 0:if(r.aborted||r.commited)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.rollback()];case 2:case 3:return t.sent(),[3,4];case 4:throw e;case 5:if(!0===r.aborted)throw r.abortReason;throw e}})})},t<=0?[4,i(o)]:[3,6];case 5:s.sent(),s.label=6;case 6:return o&&o.code===AV.code?[4,FV.bind(this)(e,--t)]:[3,8];case 7:return[2,s.sent()];case 8:return[4,i(o)];case 9:return s.sent(),[3,10];case 10:return[2]}})})}var WV=function(){function e(e){this.config=e,this.Geo=rC,this.serverDate=UP,this.command=SV,this.RegExp=TV,this.startTransaction=BV,this.runTransaction=FV,this.logicCommand=uC,this.updateCommand=cC,this.queryCommand=mC}return e.prototype.collection=function(e){if(!e)throw new Error("Collection name is required");return new _V(this,e)},e.prototype.createCollection=function(t){var r={collectionName:t};return new e.reqClass(this.config).send("database.addCollection",r)},e}(),HV=function(){return HV=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},HV.apply(this,arguments)};var GV={name:"database",entity:{database:function(e){var t=this.platform,r=t.adapter,n=t.runtime;return WV.reqClass=this.request.constructor,WV.getAccessToken=this.authInstance?this.authInstance.getAccessToken.bind(this.authInstance):function(){return""},WV.runtime=n,this.wsClientClass&&(WV.wsClass=r.wsClass,WV.wsClientClass=this.wsClientClass),WV.ws||(WV.ws=null),new WV(HV(HV(HV({},this.config),{_fromApp:this}),e))}}};try{cloudbase.registerComponent(GV)}catch(hL){}function $V(e){try{e.registerComponent(GV)}catch(hL){console.warn(hL)}}try{window.registerDatabase=$V}catch(hL){}var zV="2.23.0";na.registerVersion(zV);try{!function(e){try{e.registerComponent(Ys)}catch(hL){console.warn(hL)}}(na),function(e){try{e.registerComponent(gc)}catch(hL){console.warn(hL)}}(na),Fc(na),$V(na),function(e){try{e.registerComponent(Um),e.registerHook(Lm)}catch(hL){console.warn(hL)}}(na),function(e){try{e.registerComponent(zm)}catch(hL){console.warn(hL)}}(na),DO(na),HR(na),ic(na),eP(na)}catch(hL){}try{window.cloudbase=na}catch(hL){}var KV=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),JV=function(){return JV=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},JV.apply(this,arguments)},YV=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function a(e){try{c(n.next(e))}catch(hL){i(hL)}}function s(e){try{c(n.throw(e))}catch(hL){i(hL)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(a,s)}c((n=n.apply(e,t||[])).next())})},XV=function(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(hL){i=[6,hL],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};var QV="Error when aborting requestTask",ZV=function(e){function t(t){void 0===t&&(t={});var r=e.call(this)||this,n=t.timeout,o=t.timeoutMsg,i=t.restrictedMethods;return r._timeout=n||0,r._timeoutMsg=o||"è¯·æ±‚è¶…æ—¶",r._restrictedMethods=i||["get","post","upload","download"],r}return KV(t,e),t.prototype.post=function(e){var t=this;return new Promise(function(r,n){var o=e.url,i=e.body,a=e.data,s=e.headers,c=U("https:",o),l=uni.request({url:c,data:a||i,timeout:t._timeout,method:"POST",header:s,success:function(e){e.statusCode>=200&&e.statusCode<300?r({statusCode:e.statusCode,status:e.statusCode,data:e.data}):n(e)},fail:function(e){n(e)},complete:function(e){if(e&&e.errMsg&&(t._timeout&&-1!==t._restrictedMethods.indexOf("post")&&e.errMsg.includes("timeout"))){console.warn(t._timeoutMsg);try{l.abort()}catch(hL){console.warn(QV,hL)}}}})})},t.prototype.get=function(e){var t=this;return new Promise(function(r,n){var o=e.url,i=e.body,a=e.headers,s=U("https:",o),c=uni.request({url:s,data:i,timeout:t._timeout,method:"GET",header:a,success:function(e){e.statusCode>=200&&e.statusCode<300?r({statusCode:e.statusCode,status:e.statusCode,data:e.data}):n(e)},fail:function(e){n(e)},complete:function(e){if(e&&e.errMsg&&(t._timeout&&-1!==t._restrictedMethods.indexOf("get")&&e.errMsg.includes("timeout"))){console.warn(t._timeoutMsg);try{c.abort()}catch(hL){console.warn(QV,hL)}}}})})},t.prototype.upload=function(e){var t=this,r=this;return new Promise(function(n){return YV(t,void 0,void 0,function(){var t,o,i,a,s,c;return XV(this,function(l){return t=e.url,o=e.file,i=e.data,a=e.headers,s=e.onUploadProgress,c=uni.uploadFile({url:t,filePath:o,name:"file",formData:i||{},header:a,timeout:this._timeout,success:function(e){var t={statusCode:e.statusCode,data:e.data||{}};200===e.statusCode&&i.success_action_status&&(t.statusCode=parseInt(i.success_action_status,10)),n(t)},fail:function(e){n(e)},complete:function(e){if(e&&e.errMsg&&(r._timeout&&-1!==r._restrictedMethods.indexOf("upload")&&"request:fail timeout"===e.errMsg)){console.warn(r._timeoutMsg);try{c.abort()}catch(hL){}}}}),s&&c.onProgressUpdate(function(e){s(e)}),[2]})})})},t.prototype.download=function(e){var t=this,r=this;return new Promise(function(n,o){var i=e.url,a=e.headers,s=uni.downloadFile({url:U("https:",i),header:a,timeout:t._timeout,success:function(e){200===e.statusCode&&e.tempFilePath?n({statusCode:200,tempFilePath:e.tempFilePath}):n(e)},fail:function(e){o(e)},complete:function(e){if(e&&e.errMsg&&(r._timeout&&-1!==r._restrictedMethods.indexOf("download")&&e.errMsg.includes("timeout"))){console.warn(r._timeoutMsg);try{s.abort()}catch(hL){}}}})})},t.prototype.fetch=function(e){var t=e.url,r=e.body,n=e.enableAbort,o=e.headers,i=e.method,a=e.stream,s=void 0!==a&&a,c=e.signal,l=e.timeout,u=this,d=null!=l?l:this._timeout,f=null,p=new Yn({start:function(e){f=e},cancel:function(){f=null}});return new Promise(function(e,a){s&&e({data:p});var l=uni.request({url:U("https:",t),data:r,timeout:d,method:i.toUpperCase(),header:o,success:function(t){var r;null===(r=f)||void 0===r||r.close(),!s&&e(t)},fail:function(e){var t;if(null===(t=f)||void 0===t||t.close(),a(e),s)throw e},complete:function(e){if(e&&e.errMsg&&(d&&-1!==u._restrictedMethods.indexOf(i.toLowerCase())&&n&&e.errMsg.includes("timeout"))){console.warn(u._timeoutMsg);try{l.abort()}catch(hL){console.warn(QV,hL)}}},enableChunked:s});if(s&&"function"==typeof l.onChunkReceived?l.onChunkReceived(function(e){var t;null===(t=f)||void 0===t||t.enqueue(new Uint8Array(e.data))}):s&&console.warn("[Adapter.fetch] onChunkReceived is not supported in this environment. Streaming will not work."),c){var h=function(){try{l.abort()}catch(hL){console.warn(QV,hL)}};c.aborted?h():c.addEventListener("abort",function(){return h()})}})},t}(V),eL={setItem:function(e,t){uni.setStorageSync(e,t)},getItem:function(e){return uni.getStorageSync(e)},removeItem:function(e){uni.removeStorageSync(e)},clear:function(){uni.clearStorageSync()}},tL=function(){return function(e,t){void 0===t&&(t={}),this.CONNECTING=0,this.OPEN=1,this.CLOSING=2,this.CLOSED=3;var r=uni.connectSocket(JV(JV({url:e},t),{multiple:!0,complete:function(){},fail:function(e){return console.error("è¿æ¥å¤±è´¥:",e)}}));return{set onopen(e){r.onOpen(e)},set onmessage(e){r.onMessage(e)},set onclose(e){r.onClose(e)},set onerror(e){r.onError(e)},send:function(e){return r.send({data:e})},close:function(e,t){return r.close({code:e,reason:t})},get readyState(){return r.readyState},CONNECTING:this.CONNECTING,OPEN:this.OPEN,CLOSING:this.CLOSING,CLOSED:this.CLOSED}}}();var rL={genAdapter:function(e){return{root:{globalThis:{}},reqClass:ZV,wsClass:tL,captchaOptions:{openURIWithCallback:function(t){var r=e.uni,n={},o=t,i=t.match(/^(data:.*?)(\?[^#\s]*)?$/);if(i){o=i[1];var a=i[2];a&&(n=function(e){var t={},r=e.replace(/^[?#]/,"");return r?(r.split("&").forEach(function(e){var r=e.split("="),n=r[0],o=r[1];n=decodeURIComponent(n),o=decodeURIComponent(o),n&&(t[n]?Array.isArray(t[n])?t[n].push(o):t[n]=[t[n],o]:t[n]=o)}),t):t}(a))}var s=n.token,c=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(n,["token"]);return/^data:/.test(o)&&!s?Promise.reject({error:"invalid_argument",error_description:"invalie captcha data: "+t}):s?new Promise(function(e){console.log("wait for captcha..."),r.$emit("CAPTCHA_DATA_CHANGE",JV(JV({},c),{token:s,url:o})),r.$once("RESOLVE_CAPTCHA_DATA",function(t){e(t)})}):Promise.reject({error:"unimplemented",error_description:"need to impl captcha data"})}},localStorage:eL,primaryStorage:R.local,getAppSign:function(){var e=uni.getAccountInfoSync();return function(){try{var e=uni.getAccountInfoSync();return!(!e||!e.plugin)}catch(hL){return!1}}()?e&&e.plugin?e.plugin.appId:"":e&&e.miniProgram?e.miniProgram.appId:""}}},isMatch:function(){if("undefined"==typeof uni||"function"!=typeof uni.getSystemInfoSync)return!1;if(!uni.getStorageSync)return!1;if(!uni.setStorageSync)return!1;if(!uni.connectSocket)return!1;if(!uni.request)return!1;try{var e=uni.getSystemInfoSync();return!(!e||!e.platform)}catch(hL){return!1}},runtime:"uniapp"};na.useAdapters(rL,{uni:uni});const nL={}.VITE_ENV_ID||"",oL=nL&&""!==nL.trim(),iL=oL?((e={})=>{if(!oL)return t("warn","at utils/cloudbase.ts:23","äº‘å¼€å‘ç¯å¢ƒIDæœªé…ç½®ï¼Œè·³è¿‡åˆå§‹åŒ–"),null;const r={env:e.env||nL,timeout:e.timeout||15e3};return na.init(r)})():null,aL=iL?iL.auth():null,sL=()=>oL,cL=async()=>{if(!sL())throw new Error("ç¯å¢ƒIDæœªé…ç½®");if(!aL)throw new Error("äº‘å¼€å‘æœªåˆå§‹åŒ–");try{let e=await aL.getLoginState();return e&&e.user?(t("log","at utils/cloudbase.ts:317","ç”¨æˆ·å·²ç™»å½•"),e):(t("log","at utils/cloudbase.ts:321","ç”¨æˆ·æœªç™»å½•ï¼Œæ‰§è¡Œç™»å½•..."),await(async()=>{try{await aL.signInAnonymously()}catch(e){throw t("error","at utils/cloudbase.ts:65","ç™»å½•å¤±è´¥:",e),e}})(),e=await aL.getLoginState(),e)}catch(e){throw t("error","at utils/cloudbase.ts:327","ç™»å½•å¤±è´¥:",e),e}};const lL=e.defineComponent({__name:"App",setup:e=>(i(async()=>{t("log","at App.vue:7","App Launch");try{h()}catch(e){t("error","at App.vue:13","æ­Œæ›²æ•°æ®åº“åˆå§‹åŒ–å¼‚å¸¸:",e)}if(sL())try{await async function(){try{return sL()?(await cL(),t("log","at utils/cloudbase.ts:345","äº‘å¼€å‘åˆå§‹åŒ–æˆåŠŸ"),!0):(t("log","at utils/cloudbase.ts:340","äº‘å¼€å‘ç¯å¢ƒæœªé…ç½®ï¼Œè·³è¿‡åˆå§‹åŒ–"),!0)}catch(e){return t("error","at utils/cloudbase.ts:348","äº‘å¼€å‘åˆå§‹åŒ–å¤±è´¥:",e),!1}}()?t("log","at App.vue:22","äº‘å¼€å‘åˆå§‹åŒ–æˆåŠŸ"):t("warn","at App.vue:24","äº‘å¼€å‘åˆå§‹åŒ–å¤±è´¥")}catch(e){t("error","at App.vue:27","äº‘å¼€å‘åˆå§‹åŒ–å¼‚å¸¸:",e)}}),n(()=>{t("log","at App.vue:34","App Show")}),o(()=>{t("log","at App.vue:38","App Hide")}),()=>{})}),uL=a(e.defineComponent({__name:"show-captcha",setup(r){const n=e.ref(null),o=e.ref(""),i=e.ref({url:"",token:""}),a=e.ref(""),s=e.ref(!1),c=e.ref(!1),l=e.ref(!1);e.watch(n,e=>{e&&c.value&&(t("log","at components/show-captcha.vue:86","Popup å®ä¾‹å·²æˆåŠŸè·å–ï¼Œæ­£åœ¨æ‰“å¼€..."),e.open())});const u=e=>{t("error","at components/show-captcha.vue:93","éªŒè¯ç å›¾ç‰‡åŠ è½½å¤±è´¥:",e.detail.errMsg),uni.showToast({title:"éªŒè¯ç å›¾ç‰‡åŠ è½½å¤±è´¥",icon:"none"})},d=async()=>{if(l.value)return;t("log","at components/show-captcha.vue:104","å¼€å§‹åˆ·æ–°éªŒè¯ç ..."),l.value=!0;const{token:e,data:r}=await aL.createCaptchaData({state:a.value});i.value.token=e,i.value.url=r,l.value=!1},f=e=>{e.show||(c.value=!1)},p=()=>{n.value?n.value.close():c.value=!1,c.value=!1},h=async()=>{if(o.value.trim())if(i.value.token)try{s.value=!0,t("log","at components/show-captcha.vue:157","æäº¤éªŒè¯ç :",o.value,"token:",i.value.token);const e=await aL.verifyCaptchaData({key:o.value,token:i.value.token});t("log","at components/show-captcha.vue:162","éªŒè¯ç æäº¤æˆåŠŸ:",e),uni.$emit("RESOLVE_CAPTCHA_DATA",e),p()}catch(e){t("error","at components/show-captcha.vue:166","éªŒè¯ç éªŒè¯å¤±è´¥:",e),uni.showToast({title:"éªŒè¯å¤±è´¥ï¼Œè¯·é‡è¯•",icon:"none"})}finally{s.value=!1}else uni.showToast({title:"éªŒè¯ç æ•°æ®å¼‚å¸¸",icon:"none"});else uni.showToast({title:"è¯·è¾“å…¥éªŒè¯ç ",icon:"none"})},m=()=>{t("log","at components/show-captcha.vue:175","ç”¨æˆ·å–æ¶ˆéªŒè¯ç è¾“å…¥"),uni.$emit("RESOLVE_CAPTCHA_DATA",{error:"user_cancelled",error_description:"ç”¨æˆ·å–æ¶ˆäº†éªŒè¯ç è¾“å…¥"}),p()},y=e=>{t("log","at components/show-captcha.vue:185","æ¥æ”¶åˆ° CAPTCHA_DATA_CHANGE äº‹ä»¶:",e),e&&e.url&&e.token?(l.value=!1,(e=>{t("log","at components/show-captcha.vue:119","æ‰“å¼€éªŒè¯ç å¼¹çª—:",e),i.value=e,a.value=e.state,o.value="",c.value=!0})(e)):(t("warn","at components/show-captcha.vue:190","æ¥æ”¶åˆ°çš„éªŒè¯ç æ•°æ®æ ¼å¼ä¸æ­£ç¡®:",e),l.value=!1)};return e.onMounted(()=>{t("log","at components/show-captcha.vue:197","éªŒè¯ç ç»„ä»¶å·²æŒ‚è½½ï¼Œå¼€å§‹ç›‘å¬äº‹ä»¶"),uni.$on("CAPTCHA_DATA_CHANGE",y)}),e.onUnmounted(()=>{t("log","at components/show-captcha.vue:203","éªŒè¯ç ç»„ä»¶å·²å¸è½½ï¼Œç§»é™¤äº‹ä»¶ç›‘å¬"),uni.$off("CAPTCHA_DATA_CHANGE",y)}),(t,r)=>{const a=e.resolveComponent("uni-load-more"),p=e.resolveComponent("uni-popup");return c.value?(e.openBlock(),e.createElementBlock("view",{key:0},[e.createVNode(p,{ref_key:"popup",ref:n,type:"center","is-mask-click":!1,onMaskClick:m,onChange:f},{default:e.withCtx(()=>[e.createElementVNode("view",{class:"captcha-container"},[e.createElementVNode("view",{class:"captcha-header"},[e.createElementVNode("text",{class:"title"},"è¯·å®Œæˆå®‰å…¨éªŒè¯"),e.createElementVNode("text",{class:"close-btn",onClick:m},"âœ•")]),e.createElementVNode("view",{class:"captcha-body"},[e.createElementVNode("view",{class:"captcha-image-wrapper"},[e.createElementVNode("view",{class:"image-content"},[i.value.url?(e.openBlock(),e.createElementBlock("image",{key:0,class:"captcha-img",src:i.value.url,mode:"aspectFit",onError:u},null,40,["src"])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"captcha-placeholder"},[e.createElementVNode("text",null,"éªŒè¯ç åŠ è½½ä¸­...")])),l.value?(e.openBlock(),e.createElementBlock("view",{key:2,class:"refresh-overlay"},[e.createVNode(a,{status:"loading","show-icon":!0,color:"#FFF"})])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"refresh-action",onClick:d},[e.createElementVNode("text",{class:"refresh-text"},"çœ‹ä¸æ¸…ï¼Ÿæ¢ä¸€å¼ ")])]),e.withDirectives(e.createElementVNode("input",{class:"captcha-input","onUpdate:modelValue":r[0]||(r[0]=e=>o.value=e),placeholder:"è¯·è¾“å…¥éªŒè¯ç ",maxlength:"6",onConfirm:h},null,544),[[e.vModelText,o.value]])]),e.createElementVNode("view",{class:"captcha-actions"},[e.createElementVNode("button",{class:"action-btn cancel-btn",onClick:m},"å–æ¶ˆ"),e.createElementVNode("button",{class:e.normalizeClass(["action-btn confirm-btn",{disabled:!o.value||s.value}]),onClick:h,disabled:!o.value||s.value},e.toDisplayString(s.value?"éªŒè¯ä¸­...":"ç¡®å®š"),11,["disabled"])])])]),_:1},512)])):e.createCommentVNode("",!0)}}}),[["__scopeId","data-v-bee51414"]]);const{app:dL,Vuex:fL,Pinia:pL}=function(){const t=e.createVueApp(lL);return t.component("show-captcha",uL),{app:t}}();uni.Vuex=fL,uni.Pinia=pL,dL.provide("__globalStyles",__uniConfig.styles),dL._component.mpType="app",dL._component.render=()=>{},dL.mount("#app")}(Vue);
